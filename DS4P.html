<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Data Science for Psychologists</title>
  <meta name="description" content="PSY 703: Data Science for Psychologists: A Refreshed Exploratory and Graphical Data Analysis in R" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Data Science for Psychologists" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/DataScience4Psych/DataScience4Psych/assets/logo.png" />
  <meta property="og:description" content="PSY 703: Data Science for Psychologists: A Refreshed Exploratory and Graphical Data Analysis in R" />
  <meta name="github-repo" content="DataScience4Psych/DataScience4Psych" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science for Psychologists" />
  <meta name="twitter:site" content="@smasongarrison" />
  <meta name="twitter:description" content="PSY 703: Data Science for Psychologists: A Refreshed Exploratory and Graphical Data Analysis in R" />
  <meta name="twitter:image" content="https://github.com/DataScience4Psych/DataScience4Psych/assets/logo.png" />

<meta name="author" content="S. Mason Garrison" />


<meta name="date" content="2022-12-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.26/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<script src="libs/twitter-widget-0.0.1/widgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<html>

  <head>
  <script src="anchor-links.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GL8GKDDW8C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GL8GKDDW8C');
</script>

</head>

</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Data Science for Psychologists</h1>
<h2 class="subtitle"><em>A Refreshed Exploratory &amp; Graphical Data Analysis in R</em></h2>
<p class="author"><em>S. Mason Garrison</em></p>
<p class="date"><em>2022-12-27</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#part-front-matter" id="toc-part-front-matter">(PART*) Front Matter</a></li>
<li><a href="#welcome-to-psy-703" id="toc-welcome-to-psy-703">Welcome to PSY 703</a>
<ul>
<li><a href="#mason-notes" id="toc-mason-notes">Mason Notes</a>
<ul>
<li><a href="#how-to-use-these-notes" id="toc-how-to-use-these-notes">How to use these notes</a></li>
<li><a href="#status-of-course" id="toc-status-of-course">Status of course</a></li>
</ul></li>
</ul></li>
<li><a href="#attribution" id="toc-attribution">Attribution</a>
<ul>
<li><a href="#major-attributions" id="toc-major-attributions">Major Attributions</a></li>
<li><a href="#additional-attributions" id="toc-additional-attributions">Additional Attributions</a></li>
</ul></li>
<li><a href="#license" id="toc-license">License</a></li>
<li><a href="#sitemap" id="toc-sitemap">Sitemap</a></li>
<li><a href="#colophon" id="toc-colophon">Colophon</a></li>
<li><a href="#part-module-00" id="toc-part-module-00">(PART*) Module 00</a></li>
<li><a href="#dont-miss-module-00" id="toc-dont-miss-module-00">Don‚Äôt Miss Module 00</a>
<ul>
<li><a href="#big-ideas" id="toc-big-ideas"><span class="toc-section-number">0.1</span> Big Ideas</a></li>
<li><a href="#course-modality" id="toc-course-modality"><span class="toc-section-number">0.2</span> Course Modality</a>
<ul>
<li><a href="#successful-asynchronous-learning" id="toc-successful-asynchronous-learning"><span class="toc-section-number">0.2.1</span> Successful Asynchronous Learning</a></li>
</ul></li>
<li><a href="#knowledge-is-power" id="toc-knowledge-is-power"><span class="toc-section-number">0.3</span> Knowledge is Power</a></li>
<li><a href="#meet-prof.-mason" id="toc-meet-prof.-mason"><span class="toc-section-number">0.4</span> Meet Prof.¬†Mason</a></li>
<li><a href="#website-tour" id="toc-website-tour"><span class="toc-section-number">0.5</span> Website Tour</a></li>
</ul></li>
<li><a href="#guidance" id="toc-guidance">Guidance</a>
<ul>
<li><a href="#materials" id="toc-materials"><span class="toc-section-number">0.6</span> Materials</a>
<ul>
<li><a href="#hardware" id="toc-hardware"><span class="toc-section-number">0.6.1</span> Hardware</a></li>
<li><a href="#required-texts" id="toc-required-texts"><span class="toc-section-number">0.6.2</span> Required Texts</a></li>
<li><a href="#syllabussoftware" id="toc-syllabussoftware"><span class="toc-section-number">0.6.3</span> Software</a></li>
</ul></li>
<li><a href="#assignment-instructions" id="toc-assignment-instructions"><span class="toc-section-number">0.7</span> Assignment Instructions</a>
<ul>
<li><a href="#portfolio" id="toc-portfolio"><span class="toc-section-number">0.7.1</span> Portfolio</a></li>
<li><a href="#additional-ground-rules" id="toc-additional-ground-rules"><span class="toc-section-number">0.7.2</span> Additional Ground Rules</a></li>
</ul></li>
</ul></li>
<li><a href="#part-module-01" id="toc-part-module-01">(PART) Module 01</a></li>
<li><a href="#welcome-to-data-science" id="toc-welcome-to-data-science"><span class="toc-section-number">1</span> Welcome to Data Science</a>
<ul>
<li><a href="#module-materials" id="toc-module-materials"><span class="toc-section-number">1.1</span> Module Materials</a>
<ul>
<li><a href="#estimated-video-length" id="toc-estimated-video-length"><span class="toc-section-number">1.1.1</span> Estimated Video Length</a></li>
</ul></li>
</ul></li>
<li><a href="#what-is-data-science" id="toc-what-is-data-science"><span class="toc-section-number">2</span> What is Data Science?</a>
<ul>
<li><a href="#see-for-yourselves" id="toc-see-for-yourselves"><span class="toc-section-number">2.1</span> See for yourselves!</a>
<ul>
<li><a href="#shiny-app" id="toc-shiny-app"><span class="toc-section-number">2.1.1</span> Shiny App</a></li>
<li><a href="#hans-rosling" id="toc-hans-rosling"><span class="toc-section-number">2.1.2</span> Hans Rosling</a></li>
<li><a href="#social-media" id="toc-social-media"><span class="toc-section-number">2.1.3</span> Social Media</a></li>
<li><a href="#read-for-yourselves" id="toc-read-for-yourselves"><span class="toc-section-number">2.1.4</span> Read for yourselves!</a></li>
</ul></li>
<li><a href="#course-structure-and-some-other-useful-things" id="toc-course-structure-and-some-other-useful-things"><span class="toc-section-number">2.2</span> Course structure and some other useful things</a></li>
<li><a href="#in-class-activity" id="toc-in-class-activity"><span class="toc-section-number">2.3</span> In-Class Activity</a>
<ul>
<li><a href="#un-votes" id="toc-un-votes"><span class="toc-section-number">2.3.1</span> UN Votes</a></li>
<li><a href="#covid-data" id="toc-covid-data"><span class="toc-section-number">2.3.2</span> Covid Data</a></li>
</ul></li>
</ul></li>
<li><a href="#meet-our-toolbox" id="toc-meet-our-toolbox"><span class="toc-section-number">3</span> Meet our toolbox!</a>
<ul>
<li><a href="#r-and-rstudio" id="toc-r-and-rstudio"><span class="toc-section-number">3.1</span> R and RStudio</a>
<ul>
<li><a href="#install" id="toc-install"><span class="toc-section-number">3.1.1</span> Install R and RStudio</a></li>
<li><a href="#testing-testing" id="toc-testing-testing"><span class="toc-section-number">3.1.2</span> Testing testing</a></li>
<li><a href="#add-on-packages" id="toc-add-on-packages"><span class="toc-section-number">3.1.3</span> Add-on packages</a></li>
<li><a href="#further-resources" id="toc-further-resources"><span class="toc-section-number">3.1.4</span> Further resources</a></li>
</ul></li>
</ul></li>
<li><a href="#bechdal" id="toc-bechdal"><span class="toc-section-number">4</span> Bechdel Activity</a></li>
<li><a href="#thoughtful-workflow" id="toc-thoughtful-workflow"><span class="toc-section-number">5</span> Thoughtful Workflow</a>
<ul>
<li><a href="#rmarkdown" id="toc-rmarkdown"><span class="toc-section-number">5.1</span> R Markdown</a></li>
<li><a href="#installgit" id="toc-installgit"><span class="toc-section-number">5.2</span> Git and Github</a>
<ul>
<li><a href="#what-is-github" id="toc-what-is-github"><span class="toc-section-number">5.2.1</span> What is Github?</a></li>
<li><a href="#git" id="toc-git"><span class="toc-section-number">5.2.2</span> Git</a></li>
</ul></li>
<li><a href="#getting-help-with-r" id="toc-getting-help-with-r"><span class="toc-section-number">5.3</span> Getting Help with R</a></li>
</ul></li>
<li><a href="#r_basics" id="toc-r_basics"><span class="toc-section-number">6</span> R basics and workflows</a>
<ul>
<li><a href="#basics-of-working-with-r-at-the-command-line-and-rstudio-goodies" id="toc-basics-of-working-with-r-at-the-command-line-and-rstudio-goodies"><span class="toc-section-number">6.1</span> Basics of working with R at the command line and RStudio goodies</a>
<ul>
<li><a href="#object-names" id="toc-object-names"><span class="toc-section-number">6.1.1</span> Object names</a></li>
<li><a href="#functions" id="toc-functions"><span class="toc-section-number">6.1.2</span> Functions</a></li>
</ul></li>
<li><a href="#workspace-and-working-directory" id="toc-workspace-and-working-directory"><span class="toc-section-number">6.2</span> Workspace and working directory</a>
<ul>
<li><a href="#workspace-.rdata" id="toc-workspace-.rdata"><span class="toc-section-number">6.2.1</span> Workspace, <code>.RData</code></a></li>
<li><a href="#working-directory" id="toc-working-directory"><span class="toc-section-number">6.2.2</span> Working directory</a></li>
</ul></li>
<li><a href="#rprojs" id="toc-rprojs"><span class="toc-section-number">6.3</span> RStudio projects</a></li>
<li><a href="#tradition" id="toc-tradition"><span class="toc-section-number">6.4</span> Tradition</a></li>
</ul></li>
<li><a href="#shorthappygit" id="toc-shorthappygit"><span class="toc-section-number">7</span> RDD: Getting Started with Github</a>
<ul>
<li><a href="#the-basics-of-github" id="toc-the-basics-of-github"><span class="toc-section-number">7.1</span> The Basics of GitHub</a></li>
<li><a href="#octocat-git-and-github" id="toc-octocat-git-and-github"><span class="toc-section-number">7.2</span> :octocat: Git and GitHub</a></li>
<li><a href="#octocat-understanding-the-github-flow" id="toc-octocat-understanding-the-github-flow"><span class="toc-section-number">7.3</span> :octocat: Understanding the GitHub flow</a>
<ul>
<li><a href="#repositories" id="toc-repositories"><span class="toc-section-number">7.3.1</span> Repositories</a></li>
<li><a href="#cloning" id="toc-cloning"><span class="toc-section-number">7.3.2</span> Cloning</a></li>
<li><a href="#committing-and-pushing" id="toc-committing-and-pushing"><span class="toc-section-number">7.3.3</span> Committing and pushing</a></li>
</ul></li>
<li><a href="#github-terms-to-know" id="toc-github-terms-to-know"><span class="toc-section-number">7.4</span> üíª GitHub terms to know</a>
<ul>
<li><a href="#repositories-1" id="toc-repositories-1"><span class="toc-section-number">7.4.1</span> Repositories</a></li>
<li><a href="#branches" id="toc-branches"><span class="toc-section-number">7.4.2</span> Branches</a></li>
<li><a href="#forks" id="toc-forks"><span class="toc-section-number">7.4.3</span> Forks</a></li>
<li><a href="#pull-requests" id="toc-pull-requests"><span class="toc-section-number">7.4.4</span> Pull requests</a></li>
<li><a href="#issues" id="toc-issues"><span class="toc-section-number">7.4.5</span> Issues</a></li>
<li><a href="#your-user-profile" id="toc-your-user-profile"><span class="toc-section-number">7.4.6</span> Your user profile</a></li>
<li><a href="#using-markdown-on-github" id="toc-using-markdown-on-github"><span class="toc-section-number">7.4.7</span> Using markdown on GitHub</a></li>
<li><a href="#engaging-with-the-github-community" id="toc-engaging-with-the-github-community"><span class="toc-section-number">7.4.8</span> Engaging with the GitHub community</a></li>
</ul></li>
<li><a href="#install-intro" id="toc-install-intro"><span class="toc-section-number">7.5</span> Half the battle</a></li>
<li><a href="#github-acct" id="toc-github-acct"><span class="toc-section-number">7.6</span> Register a GitHub account</a>
<ul>
<li><a href="#username-advice" id="toc-username-advice"><span class="toc-section-number">7.6.1</span> Username advice</a></li>
<li><a href="#free-private-repos" id="toc-free-private-repos"><span class="toc-section-number">7.6.2</span> Free private repos</a></li>
</ul></li>
<li><a href="#install_git" id="toc-install_git"><span class="toc-section-number">7.7</span> Install Git</a>
<ul>
<li><a href="#git-already-installed" id="toc-git-already-installed"><span class="toc-section-number">7.7.1</span> Git already installed?</a></li>
</ul></li>
<li><a href="#install-git-windows" id="toc-install-git-windows"><span class="toc-section-number">7.8</span> Windows</a>
<ul>
<li><a href="#macos" id="toc-macos"><span class="toc-section-number">7.8.1</span> macOS</a></li>
</ul></li>
<li><a href="#hello-git" id="toc-hello-git"><span class="toc-section-number">7.9</span> Introduce yourself to Git</a>
<ul>
<li><a href="#more-about-git-config" id="toc-more-about-git-config"><span class="toc-section-number">7.9.1</span> More about <code>git config</code></a></li>
<li><a href="#git-editor" id="toc-git-editor"><span class="toc-section-number">7.9.2</span> Configure the Git editor</a></li>
</ul></li>
<li><a href="#git-client" id="toc-git-client"><span class="toc-section-number">7.10</span> Install a Git client</a>
<ul>
<li><a href="#what-is-a-git-client-why-would-you-want-one" id="toc-what-is-a-git-client-why-would-you-want-one"><span class="toc-section-number">7.10.1</span> What is a Git client? Why would you want one?</a></li>
<li><a href="#a-picture-is-worth-a-thousand-words" id="toc-a-picture-is-worth-a-thousand-words"><span class="toc-section-number">7.10.2</span> A picture is worth a thousand words</a></li>
<li><a href="#no-one-is-giving-out-git-nerd-merit-badges" id="toc-no-one-is-giving-out-git-nerd-merit-badges"><span class="toc-section-number">7.10.3</span> No one is giving out Git Nerd merit badges</a></li>
<li><a href="#recommended-git-clients" id="toc-recommended-git-clients"><span class="toc-section-number">7.10.4</span> Recommended Git clients</a></li>
</ul></li>
<li><a href="#resources" id="toc-resources"><span class="toc-section-number">7.11</span> üìö Resources</a></li>
<li><a href="#optional-next-steps" id="toc-optional-next-steps"><span class="toc-section-number">7.12</span> üìù Optional next steps</a></li>
</ul></li>
<li><a href="#lab01" id="toc-lab01"><span class="toc-section-number">8</span> Lab: Hello R!</a>
<ul>
<li><a href="#lab-goals" id="toc-lab-goals">Lab Goals</a></li>
<li><a href="#getting-started" id="toc-getting-started">Getting started</a>
<ul>
<li><a href="#option-1-use-rstudio" id="toc-option-1-use-rstudio">Option 1: Use RStudio</a></li>
<li><a href="#option-2-use-github-desktop" id="toc-option-2-use-github-desktop">Option 2: Use Github Desktop</a></li>
<li><a href="#option-3-brute-force" id="toc-option-3-brute-force">Option 3: Brute Force</a></li>
</ul></li>
<li><a href="#warm-up" id="toc-warm-up">Warm up</a>
<ul>
<li><a href="#yaml" id="toc-yaml">YAML</a></li>
<li><a href="#committing-changes" id="toc-committing-changes">Committing changes</a></li>
<li><a href="#pushing-changes" id="toc-pushing-changes">Pushing changes</a></li>
<li><a href="#packages" id="toc-packages">Packages</a></li>
<li><a href="#data" id="toc-data">Data</a></li>
</ul></li>
<li><a href="#exercises" id="toc-exercises">Exercises</a></li>
</ul></li>
<li><a href="#part-module-02" id="toc-part-module-02">(PART) Module 02</a></li>
<li><a href="#welcome-to-data-and-visualization" id="toc-welcome-to-data-and-visualization"><span class="toc-section-number">9</span> Welcome to Data and Visualization</a>
<ul>
<li><a href="#module-materials-1" id="toc-module-materials-1"><span class="toc-section-number">9.1</span> Module Materials</a>
<ul>
<li><a href="#estimated-video-length-1" id="toc-estimated-video-length-1"><span class="toc-section-number">9.1.1</span> Estimated Video Length</a></li>
</ul></li>
</ul></li>
<li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis"><span class="toc-section-number">10</span> Exploratory Data Analysis</a>
<ul>
<li><a href="#what-is-in-a-dataset" id="toc-what-is-in-a-dataset"><span class="toc-section-number">10.1</span> What is in a dataset?</a>
<ul>
<li><a href="#why-do-we-visualize" id="toc-why-do-we-visualize"><span class="toc-section-number">10.1.1</span> Why do we visualize?</a></li>
</ul></li>
</ul></li>
<li><a href="#visualizing-data-with-ggplot2" id="toc-visualizing-data-with-ggplot2"><span class="toc-section-number">11</span> Visualizing data with ggplot2</a>
<ul>
<li><a href="#ggplot2-and-aesthetics" id="toc-ggplot2-and-aesthetics"><span class="toc-section-number">11.1</span> ggplot2 and aesthetics</a></li>
</ul></li>
<li><a href="#visualizing-numerical-data" id="toc-visualizing-numerical-data"><span class="toc-section-number">12</span> Visualizing numerical data</a>
<ul>
<li><a href="#looking-at-data" id="toc-looking-at-data"><span class="toc-section-number">12.1</span> Looking at Data</a></li>
<li><a href="#more-on-visualizing-numerical-data" id="toc-more-on-visualizing-numerical-data"><span class="toc-section-number">12.2</span> More on visualizing numerical data</a></li>
</ul></li>
<li><a href="#visualizing-categorical-data" id="toc-visualizing-categorical-data"><span class="toc-section-number">13</span> Visualizing categorical data</a></li>
<li><a href="#star-wars-activity" id="toc-star-wars-activity"><span class="toc-section-number">14</span> Star Wars Activity!</a></li>
<li><a href="#visualization-examples" id="toc-visualization-examples"><span class="toc-section-number">15</span> Visualization Examples</a>
<ul>
<li><a href="#census-reporter-data-from-north-carolina" id="toc-census-reporter-data-from-north-carolina"><span class="toc-section-number">15.1</span> Census Reporter Data from North Carolina</a></li>
</ul></li>
<li><a href="#basiccare" id="toc-basiccare"><span class="toc-section-number">16</span> Basic care and feeding of data in R</a>
<ul>
<li><a href="#buckle-your-seatbelt" id="toc-buckle-your-seatbelt"><span class="toc-section-number">16.1</span> Buckle your seatbelt</a></li>
<li><a href="#data-frames-are-awesome" id="toc-data-frames-are-awesome"><span class="toc-section-number">16.2</span> Data frames are awesome</a></li>
<li><a href="#get-the-gapminder-data" id="toc-get-the-gapminder-data"><span class="toc-section-number">16.3</span> Get the Gapminder data</a></li>
<li><a href="#meet-the-gapminder-data-frame-or-tibble" id="toc-meet-the-gapminder-data-frame-or-tibble"><span class="toc-section-number">16.4</span> Meet the <code>gapminder</code> data frame or ‚Äútibble‚Äù</a></li>
<li><a href="#look-at-the-variables-inside-a-data-frame" id="toc-look-at-the-variables-inside-a-data-frame"><span class="toc-section-number">16.5</span> Look at the variables inside a data frame</a></li>
<li><a href="#recap" id="toc-recap"><span class="toc-section-number">16.6</span> Recap</a></li>
</ul></li>
<li><a href="#lab02" id="toc-lab02"><span class="toc-section-number">17</span> Lab: Global plastic waste</a>
<ul>
<li><a href="#learning-goals" id="toc-learning-goals">Learning goals</a></li>
<li><a href="#getting-started-1" id="toc-getting-started-1">Getting started</a>
<ul>
<li><a href="#packages-1" id="toc-packages-1">Packages</a></li>
<li><a href="#data-1" id="toc-data-1">Data</a></li>
</ul></li>
<li><a href="#warm-up-1" id="toc-warm-up-1">Warm up</a></li>
<li><a href="#exercises-1" id="toc-exercises-1">Exercises</a></li>
<li><a href="#wrapping-up" id="toc-wrapping-up">Wrapping up</a></li>
</ul></li>
<li><a href="#part-module-03" id="toc-part-module-03">(PART) Module 03</a></li>
<li><a href="#welcome-to-the-tidyverse" id="toc-welcome-to-the-tidyverse"><span class="toc-section-number">18</span> Welcome to the tidyverse!</a>
<ul>
<li><a href="#module-materials-2" id="toc-module-materials-2"><span class="toc-section-number">18.1</span> Module Materials</a></li>
<li><a href="#estimated-video-length-2" id="toc-estimated-video-length-2"><span class="toc-section-number">18.2</span> Estimated Video Length</a></li>
</ul></li>
<li><a href="#tidy-data" id="toc-tidy-data"><span class="toc-section-number">19</span> Tidy data</a>
<ul>
<li><a href="#data-structures-in-r" id="toc-data-structures-in-r"><span class="toc-section-number">19.1</span> Data structures in R</a></li>
</ul></li>
<li><a href="#grammar-of-data-wrangling" id="toc-grammar-of-data-wrangling"><span class="toc-section-number">20</span> Grammar of data wrangling</a>
<ul>
<li><a href="#piping" id="toc-piping"><span class="toc-section-number">20.1</span> Piping</a></li>
</ul></li>
<li><a href="#dplyr_intro" id="toc-dplyr_intro"><span class="toc-section-number">21</span> Introduction to dplyr</a>
<ul>
<li><a href="#load-dplyr-and-gapminder" id="toc-load-dplyr-and-gapminder"><span class="toc-section-number">21.0.1</span> Load dplyr and gapminder</a></li>
<li><a href="#say-hello-to-the-gapminder-tibble" id="toc-say-hello-to-the-gapminder-tibble"><span class="toc-section-number">21.0.2</span> Say hello to the <code>gapminder</code> tibble</a></li>
<li><a href="#think-before-you-create-excerpts-of-your-data" id="toc-think-before-you-create-excerpts-of-your-data"><span class="toc-section-number">21.1</span> Think before you create excerpts of your data ‚Ä¶</a></li>
<li><a href="#use-filter-to-subset-data-row-wise" id="toc-use-filter-to-subset-data-row-wise"><span class="toc-section-number">21.2</span> Use <code>filter()</code> to subset data row-wise</a></li>
<li><a href="#meet-the-new-pipe-operator" id="toc-meet-the-new-pipe-operator"><span class="toc-section-number">21.3</span> Meet the new pipe operator</a></li>
<li><a href="#use-select-to-subset-the-data-on-variables-or-columns." id="toc-use-select-to-subset-the-data-on-variables-or-columns."><span class="toc-section-number">21.4</span> Use <code>select()</code> to subset the data on variables or columns.</a></li>
<li><a href="#revel-in-the-convenience" id="toc-revel-in-the-convenience"><span class="toc-section-number">21.5</span> Revel in the convenience</a></li>
<li><a href="#pure-predictable-pipeable" id="toc-pure-predictable-pipeable"><span class="toc-section-number">21.6</span> Pure, predictable, pipeable</a></li>
</ul></li>
<li><a href="#handson" id="toc-handson"><span class="toc-section-number">22</span> Hands on Data Wrangling</a>
<ul>
<li><a href="#working-with-a-single-data-frame" id="toc-working-with-a-single-data-frame"><span class="toc-section-number">22.1</span> Working with a single data frame</a></li>
<li><a href="#activity-04-hotels" id="toc-activity-04-hotels"><span class="toc-section-number">22.2</span> Activity 04: Hotels!</a></li>
<li><a href="#dplyr_single" id="toc-dplyr_single"><span class="toc-section-number">22.3</span> ODD: Single table dplyr functions</a>
<ul>
<li><a href="#load-dplyr-and-gapminder-1" id="toc-load-dplyr-and-gapminder-1"><span class="toc-section-number">22.3.1</span> Load dplyr and gapminder</a></li>
<li><a href="#create-a-copy-of-gapminder" id="toc-create-a-copy-of-gapminder"><span class="toc-section-number">22.3.2</span> Create a copy of <code>gapminder</code></a></li>
<li><a href="#use-mutate-to-add-new-variables" id="toc-use-mutate-to-add-new-variables"><span class="toc-section-number">22.3.3</span> Use <code>mutate()</code> to add new variables</a></li>
<li><a href="#use-arrange-to-row-order-data-in-a-principled-way" id="toc-use-arrange-to-row-order-data-in-a-principled-way"><span class="toc-section-number">22.3.4</span> Use <code>arrange()</code> to row-order data in a principled way</a></li>
<li><a href="#use-rename-to-rename-variables" id="toc-use-rename-to-rename-variables"><span class="toc-section-number">22.3.5</span> Use <code>rename()</code> to rename variables</a></li>
<li><a href="#select-can-rename-and-reposition-variables" id="toc-select-can-rename-and-reposition-variables"><span class="toc-section-number">22.3.6</span> <code>select()</code> can rename and reposition variables</a></li>
<li><a href="#group_by-is-a-mighty-weapon" id="toc-group_by-is-a-mighty-weapon"><span class="toc-section-number">22.3.7</span> <code>group_by()</code> is a mighty weapon</a></li>
<li><a href="#grouped-mutate" id="toc-grouped-mutate"><span class="toc-section-number">22.3.8</span> Grouped mutate</a></li>
<li><a href="#grand-finale" id="toc-grand-finale"><span class="toc-section-number">22.3.9</span> Grand Finale</a></li>
<li><a href="#resources-1" id="toc-resources-1"><span class="toc-section-number">22.3.10</span> Resources</a></li>
</ul></li>
</ul></li>
<li><a href="#working-with-multiple-data-frames" id="toc-working-with-multiple-data-frames"><span class="toc-section-number">23</span> Working with multiple data frames</a>
<ul>
<li><a href="#case-studies-in-joining" id="toc-case-studies-in-joining"><span class="toc-section-number">23.1</span> Case Studies in Joining</a></li>
</ul></li>
<li><a href="#merges" id="toc-merges"><span class="toc-section-number">24</span> ODD: Merges and Collaboration</a>
<ul>
<li><a href="#learning-goal" id="toc-learning-goal"><span class="toc-section-number">24.1</span> Learning goal</a></li>
<li><a href="#merges-and-merge-conflicts" id="toc-merges-and-merge-conflicts"><span class="toc-section-number">24.2</span> Merges and merge conflicts</a></li>
<li><a href="#merge-conflict-activity" id="toc-merge-conflict-activity"><span class="toc-section-number">24.3</span> Merge conflict activity</a>
<ul>
<li><a href="#setup" id="toc-setup"><span class="toc-section-number">24.3.1</span> Setup</a></li>
<li><a href="#lets-cause-a-merge-conflict" id="toc-lets-cause-a-merge-conflict"><span class="toc-section-number">24.3.2</span> Let‚Äôs cause a merge conflict!</a></li>
</ul></li>
<li><a href="#tips-for-collaborating-via-github" id="toc-tips-for-collaborating-via-github"><span class="toc-section-number">24.4</span> Tips for collaborating via GitHub</a></li>
</ul></li>
<li><a href="#lab03" id="toc-lab03"><span class="toc-section-number">25</span> Lab: Nobel laureates</a>
<ul>
<li><a href="#learning-goals-1" id="toc-learning-goals-1"><span class="toc-section-number">25.1</span> Learning goals</a></li>
<li><a href="#lab-prep" id="toc-lab-prep"><span class="toc-section-number">25.2</span> Lab prep</a></li>
<li><a href="#getting-started-2" id="toc-getting-started-2"><span class="toc-section-number">25.3</span> Getting started</a>
<ul>
<li><a href="#warm-up-2" id="toc-warm-up-2"><span class="toc-section-number">25.3.1</span> Warm up</a></li>
<li><a href="#packages-2" id="toc-packages-2"><span class="toc-section-number">25.3.2</span> Packages</a></li>
<li><a href="#data-2" id="toc-data-2"><span class="toc-section-number">25.3.3</span> Data</a></li>
</ul></li>
<li><a href="#exercises-2" id="toc-exercises-2"><span class="toc-section-number">25.4</span> Exercises</a>
<ul>
<li><a href="#get-to-know-your-data" id="toc-get-to-know-your-data"><span class="toc-section-number">25.4.1</span> Get to know your data</a></li>
<li><a href="#most-living-nobel-laureates-were-based-in-the-us-when-they-won-their-prizes" id="toc-most-living-nobel-laureates-were-based-in-the-us-when-they-won-their-prizes"><span class="toc-section-number">25.4.2</span> Most living Nobel laureates were based in the US when they won their prizes</a></li>
</ul></li>
<li><a href="#but-of-those-us-based-nobel-laureates-many-were-born-in-other-countries" id="toc-but-of-those-us-based-nobel-laureates-many-were-born-in-other-countries"><span class="toc-section-number">25.5</span> But of those US-based Nobel laureates, many were born in other countries</a>
<ul>
<li><a href="#heres-where-those-immigrant-nobelists-were-born" id="toc-heres-where-those-immigrant-nobelists-were-born"><span class="toc-section-number">25.5.1</span> Here‚Äôs where those immigrant Nobelists were born</a></li>
</ul></li>
<li><a href="#interested-in-how-buzzfeed-made-their-visualizations" id="toc-interested-in-how-buzzfeed-made-their-visualizations"><span class="toc-section-number">25.6</span> Interested in how Buzzfeed made their visualizations?</a></li>
</ul></li>
<li><a href="#part-module-04" id="toc-part-module-04">(PART) Module 04</a></li>
<li><a href="#welcome-to-data-diving-with-types" id="toc-welcome-to-data-diving-with-types"><span class="toc-section-number">26</span> Welcome to Data Diving with Types</a>
<ul>
<li><a href="#module-materials-3" id="toc-module-materials-3"><span class="toc-section-number">26.1</span> Module Materials</a></li>
<li><a href="#estimated-video-length-3" id="toc-estimated-video-length-3"><span class="toc-section-number">26.2</span> Estimated Video Length</a></li>
</ul></li>
<li><a href="#data-types-and-recoding" id="toc-data-types-and-recoding"><span class="toc-section-number">27</span> Data types and recoding</a>
<ul>
<li><a href="#why-should-you-care-about-data-types" id="toc-why-should-you-care-about-data-types"><span class="toc-section-number">27.1</span> Why should you care about data types?</a></li>
<li><a href="#data-types" id="toc-data-types"><span class="toc-section-number">27.2</span> Data types!</a>
<ul>
<li><a href="#another-hotels-activity" id="toc-another-hotels-activity"><span class="toc-section-number">27.2.1</span> Another Hotels Activity</a></li>
</ul></li>
<li><a href="#special-values" id="toc-special-values"><span class="toc-section-number">27.3</span> Special Values</a></li>
<li><a href="#data-classes" id="toc-data-classes"><span class="toc-section-number">27.4</span> Data classes</a></li>
<li><a href="#working-with-factors" id="toc-working-with-factors"><span class="toc-section-number">27.5</span> Working with factors</a>
<ul>
<li><a href="#an-another-hotels-activity" id="toc-an-another-hotels-activity"><span class="toc-section-number">27.5.1</span> (An) Another Hotels Activity</a></li>
</ul></li>
<li><a href="#working-with-dates" id="toc-working-with-dates"><span class="toc-section-number">27.6</span> Working with Dates</a></li>
</ul></li>
<li><a href="#importing-data" id="toc-importing-data"><span class="toc-section-number">28</span> Importing data!</a>
<ul>
<li><a href="#importing-data-1" id="toc-importing-data-1"><span class="toc-section-number">28.1</span> Importing data!</a>
<ul>
<li><a href="#another-activity" id="toc-another-activity"><span class="toc-section-number">28.1.1</span> Another Activity</a></li>
</ul></li>
<li><a href="#importing-and-variable-types" id="toc-importing-and-variable-types"><span class="toc-section-number">28.2</span> Importing and Variable Types!</a>
<ul>
<li><a href="#more-activity" id="toc-more-activity"><span class="toc-section-number">28.2.1</span> More Activity</a></li>
</ul></li>
<li><a href="#vroom" id="toc-vroom"><span class="toc-section-number">28.3</span> Vroom!</a></li>
</ul></li>
<li><a href="#import-export" id="toc-import-export"><span class="toc-section-number">29</span> Writing and reading files</a>
<ul>
<li><a href="#file-io-overview" id="toc-file-io-overview"><span class="toc-section-number">29.1</span> File I/O overview</a>
<ul>
<li><a href="#data-import-mindset" id="toc-data-import-mindset"><span class="toc-section-number">29.1.1</span> Data import mindset</a></li>
<li><a href="#data-export-mindset" id="toc-data-export-mindset"><span class="toc-section-number">29.1.2</span> Data export mindset</a></li>
</ul></li>
<li><a href="#lets-begin" id="toc-lets-begin"><span class="toc-section-number">29.2</span> Let‚Äôs Begin!</a>
<ul>
<li><a href="#load-the-tidyverse" id="toc-load-the-tidyverse"><span class="toc-section-number">29.2.1</span> Load the tidyverse</a></li>
<li><a href="#locate-the-gapminder-data" id="toc-locate-the-gapminder-data"><span class="toc-section-number">29.2.2</span> Locate the Gapminder data</a></li>
<li><a href="#bring-rectangular-data-in" id="toc-bring-rectangular-data-in"><span class="toc-section-number">29.2.3</span> Bring rectangular data in</a></li>
</ul></li>
<li><a href="#compute-something-worthy-of-export" id="toc-compute-something-worthy-of-export"><span class="toc-section-number">29.3</span> Compute something worthy of export</a>
<ul>
<li><a href="#write-rectangular-data-out" id="toc-write-rectangular-data-out"><span class="toc-section-number">29.3.1</span> Write rectangular data out</a></li>
<li><a href="#invertibility" id="toc-invertibility"><span class="toc-section-number">29.3.2</span> Invertibility</a></li>
<li><a href="#reordering-the-levels-of-the-country-factor" id="toc-reordering-the-levels-of-the-country-factor"><span class="toc-section-number">29.3.3</span> Reordering the levels of the country factor</a></li>
<li><a href="#saverds-and-readrds" id="toc-saverds-and-readrds"><span class="toc-section-number">29.3.4</span> <code>saveRDS()</code> and <code>readRDS()</code></a></li>
<li><a href="#retaining-factor-levels-upon-re-import" id="toc-retaining-factor-levels-upon-re-import"><span class="toc-section-number">29.3.5</span> Retaining factor levels upon re-import</a></li>
<li><a href="#dput-and-dget" id="toc-dput-and-dget"><span class="toc-section-number">29.3.6</span> <code>dput()</code> and <code>dget()</code></a></li>
<li><a href="#other-types-of-objects-to-use-dput-or-saverds-on" id="toc-other-types-of-objects-to-use-dput-or-saverds-on"><span class="toc-section-number">29.3.7</span> Other types of objects to use <code>dput()</code> or <code>saveRDS()</code> on</a></li>
</ul></li>
<li><a href="#clean-up" id="toc-clean-up"><span class="toc-section-number">29.4</span> Clean up</a>
<ul>
<li><a href="#pitfalls-of-delimited-files" id="toc-pitfalls-of-delimited-files"><span class="toc-section-number">29.4.1</span> Pitfalls of delimited files</a></li>
</ul></li>
<li><a href="#resources-2" id="toc-resources-2"><span class="toc-section-number">29.5</span> Resources</a></li>
</ul></li>
<li><a href="#odd-transformations-data" id="toc-odd-transformations-data"><span class="toc-section-number">30</span> ODD: Transformations data!</a>
<ul>
<li><a href="#transforming-data-tukeys-ladder-of-powers" id="toc-transforming-data-tukeys-ladder-of-powers"><span class="toc-section-number">30.1</span> Transforming Data: Tukey‚Äôs Ladder of Powers</a></li>
<li><a href="#vectorizing-a-function" id="toc-vectorizing-a-function"><span class="toc-section-number">30.2</span> Vectorizing a function</a></li>
<li><a href="#box-cox-transformation" id="toc-box-cox-transformation"><span class="toc-section-number">30.3</span> Box Cox Transformation</a>
<ul>
<li><a href="#additional-resources" id="toc-additional-resources"><span class="toc-section-number">30.3.1</span> Additional Resources</a></li>
</ul></li>
</ul></li>
<li><a href="#lab04" id="toc-lab04"><span class="toc-section-number">31</span> Lab: Visualizing spatial data</a>
<ul>
<li><a href="#la-quinta-is-spanish-for-next-to-dennys-pt.-1" id="toc-la-quinta-is-spanish-for-next-to-dennys-pt.-1"><span class="toc-section-number">31.1</span> La Quinta is Spanish for ‚Äònext to Denny‚Äôs‚Äô, Pt. 1</a></li>
<li><a href="#getting-started-3" id="toc-getting-started-3"><span class="toc-section-number">31.2</span> Getting started</a>
<ul>
<li><a href="#packages-3" id="toc-packages-3"><span class="toc-section-number">31.2.1</span> Packages</a></li>
<li><a href="#project-name" id="toc-project-name"><span class="toc-section-number">31.2.2</span> Project name</a></li>
<li><a href="#warm-up-3" id="toc-warm-up-3"><span class="toc-section-number">31.2.3</span> Warm up</a></li>
<li><a href="#yaml-1" id="toc-yaml-1"><span class="toc-section-number">31.2.4</span> YAML</a></li>
<li><a href="#commiting-and-pushing-changes" id="toc-commiting-and-pushing-changes"><span class="toc-section-number">31.2.5</span> Commiting and pushing changes</a></li>
</ul></li>
<li><a href="#the-data" id="toc-the-data"><span class="toc-section-number">31.3</span> The data</a></li>
<li><a href="#exercises-3" id="toc-exercises-3">Exercises</a></li>
</ul></li>
<li><a href="#part-module-05" id="toc-part-module-05">(PART) Module 05</a></li>
<li><a href="#welcome-to-tips-for-effective-data-visualization" id="toc-welcome-to-tips-for-effective-data-visualization"><span class="toc-section-number">32</span> Welcome to Tips for effective data visualization</a>
<ul>
<li><a href="#module-materials-4" id="toc-module-materials-4"><span class="toc-section-number">32.1</span> Module Materials</a></li>
<li><a href="#estimated-video-length-4" id="toc-estimated-video-length-4"><span class="toc-section-number">32.2</span> Estimated Video Length</a></li>
</ul></li>
<li><a href="#designing-effective-visualizations" id="toc-designing-effective-visualizations"><span class="toc-section-number">33</span> Designing effective visualizations</a>
<ul>
<li><a href="#principles-for-effective-visualizations" id="toc-principles-for-effective-visualizations"><span class="toc-section-number">33.1</span> Principles for effective visualizations!</a></li>
</ul></li>
<li><a href="#deeper-diving-into-ggplot2" id="toc-deeper-diving-into-ggplot2"><span class="toc-section-number">34</span> Deeper Diving into ggplot2!</a>
<ul>
<li><a href="#what-are-the-components-of-a-plot" id="toc-what-are-the-components-of-a-plot"><span class="toc-section-number">34.1</span> What are the components of a plot?</a></li>
<li><a href="#stats-geoms-and-positions" id="toc-stats-geoms-and-positions"><span class="toc-section-number">34.2</span> Stats, Geoms, and Positions</a>
<ul>
<li><a href="#jitter-to-the-rescue" id="toc-jitter-to-the-rescue"><span class="toc-section-number">34.2.1</span> Jitter to the rescue!</a></li>
</ul></li>
<li><a href="#scales-and-coordinates" id="toc-scales-and-coordinates"><span class="toc-section-number">34.3</span> Scales and Coordinates</a></li>
<li><a href="#how-this-all-works-with-minard" id="toc-how-this-all-works-with-minard"><span class="toc-section-number">34.4</span> How this all works with Minard</a></li>
</ul></li>
<li><a href="#plots-behaving-badly" id="toc-plots-behaving-badly"><span class="toc-section-number">35</span> Plots Behaving Badly</a>
<ul>
<li><a href="#general-principles" id="toc-general-principles"><span class="toc-section-number">35.1</span> General Principles</a>
<ul>
<li><a href="#piecharts" id="toc-piecharts"><span class="toc-section-number">35.1.1</span> Piecharts</a></li>
<li><a href="#barplots-as-data-summaries" id="toc-barplots-as-data-summaries"><span class="toc-section-number">35.1.2</span> Barplots as data summaries</a></li>
<li><a href="#show-the-scatterplot" id="toc-show-the-scatterplot"><span class="toc-section-number">35.1.3</span> Show the scatterplot</a></li>
</ul></li>
<li><a href="#high-correlation-does-not-imply-replication" id="toc-high-correlation-does-not-imply-replication"><span class="toc-section-number">35.2</span> High correlation does not imply replication</a></li>
<li><a href="#barpots-for-paired-data" id="toc-barpots-for-paired-data"><span class="toc-section-number">35.3</span> Barpots for paired data</a></li>
<li><a href="#gratuitous-3d" id="toc-gratuitous-3d"><span class="toc-section-number">35.4</span> Gratuitous 3D</a></li>
<li><a href="#ignoring-important-factors" id="toc-ignoring-important-factors"><span class="toc-section-number">35.5</span> Ignoring important factors</a></li>
<li><a href="#too-many-significant-digits" id="toc-too-many-significant-digits"><span class="toc-section-number">35.6</span> Too many significant digits</a></li>
<li><a href="#displaying-data-well" id="toc-displaying-data-well"><span class="toc-section-number">35.7</span> Displaying data well</a></li>
<li><a href="#some-further-reading" id="toc-some-further-reading"><span class="toc-section-number">35.8</span> Some further reading:</a></li>
</ul></li>
<li><a href="#odd-design-choices-in-data-visualization" id="toc-odd-design-choices-in-data-visualization"><span class="toc-section-number">36</span> ODD: Design choices in data visualization</a>
<ul>
<li><a href="#how-to-spot-a-misleading-graph" id="toc-how-to-spot-a-misleading-graph"><span class="toc-section-number">36.1</span> How to spot a misleading graph</a></li>
<li><a href="#data-visualization-and-misrepresentation" id="toc-data-visualization-and-misrepresentation"><span class="toc-section-number">36.2</span> Data Visualization and Misrepresentation</a></li>
<li><a href="#vox-on-how-coronavirus-charts-can-mislead-us" id="toc-vox-on-how-coronavirus-charts-can-mislead-us"><span class="toc-section-number">36.3</span> Vox on How coronavirus charts can mislead us</a></li>
<li><a href="#vox-on-shut-up-about-the-y-axis.-it-shouldnt-always-start-at-zero." id="toc-vox-on-shut-up-about-the-y-axis.-it-shouldnt-always-start-at-zero."><span class="toc-section-number">36.4</span> Vox on Shut up about the y-axis. It shouldn‚Äôt always start at zero.</a></li>
<li><a href="#gloriously-terrible-plots" id="toc-gloriously-terrible-plots"><span class="toc-section-number">36.5</span> Gloriously Terrible Plots!!</a></li>
</ul></li>
<li><a href="#secrets" id="toc-secrets"><span class="toc-section-number">37</span> ODD: Secrets of a happy graphing life</a>
<ul>
<li><a href="#load-gapminder-and-the-tidyverse" id="toc-load-gapminder-and-the-tidyverse"><span class="toc-section-number">37.1</span> Load gapminder and the tidyverse</a></li>
<li><a href="#hidden-data-wrangling-problems" id="toc-hidden-data-wrangling-problems"><span class="toc-section-number">37.2</span> Hidden data wrangling problems</a></li>
<li><a href="#keep-stuff-in-data-frames" id="toc-keep-stuff-in-data-frames"><span class="toc-section-number">37.3</span> Keep stuff in data frames</a>
<ul>
<li><a href="#explicit-data-frame-creation-via-tibbletibble-and-tibbletribble" id="toc-explicit-data-frame-creation-via-tibbletibble-and-tibbletribble"><span class="toc-section-number">37.3.1</span> Explicit data frame creation via <code>tibble::tibble()</code> and <code>tibble::tribble()</code></a></li>
<li><a href="#sidebar-with" id="toc-sidebar-with"><span class="toc-section-number">37.3.2</span> Sidebar: <code>with()</code></a></li>
</ul></li>
<li><a href="#worked-example" id="toc-worked-example"><span class="toc-section-number">37.4</span> Worked example</a>
<ul>
<li><a href="#reshape-your-data" id="toc-reshape-your-data"><span class="toc-section-number">37.4.1</span> Reshape your data</a></li>
<li><a href="#iterate-over-the-variables-via-faceting" id="toc-iterate-over-the-variables-via-faceting"><span class="toc-section-number">37.4.2</span> Iterate over the variables via faceting</a></li>
<li><a href="#recap-1" id="toc-recap-1"><span class="toc-section-number">37.4.3</span> Recap</a></li>
</ul></li>
</ul></li>
<li><a href="#save-figs" id="toc-save-figs"><span class="toc-section-number">38</span> Writing figures to file</a>
<ul>
<li><a href="#step-away-from-the-mouse" id="toc-step-away-from-the-mouse"><span class="toc-section-number">38.1</span> Step away from the mouse</a></li>
<li><a href="#good-names-are-like-breadcrumbs" id="toc-good-names-are-like-breadcrumbs"><span class="toc-section-number">38.2</span> Good names are like breadcrumbs</a></li>
<li><a href="#graphics-devices" id="toc-graphics-devices"><span class="toc-section-number">38.3</span> Graphics devices</a></li>
<li><a href="#write-figures-to-file-with-ggsave" id="toc-write-figures-to-file-with-ggsave"><span class="toc-section-number">38.4</span> Write figures to file with <code>ggsave()</code></a>
<ul>
<li><a href="#passing-a-plot-object-to-ggsave" id="toc-passing-a-plot-object-to-ggsave"><span class="toc-section-number">38.4.1</span> Passing a plot object to <code>ggsave()</code></a></li>
<li><a href="#scaling" id="toc-scaling"><span class="toc-section-number">38.4.2</span> Scaling</a></li>
</ul></li>
<li><a href="#write-non-ggplot2-figures-to-file" id="toc-write-non-ggplot2-figures-to-file"><span class="toc-section-number">38.5</span> Write non-ggplot2 figures to file</a></li>
<li><a href="#preemptive-answers-to-some-faqs" id="toc-preemptive-answers-to-some-faqs"><span class="toc-section-number">38.6</span> Preemptive answers to some FAQs</a>
<ul>
<li><a href="#despair-over-non-existent-or-empty-figures" id="toc-despair-over-non-existent-or-empty-figures"><span class="toc-section-number">38.6.1</span> Despair over non-existent or empty figures</a></li>
<li><a href="#mysterious-empty-rplots.pdf-file" id="toc-mysterious-empty-rplots.pdf-file"><span class="toc-section-number">38.6.2</span> Mysterious empty <code>Rplots.pdf</code> file</a></li>
</ul></li>
<li><a href="#chunk-name-determines-figure-file-name" id="toc-chunk-name-determines-figure-file-name"><span class="toc-section-number">38.7</span> Chunk name determines figure file name</a></li>
<li><a href="#clean-up-1" id="toc-clean-up-1"><span class="toc-section-number">38.8</span> Clean up</a></li>
</ul></li>
<li><a href="#lab05" id="toc-lab05"><span class="toc-section-number">39</span> Lab: Wrangling spatial data</a>
<ul>
<li><a href="#la-quinta-is-spanish-for-next-to-dennys-pt.-2" id="toc-la-quinta-is-spanish-for-next-to-dennys-pt.-2"><span class="toc-section-number">39.1</span> La Quinta is Spanish for <em>next to Denny‚Äôs</em>, Pt. 2‚Äù</a></li>
<li><a href="#getting-started-4" id="toc-getting-started-4"><span class="toc-section-number">39.2</span> Getting started</a>
<ul>
<li><a href="#packages-4" id="toc-packages-4"><span class="toc-section-number">39.2.1</span> Packages</a></li>
<li><a href="#housekeeping" id="toc-housekeeping"><span class="toc-section-number">39.2.2</span> Housekeeping</a></li>
</ul></li>
<li><a href="#warm-up-4" id="toc-warm-up-4"><span class="toc-section-number">39.3</span> Warm up</a>
<ul>
<li><a href="#yaml-2" id="toc-yaml-2"><span class="toc-section-number">39.3.1</span> YAML</a></li>
<li><a href="#commiting-and-pushing-changes-1" id="toc-commiting-and-pushing-changes-1"><span class="toc-section-number">39.3.2</span> Commiting and pushing changes:</a></li>
</ul></li>
<li><a href="#the-data-1" id="toc-the-data-1"><span class="toc-section-number">39.4</span> The data</a></li>
<li><a href="#exercises-4" id="toc-exercises-4"><span class="toc-section-number">39.5</span> Exercises</a></li>
</ul></li>
<li><a href="#part-module-06" id="toc-part-module-06">(PART) Module 06</a></li>
<li><a href="#mod06" id="toc-mod06"><span class="toc-section-number">40</span> Welcome to Confounding and Communication!</a>
<ul>
<li><a href="#module-materials-5" id="toc-module-materials-5"><span class="toc-section-number">40.1</span> Module Materials</a></li>
<li><a href="#video-length" id="toc-video-length"><span class="toc-section-number">40.2</span> Video Length</a></li>
</ul></li>
<li><a href="#scientific-studies-and-confounding" id="toc-scientific-studies-and-confounding"><span class="toc-section-number">41</span> Scientific studies and confounding!</a>
<ul>
<li><a href="#scientific-studies" id="toc-scientific-studies"><span class="toc-section-number">41.1</span> Scientific studies</a></li>
<li><a href="#climate-change-a-conditional-probability-case-study" id="toc-climate-change-a-conditional-probability-case-study"><span class="toc-section-number">41.2</span> Climate Change: A Conditional Probability Case Study</a></li>
<li><a href="#introducing-simpsons-paradox-with-a-case-study" id="toc-introducing-simpsons-paradox-with-a-case-study"><span class="toc-section-number">41.3</span> Introducing Simpson‚Äôs Paradox with a case study</a></li>
<li><a href="#revisiting-simpsons-paradox" id="toc-revisiting-simpsons-paradox"><span class="toc-section-number">41.4</span> Revisiting Simpson‚Äôs Paradox</a></li>
</ul></li>
<li><a href="#communicating-data-science-results-effectively" id="toc-communicating-data-science-results-effectively"><span class="toc-section-number">42</span> Communicating data science results effectively!</a></li>
<li><a href="#lab06" id="toc-lab06"><span class="toc-section-number">43</span> Lab: Ugly charts and Simpson‚Äôs paradox</a>
<ul>
<li><a href="#getting-started-5" id="toc-getting-started-5"><span class="toc-section-number">43.1</span> Getting started</a>
<ul>
<li><a href="#housekeeping-1" id="toc-housekeeping-1"><span class="toc-section-number">43.1.1</span> Housekeeping</a></li>
</ul></li>
<li><a href="#packages-5" id="toc-packages-5"><span class="toc-section-number">43.2</span> Packages</a></li>
<li><a href="#take-a-sad-plot-and-make-it-better" id="toc-take-a-sad-plot-and-make-it-better"><span class="toc-section-number">43.3</span> Take a sad plot and make it better</a>
<ul>
<li><a href="#instructional-staff-employment-trends" id="toc-instructional-staff-employment-trends"><span class="toc-section-number">43.3.1</span> Instructional staff employment trends</a></li>
<li><a href="#fisheries" id="toc-fisheries"><span class="toc-section-number">43.3.2</span> Fisheries</a></li>
</ul></li>
<li><a href="#stretch-practice-with-smokers-in-whickham" id="toc-stretch-practice-with-smokers-in-whickham"><span class="toc-section-number">43.4</span> Stretch Practice with Smokers in Whickham</a>
<ul>
<li><a href="#packages-6" id="toc-packages-6"><span class="toc-section-number">43.4.1</span> Packages</a></li>
<li><a href="#the-data-2" id="toc-the-data-2"><span class="toc-section-number">43.4.2</span> The data</a></li>
<li><a href="#exercises-5" id="toc-exercises-5"><span class="toc-section-number">43.4.3</span> Exercises</a></li>
</ul></li>
<li><a href="#wrapping-up-1" id="toc-wrapping-up-1"><span class="toc-section-number">43.5</span> Wrapping up</a></li>
<li><a href="#more-ugly-charts" id="toc-more-ugly-charts"><span class="toc-section-number">43.6</span> More ugly charts</a></li>
</ul></li>
<li><a href="#part-module-07" id="toc-part-module-07">(PART) Module 07</a></li>
<li><a href="#welcome-to-web-scraping" id="toc-welcome-to-web-scraping"><span class="toc-section-number">44</span> Welcome to web scraping</a>
<ul>
<li><a href="#module-materials-6" id="toc-module-materials-6"><span class="toc-section-number">44.1</span> Module Materials</a></li>
<li><a href="#estimated-video-length-5" id="toc-estimated-video-length-5"><span class="toc-section-number">44.2</span> Estimated Video Length</a></li>
</ul></li>
<li><a href="#scraping-the-web" id="toc-scraping-the-web"><span class="toc-section-number">45</span> Scraping the web</a>
<ul>
<li><a href="#using-the-selectorgadget" id="toc-using-the-selectorgadget"><span class="toc-section-number">45.1</span> Using the SelectorGadget!</a></li>
<li><a href="#top-250-movies-on-imdb" id="toc-top-250-movies-on-imdb"><span class="toc-section-number">45.2</span> Top 250 movies on IMDB!</a></li>
<li><a href="#activity-08-imdb" id="toc-activity-08-imdb"><span class="toc-section-number">45.3</span> Activity 08: IMDB!</a></li>
<li><a href="#useful-regex-things" id="toc-useful-regex-things"><span class="toc-section-number">45.4</span> Useful RegEx things‚Ä¶</a></li>
</ul></li>
<li><a href="#data-usually-finds-me" id="toc-data-usually-finds-me"><span class="toc-section-number">46</span> Data usually finds me</a>
<ul>
<li><a href="#i-dont-go-looking-for-data-data-usually-finds-me" id="toc-i-dont-go-looking-for-data-data-usually-finds-me"><span class="toc-section-number">46.1</span> I don‚Äôt go looking for Data ‚Ä¶ Data usually finds me</a></li>
<li><a href="#two-major-approaches" id="toc-two-major-approaches"><span class="toc-section-number">46.2</span> Two Major Approaches</a>
<ul>
<li><a href="#where-do-you-start" id="toc-where-do-you-start"><span class="toc-section-number">46.2.1</span> Where do you start?</a></li>
</ul></li>
<li><a href="#confirmatory-approach-to-archival-data" id="toc-confirmatory-approach-to-archival-data"><span class="toc-section-number">46.3</span> Confirmatory Approach to Archival Data</a></li>
<li><a href="#exploratory-approach" id="toc-exploratory-approach"><span class="toc-section-number">46.4</span> Exploratory Approach</a></li>
<li><a href="#data-retrieval-ranges-wildly" id="toc-data-retrieval-ranges-wildly"><span class="toc-section-number">46.5</span> Data Retrieval Ranges Wildly</a></li>
<li><a href="#bit-of-context-marriage-study" id="toc-bit-of-context-marriage-study"><span class="toc-section-number">46.6</span> Bit of Context: Marriage Study</a></li>
<li><a href="#list-of-data-places" id="toc-list-of-data-places"><span class="toc-section-number">46.7</span> List of Data Places</a></li>
<li><a href="#great-papers-to-get-you-started" id="toc-great-papers-to-get-you-started"><span class="toc-section-number">46.8</span> Great Papers to Get You Started</a></li>
</ul></li>
<li><a href="#api-wrappers" id="toc-api-wrappers"><span class="toc-section-number">47</span> Use API-wrapping packages</a>
<ul>
<li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">47.1</span> Introduction</a></li>
<li><a href="#click-and-download" id="toc-click-and-download"><span class="toc-section-number">47.2</span> Click-and-Download</a>
<ul>
<li><a href="#from-ropensci-web-services-page" id="toc-from-ropensci-web-services-page"><span class="toc-section-number">47.2.1</span> From rOpenSci web services page:</a></li>
</ul></li>
<li><a href="#data-supplied-on-the-web" id="toc-data-supplied-on-the-web"><span class="toc-section-number">47.3</span> Data supplied on the web</a></li>
<li><a href="#install-and-play" id="toc-install-and-play"><span class="toc-section-number">47.4</span> Install-and-play</a>
<ul>
<li><a href="#load-the-tidyverse-1" id="toc-load-the-tidyverse-1"><span class="toc-section-number">47.4.1</span> Load the tidyverse</a></li>
<li><a href="#sightings-of-birds-rebird" id="toc-sightings-of-birds-rebird"><span class="toc-section-number">47.4.2</span> Sightings of birds: rebird</a></li>
<li><a href="#geonames" id="toc-geonames"><span class="toc-section-number">47.4.3</span> Searching geographic info: geonames</a></li>
<li><a href="#wikipedia-searching" id="toc-wikipedia-searching"><span class="toc-section-number">47.4.4</span> Wikipedia searching</a></li>
<li><a href="#plos-one" id="toc-plos-one"><span class="toc-section-number">47.4.5</span> Searching the Public Library of Science: rplos</a></li>
<li><a href="#is-it-a-boy-or-a-girl-gender-associated-names-throughout-us-history" id="toc-is-it-a-boy-or-a-girl-gender-associated-names-throughout-us-history"><span class="toc-section-number">47.4.6</span> Is it a boy or a girl? gender-associated names throughout US history</a></li>
</ul></li>
</ul></li>
<li><a href="#diy-web-data" id="toc-diy-web-data"><span class="toc-section-number">48</span> DIY web data</a>
<ul>
<li><a href="#interacting-with-an-api" id="toc-interacting-with-an-api"><span class="toc-section-number">48.1</span> Interacting with an API</a>
<ul>
<li><a href="#load-the-tidyverse-2" id="toc-load-the-tidyverse-2"><span class="toc-section-number">48.1.1</span> Load the tidyverse</a></li>
<li><a href="#examine-the-structure-of-api-requests-using-the-open-movie-database" id="toc-examine-the-structure-of-api-requests-using-the-open-movie-database"><span class="toc-section-number">48.1.2</span> Examine the structure of API requests using the Open Movie Database</a></li>
<li><a href="#create-an-omdb-api-key" id="toc-create-an-omdb-api-key"><span class="toc-section-number">48.1.3</span> Create an OMDb API Key</a></li>
<li><a href="#recreate-the-request-url-in-r" id="toc-recreate-the-request-url-in-r"><span class="toc-section-number">48.1.4</span> Recreate the request URL in R</a></li>
<li><a href="#get-data-using-the-curl-package" id="toc-get-data-using-the-curl-package"><span class="toc-section-number">48.1.5</span> Get data using the curl package</a></li>
</ul></li>
<li><a href="#intro-to-json-and-xml" id="toc-intro-to-json-and-xml"><span class="toc-section-number">48.2</span> Intro to JSON and XML</a>
<ul>
<li><a href="#parsing-the-json-response-with-jsonlite" id="toc-parsing-the-json-response-with-jsonlite"><span class="toc-section-number">48.2.1</span> Parsing the JSON response with jsonlite</a></li>
<li><a href="#parsing-the-xml-response-using-xml2" id="toc-parsing-the-xml-response-using-xml2"><span class="toc-section-number">48.2.2</span> Parsing the XML response using xml2</a></li>
</ul></li>
<li><a href="#introducing-the-easy-way-httr" id="toc-introducing-the-easy-way-httr"><span class="toc-section-number">48.3</span> Introducing the easy way: httr</a></li>
<li><a href="#scraping" id="toc-scraping"><span class="toc-section-number">48.4</span> Scraping</a>
<ul>
<li><a href="#obtain-a-table" id="toc-obtain-a-table"><span class="toc-section-number">48.4.1</span> Obtain a table</a></li>
</ul></li>
<li><a href="#scraping-via-css-selectors" id="toc-scraping-via-css-selectors"><span class="toc-section-number">48.5</span> Scraping via CSS selectors</a></li>
<li><a href="#random-observations-on-scraping" id="toc-random-observations-on-scraping"><span class="toc-section-number">48.6</span> Random observations on scraping</a></li>
<li><a href="#extras" id="toc-extras"><span class="toc-section-number">48.7</span> Extras</a>
<ul>
<li><a href="#airports" id="toc-airports"><span class="toc-section-number">48.7.1</span> Airports</a></li>
</ul></li>
</ul></li>
<li><a href="#lab07" id="toc-lab07"><span class="toc-section-number">49</span> Lab: Better Viz</a>
<ul>
<li><a href="#conveying-the-right-message-through-visualization" id="toc-conveying-the-right-message-through-visualization"><span class="toc-section-number">49.1</span> Conveying the right message through visualization</a></li>
<li><a href="#learning-goals-2" id="toc-learning-goals-2"><span class="toc-section-number">49.2</span> Learning goals</a></li>
<li><a href="#getting-started-6" id="toc-getting-started-6"><span class="toc-section-number">49.3</span> Getting started</a>
<ul>
<li><a href="#warm-up-5" id="toc-warm-up-5"><span class="toc-section-number">49.3.1</span> Warm up</a></li>
<li><a href="#packages-7" id="toc-packages-7"><span class="toc-section-number">49.3.2</span> Packages</a></li>
<li><a href="#data-3" id="toc-data-3"><span class="toc-section-number">49.3.3</span> Data</a></li>
</ul></li>
<li><a href="#exercises-6" id="toc-exercises-6"><span class="toc-section-number">49.4</span> Exercises</a></li>
</ul></li>
<li><a href="#part-module-08" id="toc-part-module-08">(PART) Module 08</a></li>
<li><a href="#welcome-to-functions-and-automation" id="toc-welcome-to-functions-and-automation"><span class="toc-section-number">50</span> Welcome to Functions and Automation</a>
<ul>
<li><a href="#module-materials-7" id="toc-module-materials-7"><span class="toc-section-number">50.1</span> Module Materials</a></li>
</ul></li>
<li><a href="#functions-1" id="toc-functions-1"><span class="toc-section-number">51</span> Functions!</a>
<ul>
<li><a href="#code-along-pt-1" id="toc-code-along-pt-1"><span class="toc-section-number">51.1</span> Code Along pt 1</a></li>
<li><a href="#functions-for-real" id="toc-functions-for-real"><span class="toc-section-number">51.2</span> Functions for real!</a></li>
<li><a href="#code-along-pt-2" id="toc-code-along-pt-2"><span class="toc-section-number">51.3</span> Code Along pt 2</a></li>
<li><a href="#writing-functions" id="toc-writing-functions"><span class="toc-section-number">51.4</span> Writing Functions</a></li>
</ul></li>
<li><a href="#automation" id="toc-automation"><span class="toc-section-number">52</span> Automation</a>
<ul>
<li><a href="#code-along-pt-3" id="toc-code-along-pt-3"><span class="toc-section-number">52.1</span> Code Along pt 3</a></li>
<li><a href="#math-to-coding" id="toc-math-to-coding"><span class="toc-section-number">52.2</span> Math to Coding</a></li>
</ul></li>
<li><a href="#functions-part1" id="toc-functions-part1"><span class="toc-section-number">53</span> Write your own R functions</a>
<ul>
<li><a href="#what-and-why" id="toc-what-and-why"><span class="toc-section-number">53.1</span> What and why?</a></li>
<li><a href="#load-the-gapminder-data" id="toc-load-the-gapminder-data"><span class="toc-section-number">53.2</span> Load the Gapminder data</a></li>
<li><a href="#max---min" id="toc-max---min"><span class="toc-section-number">53.3</span> Max - min</a></li>
<li><a href="#get-something-that-works" id="toc-get-something-that-works"><span class="toc-section-number">53.4</span> Get something that works</a>
<ul>
<li><a href="#skateboard-perfectly-formed-rear-view-mirror" id="toc-skateboard-perfectly-formed-rear-view-mirror"><span class="toc-section-number">53.4.1</span> Skateboard &gt;&gt; perfectly formed rear-view mirror</a></li>
</ul></li>
<li><a href="#turn-the-working-interactive-code-into-a-function" id="toc-turn-the-working-interactive-code-into-a-function"><span class="toc-section-number">53.5</span> Turn the working interactive code into a function</a></li>
<li><a href="#test-your-function" id="toc-test-your-function"><span class="toc-section-number">53.6</span> Test your function</a>
<ul>
<li><a href="#test-on-new-inputs" id="toc-test-on-new-inputs"><span class="toc-section-number">53.6.1</span> Test on new inputs</a></li>
<li><a href="#test-on-real-data-but-different-real-data" id="toc-test-on-real-data-but-different-real-data"><span class="toc-section-number">53.6.2</span> Test on real data but <em>different</em> real data</a></li>
<li><a href="#test-on-unexpected-stuff" id="toc-test-on-unexpected-stuff"><span class="toc-section-number">53.6.3</span> Test on unexpected stuff</a></li>
<li><a href="#unbreakable" id="toc-unbreakable"><span class="toc-section-number">53.6.4</span> Unbreakable</a></li>
</ul></li>
<li><a href="#check-the-validity-of-arguments" id="toc-check-the-validity-of-arguments"><span class="toc-section-number">53.7</span> Check the validity of arguments</a>
<ul>
<li><a href="#stop-if-not" id="toc-stop-if-not"><span class="toc-section-number">53.7.1</span> stop if not</a></li>
<li><a href="#if-then-stop" id="toc-if-then-stop"><span class="toc-section-number">53.7.2</span> if then stop</a></li>
<li><a href="#sidebar-non-programming-uses-for-assertions" id="toc-sidebar-non-programming-uses-for-assertions"><span class="toc-section-number">53.7.3</span> Sidebar: non-programming uses for assertions</a></li>
</ul></li>
<li><a href="#wrap-up-and-whats-next" id="toc-wrap-up-and-whats-next"><span class="toc-section-number">53.8</span> Wrap-up and what‚Äôs next?</a></li>
<li><a href="#where-were-we-where-are-we-going" id="toc-where-were-we-where-are-we-going"><span class="toc-section-number">53.9</span> Where were we? Where are we going?</a></li>
<li><a href="#load-the-gapminder-data-1" id="toc-load-the-gapminder-data-1"><span class="toc-section-number">53.10</span> Load the Gapminder data</a></li>
<li><a href="#restore-our-max-minus-min-function" id="toc-restore-our-max-minus-min-function"><span class="toc-section-number">53.11</span> Restore our max minus min function</a></li>
<li><a href="#generalize-our-function-to-other-quantiles" id="toc-generalize-our-function-to-other-quantiles"><span class="toc-section-number">53.12</span> Generalize our function to other quantiles</a></li>
<li><a href="#get-something-that-works-again" id="toc-get-something-that-works-again"><span class="toc-section-number">53.13</span> Get something that works, again</a></li>
<li><a href="#turn-the-working-interactive-code-into-a-function-again" id="toc-turn-the-working-interactive-code-into-a-function-again"><span class="toc-section-number">53.14</span> Turn the working interactive code into a function, again</a></li>
<li><a href="#argument-names-freedom-and-conventions" id="toc-argument-names-freedom-and-conventions"><span class="toc-section-number">53.15</span> Argument names: freedom and conventions</a></li>
<li><a href="#what-a-function-returns" id="toc-what-a-function-returns"><span class="toc-section-number">53.16</span> What a function returns</a></li>
<li><a href="#default-values-freedom-to-not-specify-the-arguments" id="toc-default-values-freedom-to-not-specify-the-arguments"><span class="toc-section-number">53.17</span> Default values: freedom to NOT specify the arguments</a></li>
<li><a href="#check-the-validity-of-arguments-again" id="toc-check-the-validity-of-arguments-again"><span class="toc-section-number">53.18</span> Check the validity of arguments, again</a></li>
<li><a href="#wrap-up-and-whats-next-1" id="toc-wrap-up-and-whats-next-1"><span class="toc-section-number">53.19</span> Wrap-up and what‚Äôs next?</a></li>
<li><a href="#where-were-we-where-are-we-going-1" id="toc-where-were-we-where-are-we-going-1"><span class="toc-section-number">53.20</span> Where were we? Where are we going?</a></li>
<li><a href="#load-the-gapminder-data-2" id="toc-load-the-gapminder-data-2"><span class="toc-section-number">53.21</span> Load the Gapminder data</a></li>
<li><a href="#restore-our-max-minus-min-function-1" id="toc-restore-our-max-minus-min-function-1"><span class="toc-section-number">53.22</span> Restore our max minus min function</a></li>
<li><a href="#be-proactive-about-nas" id="toc-be-proactive-about-nas"><span class="toc-section-number">53.23</span> Be proactive about <code>NA</code>s</a></li>
<li><a href="#the-useful-but-mysterious-...-argument" id="toc-the-useful-but-mysterious-...-argument"><span class="toc-section-number">53.24</span> The useful but mysterious <code>...</code> argument</a></li>
<li><a href="#use-testthat-for-formal-unit-tests" id="toc-use-testthat-for-formal-unit-tests"><span class="toc-section-number">53.25</span> Use testthat for formal unit tests</a></li>
</ul></li>
<li><a href="#functions-practicum" id="toc-functions-practicum"><span class="toc-section-number">54</span> Function-writing practicum</a>
<ul>
<li><a href="#overview" id="toc-overview"><span class="toc-section-number">54.1</span> Overview</a></li>
<li><a href="#load-the-gapminder-data-3" id="toc-load-the-gapminder-data-3"><span class="toc-section-number">54.2</span> Load the Gapminder data</a></li>
<li><a href="#get-data-to-practice-with" id="toc-get-data-to-practice-with"><span class="toc-section-number">54.3</span> Get data to practice with</a></li>
<li><a href="#get-some-code-that-works" id="toc-get-some-code-that-works"><span class="toc-section-number">54.4</span> Get some code that works</a>
<ul>
<li><a href="#sidebar-regression-stuff" id="toc-sidebar-regression-stuff"><span class="toc-section-number">54.4.1</span> Sidebar: regression stuff</a></li>
</ul></li>
<li><a href="#turn-working-code-into-a-function" id="toc-turn-working-code-into-a-function"><span class="toc-section-number">54.5</span> Turn working code into a function</a></li>
<li><a href="#test-on-other-data-and-in-a-clean-workspace" id="toc-test-on-other-data-and-in-a-clean-workspace"><span class="toc-section-number">54.6</span> Test on other data and in a clean workspace</a></li>
<li><a href="#are-we-there-yet" id="toc-are-we-there-yet"><span class="toc-section-number">54.7</span> Are we there yet?</a></li>
<li><a href="#resources-3" id="toc-resources-3"><span class="toc-section-number">54.8</span> Resources</a></li>
</ul></li>
<li><a href="#lab08" id="toc-lab08"><span class="toc-section-number">55</span> Lab: University of Edinburgh Art Collection</a>
<ul>
<li><a href="#getting-started-7" id="toc-getting-started-7"><span class="toc-section-number">55.1</span> Getting started</a></li>
<li><a href="#r-scripts-vs.-r-markdown-documents" id="toc-r-scripts-vs.-r-markdown-documents"><span class="toc-section-number">55.2</span> R scripts vs.¬†R Markdown documents</a></li>
<li><a href="#selectorgadget" id="toc-selectorgadget"><span class="toc-section-number">55.3</span> SelectorGadget</a>
<ul>
<li><a href="#scraping-a-single-page" id="toc-scraping-a-single-page"><span class="toc-section-number">55.3.1</span> Scraping a single page</a></li>
<li><a href="#titles" id="toc-titles"><span class="toc-section-number">55.3.2</span> Titles</a></li>
<li><a href="#links" id="toc-links"><span class="toc-section-number">55.3.3</span> Links</a></li>
<li><a href="#artists" id="toc-artists"><span class="toc-section-number">55.3.4</span> Artists</a></li>
<li><a href="#put-it-altogether" id="toc-put-it-altogether"><span class="toc-section-number">55.3.5</span> Put it altogether</a></li>
<li><a href="#scrape-the-next-page" id="toc-scrape-the-next-page"><span class="toc-section-number">55.3.6</span> Scrape the next page</a></li>
</ul></li>
<li><a href="#functions-2" id="toc-functions-2"><span class="toc-section-number">55.4</span> Functions</a></li>
<li><a href="#iteration" id="toc-iteration"><span class="toc-section-number">55.5</span> Iteration</a>
<ul>
<li><a href="#list-of-urls" id="toc-list-of-urls"><span class="toc-section-number">55.5.1</span> List of URLs</a></li>
<li><a href="#mapping" id="toc-mapping"><span class="toc-section-number">55.5.2</span> Mapping</a></li>
<li><a href="#write-out-data" id="toc-write-out-data"><span class="toc-section-number">55.5.3</span> Write out data</a></li>
</ul></li>
<li><a href="#analysis" id="toc-analysis"><span class="toc-section-number">55.6</span> Analysis</a></li>
</ul></li>
<li><a href="#part-module-09" id="toc-part-module-09">(PART) Module 09</a></li>
<li><a href="#welcome-to-data-and-ethics" id="toc-welcome-to-data-and-ethics"><span class="toc-section-number">56</span> Welcome to Data and Ethics</a>
<ul>
<li><a href="#module-materials-8" id="toc-module-materials-8"><span class="toc-section-number">56.1</span> Module Materials</a></li>
</ul></li>
<li><a href="#data-science-and-ethics" id="toc-data-science-and-ethics"><span class="toc-section-number">57</span> Data Science and Ethics</a>
<ul>
<li><a href="#module-commentary" id="toc-module-commentary"><span class="toc-section-number">57.1</span> Module Commentary</a></li>
<li><a href="#misrepresenting-data" id="toc-misrepresenting-data"><span class="toc-section-number">57.2</span> Misrepresenting Data</a>
<ul>
<li><a href="#graph-detective" id="toc-graph-detective"><span class="toc-section-number">57.2.1</span> Graph Detective</a></li>
</ul></li>
<li><a href="#maps" id="toc-maps"><span class="toc-section-number">57.3</span> Maps</a></li>
</ul></li>
<li><a href="#bias" id="toc-bias"><span class="toc-section-number">58</span> Bias</a>
<ul>
<li><a href="#curated-videography" id="toc-curated-videography"><span class="toc-section-number">58.1</span> Curated Videography</a>
<ul>
<li><a href="#data-science-ethics-in-6-minutes" id="toc-data-science-ethics-in-6-minutes"><span class="toc-section-number">58.1.1</span> Data Science Ethics in 6 Minutes</a></li>
<li><a href="#ai-for-good-in-the-r-and-python-ecosystems" id="toc-ai-for-good-in-the-r-and-python-ecosystems"><span class="toc-section-number">58.1.2</span> AI for Good in the R and Python ecosystems</a></li>
<li><a href="#are-we-automating-racism" id="toc-are-we-automating-racism"><span class="toc-section-number">58.1.3</span> Are We Automating Racism?</a></li>
<li><a href="#big-techs-b.s.-about-ai-ethics" id="toc-big-techs-b.s.-about-ai-ethics"><span class="toc-section-number">58.1.4</span> Big Tech‚Äôs B.S. about AI ethics</a></li>
</ul></li>
<li><a href="#annotated-bibliography-instructions" id="toc-annotated-bibliography-instructions"><span class="toc-section-number">58.2</span> Annotated Bibliography Instructions</a></li>
</ul></li>
<li><a href="#lab09" id="toc-lab09"><span class="toc-section-number">59</span> Lab: Modeling professor attractiveness and course evaluations</a>
<ul>
<li><a href="#getting-started-8" id="toc-getting-started-8"><span class="toc-section-number">59.1</span> Getting started</a>
<ul>
<li><a href="#packages-8" id="toc-packages-8"><span class="toc-section-number">59.1.1</span> Packages</a></li>
<li><a href="#housekeeping-2" id="toc-housekeeping-2"><span class="toc-section-number">59.1.2</span> Housekeeping</a></li>
</ul></li>
<li><a href="#warm-up-6" id="toc-warm-up-6"><span class="toc-section-number">59.2</span> Warm up</a>
<ul>
<li><a href="#yaml-3" id="toc-yaml-3"><span class="toc-section-number">59.2.1</span> YAML</a></li>
<li><a href="#committing-and-pushing-changes" id="toc-committing-and-pushing-changes"><span class="toc-section-number">59.2.2</span> Committing and pushing changes</a></li>
</ul></li>
<li><a href="#the-data-3" id="toc-the-data-3"><span class="toc-section-number">59.3</span> The data</a></li>
<li><a href="#exercises-7" id="toc-exercises-7"><span class="toc-section-number">59.4</span> Exercises</a>
<ul>
<li><a href="#part-1-exploratory-data-analysis" id="toc-part-1-exploratory-data-analysis"><span class="toc-section-number">59.4.1</span> Part 1: Exploratory Data Analysis</a></li>
<li><a href="#part-2-linear-regression-with-a-numerical-predictor" id="toc-part-2-linear-regression-with-a-numerical-predictor"><span class="toc-section-number">59.4.2</span> Part 2: Linear regression with a numerical predictor</a></li>
<li><a href="#part-3-linear-regression-with-a-categorical-predictor" id="toc-part-3-linear-regression-with-a-categorical-predictor"><span class="toc-section-number">59.4.3</span> Part 3: Linear regression with a categorical predictor</a></li>
</ul></li>
</ul></li>
<li><a href="#part-module-10" id="toc-part-module-10">(PART) Module 10</a></li>
<li><a href="#welcome-to-modeling-the-tidy-way" id="toc-welcome-to-modeling-the-tidy-way"><span class="toc-section-number">60</span> Welcome to modeling the tidy way!</a>
<ul>
<li><a href="#module-materials-9" id="toc-module-materials-9"><span class="toc-section-number">60.1</span> Module Materials</a></li>
</ul></li>
<li><a href="#language-of-models" id="toc-language-of-models"><span class="toc-section-number">61</span> Language of Models!</a>
<ul>
<li><a href="#what-is-a-model" id="toc-what-is-a-model"><span class="toc-section-number">61.1</span> What is a model?</a></li>
<li><a href="#modeling-the-relationship-between-variables" id="toc-modeling-the-relationship-between-variables"><span class="toc-section-number">61.2</span> Modeling the relationship between variables</a></li>
</ul></li>
<li><a href="#fitting-and-interpreting-models" id="toc-fitting-and-interpreting-models"><span class="toc-section-number">62</span> Fitting and interpreting models</a>
<ul>
<li><a href="#models-with-numerical-explanatory-variables" id="toc-models-with-numerical-explanatory-variables"><span class="toc-section-number">62.1</span> Models with numerical explanatory variables</a></li>
<li><a href="#a-more-technical-worked-example" id="toc-a-more-technical-worked-example"><span class="toc-section-number">62.2</span> A More Technical Worked Example</a>
<ul>
<li><a href="#does-the-linear-model-fit" id="toc-does-the-linear-model-fit"><span class="toc-section-number">62.2.1</span> Does the linear model fit?</a></li>
<li><a href="#homoscedasticity" id="toc-homoscedasticity"><span class="toc-section-number">62.2.2</span> Homoscedasticity</a></li>
<li><a href="#normality" id="toc-normality"><span class="toc-section-number">62.2.3</span> Normality</a></li>
<li><a href="#normality-of-pooled-residuals" id="toc-normality-of-pooled-residuals"><span class="toc-section-number">62.2.4</span> Normality of pooled residuals</a></li>
<li><a href="#the-actually-correct-way" id="toc-the-actually-correct-way"><span class="toc-section-number">62.2.5</span> The actually correct way</a></li>
<li><a href="#our-final-model" id="toc-our-final-model"><span class="toc-section-number">62.2.6</span> Our final model</a></li>
<li><a href="#what-have-we-learned" id="toc-what-have-we-learned"><span class="toc-section-number">62.2.7</span> What have we learned?</a></li>
<li><a href="#commentary-on-model-performance" id="toc-commentary-on-model-performance"><span class="toc-section-number">62.2.8</span> Commentary on Model Performance</a></li>
</ul></li>
<li><a href="#models-with-categorical-explanatory-variables" id="toc-models-with-categorical-explanatory-variables"><span class="toc-section-number">62.3</span> Models with categorical explanatory variables</a></li>
</ul></li>
<li><a href="#modeling-non-linear-relationships" id="toc-modeling-non-linear-relationships"><span class="toc-section-number">63</span> Modeling non-linear relationships</a></li>
<li><a href="#modeling-with-multiple-predictors" id="toc-modeling-with-multiple-predictors"><span class="toc-section-number">64</span> Modeling with multiple predictors</a>
<ul>
<li><a href="#the-linear-model-with-multiple-predictors" id="toc-the-linear-model-with-multiple-predictors"><span class="toc-section-number">64.1</span> The linear model with multiple predictors</a></li>
<li><a href="#two-numerical-predictors" id="toc-two-numerical-predictors"><span class="toc-section-number">64.2</span> Two numerical predictors</a></li>
<li><a href="#my-thoughts-on-tidy-modeling-tidymodelthoughts" id="toc-my-thoughts-on-tidy-modeling-tidymodelthoughts"><span class="toc-section-number">64.3</span> My Thoughts on Tidy Modeling {tidymodelthoughts}</a></li>
</ul></li>
<li><a href="#notes-on-logistic-regression" id="toc-notes-on-logistic-regression"><span class="toc-section-number">65</span> Notes on Logistic Regression</a>
<ul>
<li><a href="#predicting-categorical-data" id="toc-predicting-categorical-data"><span class="toc-section-number">65.1</span> Predicting categorical data</a></li>
<li><a href="#sensitivity-and-specificity" id="toc-sensitivity-and-specificity"><span class="toc-section-number">65.2</span> Sensitivity and specificity</a></li>
</ul></li>
<li><a href="#lab10" id="toc-lab10"><span class="toc-section-number">66</span> Lab: Modeling with multiple predictors</a>
<ul>
<li><a href="#professor-attractiveness-and-course-evaluations-pt.-2" id="toc-professor-attractiveness-and-course-evaluations-pt.-2"><span class="toc-section-number">66.1</span> Professor attractiveness and course evaluations, Pt. 2</a></li>
<li><a href="#getting-started-9" id="toc-getting-started-9"><span class="toc-section-number">66.2</span> Getting started</a>
<ul>
<li><a href="#packages-9" id="toc-packages-9"><span class="toc-section-number">66.2.1</span> Packages</a></li>
</ul></li>
<li><a href="#warm-up-7" id="toc-warm-up-7"><span class="toc-section-number">66.3</span> Warm up</a>
<ul>
<li><a href="#yaml-4" id="toc-yaml-4"><span class="toc-section-number">66.3.1</span> YAML</a></li>
<li><a href="#commiting-and-pushing-changes-2" id="toc-commiting-and-pushing-changes-2"><span class="toc-section-number">66.3.2</span> Commiting and pushing changes</a></li>
</ul></li>
<li><a href="#the-data-4" id="toc-the-data-4"><span class="toc-section-number">66.4</span> The data</a></li>
<li><a href="#exercises-8" id="toc-exercises-8"><span class="toc-section-number">66.5</span> Exercises</a>
<ul>
<li><a href="#part-1-simple-linear-regression" id="toc-part-1-simple-linear-regression"><span class="toc-section-number">66.5.1</span> Part 1: Simple linear regression</a></li>
<li><a href="#part-2-multiple-linear-regression" id="toc-part-2-multiple-linear-regression"><span class="toc-section-number">66.5.2</span> Part 2: Multiple linear regression</a></li>
<li><a href="#part-3-the-search-for-the-best-model" id="toc-part-3-the-search-for-the-best-model"><span class="toc-section-number">66.5.3</span> Part 3: The search for the best model</a></li>
</ul></li>
</ul></li>
<li><a href="#part-module-11" id="toc-part-module-11">(PART) Module 11</a></li>
<li><a href="#welcome-to-overfitting-and-cross-validation" id="toc-welcome-to-overfitting-and-cross-validation"><span class="toc-section-number">67</span> Welcome to Overfitting and Cross-Validation</a>
<ul>
<li><a href="#module-materials-10" id="toc-module-materials-10"><span class="toc-section-number">67.1</span> Module Materials</a></li>
</ul></li>
<li><a href="#overfitting" id="toc-overfitting"><span class="toc-section-number">68</span> Overfitting!</a>
<ul>
<li><a href="#prediction" id="toc-prediction"><span class="toc-section-number">68.1</span> Prediction</a></li>
<li><a href="#workflow" id="toc-workflow"><span class="toc-section-number">68.2</span> Workflow</a></li>
</ul></li>
<li><a href="#cross-validation" id="toc-cross-validation"><span class="toc-section-number">69</span> Cross-Validation</a>
<ul>
<li><a href="#v-fold" id="toc-v-fold"><span class="toc-section-number">69.1</span> V-Fold</a></li>
</ul></li>
<li><a href="#featurenotes" id="toc-featurenotes"><span class="toc-section-number">70</span> Notes on Feature Engineering</a>
<ul>
<li><a href="#feature-engineering" id="toc-feature-engineering"><span class="toc-section-number">70.1</span> Feature engineering</a>
<ul>
<li><a href="#same-training-and-testing-sets-as-before" id="toc-same-training-and-testing-sets-as-before"><span class="toc-section-number">70.1.1</span> Same training and testing sets as before</a></li>
<li><a href="#a-simple-approach-mutate" id="toc-a-simple-approach-mutate"><span class="toc-section-number">70.1.2</span> A simple approach: <code>mutate()</code></a></li>
</ul></li>
<li><a href="#modeling-workflow-revisited" id="toc-modeling-workflow-revisited"><span class="toc-section-number">70.2</span> Modeling workflow, revisited</a></li>
<li><a href="#building-recipes" id="toc-building-recipes"><span class="toc-section-number">70.3</span> Building recipes</a>
<ul>
<li><a href="#initiate-a-recipe" id="toc-initiate-a-recipe"><span class="toc-section-number">70.3.1</span> Initiate a recipe</a></li>
<li><a href="#remove-certain-variables" id="toc-remove-certain-variables"><span class="toc-section-number">70.3.2</span> Remove certain variables</a></li>
<li><a href="#feature-engineer-date" id="toc-feature-engineer-date"><span class="toc-section-number">70.3.3</span> Feature engineer date</a></li>
<li><a href="#discretize-numeric-variables" id="toc-discretize-numeric-variables"><span class="toc-section-number">70.3.4</span> Discretize numeric variables</a></li>
<li><a href="#create-dummy-variables" id="toc-create-dummy-variables"><span class="toc-section-number">70.3.5</span> Create dummy variables</a></li>
<li><a href="#remove-zero-variance-variables" id="toc-remove-zero-variance-variables"><span class="toc-section-number">70.3.6</span> Remove zero variance variables</a></li>
<li><a href="#all-in-one-place" id="toc-all-in-one-place"><span class="toc-section-number">70.3.7</span> All in one place</a></li>
</ul></li>
<li><a href="#building-workflows" id="toc-building-workflows"><span class="toc-section-number">70.4</span> Building workflows</a>
<ul>
<li><a href="#define-model" id="toc-define-model"><span class="toc-section-number">70.4.1</span> Define model</a></li>
<li><a href="#define-workflow" id="toc-define-workflow"><span class="toc-section-number">70.4.2</span> Define workflow</a></li>
<li><a href="#fit-model-to-training-data" id="toc-fit-model-to-training-data"><span class="toc-section-number">70.4.3</span> Fit model to training data</a></li>
<li><a href="#make-predictions-for-test-data" id="toc-make-predictions-for-test-data"><span class="toc-section-number">70.4.4</span> Make predictions for test data</a></li>
<li><a href="#evaluate-the-performance" id="toc-evaluate-the-performance"><span class="toc-section-number">70.4.5</span> Evaluate the performance</a></li>
</ul></li>
<li><a href="#making-decisions" id="toc-making-decisions"><span class="toc-section-number">70.5</span> Making decisions</a>
<ul>
<li><a href="#cutoff-probability-0.5" id="toc-cutoff-probability-0.5"><span class="toc-section-number">70.5.1</span> Cutoff probability: 0.5</a></li>
<li><a href="#cutoff-probability-0.25" id="toc-cutoff-probability-0.25"><span class="toc-section-number">70.5.2</span> Cutoff probability: 0.25</a></li>
<li><a href="#cutoff-probability-0.75" id="toc-cutoff-probability-0.75"><span class="toc-section-number">70.5.3</span> Cutoff probability: 0.75</a></li>
</ul></li>
</ul></li>
<li><a href="#odd-notes-on-cross-validation" id="toc-odd-notes-on-cross-validation"><span class="toc-section-number">71</span> ODD: Notes on Cross validation</a>
<ul>
<li><a href="#example-regression" id="toc-example-regression"><span class="toc-section-number">71.1</span> Example: Regression</a></li>
<li><a href="#example-mixture-models" id="toc-example-mixture-models"><span class="toc-section-number">71.2</span> Example: Mixture models</a></li>
<li><a href="#better-solution-cross-validation" id="toc-better-solution-cross-validation"><span class="toc-section-number">71.3</span> Better Solution: Cross validation</a></li>
<li><a href="#example" id="toc-example"><span class="toc-section-number">71.4</span> Example</a></li>
<li><a href="#choice-of-k" id="toc-choice-of-k"><span class="toc-section-number">71.5</span> Choice of <span class="math inline">\(K\)</span></a></li>
<li><a href="#summing-up" id="toc-summing-up"><span class="toc-section-number">71.6</span> Summing up</a></li>
</ul></li>
<li><a href="#lab08b" id="toc-lab08b"><span class="toc-section-number">72</span> Optional Lab 08b</a>
<ul>
<li><a href="#packages-10" id="toc-packages-10"><span class="toc-section-number">72.1</span> Packages</a></li>
<li><a href="#data-collection-via-web-scraping" id="toc-data-collection-via-web-scraping"><span class="toc-section-number">72.2</span> Data collection via web scraping</a></li>
<li><a href="#data-cleaning" id="toc-data-cleaning"><span class="toc-section-number">72.3</span> Data cleaning</a></li>
<li><a href="#data-visualization-and-interpretation" id="toc-data-visualization-and-interpretation"><span class="toc-section-number">72.4</span> Data visualization and interpretation</a></li>
</ul></li>
<li><a href="#part-module-12" id="toc-part-module-12">(PART) Module 12</a></li>
<li><a href="#welcome-to-quantifying-uncertainty" id="toc-welcome-to-quantifying-uncertainty"><span class="toc-section-number">73</span> Welcome to Quantifying Uncertainty</a>
<ul>
<li><a href="#module-materials-11" id="toc-module-materials-11"><span class="toc-section-number">73.1</span> Module Materials</a></li>
</ul></li>
<li><a href="#quantifying-uncertainty" id="toc-quantifying-uncertainty"><span class="toc-section-number">74</span> Quantifying Uncertainty!</a></li>
<li><a href="#bootstrapping" id="toc-bootstrapping"><span class="toc-section-number">75</span> Bootstrapping</a></li>
<li><a href="#notes-on-hypothesis-testing" id="toc-notes-on-hypothesis-testing"><span class="toc-section-number">76</span> Notes on Hypothesis Testing</a>
<ul>
<li><a href="#hypothesis-testing-for-a-single-proportion" id="toc-hypothesis-testing-for-a-single-proportion"><span class="toc-section-number">76.1</span> Hypothesis testing for a single proportion</a>
<ul>
<li><a href="#organ-donors" id="toc-organ-donors"><span class="toc-section-number">76.1.1</span> Organ donors</a></li>
<li><a href="#data-4" id="toc-data-4"><span class="toc-section-number">76.1.2</span> Data</a></li>
<li><a href="#parameter-vs.-statistic" id="toc-parameter-vs.-statistic"><span class="toc-section-number">76.1.3</span> Parameter vs.¬†statistic</a></li>
<li><a href="#correlation-vs.-causation" id="toc-correlation-vs.-causation"><span class="toc-section-number">76.1.4</span> Correlation vs.¬†causation</a></li>
<li><a href="#two-claims" id="toc-two-claims"><span class="toc-section-number">76.1.5</span> Two claims</a></li>
<li><a href="#hypothesis-testing-as-a-court-trial" id="toc-hypothesis-testing-as-a-court-trial"><span class="toc-section-number">76.1.6</span> Hypothesis testing as a court trial</a></li>
<li><a href="#hypothesis-testing-framework" id="toc-hypothesis-testing-framework"><span class="toc-section-number">76.1.7</span> Hypothesis testing framework</a></li>
<li><a href="#setting-the-hypotheses" id="toc-setting-the-hypotheses"><span class="toc-section-number">76.1.8</span> Setting the hypotheses</a></li>
<li><a href="#simulating-the-null-distribution" id="toc-simulating-the-null-distribution"><span class="toc-section-number">76.1.9</span> Simulating the null distribution</a></li>
<li><a href="#what-do-we-expect" id="toc-what-do-we-expect"><span class="toc-section-number">76.1.10</span> What do we expect?</a></li>
<li><a href="#simulation" id="toc-simulation"><span class="toc-section-number">76.1.11</span> Simulation</a></li>
<li><a href="#using-tidymodels-to-generate-the-null-distribution" id="toc-using-tidymodels-to-generate-the-null-distribution"><span class="toc-section-number">76.1.12</span> Using tidymodels to generate the null distribution</a></li>
<li><a href="#visualizing-the-null-distribution" id="toc-visualizing-the-null-distribution"><span class="toc-section-number">76.1.13</span> Visualizing the null distribution</a></li>
<li><a href="#calculating-the-p-value-visually" id="toc-calculating-the-p-value-visually"><span class="toc-section-number">76.1.14</span> Calculating the p-value, visually</a></li>
<li><a href="#calculating-the-p-value-directly" id="toc-calculating-the-p-value-directly"><span class="toc-section-number">76.1.15</span> Calculating the p-value, directly</a></li>
<li><a href="#significance-level" id="toc-significance-level"><span class="toc-section-number">76.1.16</span> Significance level</a></li>
<li><a href="#conclusion" id="toc-conclusion"><span class="toc-section-number">76.1.17</span> Conclusion</a></li>
<li><a href="#lets-get-real" id="toc-lets-get-real"><span class="toc-section-number">76.1.18</span> Let‚Äôs get real</a></li>
<li><a href="#run-the-test" id="toc-run-the-test"><span class="toc-section-number">76.1.19</span> Run the test</a></li>
<li><a href="#visualize-and-calculate" id="toc-visualize-and-calculate"><span class="toc-section-number">76.1.20</span> Visualize and calculate</a></li>
</ul></li>
<li><a href="#one-vs.-two-sided-hypothesis-tests" id="toc-one-vs.-two-sided-hypothesis-tests"><span class="toc-section-number">76.2</span> One vs.¬†two sided hypothesis tests</a>
<ul>
<li><a href="#types-of-alternative-hypotheses" id="toc-types-of-alternative-hypotheses"><span class="toc-section-number">76.2.1</span> Types of alternative hypotheses</a></li>
</ul></li>
<li><a href="#testing-for-independence" id="toc-testing-for-independence"><span class="toc-section-number">76.3</span> Testing for independence</a>
<ul>
<li><a href="#is-yawning-contagious" id="toc-is-yawning-contagious"><span class="toc-section-number">76.3.1</span> Is yawning contagious?</a></li>
<li><a href="#study-description" id="toc-study-description"><span class="toc-section-number">76.3.2</span> Study description</a></li>
<li><a href="#proportion-of-yawners" id="toc-proportion-of-yawners"><span class="toc-section-number">76.3.3</span> Proportion of yawners</a></li>
<li><a href="#independence" id="toc-independence"><span class="toc-section-number">76.3.4</span> Independence?</a></li>
<li><a href="#dependence-or-another-possible-explanation" id="toc-dependence-or-another-possible-explanation"><span class="toc-section-number">76.3.5</span> Dependence, or another possible explanation?</a></li>
<li><a href="#two-competing-claims" id="toc-two-competing-claims"><span class="toc-section-number">76.3.6</span> Two competing claims</a></li>
<li><a href="#simulation-setup" id="toc-simulation-setup"><span class="toc-section-number">76.3.7</span> Simulation setup</a></li>
<li><a href="#running-the-simulation" id="toc-running-the-simulation"><span class="toc-section-number">76.3.8</span> Running the simulation</a></li>
<li><a href="#simulation-by-hand" id="toc-simulation-by-hand"><span class="toc-section-number">76.3.9</span> Simulation by hand</a></li>
<li><a href="#simulation-by-computation" id="toc-simulation-by-computation"><span class="toc-section-number">76.3.10</span> Simulation by computation</a></li>
<li><a href="#recap-2" id="toc-recap-2"><span class="toc-section-number">76.3.11</span> Recap</a></li>
<li><a href="#visualizing-the-null-distribution-1" id="toc-visualizing-the-null-distribution-1"><span class="toc-section-number">76.3.12</span> Visualizing the null distribution</a></li>
<li><a href="#calculating-the-p-value-visually-1" id="toc-calculating-the-p-value-visually-1"><span class="toc-section-number">76.3.13</span> Calculating the p-value, visually</a></li>
<li><a href="#calculating-the-p-value-directly-1" id="toc-calculating-the-p-value-directly-1"><span class="toc-section-number">76.3.14</span> Calculating the p-value, directly</a></li>
<li><a href="#conclusion-1" id="toc-conclusion-1"><span class="toc-section-number">76.3.15</span> Conclusion</a></li>
</ul></li>
</ul></li>
<li><a href="#lab11" id="toc-lab11"><span class="toc-section-number">77</span> Lab: So what if you smoke when pregnant?</a>
<ul>
<li><a href="#simulation-based-inference" id="toc-simulation-based-inference"><span class="toc-section-number">77.1</span> Simulation based inference</a></li>
<li><a href="#getting-started-10" id="toc-getting-started-10"><span class="toc-section-number">77.2</span> Getting started</a>
<ul>
<li><a href="#packages-11" id="toc-packages-11"><span class="toc-section-number">77.2.1</span> Packages</a></li>
</ul></li>
<li><a href="#housekeeping-3" id="toc-housekeeping-3"><span class="toc-section-number">77.3</span> Housekeeping</a>
<ul>
<li><a href="#git-configuration-password-caching-1" id="toc-git-configuration-password-caching-1"><span class="toc-section-number">77.3.1</span> Git configuration / password caching</a></li>
<li><a href="#project-name-3" id="toc-project-name-3"><span class="toc-section-number">77.3.2</span> Project name</a></li>
</ul></li>
<li><a href="#warm-up-8" id="toc-warm-up-8"><span class="toc-section-number">77.4</span> Warm up</a>
<ul>
<li><a href="#yaml-5" id="toc-yaml-5"><span class="toc-section-number">77.4.1</span> YAML</a></li>
<li><a href="#commiting-and-pushing-changes-3" id="toc-commiting-and-pushing-changes-3"><span class="toc-section-number">77.4.2</span> Commiting and pushing changes</a></li>
</ul></li>
<li><a href="#set-a-seed" id="toc-set-a-seed"><span class="toc-section-number">77.5</span> Set a seed!</a></li>
<li><a href="#the-data-5" id="toc-the-data-5"><span class="toc-section-number">77.6</span> The data</a></li>
<li><a href="#exercises-9" id="toc-exercises-9"><span class="toc-section-number">77.7</span> Exercises</a>
<ul>
<li><a href="#baby-weights" id="toc-baby-weights"><span class="toc-section-number">77.7.1</span> Baby weights</a></li>
<li><a href="#baby-weight-vs.-smoking" id="toc-baby-weight-vs.-smoking"><span class="toc-section-number">77.7.2</span> Baby weight vs.¬†smoking</a></li>
<li><a href="#baby-weight-vs.-mothers-age" id="toc-baby-weight-vs.-mothers-age"><span class="toc-section-number">77.7.3</span> Baby weight vs.¬†mother‚Äôs age</a></li>
</ul></li>
</ul></li>
<li><a href="#part-module-13" id="toc-part-module-13">(PART) Module 13</a></li>
<li><a href="#welcome-to-simulating-data" id="toc-welcome-to-simulating-data"><span class="toc-section-number">78</span> Welcome to Simulating Data</a>
<ul>
<li><a href="#module-materials-12" id="toc-module-materials-12"><span class="toc-section-number">78.1</span> Module Materials</a></li>
<li><a href="#estimated-video-length-6" id="toc-estimated-video-length-6"><span class="toc-section-number">78.2</span> Estimated Video Length</a></li>
</ul></li>
<li><a href="#getting-started-with-simulating-data-in-r" id="toc-getting-started-with-simulating-data-in-r"><span class="toc-section-number">79</span> Getting started with simulating data in R</a>
<ul>
<li><a href="#generating-random-numbers" id="toc-generating-random-numbers"><span class="toc-section-number">79.1</span> Generating random numbers</a></li>
<li><a href="#rnorm-to-generate-random-numbers-from-the-normal-distribution" id="toc-rnorm-to-generate-random-numbers-from-the-normal-distribution"><span class="toc-section-number">79.2</span> <code>rnorm()</code> to generate random numbers from the normal distribution</a>
<ul>
<li><a href="#writing-out-arguments-for-clearer-code" id="toc-writing-out-arguments-for-clearer-code"><span class="toc-section-number">79.2.1</span> Writing out arguments for clearer code</a></li>
<li><a href="#setting-the-random-seed-for-reproducible-random-numbers" id="toc-setting-the-random-seed-for-reproducible-random-numbers"><span class="toc-section-number">79.2.2</span> Setting the random seed for reproducible random numbers</a></li>
<li><a href="#change-parameters-in-rnorm" id="toc-change-parameters-in-rnorm"><span class="toc-section-number">79.2.3</span> Change parameters in <code>rnorm()</code></a></li>
<li><a href="#using-vectors-of-values-for-the-parameter-arguments" id="toc-using-vectors-of-values-for-the-parameter-arguments"><span class="toc-section-number">79.2.4</span> Using vectors of values for the parameter arguments</a></li>
</ul></li>
<li><a href="#example-of-using-the-simulated-numbers-from-rnorm" id="toc-example-of-using-the-simulated-numbers-from-rnorm"><span class="toc-section-number">79.3</span> Example of using the simulated numbers from <code>rnorm()</code></a></li>
<li><a href="#example-of-using-the-simulated-numbers-from-runif" id="toc-example-of-using-the-simulated-numbers-from-runif"><span class="toc-section-number">79.4</span> Example of using the simulated numbers from <code>runif()</code></a></li>
<li><a href="#discrete-counts-with-rpois" id="toc-discrete-counts-with-rpois"><span class="toc-section-number">79.5</span> Discrete counts with <code>rpois()</code></a></li>
<li><a href="#example-of-using-the-simulated-numbers-from-rpois" id="toc-example-of-using-the-simulated-numbers-from-rpois"><span class="toc-section-number">79.6</span> Example of using the simulated numbers from <code>rpois()</code></a></li>
</ul></li>
<li><a href="#generate-character-vectors-with-rep" id="toc-generate-character-vectors-with-rep"><span class="toc-section-number">80</span> Generate character vectors with <code>rep()</code></a>
<ul>
<li><a href="#using-letters-and-letters" id="toc-using-letters-and-letters"><span class="toc-section-number">80.1</span> Using <code>letters</code> and <code>LETTERS</code></a></li>
<li><a href="#repeat-each-element-of-a-vector-with-each" id="toc-repeat-each-element-of-a-vector-with-each"><span class="toc-section-number">80.2</span> Repeat each element of a vector with <code>each</code></a></li>
<li><a href="#repeat-a-whole-vector-with-the-times-argument" id="toc-repeat-a-whole-vector-with-the-times-argument"><span class="toc-section-number">80.3</span> Repeat a whole vector with the <code>times</code> argument</a></li>
<li><a href="#set-the-output-vector-length-with-the-length.out-argument" id="toc-set-the-output-vector-length-with-the-length.out-argument"><span class="toc-section-number">80.4</span> Set the output vector length with the <code>length.out</code> argument</a></li>
<li><a href="#repeat-each-element-a-different-number-of-times" id="toc-repeat-each-element-a-different-number-of-times"><span class="toc-section-number">80.5</span> Repeat each element a different number of <code>times</code></a></li>
<li><a href="#combining-each-with-times" id="toc-combining-each-with-times"><span class="toc-section-number">80.6</span> Combining <code>each</code> with <code>times</code></a></li>
<li><a href="#combining-each-with-length.out" id="toc-combining-each-with-length.out"><span class="toc-section-number">80.7</span> Combining <code>each</code> with <code>length.out</code></a></li>
</ul></li>
<li><a href="#creating-datasets-with-quantiative-and-categorical-variables" id="toc-creating-datasets-with-quantiative-and-categorical-variables"><span class="toc-section-number">81</span> Creating datasets with quantiative and categorical variables</a>
<ul>
<li><a href="#simulate-data-with-no-differences-among-two-groups" id="toc-simulate-data-with-no-differences-among-two-groups"><span class="toc-section-number">81.1</span> Simulate data with no differences among two groups</a></li>
<li><a href="#simulate-data-with-a-difference-among-groups" id="toc-simulate-data-with-a-difference-among-groups"><span class="toc-section-number">81.2</span> Simulate data with a difference among groups</a></li>
<li><a href="#multiple-quantitative-variables-with-groups" id="toc-multiple-quantitative-variables-with-groups"><span class="toc-section-number">81.3</span> Multiple quantitative variables with groups</a></li>
</ul></li>
<li><a href="#repeatedly-simulate-data-with-replicate" id="toc-repeatedly-simulate-data-with-replicate"><span class="toc-section-number">82</span> Repeatedly simulate data with <code>replicate()</code></a>
<ul>
<li><a href="#simple-example-of-replicate" id="toc-simple-example-of-replicate"><span class="toc-section-number">82.1</span> Simple example of <code>replicate()</code></a></li>
<li><a href="#an-equivalent-for-loop-example" id="toc-an-equivalent-for-loop-example"><span class="toc-section-number">82.2</span> An equivalent <code>for()</code> loop example</a></li>
<li><a href="#using-replicate-to-repeatedly-make-a-dataset" id="toc-using-replicate-to-repeatedly-make-a-dataset"><span class="toc-section-number">82.3</span> Using <code>replicate()</code> to repeatedly make a dataset</a></li>
</ul></li>
<li><a href="#whats-the-next-step" id="toc-whats-the-next-step"><span class="toc-section-number">83</span> What‚Äôs the next step?</a></li>
<li><a href="#part-module-14" id="toc-part-module-14">(PART) Module 14</a></li>
<li><a href="#rshiny" id="toc-rshiny"><span class="toc-section-number">84</span> Welcome to interactive web apps</a>
<ul>
<li><a href="#module-materials-13" id="toc-module-materials-13"><span class="toc-section-number">84.1</span> Module Materials</a></li>
</ul></li>
<li><a href="#rshiny-overview" id="toc-rshiny-overview"><span class="toc-section-number">85</span> RShiny Overview</a></li>
<li><a href="#practical-advice-from-the-data-professor" id="toc-practical-advice-from-the-data-professor"><span class="toc-section-number">86</span> Practical Advice from the Data Professor</a>
<ul>
<li><a href="#web-apps-in-r-building-your-first-web-application-in-r" id="toc-web-apps-in-r-building-your-first-web-application-in-r"><span class="toc-section-number">86.1</span> Web Apps in R: Building your First Web Application in R</a></li>
<li><a href="#web-apps-in-r-build-interactive-histogram-web-application-in-r" id="toc-web-apps-in-r-build-interactive-histogram-web-application-in-r"><span class="toc-section-number">86.2</span> Web Apps in R: Build Interactive Histogram Web Application in R</a></li>
<li><a href="#web-apps-in-r-building-data-driven-web-application-in-r" id="toc-web-apps-in-r-building-data-driven-web-application-in-r"><span class="toc-section-number">86.3</span> Web Apps in R: Building Data-Driven Web Application in R</a></li>
<li><a href="#web-apps-in-r-building-the-machine-learning-web-application-in-r" id="toc-web-apps-in-r-building-the-machine-learning-web-application-in-r"><span class="toc-section-number">86.4</span> Web Apps in R: Building the Machine Learning Web Application in R</a></li>
<li><a href="#web-apps-in-r-build-bmi-calculator-web-application-in-r-for-health-monitoring" id="toc-web-apps-in-r-build-bmi-calculator-web-application-in-r-for-health-monitoring"><span class="toc-section-number">86.5</span> Web Apps in R: Build BMI Calculator web application in R for health monitoring</a></li>
</ul></li>
<li><a href="#shiny-overview" id="toc-shiny-overview"><span class="toc-section-number">87</span> All the Shiny things</a>
<ul>
<li><a href="#shiny-slides" id="toc-shiny-slides"><span class="toc-section-number">87.1</span> Building Slides</a></li>
<li><a href="#shiny-tutorial" id="toc-shiny-tutorial"><span class="toc-section-number">87.2</span> Building Shiny apps</a>
<ul>
<li><a href="#shiny-tutorial-1" id="toc-shiny-tutorial-1"><span class="toc-section-number">87.2.1</span> Before we begin</a></li>
<li><a href="#shiny-tutorial-2" id="toc-shiny-tutorial-2"><span class="toc-section-number">87.2.2</span> Shiny app basics</a></li>
<li><a href="#shiny-tutorial-3" id="toc-shiny-tutorial-3"><span class="toc-section-number">87.2.3</span> Create an empty Shiny app</a></li>
<li><a href="#shiny-tutorial-4" id="toc-shiny-tutorial-4"><span class="toc-section-number">87.2.4</span> Load the dataset</a></li>
</ul></li>
<li><a href="#shiny-tutorial-5" id="toc-shiny-tutorial-5"><span class="toc-section-number">87.3</span> Build the basic UI</a>
<ul>
<li><a href="#add-plain-text-to-the-ui" id="toc-add-plain-text-to-the-ui"><span class="toc-section-number">87.3.1</span> Add plain text to the UI</a></li>
<li><a href="#shiny-tutorial-6" id="toc-shiny-tutorial-6"><span class="toc-section-number">87.3.2</span> Add inputs to the UI</a></li>
<li><a href="#shiny-tutorial-7" id="toc-shiny-tutorial-7"><span class="toc-section-number">87.3.3</span> Add placeholders for outputs</a></li>
<li><a href="#output-for-a-table-summary-of-the-results" id="toc-output-for-a-table-summary-of-the-results"><span class="toc-section-number">87.3.4</span> Output for a table summary of the results</a></li>
</ul></li>
<li><a href="#shiny-tutorial-8" id="toc-shiny-tutorial-8"><span class="toc-section-number">87.4</span> Checkpoint: what our app looks like after implementing the UI</a>
<ul>
<li><a href="#shiny-tutorial-9" id="toc-shiny-tutorial-9"><span class="toc-section-number">87.4.1</span> Implement server logic to create outputs</a></li>
<li><a href="#building-the-plot-output" id="toc-building-the-plot-output"><span class="toc-section-number">87.4.2</span> Building the plot output</a></li>
<li><a href="#shiny-tutorial-10" id="toc-shiny-tutorial-10"><span class="toc-section-number">87.4.3</span> Reactivity 101</a></li>
<li><a href="#shiny-tutorial-11" id="toc-shiny-tutorial-11"><span class="toc-section-number">87.4.4</span> Using <code>uiOutput()</code> to create UI elements dynamically</a></li>
<li><a href="#use-uioutput-in-our-app-to-populate-the-countries" id="toc-use-uioutput-in-our-app-to-populate-the-countries"><span class="toc-section-number">87.4.5</span> Use <code>uiOutput()</code> in our app to populate the countries</a></li>
<li><a href="#shiny-tutorial-12" id="toc-shiny-tutorial-12"><span class="toc-section-number">87.4.6</span> Final Shiny app code</a></li>
<li><a href="#shiny-tutorial-13" id="toc-shiny-tutorial-13"><span class="toc-section-number">87.4.7</span> Share your app with the world</a></li>
<li><a href="#shiny-tutorial-14" id="toc-shiny-tutorial-14"><span class="toc-section-number">87.4.8</span> More Shiny features to check out</a></li>
<li><a href="#scoping-rules-in-shiny-apps" id="toc-scoping-rules-in-shiny-apps"><span class="toc-section-number">87.4.9</span> Scoping rules in Shiny apps</a></li>
<li><a href="#add-images" id="toc-add-images"><span class="toc-section-number">87.4.10</span> Add images</a></li>
</ul></li>
<li><a href="#shiny-tutorial-15" id="toc-shiny-tutorial-15"><span class="toc-section-number">87.5</span> Ideas to improve our app</a></li>
</ul></li>
<li><a href="#shiny-resources" id="toc-shiny-resources"><span class="toc-section-number">88</span> Shiny Resources</a>
<ul>
<li><a href="#awesome-add-on-packages-to-shiny" id="toc-awesome-add-on-packages-to-shiny"><span class="toc-section-number">88.1</span> Awesome add-on packages to Shiny</a></li>
</ul></li>
<li><a href="#part-module-15" id="toc-part-module-15">(PART) Module 15</a></li>
<li><a href="#special-topics-machine-learn" id="toc-special-topics-machine-learn"><span class="toc-section-number">89</span> Special Topics: Machine, Learn!</a>
<ul>
<li><a href="#module-materials-14" id="toc-module-materials-14"><span class="toc-section-number">89.1</span> Module Materials</a></li>
</ul></li>
<li><a href="#neural-networks" id="toc-neural-networks"><span class="toc-section-number">90</span> Neural Networks!</a>
<ul>
<li><a href="#what-is-a-neural-network" id="toc-what-is-a-neural-network"><span class="toc-section-number">90.1</span> What is a Neural Network?</a></li>
<li><a href="#how-does-it-learn" id="toc-how-does-it-learn"><span class="toc-section-number">90.2</span> How does it learn?</a>
<ul>
<li><a href="#teaching-a.i.-to-play-my-game" id="toc-teaching-a.i.-to-play-my-game"><span class="toc-section-number">90.2.1</span> Teaching A.I. to Play My Game!</a></li>
<li><a href="#stickman-a.i.-learns-to-walk" id="toc-stickman-a.i.-learns-to-walk"><span class="toc-section-number">90.2.2</span> Stickman A.I. Learns To Walk</a></li>
</ul></li>
</ul></li>
<li><a href="#natural-language-processing" id="toc-natural-language-processing"><span class="toc-section-number">91</span> Natural Language Processing</a></li>
<li><a href="#part-module-last" id="toc-part-module-last">(PART*) Module Last</a></li>
<li><a href="#dont-miss-the-last-module" id="toc-dont-miss-the-last-module">Don‚Äôt Miss The Last Module</a>
<ul>
<li><a href="#important-wake-forest-stuff" id="toc-important-wake-forest-stuff"><span class="toc-section-number">91.1</span> Important Wake Forest Stuff</a></li>
<li><a href="#what-next" id="toc-what-next"><span class="toc-section-number">91.2</span> What Next?</a>
<ul>
<li><a href="#industry-transition-stories" id="toc-industry-transition-stories"><span class="toc-section-number">91.2.1</span> Industry Transition Stories</a></li>
</ul></li>
</ul></li>
<li><a href="#part-r" id="toc-part-r">(PART) R</a></li>
<li><a href="#r-workflow" id="toc-r-workflow"><span class="toc-section-number">92</span> R Workflow</a></li>
<li><a href="#r-project-development" id="toc-r-project-development"><span class="toc-section-number">93</span> R Project Development</a>
<ul>
<li><a href="#overview-1" id="toc-overview-1"><span class="toc-section-number">93.1</span> Overview</a></li>
<li><a href="#create-a-new-r-project" id="toc-create-a-new-r-project"><span class="toc-section-number">93.2</span> Create a New R Project</a></li>
<li><a href="#navigate-between-projects" id="toc-navigate-between-projects"><span class="toc-section-number">93.3</span> Navigate Between Projects</a></li>
<li><a href="#recommended-workflow" id="toc-recommended-workflow"><span class="toc-section-number">93.4</span> Recommended Workflow</a></li>
<li><a href="#your-turn" id="toc-your-turn"><span class="toc-section-number">93.5</span> Your Turn</a></li>
</ul></li>
<li><a href="#rmd-creation" id="toc-rmd-creation"><span class="toc-section-number">94</span> Rmd Creation</a>
<ul>
<li><a href="#create-a-new-document" id="toc-create-a-new-document"><span class="toc-section-number">94.1</span> Create a New Document</a></li>
<li><a href="#compile-the-document" id="toc-compile-the-document"><span class="toc-section-number">94.2</span> Compile the Document</a></li>
<li><a href="#document-types" id="toc-document-types"><span class="toc-section-number">94.3</span> Document Types</a>
<ul>
<li><a href="#html" id="toc-html"><span class="toc-section-number">94.3.1</span> HTML</a></li>
<li><a href="#pdf" id="toc-pdf"><span class="toc-section-number">94.3.2</span> PDF</a></li>
<li><a href="#word" id="toc-word"><span class="toc-section-number">94.3.3</span> Word</a></li>
<li><a href="#templates" id="toc-templates"><span class="toc-section-number">94.3.4</span> Templates</a></li>
<li><a href="#other-types" id="toc-other-types"><span class="toc-section-number">94.3.5</span> Other Types</a></li>
</ul></li>
<li><a href="#your-turn-1" id="toc-your-turn-1"><span class="toc-section-number">94.4</span> Your Turn</a></li>
</ul></li>
<li><a href="#basic-syntax" id="toc-basic-syntax"><span class="toc-section-number">95</span> Basic Syntax</a>
<ul>
<li><a href="#heading-text" id="toc-heading-text"><span class="toc-section-number">95.1</span> Heading Text</a></li>
<li><a href="#plain-text" id="toc-plain-text"><span class="toc-section-number">95.2</span> Plain Text</a></li>
<li><a href="#bold-and-italicized-text" id="toc-bold-and-italicized-text"><span class="toc-section-number">95.3</span> <strong>Bold</strong> and <em>Italicized</em> Text</a></li>
<li><a href="#lists" id="toc-lists"><span class="toc-section-number">95.4</span> Lists</a>
<ul>
<li><a href="#unordered-lists" id="toc-unordered-lists"><span class="toc-section-number">95.4.1</span> Unordered Lists</a></li>
<li><a href="#ordered-lists" id="toc-ordered-lists"><span class="toc-section-number">95.4.2</span> Ordered Lists</a></li>
</ul></li>
<li><a href="#link-to-a-section" id="toc-link-to-a-section"><span class="toc-section-number">95.5</span> Link to a Section</a></li>
<li><a href="#hyperlink" id="toc-hyperlink"><span class="toc-section-number">95.6</span> Hyperlink</a></li>
<li><a href="#insert-images" id="toc-insert-images"><span class="toc-section-number">95.7</span> Insert Images</a></li>
<li><a href="#tabbed-sections" id="toc-tabbed-sections"><span class="toc-section-number">95.8</span> Tabbed Sections</a></li>
<li><a href="#your-turn-2" id="toc-your-turn-2"><span class="toc-section-number">95.9</span> Your Turn</a></li>
</ul></li>
<li><a href="#lesson-4-yaml-headers" id="toc-lesson-4-yaml-headers"><span class="toc-section-number">96</span> Lesson 4: YAML Headers</a>
<ul>
<li><a href="#title" id="toc-title"><span class="toc-section-number">96.1</span> Title</a>
<ul>
<li><a href="#subtitle" id="toc-subtitle"><span class="toc-section-number">96.1.1</span> Subtitle</a></li>
</ul></li>
<li><a href="#authors" id="toc-authors"><span class="toc-section-number">96.2</span> Author(s)</a></li>
<li><a href="#date" id="toc-date"><span class="toc-section-number">96.3</span> Date</a></li>
<li><a href="#table-of-contents-toc" id="toc-table-of-contents-toc"><span class="toc-section-number">96.4</span> Table of Contents (TOC)</a>
<ul>
<li><a href="#floating-table-of-contents-toc" id="toc-floating-table-of-contents-toc"><span class="toc-section-number">96.4.1</span> Floating Table of Contents (TOC)</a></li>
</ul></li>
<li><a href="#themes" id="toc-themes"><span class="toc-section-number">96.5</span> Themes</a></li>
<li><a href="#code-folding" id="toc-code-folding"><span class="toc-section-number">96.6</span> Code Folding</a>
<ul>
<li><a href="#example-without-code-folding" id="toc-example-without-code-folding"><span class="toc-section-number">96.6.1</span> Example without Code Folding</a></li>
<li><a href="#examples-with-code-folding" id="toc-examples-with-code-folding"><span class="toc-section-number">96.6.2</span> Examples with Code Folding</a></li>
</ul></li>
<li><a href="#output" id="toc-output"><span class="toc-section-number">96.7</span> output</a></li>
<li><a href="#custom-template" id="toc-custom-template"><span class="toc-section-number">96.8</span> Custom Template</a></li>
<li><a href="#ymlthis" id="toc-ymlthis"><span class="toc-section-number">96.9</span> ymlthis</a></li>
<li><a href="#your-turn-3" id="toc-your-turn-3"><span class="toc-section-number">96.10</span> Your Turn</a></li>
</ul></li>
<li><a href="#lesson-5-code-chunks-and-inline-code" id="toc-lesson-5-code-chunks-and-inline-code"><span class="toc-section-number">97</span> Lesson 5: Code Chunks and Inline Code</a>
<ul>
<li><a href="#code-chunks" id="toc-code-chunks"><span class="toc-section-number">97.1</span> Code Chunks</a>
<ul>
<li><a href="#shortcuts" id="toc-shortcuts"><span class="toc-section-number">97.1.1</span> Shortcuts</a></li>
<li><a href="#options" id="toc-options"><span class="toc-section-number">97.1.2</span> Options</a></li>
</ul></li>
<li><a href="#inline-code" id="toc-inline-code"><span class="toc-section-number">97.2</span> Inline Code</a></li>
<li><a href="#your-turn-part-1" id="toc-your-turn-part-1"><span class="toc-section-number">97.3</span> Your Turn (Part 1)</a></li>
<li><a href="#interactive-features" id="toc-interactive-features"><span class="toc-section-number">97.4</span> Interactive Features</a>
<ul>
<li><a href="#dt" id="toc-dt"><span class="toc-section-number">97.4.1</span> DT</a></li>
<li><a href="#plotly" id="toc-plotly"><span class="toc-section-number">97.4.2</span> Plotly</a></li>
<li><a href="#leaflet" id="toc-leaflet"><span class="toc-section-number">97.4.3</span> Leaflet</a></li>
</ul></li>
<li><a href="#your-turn-part-2" id="toc-your-turn-part-2"><span class="toc-section-number">97.5</span> Your Turn (Part 2)</a></li>
</ul></li>
<li><a href="#child-documents" id="toc-child-documents"><span class="toc-section-number">98</span> Child Documents</a>
<ul>
<li><a href="#extract-and-run-r-code-from-r-markdown-files" id="toc-extract-and-run-r-code-from-r-markdown-files"><span class="toc-section-number">98.1</span> Extract and Run R-Code from R Markdown Files</a>
<ul>
<li><a href="#r-code" id="toc-r-code"><span class="toc-section-number">98.1.1</span> R Code</a></li>
</ul></li>
<li><a href="#your-turn-4" id="toc-your-turn-4"><span class="toc-section-number">98.2</span> Your Turn</a></li>
</ul></li>
<li><a href="#parameterized-reports" id="toc-parameterized-reports"><span class="toc-section-number">99</span> Parameterized Reports</a>
<ul>
<li><a href="#params" id="toc-params"><span class="toc-section-number">99.1</span> params</a></li>
<li><a href="#knitting" id="toc-knitting"><span class="toc-section-number">99.2</span> Knitting</a></li>
<li><a href="#rmarkdownrender" id="toc-rmarkdownrender"><span class="toc-section-number">99.3</span> rmarkdown::render()</a></li>
<li><a href="#your-turn-5" id="toc-your-turn-5"><span class="toc-section-number">99.4</span> Your Turn</a></li>
</ul></li>
<li><a href="#thoughts-from-hadley-wickham-on-tidyverse" id="toc-thoughts-from-hadley-wickham-on-tidyverse">Thoughts from Hadley Wickham on Tidyverse</a>
<ul>
<li><a href="#dive-into-hadley-wickhams-tidyverse" id="toc-dive-into-hadley-wickhams-tidyverse"><span class="toc-section-number">99.5</span> Dive into Hadley Wickham‚Äôs Tidyverse</a></li>
<li><a href="#current-state-of-the-tidyverse-2020" id="toc-current-state-of-the-tidyverse-2020"><span class="toc-section-number">99.6</span> Current State of the Tidyverse (2020)</a></li>
</ul></li>
<li><a href="#part-back-matter" id="toc-part-back-matter">(PART) Back Matter</a></li>
<li><a href="#good-resources" id="toc-good-resources"><span class="toc-section-number">100</span> Good Resources</a>
<ul>
<li><a href="#cheatsheets" id="toc-cheatsheets"><span class="toc-section-number">100.1</span> Cheatsheets</a></li>
</ul></li>
<li><a href="#media-without-a-home-yet" id="toc-media-without-a-home-yet"><span class="toc-section-number">101</span> Media without a home yet</a>
<ul>
<li><a href="#sips-resources" id="toc-sips-resources"><span class="toc-section-number">101.1</span> SIPS Resources</a></li>
<li><a href="#visualizing-linear-models-an-r-bag-of-tricks" id="toc-visualizing-linear-models-an-r-bag-of-tricks"><span class="toc-section-number">101.2</span> Visualizing Linear Models: An R Bag of Tricks</a></li>
<li><a href="#for-new-programmers-learning-keyboard-shortcuts" id="toc-for-new-programmers-learning-keyboard-shortcuts"><span class="toc-section-number">101.3</span> For new programmers learning keyboard shortcuts‚Ä¶</a></li>
<li><a href="#are-you-a-student-if-yes-this-is-the-best-data-science-project-for-you" id="toc-are-you-a-student-if-yes-this-is-the-best-data-science-project-for-you"><span class="toc-section-number">101.4</span> Are you a student? If yes, this is the best data science project for you!</a></li>
<li><a href="#rstudio-is-magic" id="toc-rstudio-is-magic"><span class="toc-section-number">101.5</span> rstudio is magic</a></li>
<li><a href="#automation-quote" id="toc-automation-quote"><span class="toc-section-number">101.6</span> automation quote</a></li>
<li><a href="#how-computer-memory-works" id="toc-how-computer-memory-works"><span class="toc-section-number">101.7</span> How computer memory works!</a></li>
<li><a href="#is-coding-a-math-skill-or-a-language-skill-neither-both" id="toc-is-coding-a-math-skill-or-a-language-skill-neither-both"><span class="toc-section-number">101.8</span> Is Coding a Math Skill or a Language Skill? Neither? Both?</a></li>
<li><a href="#quantum-computers-explained" id="toc-quantum-computers-explained"><span class="toc-section-number">101.9</span> Quantum Computers Explained!</a></li>
<li><a href="#the-rise-of-the-machines-why-automation-is-different-this-time" id="toc-the-rise-of-the-machines-why-automation-is-different-this-time"><span class="toc-section-number">101.10</span> The Rise of the Machines ‚Äì Why Automation is Different this Time</a></li>
<li><a href="#emergence-how-stupid-things-become-smart-together" id="toc-emergence-how-stupid-things-become-smart-together"><span class="toc-section-number">101.11</span> Emergence ‚Äì How Stupid Things Become Smart Together</a></li>
<li><a href="#how-not-to-ask-for-help" id="toc-how-not-to-ask-for-help"><span class="toc-section-number">101.12</span> How not to ask for help</a></li>
<li><a href="#the-birthday-paradox" id="toc-the-birthday-paradox"><span class="toc-section-number">101.13</span> The Birthday Paradox</a></li>
<li><a href="#why-cant-you-divide-by-zero" id="toc-why-cant-you-divide-by-zero"><span class="toc-section-number">101.14</span> Why can‚Äôt you divide by zero?</a></li>
<li><a href="#yea-hes-chewing-up-my-stats-homework-but-that-face-though" id="toc-yea-hes-chewing-up-my-stats-homework-but-that-face-though"><span class="toc-section-number">101.15</span> Yea he‚Äôs chewing up my stats homework but that face though‚Ä¶</a></li>
<li><a href="#coding-kitty" id="toc-coding-kitty"><span class="toc-section-number">101.16</span> Coding Kitty</a></li>
<li><a href="#democratic-databases-science-on-github" id="toc-democratic-databases-science-on-github"><span class="toc-section-number">101.17</span> Democratic databases: science on GitHub</a></li>
<li><a href="#ten-simple-rules-for-getting-started-on-twitter-as-a-scientist" id="toc-ten-simple-rules-for-getting-started-on-twitter-as-a-scientist"><span class="toc-section-number">101.18</span> Ten simple rules for getting started on Twitter as a scientist</a></li>
<li><a href="#nyt-data-ethics-stuff" id="toc-nyt-data-ethics-stuff"><span class="toc-section-number">101.19</span> NYT data ethics stuff</a></li>
<li><a href="#section" id="toc-section"><span class="toc-section-number">101.20</span> </a></li>
</ul></li>
<li><a href="#public-health" id="toc-public-health">Public Health</a>
<ul>
<li><a href="#crowns-and-tears-a-covid-19-visualization-with-a-music-box-and-punch-cards" id="toc-crowns-and-tears-a-covid-19-visualization-with-a-music-box-and-punch-cards">Crowns and Tears: A Covid-19 visualization with a Music Box and punch cards</a></li>
<li><a href="#masks" id="toc-masks">Masks</a></li>
<li><a href="#dashboards" id="toc-dashboards">Dashboards</a>
<ul>
<li><a href="#wake-forest" id="toc-wake-forest">Wake Forest</a></li>
<li><a href="#north-carolina" id="toc-north-carolina">North Carolina</a></li>
</ul></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Psychologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="part-front-matter" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART*) Front Matter<a href="#part-front-matter" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-psy-703" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Welcome to PSY 703<a href="#welcome-to-psy-703" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Welcome to class! This website is designed to accompany Mason Garrison‚Äôs Data Science for Psychologists (DS4P). DS4P is a graduate-level quantitative methods course at Wake Forest University. This class assumes zero knowledge of programming, computer science, linear algebra, probability, or really anything fancy. I encourage anyone who is quant-curious to work their way through these course notes. The course notes include lectures, worked examples, readings, activities, and labs. You can find the current version of the course syllabus <a href="https://smasongarrison.github.io/syllabi/">here</a>, along with all of the <a href="https://smasongarrison.github.io/syllabi">other syllabi for my classes</a>. All the embedded lecture videos can be found on a <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYZomNqf-1dtCDW94ySdLv-9">youtube playlist</a>.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/nYYJmmcgzr8" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:index.Rmd-->
<!-- front page -->
<div id="mason-notes" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Mason Notes<a href="#mason-notes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This website is constantly changing. I am actively developing this course, and is approximately 99.2% done. I have made this process explicitly transparent because I want you to see how you can use R to produce some pretty neat things. Indeed, I‚Äôve included the source code for this website in the class <a href="https://github.com/DataScience4Psych">repo</a>. I encourage you to contribute to the <a href="https://github.com/DataScience4Psych/DataScience4Psych">course code</a>. If you catch typos or errors, please issue a pull request with the fixes. If you find cool or useful resources, please add them. By the end of the semester, I would love for everyone to have contributed to the course materials.</p>
<div id="how-to-use-these-notes" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">How to use these notes<a href="#how-to-use-these-notes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To navigate these course notes, use the table of contents on the left side of the screen. You can open or close the table of contents using the hamburger icon (horizontal bars) at the top of the document. There are also additional icons at the top of the document that allow you to search the document, change the size, font, or color scheme of the page. The document will be updated (unpredictably) throughout the semester.</p>
<p>Every module corresponds to a week‚Äôs worth of material. Most modules are dedicated to improving a specific skill or at the very least dedicated to a specific theme. Within each module, there are embedded videos, slides, activities, labs, and tutorials. The skills developed in each module build upon skills you‚Äôve developed in previous modules. Eventually, this class will have more modules available than weeks in a semester, so that you ‚Äì the reader ‚Äì can choose your own adventure (err‚Ä¶ module) you‚Äôd like to start with.</p>
<p>Although these notes have some textbook-like features, they are neither comprehensive nor completely original. The main purpose is to give you all a set of common materials to draw upon during the course. In class, we will sometimes do things outside the notes. The idea here is that you will read the materials and try to learn from them, just as you will attend classes and try to learn from them.</p>
</div>
<div id="status-of-course" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Status of course<a href="#status-of-course" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In terms of timing, I will have each module completed by the start of the week. Given that the class meets on Tuesday and Thursday, the start of the ‚Äúweek‚Äù will be Monday at 12 p.m. EST. I may get ahead of this deadline. You can see the current status of the course below. Although you are welcome to work ahead, be aware that I will be making changes to modules that haven‚Äôt officially started yet. In addition, I may add optional materials to previous modules that might be helpful.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/fwJHNw9jU_U" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>This table provides the current status of the course. It lists proportions of specific components by module. Overall, it is 99.167% complete.</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-89bc4a34c722eeeb8166" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-89bc4a34c722eeeb8166">{"x":{"filter":"none","vertical":false,"data":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,null,null],[null,1,1,1,1,1,1,1,1,1,1,1,1,1,null,null],[1,1,1,1,1,1,1,1,1,0.5,1,1,1,1,null,null],[null,1,1,1,1,1,null,1,1,null,null,null,null,null,null,null],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,null],[1,1,1,1,1,1,1,1,1,0.875,1,1,1,1,1,null]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>Module<\/th>\n      <th>Slides<\/th>\n      <th>Lab<\/th>\n      <th>Videos<\/th>\n      <th>Application<\/th>\n      <th>Lecture Notes<\/th>\n      <th>Status<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"autoWidth":true,"bInfo":false,"paging":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,5,6]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="attribution" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Attribution<a href="#attribution" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This class leans heavily on other peoples‚Äô materials and ideas. I have done my best to document the origin of the materials and ideas. In particular, I have noted people whose work has been a major contribution as well as those who have additional contributions. You can see specific changes by examining the <a href="https://github.com/DataScience4Psych/DataScience4Psych/commits/main">edit history on the git repo</a></p>
<div id="major-attributions" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Major Attributions<a href="#major-attributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Jenny Bryan‚Äôs (<a href="https://jennybryan.org">jennybryan.org</a>) <a href="https://stat545.com">STAT 545</a> and <a href="https://happygitwithr.com/">Happy Git with R</a>;</li>
<li>Joe Rodgers‚Äôs PSY 8751 Exploratory and Graphical Data Analysis Course</li>
<li>Mine √áetinkaya-Rundel‚Äôs <a href="https://datasciencebox.org/">Data Science in a Box</a>.</li>
</ul>
</div>
<div id="additional-attributions" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Additional Attributions<a href="#additional-attributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Academic.io‚Äôs <a href="https://github.com/academic/awesome-datascience">AWESOME DATA SCIENCE</a></li>
<li><a href="https://jfukuyama.github.io/">Julia Fukuyama</a>‚Äôs <a href="https://jfukuyama.github.io/teaching/stat670/">EXPLORATORY DATA ANALYSIS</a></li>
<li>Benjamin Soltoff‚Äôs <a href="https://cfss.uchicago.edu/">Computing for the Social Sciences</a></li>
<li><a href="https://github.com/grantmcdermott">Grant McDermott</a>‚Äôs course materials on <a href="https://github.com/uo-ec607">environmental economics and data science</a></li>
<li><a href="https://github.com/zsmith27/">Zachary M. Smith</a>‚Äôs <a href="https://github.com/zsmith27/rmarkdown_crash-course">crash course in rmarkdown</a></li>
<li><a href="https://thomaselove.github.io/431-notes/">Thomas E. Love</a></li>
<li><a href="https://www.biostat.wisc.edu/~kbroman/topten_worstgraphs/">Karl Broman</a></li>
<li><a href="https://esclark.hcommons.org/the-unessay/">EMILY SUZANNE CLARK</a>‚Äôs Rubric for Unessays</li>
<li><a href="https://github.com/aosmith16">Ariel Muldoon</a>‚Äôs <a href="https://github.com/aosmith16/simulation-helper-functions">tutorial on simulations</a></li>
</ul>
</div>
</div>
<div id="license" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">License<a href="#license" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<center>
<i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i>
</center>
<p><em>This information is a human-readable summary of (and not a substitute for) the license. Please see <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" class="uri">https://creativecommons.org/licenses/by-sa/4.0/legalcode</a> for the full legal text.</em></p>
<p><strong>You are free to:</strong></p>
<ul>
<li><p><strong>Share</strong>‚Äîcopy and redistribute the material in any medium or format</p></li>
<li><p><strong>Remix</strong>‚Äîremix, transform, and build upon the material for any purpose, even commercially.</p></li>
</ul>
<p>The licensor cannot revoke these freedoms as long as you follow the license terms.</p>
<p><strong>Under the following terms:</strong></p>
<ul>
<li><p><strong>Attribution</strong>‚ÄîYou must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.</p></li>
<li><p><strong>ShareAlike</strong>‚ÄîIf you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original.</p></li>
<li><p><strong>No additional restrictions</strong>‚ÄîYou may not apply legal terms or technological measures that legally restrict others from doing anything the license permits.</p></li>
</ul>
<p><strong>Notices:</strong></p>
<p>You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation.</p>
<p>No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material.</p>
</div>
<div id="sitemap" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Sitemap<a href="#sitemap" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="jkuhcolbgk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jkuhcolbgk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jkuhcolbgk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jkuhcolbgk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jkuhcolbgk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jkuhcolbgk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jkuhcolbgk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jkuhcolbgk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jkuhcolbgk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jkuhcolbgk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jkuhcolbgk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jkuhcolbgk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jkuhcolbgk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jkuhcolbgk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jkuhcolbgk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jkuhcolbgk .gt_from_md > :first-child {
  margin-top: 0;
}

#jkuhcolbgk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jkuhcolbgk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jkuhcolbgk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jkuhcolbgk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jkuhcolbgk .gt_row_group_first td {
  border-top-width: 2px;
}

#jkuhcolbgk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkuhcolbgk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jkuhcolbgk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jkuhcolbgk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jkuhcolbgk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkuhcolbgk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jkuhcolbgk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jkuhcolbgk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jkuhcolbgk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jkuhcolbgk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkuhcolbgk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jkuhcolbgk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jkuhcolbgk .gt_left {
  text-align: left;
}

#jkuhcolbgk .gt_center {
  text-align: center;
}

#jkuhcolbgk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jkuhcolbgk .gt_font_normal {
  font-weight: normal;
}

#jkuhcolbgk .gt_font_bold {
  font-weight: bold;
}

#jkuhcolbgk .gt_font_italic {
  font-style: italic;
}

#jkuhcolbgk .gt_super {
  font-size: 65%;
}

#jkuhcolbgk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jkuhcolbgk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jkuhcolbgk .gt_indent_1 {
  text-indent: 5px;
}

#jkuhcolbgk .gt_indent_2 {
  text-indent: 10px;
}

#jkuhcolbgk .gt_indent_3 {
  text-indent: 15px;
}

#jkuhcolbgk .gt_indent_4 {
  text-indent: 20px;
}

#jkuhcolbgk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="title">title</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="link">link</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="title" class="gt_row gt_left">404</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/404.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">api wrappers</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/api-wrappers.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">attribution</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/attribution.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">automation</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/automation.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">basic syntax</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/basic-syntax.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">basic data care</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/basic_data_care.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">basiccare</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/basiccare.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">bechdal</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/bechdal.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">bias</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/bias.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">bootstrapping</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/bootstrapping.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">child documents</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/child-documents.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">colophon</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/colophon.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">communicating data science results effectively</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/communicating-data-science-results-effectively.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">creating datasets with quantiative and categorical variables</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/creating-datasets-with-quantiative-and-categorical-variables.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">cross validation</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/cross-validation.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">data science and ethics</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/data-science-and-ethics.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">data types and recoding</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/data-types-and-recoding.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">data usually finds me</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/data-usually-finds-me.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">deeper diving into ggplot2</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/deeper-diving-into-ggplot2.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">designing effective visualizations</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/designing-effective-visualizations.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">diy web data</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/diy-web-data.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">dont miss module 00</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/dont-miss-module-00.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">dont miss the last module</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/dont-miss-the-last-module.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">dplyr intro</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/dplyr-intro.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">dplyr intro</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/dplyr_intro.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">exploratory data analysis</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/exploratory-data-analysis.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">featurenotes</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/featurenotes.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">fitting and interpreting models</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/fitting-and-interpreting-models.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">functions 1</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/functions-1.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">functions part1</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/functions-part1.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">functions practicum</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/functions-practicum.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">generate character vectors with rep</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/generate-character-vectors-with-rep.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">getting started with simulating data in r</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/getting-started-with-simulating-data-in-r.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">good resources</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/good-resources.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">grammar of data wrangling</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/grammar-of-data-wrangling.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">guidance</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/guidance.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">handson</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/handson.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">import export</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/import-export.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">importing data</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/importing-data.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">index</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/index.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab01</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab01.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab02</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab02.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab03</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab03.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab04</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab04.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab05</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab05.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab06</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab06.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab07</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab07.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab08</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab08.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab08b</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab08b.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab09</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab09.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab10</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab10.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lab11</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lab11.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">language of models</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/language-of-models.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lesson 2 rmd creation</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lesson-2-rmd-creation.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lesson 3 basic syntax</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lesson-3-basic-syntax.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lesson 4 yaml headers</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lesson-4-yaml-headers.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lesson 5 code chunks and inline code</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lesson-5-code-chunks-and-inline-code.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lesson 6 child documents</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lesson-6-child-documents.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">lesson 7 parameterized reports</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/lesson-7-parameterized-reports.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">license</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/license.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">media without a home yet</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/media-without-a-home-yet.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">meet our toolbox</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/meet-our-toolbox.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">merges</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/merges.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">mod06</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/mod06.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">modeling non linear relationships</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/modeling-non-linear-relationships.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">modeling with multiple predictors</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/modeling-with-multiple-predictors.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">natural language processing</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/natural-language-processing.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">neural networks</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/neural-networks.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">notes on feature engineering</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/notes-on-feature-engineering.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">notes on hypothesis testing</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/notes-on-hypothesis-testing.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">notes on logistic regression</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/notes-on-logistic-regression.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">odd design choices in data visualization</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/odd-design-choices-in-data-visualization.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">odd notes on cross validation</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/odd-notes-on-cross-validation.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">odd transformations data</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/odd-transformations-data.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">overfitting</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/overfitting.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">parameterized reports</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/parameterized-reports.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">plots behaving badly</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/plots-behaving-badly.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">practical advice from the data professor</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/practical-advice-from-the-data-professor.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">public health</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/public-health.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">quantifying uncertainty</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/quantifying-uncertainty.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">r project development</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/r-project-development.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">r workflow</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/r-workflow.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">r basics</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/r_basics.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">references</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/references.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">repeatedly simulate data with replicate</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/repeatedly-simulate-data-with-replicate.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">rmd creation</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/rmd-creation.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">rshiny overview</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/rshiny-overview.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">rshiny</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/rshiny.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">save figs</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/save-figs.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">scientific studies and confounding</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/scientific-studies-and-confounding.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">scraping the web</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/scraping-the-web.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">secrets</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/secrets.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">shiny overview</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/shiny-overview.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">shiny resources</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/shiny-resources.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">shorthappygit</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/shorthappygit.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">sitemap</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/sitemap.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">special topics machine learn</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/special-topics-machine-learn.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">star wars activity</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/star-wars-activity.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">thoughtful workflow</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/thoughtful-workflow.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">thoughts from hadley wickham on tidyverse</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/thoughts-from-hadley-wickham-on-tidyverse.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">tidy data</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/tidy-data.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">visualization examples</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/visualization-examples.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">visualizing categorical data</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/visualizing-categorical-data.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">visualizing data with ggplot2</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/visualizing-data-with-ggplot2.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">visualizing numerical data</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/visualizing-numerical-data.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to a markdown crashcourse</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-a-markdown-crashcourse.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to data and ethics</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-data-and-ethics.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to data and visualization</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-data-and-visualization.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to data diving with types</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-data-diving-with-types.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to data science</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-data-science.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to functions and automation</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-functions-and-automation.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to modeling the tidy way</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-modeling-the-tidy-way.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to overfitting and cross validation</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-overfitting-and-cross-validation.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to quantifying uncertainty</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-quantifying-uncertainty.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to simulating data</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-simulating-data.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to the tidyverse</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-the-tidyverse.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to tips for effective data visualization</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-tips-for-effective-data-visualization.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">welcome to web scraping</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/welcome-to-web-scraping.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">what is data science</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/what-is-data-science.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">whats the next step</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/whats-the-next-step.html">website</a></td></tr>
    <tr><td headers="title" class="gt_row gt_left">working with multiple data frames</td>
<td headers="link" class="gt_row gt_center"><a href="https://datascience4psych.github.io/DataScience4Psych/working-with-multiple-data-frames.html">website</a></td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="colophon" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Colophon<a href="#colophon" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These notes was written in <a href="http://bookdown.org/">bookdown</a> inside <a href="http://www.rstudio.com/ide/">RStudio</a>. The <a href="https://datascience4psych.github.io/DataScience4Psych">website</a> is hosted with <a href="https://www.github.com">github</a>, The complete source is available from <a href="https://github.com/DataScience4Psych/DataScience4Psych">github</a>.</p>
<p>The book style was designed by <a href="https://desiree.rbind.io/">Desir√©e De Leon</a>.</p>
<p>This version of the notes was built with:</p>
<pre><code>#&gt; Finding R package dependencies ... Done!
#&gt;  setting  value
#&gt;  version  R version 4.2.2 (2022-10-31 ucrt)
#&gt;  os       Windows 10 x64 (build 22623)
#&gt;  system   x86_64, mingw32
#&gt;  ui       RTerm
#&gt;  language (EN)
#&gt;  collate  English_United States.utf8
#&gt;  ctype    English_United States.utf8
#&gt;  tz       America/New_York
#&gt;  date     2022-12-27
#&gt;  pandoc   2.19.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)</code></pre>
<p>Along with these packages:</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4af7cbf85b5834f17747" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4af7cbf85b5834f17747">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["askpass","assertthat","backports","base64enc","bigD","bit","bit64","bitops","blob","bookdown","brew","brio","broom","bslib","cachem","callr","cellranger","cli","clipr","colorspace","commonmark","conflicted","cpp11","crayon","credentials","crosstalk","crul","curl","data.table","DBI","dbplyr","desc","devtools","dichromat","diffobj","digest","downlit","dplyr","DT","dtplyr","ellipsis","evaluate","fansi","farver","fastmap","fontawesome","forcats","fs","gapminder","gargle","gender","genderdata","generics","geonames","gert","ggplot2","gh","gitcreds","glue","googledrive","googlesheets4","gridExtra","gt","gtable","haven","highr","hms","htmltools","htmlwidgets","httpcode","httpuv","httr","ids","ini","isoband","jquerylib","jsonlite","juicyjuice","knitr","labeling","later","lattice","lazyeval","lifecycle","lubridate","magrittr","MASS","Matrix","memoise","mgcv","mime","miniUI","modelr","munsell","nlme","openssl","pillar","pkgbuild","pkgconfig","pkgdown","pkgload","plyr","praise","prettyunits","processx","profvis","progress","promises","ps","purrr","R6","ragg","rappdirs","rcmdcheck","RColorBrewer","Rcpp","readr","readxl","rebird","rematch","rematch2","remotes","reprex","reshape2","rjson","rlang","rmarkdown","roxygen2","rplos","rprojroot","rstudioapi","rversions","rvest","sass","scales","selectr","sessioninfo","shiny","solrium","sourcetools","stringi","stringr","sys","systemfonts","testthat","textshaping","tibble","tidyr","tidyselect","tidyverse","timechange","tinytex","triebeard","tzdb","urlchecker","urltools","usethis","utf8","uuid","V8","vctrs","viridis","viridisLite","vroom","waldo","whisker","withr","xfun","xml2","xopen","xtable","yaml","zip"],[null,"0.2.1","1.4.1",null,null,"4.0.5","4.0.5",null,null,"0.31",null,null,"1.0.2","0.4.2","1.0.6","3.7.3","1.1.0","3.5.0",null,"2.0-3","1.8.1",null,null,"1.5.2",null,"1.2.0",null,"4.3.3",null,"1.1.3","2.2.1",null,"2.4.5",null,null,"0.6.31",null,"1.0.10","0.26",null,"0.3.2","0.19","1.0.3",null,"1.1.0",null,"0.5.2","1.5.2",null,"1.2.1",null,null,"0.1.3",null,null,"3.4.0",null,null,"1.6.2","2.0.0","1.0.1",null,"0.8.0","0.3.1","2.5.1",null,"1.1.2","0.5.4","1.6.0",null,"1.6.7","1.4.4",null,null,null,"0.1.4","1.8.4",null,"1.41",null,"1.3.0",null,null,"1.0.3","1.9.0","2.0.3",null,null,"2.0.1",null,"0.12","0.1.1.1","0.1.10","0.5.0",null,null,"1.8.1","1.4.0","2.0.3",null,"1.3.2",null,null,"1.1.1","3.8.0","0.3.7",null,"1.2.0.1","1.7.2","1.0.0","2.5.1",null,null,null,null,"1.0.9","2.1.3","1.4.1",null,null,null,"2.4.2","2.0.2",null,null,"1.0.6","2.19",null,null,null,"0.14",null,"1.0.3","0.4.4","1.2.1",null,"1.2.2","1.7.4",null,null,"1.7.8","1.5.0",null,null,null,null,"3.1.8","1.2.1","1.2.0","1.3.2","0.1.1",null,null,"0.3.0","1.0.1",null,"2.1.6","1.2.2",null,null,"0.5.1",null,null,"1.6.0",null,null,"2.5.0","0.36","1.3.3",null,"1.8-4","2.3.6",null],["2019-01-13","2019-03-21","2021-12-13","2015-07-28","2022-09-05","2022-11-15","2020-08-30","2021-04-24","2022-04-10","2022-12-13","2022-09-29","2021-11-30","2022-12-15","2022-12-16","2021-08-19","2022-11-02","2016-07-27","2022-12-20","2022-02-22","2022-02-21","2022-10-14","2021-11-26","2022-10-12","2022-09-29","2021-11-29","2021-11-04","2022-09-03","2022-10-06","2022-11-16","2022-06-18","2022-06-27","2022-09-08","2022-10-11","2022-05-02","2021-10-05","2022-12-11","2022-07-05","2022-09-01","2022-10-19","2022-08-20","2021-04-29","2022-12-13","2022-03-24","2022-07-06","2021-01-25","2022-10-25","2022-08-19","2021-12-08","2017-10-31","2022-09-08","2021-10-13",null,"2022-07-05","2019-02-19","2022-12-05","2022-11-04","2022-09-08","2022-09-08","2022-02-24","2021-07-08","2022-08-13","2017-09-09","2022-11-16","2022-09-01","2022-08-22","2022-12-22","2022-08-19","2022-12-07","2022-12-15","2020-04-10","2022-12-14","2022-08-17","2017-05-31","2018-05-20","2022-12-20","2021-04-26","2022-12-06","2022-11-10","2022-11-18","2020-10-20","2021-08-18","2021-09-22","2019-03-15","2022-10-07","2022-11-06","2022-03-30","2022-08-03","2022-09-13","2021-11-26","2022-10-21","2021-09-28","2018-05-18","2022-11-11","2018-06-12","2022-10-10","2022-12-06","2022-08-19","2022-11-27","2019-09-22","2022-12-14","2022-11-16","2022-11-11","2015-08-11","2020-01-24","2022-10-26","2020-11-02","2019-05-16","2021-02-11","2022-10-26","2022-12-20","2021-08-19","2022-10-24","2021-01-31","2021-09-27","2022-04-03","2022-07-08","2022-10-01","2022-08-17","2021-09-20","2016-04-21","2020-05-01","2021-11-30","2022-08-17","2020-04-09","2022-01-09","2022-09-24","2022-12-15","2022-12-08","2021-02-23","2022-04-02","2022-08-22","2022-08-31","2022-08-19","2022-11-24","2022-08-20","2019-11-20","2021-12-06","2022-12-15","2021-05-19","2018-04-25","2022-07-11","2022-12-02","2022-10-18","2022-02-11","2022-12-09","2021-10-13","2022-07-22","2022-09-08","2022-10-10","2022-07-18","2022-11-04","2022-12-13","2016-08-04","2022-03-28","2021-11-30","2019-04-14","2022-05-25","2021-07-24","2022-04-19","2022-11-03","2022-11-16","2021-10-13","2022-08-22","2022-09-30","2022-03-16","2022-12-05","2022-03-03","2022-12-21","2021-11-30","2018-09-17","2019-04-21","2022-10-18","2022-10-26"],["CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)",null,"CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.1)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.1)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.0)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.1)","CRAN (R 4.2.2)"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>package<\/th>\n      <th>loadedversion<\/th>\n      <th>date<\/th>\n      <th>source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":173,"autoWidth":true,"bInfo":false,"paging":false,"columnDefs":[],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,50,100,173]}},"evals":[],"jsHooks":[]}</script>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0000_front.Rmd-->
</div>
<div id="part-module-00" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART*) Module 00<a href="#part-module-00" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="dont-miss-module-00" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Don‚Äôt Miss Module 00<a href="#dont-miss-module-00" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This overview is designed to orient you to the class. Please watch the videos from this <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYaEAnJX20Ryy4OSie375rVY">playlist</a> and work your way through the notes. Although the module-level playlists are embedded in the course, you can find the full-course video playlist <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYZomNqf-1dtCDW94ySdLv-9">here</a>. In addition, you can find the slides for this module <a href="https://github.com/DataScience4Psych/DataScience4Psych/blob/main/admin/pdf/001_Introduction.pdf">here</a>. Currently, there are seven videos in this playlist. The average video length is 12 minutes, 27 seconds. The total length of the playlist is 1 hour, 27 minutes, 10 seconds. <!-- https://ytplaylist-len.herokuapp.com/ --></p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/HU39nOxcJYg" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>Data Science for Psychologists (DS4P) introduces on the principles of data science, including:</p>
<ul>
<li>data wrangling,</li>
<li>modeling,</li>
<li>visualization, and</li>
<li>communication.</li>
</ul>
<p>This class links those principles to psychological methods and open science practices by emphasizing exploratory analyses and description rather than confirmatory analyses and prediction. Through the semester, we will work our way through <a href="http://r4ds.had.co.nz/">Wickham and Grolemund‚Äôs R for Data Science text</a> and develop proficiency with <a href="https://www.tidyverse.org/">tidyverse</a>. This class emphasizes replication and reproducibility. DS4P is a practical skilled-based class and should be helpful to students aiming for academia and those interested in industry. Applications of these methods can be applied to a full range of psychological areas, including perception (e.g., eye-tracking data), neuroscience (e.g., visualizing neural networks), and individual differences (e.g., valence analysis).</p>
<div id="big-ideas" class="section level2 hasAnchor" number="0.1">
<h2 class="hasAnchor"><span class="header-section-number">0.1</span> Big Ideas<a href="#big-ideas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This class covers the following broad five areas:</p>
<ul>
<li>Reproducibility;</li>
<li>Replication;</li>
<li>Robust Methods;</li>
<li>Resplendent Visualizations; and</li>
<li>R Programming.</li>
</ul>
</div>
<div id="course-modality" class="section level2 hasAnchor" number="0.2">
<h2 class="hasAnchor"><span class="header-section-number">0.2</span> Course Modality<a href="#course-modality" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Technically, this course is designated as a blended course. This designation is because this course‚Äôs modality changes based on the level of COVID-19 transmission in the community. When COVID-19 community transmission is low or medium, this class will be in-person and masking will be required. However, if COVID-19 transmission is high in the community, this course may be moved entirely online in order to protect the health and safety of students and instructor. In the case that we move online, the in-person sessions will become synchronous online sessions. Any changes will be clearly and promptly communicated via email.</p>
<p>Pragmatically, the face-to-face portions of the class are ‚Äì well ‚Äì face-to-face. Or that was the idea anyway‚Ä¶ however, during the first semester I taught this course, a few members of the class were on the other side of the planet. Accordingly, I pivoted all the planned in-class activities and labs so that the entire class could complete their degrees on-time. So obviously this last-minute pivot was a little messy, but I think it turned out ok‚Ä¶ So again, technically, this class was blended, but effectively, it can be completed from anywhere at any time. It had to be.</p>
<div id="successful-asynchronous-learning" class="section level3 hasAnchor" number="0.2.1">
<h3 class="hasAnchor"><span class="header-section-number">0.2.1</span> Successful Asynchronous Learning<a href="#successful-asynchronous-learning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I‚Äôve created a video highlighting how to be a successful asynchronous learner.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/dc3D2tbl8G0" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>Much of this information comes from Northeastern University‚Äôs <a href="https://www.northeastern.edu/graduate/blog/tips-for-taking-online-classes/">Tips for Taking Online Classes</a></p>
<div id="productivity-during-lockdown" class="section level4 hasAnchor" number="0.2.1.1">
<h4 class="hasAnchor"><span class="header-section-number">0.2.1.1</span> Productivity During Lockdown<a href="#productivity-during-lockdown" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/snAhsXyO3Ck" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
</div>
<div id="knowledge-is-power" class="section level2 hasAnchor" number="0.3">
<h2 class="hasAnchor"><span class="header-section-number">0.3</span> Knowledge is Power<a href="#knowledge-is-power" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/ZbGMbdDLnyY" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>This brief video is covers the icebreaker I do in all of my classes. I encourage you to watch it. In it, I discuss stereotype threats and statistics anxiety.</p>
</div>
<div id="meet-prof.-mason" class="section level2 hasAnchor" number="0.4">
<h2 class="hasAnchor"><span class="header-section-number">0.4</span> Meet Prof.¬†Mason<a href="#meet-prof.-mason" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/1IOCKxgowaQ" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="website-tour" class="section level2 hasAnchor" number="0.5">
<h2 class="hasAnchor"><span class="header-section-number">0.5</span> Website Tour<a href="#website-tour" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Fq_hAQd78zo" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0001_opener.Rmd-->
</div>
</div>
<div id="guidance" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Guidance<a href="#guidance" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This document provides some basic assignment instructions and information. It is not the syllabus for students taking this course. Please see the <a href="https://smasongarrison.github.io/syllabi/data-science.html">data science syllabus</a> on my <a href="https://smasongarrison.github.io/syllabi/">syllabus website</a>. And yes, the bookdown theme looks familiar‚Ä¶</p>
<!-- To Do: find a way to embed a pdf in rmarkdown -->
<div id="materials" class="section level2 hasAnchor" number="0.6">
<h2 class="hasAnchor"><span class="header-section-number">0.6</span> Materials<a href="#materials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="hardware" class="section level3 hasAnchor" number="0.6.1">
<h3 class="hasAnchor"><span class="header-section-number">0.6.1</span> Hardware<a href="#hardware" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This class requires that you have a laptop that can run R.</p>
</div>
<div id="required-texts" class="section level3 hasAnchor" number="0.6.2">
<h3 class="hasAnchor"><span class="header-section-number">0.6.2</span> Required Texts<a href="#required-texts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The text is intended to supplement the videos, lecture notes, tutorials, activities, and labs. You probably need to consume all of them in order to be successful in this class. All materials for this course are open source, including the multimedia course notes.
- Garrison‚Äôs Data Science for Psychologists (<a href="https://datascience4psych.github.io/DataScience4Psych/" class="uri">https://datascience4psych.github.io/DataScience4Psych/</a>)
- Wickham and Grolemund‚Äôs <a href="https://r4ds.had.co.nz">R for Data Science text</a></p>
</div>
<div id="syllabussoftware" class="section level3 hasAnchor" number="0.6.3">
<h3 class="hasAnchor"><span class="header-section-number">0.6.3</span> Software<a href="#syllabussoftware" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="syllabusr" class="section level4 hasAnchor" number="0.6.3.1">
<h4 class="hasAnchor"><span class="header-section-number">0.6.3.1</span> R and RStudio<a href="#syllabusr" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/kVIZGCT5p9U" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>R is a free software environment for statistical computing and graphics. It compiles and runs on a wide variety of UNIX platforms, Windows, and MacOS.</p>
<p>RStudio is a free <em>integrated development environment</em> (IDE), a powerful user interface for R.</p>
</div>
<div id="syllabusgit" class="section level4 hasAnchor" number="0.6.3.2">
<h4 class="hasAnchor"><span class="header-section-number">0.6.3.2</span> Git and Github<a href="#syllabusgit" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Git is a version control system. Its original purpose was to help groups of developers work collaboratively on big software projects. Git manages the evolution of a set of files ‚Äì called a repository ‚Äì in a structured way. Think of it like the ‚ÄúTrack Changes‚Äù features from Microsoft Word.</p>
<p>Github is a free IDE and hosting service for Git. As a Wake Forest student, you should be able to access the <a href="https://education.github.com/benefits?type=student">GitHub Student Developer Pack for free</a>. It includes a free PRO upgrade for your github account.</p>
</div>
</div>
</div>
<div id="assignment-instructions" class="section level2 hasAnchor" number="0.7">
<h2 class="hasAnchor"><span class="header-section-number">0.7</span> Assignment Instructions<a href="#assignment-instructions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="portfolio" class="section level3 hasAnchor" number="0.7.1">
<h3 class="hasAnchor"><span class="header-section-number">0.7.1</span> Portfolio<a href="#portfolio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This description is from my advisor, Joe Rodgers.
<!-- To Do: desportify Joe's introduction --></p>
<p>DS is like basketball. We can watch either being done, and appreciate the art and skill involved in high-level performance. In the hands of Lebron James or Michael Jordan, a basketball is a highly-tuned artistic instrument; in the hands of John Tukey, a graph sings the praises of data in melodies both harmonious and discordant, reflecting model, data, and mood. Part of this course will be devoted to Watching and Studying the master at his work.</p>
<p>But basketball is played by thousands of bodies with less than NBA training and ability. Some novice basketball players are just learning their craft, and others will evolve into future LJs and MJs; others have lower aspirations, yet still enjoy participating. So also should DS be played. A second part of this course will involve learning to do EDA by Doing It.</p>
<p>Each of you will be expected to do several portfolio pieces. These projects can be done during class, as well as during out-of-class effort. The nature of most of the particular projects will be entirely up to you. You will report to your instructor during EDA Labs on what you have been doing and what you plan to do. You will give a 10-minute individual presentation to the class at the end of the course on what you did in one or two of your major projects. <!-- There are three requirements. Your projects must include some hand plotting. Your projects must include some computer work. And your projects must include one group project with two other people (your team projects). Results of this group project will also be presented toward the end of the course.--></p>
<p>Each project will require some data, to which EDA techniques will be applied. You are welcomed (in fact, strongly encouraged) to use data with which you are currently involved; dissertation or thesis data, a research project, the almanac, data from an article, data from EDA or VDat, data you collect from your family or friends, or data provided to you by your instructor are possible sources.</p>
</div>
<div id="additional-ground-rules" class="section level3 hasAnchor" number="0.7.2">
<h3 class="hasAnchor"><span class="header-section-number">0.7.2</span> Additional Ground Rules<a href="#additional-ground-rules" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this class, I actively encourage you to ‚Äúdouble-dip.‚Äù My aim is for you to incorporate your research into portfolio pieces and use these pieces in other places. However, I <em>Mason</em> have some ground rules. These rules have been implemented for various reasons, but they primarily preserve my sanity by establishing some boundaries. As much as I adore this class, my students (especially you, dear reader!), and everything it stands for ‚Äì it blurs many lines because I often serve numerous roles while teaching this class. In particular, I may also be your mentor, committee member, collaborator, letter of recommendation writer, colleague, confidant, statistics consultant, friend, or cat caretaker. I do my best to navigate these roles. However, for my sanity, here are my basic rules.</p>
<p>For anything that is related to a graduate school milestone (thesis, first year project, major area paper) or something else that you‚Äôre working with your advisor on‚Ä¶ you need to <em>actively</em> discuss it with your advisor and get their approval in advance.</p>
<p>They may not ‚Äì and that‚Äôs okay. If they‚Äôre unsure, I‚Äôm very happy to schedule a quick 30 minute chat with all three of us. My role on anything milestone related is to assist you with the implementation or give you general feedback. I cannot give you advice related to modeling or anything that would merit a discussion about authorship on the final work. I may disagree with something they recommend that you do‚Ä¶ such as use a specific software that isn‚Äôt R. (I do have many strong opinions about SPSS and AMOS, as well as modeling choices. However, there is nearly always room for debate in these issues. I try to remind folks that my opinion is just that ‚Äì an opinion.)</p>
<p>For all things related to your research at Wake Forest, <em>please defer to your advisor.</em> Everyone in the department are amazing at what they do. Seriously, each is an expert in their research area ‚Äì just as I am an expert in R (and genetically-informed designs and strange data‚Ä¶). In all likelihood, they know more about the modeling in their specific area. I am happy to share my expert opinions and I have the privilege to facilitate such conversations through the nature of this class. HOWEVER, please defer to your advisor for all design decisions. I will do my best to tell you when something is outside the scope of the class or if we‚Äôre approaching a gray area. I will not always be successful at navigating this issue. However, I will do my best to do so because I think it is worth the extra challenge.</p>
<div id="possible-projects" class="section level4 hasAnchor" number="0.7.2.1">
<h4 class="hasAnchor"><span class="header-section-number">0.7.2.1</span> Possible Projects<a href="#possible-projects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Examples of appropriate portfolio pieces are listed below. I hope some or all of these will be worked on by members of the class. You should develop and work on your projects individually, but discussion with the instructor and others class members is encouraged and in fact expected.</p>
<ol style="list-style-type: decimal">
<li><p>Draw plots by hand of some data that are of interest to you, and transform the variables in several different ways. Interpret your results.</p></li>
<li><p>Choose some data from EDA or VDat; table or plot them in a way that Tukey/Cleveland didn‚Äôt.</p></li>
<li><p>Find some population data of interest to you (e.g., North Carolina, Forsyth County,your cat herd, etc.) and do several hand plots like those in Chapter 5 of EDA. Interpret results.</p></li>
<li><p>Find some data in the World Almanac and plot and/or table them.</p></li>
<li><p>Use some two-way data, and repeatedly extract the medians like Tukey does in Ch. 10 &amp; 11.</p></li>
<li><p>Find some time series data, and smooth them in several different ways (see EDA, ch.¬†7). Data with seasonal patterns are especially interesting (see VDat, pp.¬†152-172).</p></li>
<li><p>Write an R, SAS-Graph, SPSS, BASIC, FORTRAN, C, JAVA, or other program to portray influence-enhanced scatterplots. Produce scatterplots of several relationships.</p></li>
<li><p>Write a BASIC, FORTRAN, C, SAS, SPSS, JAVA, or other program to portray scatter plots on a computer. Give the user the option to plot X and/or Y as either raw data, logs, squares, cubes, reciprocals, roots, etc.</p></li>
<li><p>Write an R, SAS-Graph, SPSS, BASIC, FORTRAN, C, JAVA or other program to produce some exotic version of stem-and-leaf diagrams.</p></li>
<li><p>Write a an R, SAS-Graph, SPSS, BASIC, FORTRAN, C, JAVA or other program to plot in three-dimensions with time as one of the dimensions (i.e., a kinostatistical plot).</p></li>
<li><p>Use R or SAS-Graph or some other dedicated graphical package to plot some interesting data (preferably in color, possibly in 3D, maybe even in higher than 3D).</p></li>
<li><p>Write an R/SAS routine to do median smoothing by three, and use it on some data.</p></li>
<li><p>Write an R program, or SAS MACRO or SAS PROC or SAS program to produce some EDA output (but don‚Äôt duplicate what PROC UNIVARIATE already does).</p></li>
<li><p>Find an R program in the R library that does interesting EDA; apply it to some interesting data.</p></li>
<li><p>Produce a correlation matrix between many variables, and develop a scatterplot matrix from it.</p></li>
<li><p>Read the literature on graphical data analysis and develop some new graphical techniques. Program your techniques. Apply them to real data.</p></li>
<li><p>Invent a new EDA graphical application, and apply it to real data.</p></li>
</ol>
<p>Additional ideas that aren‚Äôt thoroughly thought out:</p>
<ul>
<li>Data Cleaning Project using Lab Data</li>
<li>Web scraping project</li>
<li>Tidy Tuesday Project</li>
<li>Data Innovation</li>
<li>Recreate a classic visualization</li>
<li>Interactive Project (Rshiny)</li>
<li>Infographic</li>
<li>master‚Äôs thesis / first year project</li>
<li>Misleading Graph</li>
<li>Impossible to Read</li>
<li>Colorblind Friendly</li>
<li>Visualization that only uses X colors</li>
<li>Animated/video</li>
<li>Tutorial</li>
<li>Webscraper data</li>
<li>Digital Humanities Project</li>
<li>reproduce findings from an article in your content area</li>
<li>machine learn!</li>
<li>live dashboard</li>
<li>maps/ geospatial things</li>
<li>lie to me graphic</li>
</ul>
</div>
<div id="documenting-your-project" class="section level4 hasAnchor" number="0.7.2.2">
<h4 class="hasAnchor"><span class="header-section-number">0.7.2.2</span> Documenting Your Project<a href="#documenting-your-project" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You should keep a log describing all EDA projects you undertake. At the end of the course, two things will happen. First, you will give a 10 minute presentation in which you choose one of your EDA projects to describe to the class. Your description should include the goal of the project, the data you used, and a demonstration (PowerPoint, handout, holdup, computer demo, etc.) of the product. 2nd, you will turn in a Portfolio, which consists of two components:</p>
<ol style="list-style-type: decimal">
<li><p>A report describing all your projects. The total number depends on the scope and difficulty of each project (as specified in your contract). There may be projects that you don‚Äôt finish. That‚Äôs fine; EDA projects are hardly ever completely finished; write them up anyway. The projects should be numbered consecutively (i.e., in the order in which you began them), and should include for each project a description of the goal, the product (computer program, hand graph, computer graph, etc.), the data, and some interpretation. Reports must be reproducible and of high quality in terms of writing, grammar, presentation, etc.</p></li>
<li><p>A prototypical example of the product of each project (e.g., a graph, computer code, etc.). You may wish to put computer output into binders or appendices, graphs into report folders, etc.</p></li>
</ol>
<p>Portfolios will not be returned; if you wish to have a copy, make one before you turn it in. Portfolios are due the last week of class. Project reports will not be accepted late. Please, no exceptions!!!</p>
</div>
<div id="more-information-about-contract-grading" class="section level4 hasAnchor" number="0.7.2.3">
<h4 class="hasAnchor"><span class="header-section-number">0.7.2.3</span> More Information about contract grading<a href="#more-information-about-contract-grading" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p><a href="https://marckissel.netlify.app/post/on-the-unessay/" class="uri">https://marckissel.netlify.app/post/on-the-unessay/</a></p></li>
<li><p><a href="https://esclark.hcommons.org/the-unessay/" class="uri">https://esclark.hcommons.org/the-unessay/</a></p></li>
<li><p><a href="https://ryancordell.org/teaching/how-not-to-teach-digital-humanities/" class="uri">https://ryancordell.org/teaching/how-not-to-teach-digital-humanities/</a></p></li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0002_guidelines.Rmd-->
</div>
</div>
</div>
</div>
<div id="part-module-01" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 01<a href="#part-module-01" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-data-science" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Welcome to Data Science<a href="#welcome-to-data-science" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce you to data science. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the module playlist <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYao_7t5ycK4KDXNKaY-ECup">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials" class="section level2 hasAnchor" number="1.1">
<h2 class="hasAnchor"><span class="header-section-number">1.1</span> Module Materials<a href="#module-materials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Videos
<ul>
<li>Located in the subchapters of this module</li>
</ul></li>
<li>Slidedecks
<ul>
<li><a href="https://datascience4psych.github.io/slides/d01_welcome/d01_welcome.html">Welcome Slides</a></li>
<li><a href="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html">Meet the toolkit</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module, including
<ul>
<li><a href="#r_basics">R basics and workflow</a></li>
</ul></li>
<li>R4DS
<ul>
<li><a href="https://r4ds.had.co.nz/introduction.html">Book Introduction</a></li>
<li><a href="https://r4ds.had.co.nz/explore-intro.html">Data exploration Introduction</a></li>
</ul></li>
<li><a href="https://happygitwithr.com/">Happy Git with R</a>
<ul>
<li>If Happy Git is too much, start <a href="#shorthappygit">here</a></li>
<li>If Short Happy Git is too much, start with <a href="https://ohmygit.org/">Oh My Git</a></li>
</ul></li>
</ul></li>
<li>Activities
<ul>
<li><a href="https://github.com/DataScience4Psych/ae01a_unvotes">UN Voting</a></li>
<li><a href="https://github.com/DataScience4Psych/ae01b_covid">Covid Data</a></li>
<li><a href="https://github.com/DataScience4Psych/ae-02-bechdel-rmarkdown">Bechdal Test</a></li>
<li><a href="https://ohmygit.org/">Oh My Git</a></li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab01">Hello R</a></li>
</ul></li>
</ul>
<div id="estimated-video-length" class="section level3 hasAnchor" number="1.1.1">
<h3 class="hasAnchor"><span class="header-section-number">1.1.1</span> Estimated Video Length<a href="#estimated-video-length" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--https://www.youtube.com/playlist?list=PLKrrdtYgOUYao_7t5ycK4KDXNKaY-ECup & https://ytplaylist-len.herokuapp.com/ -->
<p>No of videos : 8</p>
<p>Average length of video: 12 minutes, 6 seconds</p>
<p>Total length of playlist: 1 hour, 36 minutes, 48 seconds</p>
</div>
</div>
</div>
<div id="what-is-data-science" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> What is Data Science?<a href="#what-is-data-science" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/BpKXkkU-NiY" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d01_welcome/d01_welcome.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d01_welcome/d01_welcome.html" width="672" height="400px" data-external="1">
</iframe>
<div id="see-for-yourselves" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> See for yourselves!<a href="#see-for-yourselves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I‚Äôve embedded a few examples below.</p>
<div id="shiny-app" class="section level3 hasAnchor" number="2.1.1">
<h3 class="hasAnchor"><span class="header-section-number">2.1.1</span> Shiny App<a href="#shiny-app" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://minecr.shinyapps.io/unvotes/?showcase=0" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="hans-rosling" class="section level3 hasAnchor" number="2.1.2">
<h3 class="hasAnchor"><span class="header-section-number">2.1.2</span> Hans Rosling<a href="#hans-rosling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The video below is the shorter version. Hans Rosling‚Äôs 200 Countries, 200 Years, 4 Minutes - The Joy of Stats</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/jbkSRLYSojo" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can find a longer talk-length version below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/hVimVzgtD6w" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="social-media" class="section level3 hasAnchor" number="2.1.3">
<h3 class="hasAnchor"><span class="header-section-number">2.1.3</span> Social Media<a href="#social-media" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Social media contains a ton of great (and terrible) examples of data science in action. These examples range from entire subreddits, such as
<a href="https://www.reddit.com/r/dataisbeautiful/">/r/DataisBeautiful</a> (<a href="https://www.reddit.com/r/dataisbeautiful/top/?sort=top&amp;t=all">be sure to check out the highest voted posts</a>) to celebrity tweets about data scientists.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">YASSSSSSSSSS MY LOVE STEVE IS BACK!!! <a href="https://twitter.com/hashtag/KornackiThirstcontinues?src=hash&amp;ref_src=twsrc%5Etfw">#KornackiThirstcontinues</a> <a href="https://t.co/ynK4D87Bhr">pic.twitter.com/ynK4D87Bhr</a></p>&mdash; Leslie Jones ü¶ã (@Lesdoggg) <a href="https://twitter.com/Lesdoggg/status/1346584128368508930?ref_src=twsrc%5Etfw">January 5, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Good reasons to not be a Data Scientist:<br><br>- It is a lot of work<br>- Literally nobody will know what you&#39;re talking about<br>- In the end, your computer will be your only real friend</p>&mdash; Kareem Carr | Data Scientist (@kareem_carr) <a href="https://twitter.com/kareem_carr/status/1352655262054834182?ref_src=twsrc%5Etfw">January 22, 2021</a></blockquote>

</div>
<div id="read-for-yourselves" class="section level3 hasAnchor" number="2.1.4">
<h3 class="hasAnchor"><span class="header-section-number">2.1.4</span> Read for yourselves!<a href="#read-for-yourselves" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- source: https://raw.githubusercontent.com/academic/awesome-datascience/live/README.md -->
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Link</th>
<th>Preview</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://www.oreilly.com/ideas/what-is-data-science">What is Data Science @ O‚Äôreilly</a></td>
<td><em>Data scientists combine entrepreneurship with patience, the willingness to build data products incrementally, the ability to explore, and the ability to iterate over a solution. They are inherently interdiscplinary. They can tackle all aspects of a problem, from initial data collection and data conditioning to drawing conclusions. They can think outside the box to come up with new ways to view the problem, or to work with very broadly defined problems: ‚Äúhere‚Äôs a lot of data, what can you make from it?‚Äù</em></td>
</tr>
<tr class="even">
<td><a href="https://www.quora.com/Data-Science/What-is-data-science">What is Data Science @ Quora</a></td>
<td>Data Science is a combination of a number of aspects of Data such as Technology, Algorithm development, and data interference to study the data, analyze it, and find innovative solutions to difficult problems. Basically Data Science is all about Analyzing data and driving for business growth by finding creative ways.</td>
</tr>
<tr class="odd">
<td><a href="https://hbr.org/2012/10/data-scientist-the-sexiest-job-of-the-21st-century">The sexiest job of 21st century</a></td>
<td><em>Data scientists today are akin to Wall Street ‚Äúquants‚Äù of the 1980s and 1990s. In those days people with backgrounds in physics and math streamed to investment banks and hedge funds, where they could devise entirely new algorithms and data strategies. Then a variety of universities developed master‚Äôs programs in financial engineering, which churned out a second generation of talent that was more accessible to mainstream firms. The pattern was repeated later in the 1990s with search engineers, whose rarefied skills soon came to be taught in computer science programs.</em></td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Data_science">Wikipedia</a></td>
<td><em>Data science is an inter-disciplinary field that uses scientific methods, processes, algorithms and systems to extract knowledge and insights from many structural and unstructured data. Data science is related to data mining, machine learning and big data.</em></td>
</tr>
<tr class="odd">
<td><a href="https://www.mastersindatascience.org/careers/data-scientist/">How to Become a Data Scientist</a></td>
<td><em>Data scientists are big data wranglers, gathering and analyzing large sets of structured and unstructured data. A data scientist‚Äôs role combines computer science, statistics, and mathematics. They analyze, process, and model data then interpret the results to create actionable plans for companies and other organizations.</em></td>
</tr>
<tr class="even">
<td><a href="http://www.forbes.com/sites/gilpress/2013/05/28/a-very-short-history-of-data-science/">a very short history of #datascience</a></td>
<td><em>The story of how data scientists became sexy is mostly the story of the coupling of the mature discipline of statistics with a very young one‚Äìcomputer science. The term ‚ÄúData Science‚Äù has emerged only recently to specifically designate a new profession that is expected to make sense of the vast stores of big data. But making sense of data has a long history and has been discussed by scientists, statisticians, librarians, computer scientists and others for years. The following timeline traces the evolution of the term ‚ÄúData Science‚Äù and its use, attempts to define it, and related terms.</em></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="course-structure-and-some-other-useful-things" class="section level2 hasAnchor" number="2.2">
<h2 class="hasAnchor"><span class="header-section-number">2.2</span> Course structure and some other useful things<a href="#course-structure-and-some-other-useful-things" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/3mz3HNyew-s" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d01_welcome/d01_welcome.html#28">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d01_welcome/d01_welcome.html#28" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="in-class-activity" class="section level2 hasAnchor" number="2.3">
<h2 class="hasAnchor"><span class="header-section-number">2.3</span> In-Class Activity<a href="#in-class-activity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can do either activity. The choice is yours.</p>
<div id="un-votes" class="section level3 hasAnchor" number="2.3.1">
<h3 class="hasAnchor"><span class="header-section-number">2.3.1</span> UN Votes<a href="#un-votes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://datascience4psych.github.io/slides/d01_welcome/d01_welcome.html#25" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the UN activity <a href="https://github.com/DataScience4Psych/ae01a_unvotes">here</a>. The compiled version should look something like the following‚Ä¶</p>
<iframe src="https://datascience4psych.github.io/ae01a_unvotes/unvotes.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="covid-data" class="section level3 hasAnchor" number="2.3.2">
<h3 class="hasAnchor"><span class="header-section-number">2.3.2</span> Covid Data<a href="#covid-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://datascience4psych.github.io/slides/d01_welcome/d01_welcome.html#26" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Covid version of this activity <a href="https://github.com/DataScience4Psych/ae01b_covid">here</a>. The compiled version should look something like the following‚Ä¶</p>
<iframe src="https://datascience4psych.github.io/ae01b_covid/covid.html" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
</div>
<div id="meet-our-toolbox" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> Meet our toolbox!<a href="#meet-our-toolbox" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/SJaQtRLFb-Y" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html">here</a> if they do not appear below. I recommend installing <a href="#install">R, Rstudio</a>, <a href="#installgit">git, and github</a> before starting <a href="#bechdal">activity 02</a></p>
<iframe src="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html" width="672" height="400px" data-external="1">
</iframe>
<div id="r-and-rstudio" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> R and RStudio<a href="#r-and-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="install" class="section level3 hasAnchor" number="3.1.1">
<h3 class="hasAnchor"><span class="header-section-number">3.1.1</span> Install R and RStudio<a href="#install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;https://www.youtube.com/watch?v=kVIZGCT5p9U&quot;</span> <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">embed_url</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">use_align</span>(<span class="st">&quot;center&quot;</span>)</span></code></pre></div>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/kVIZGCT5p9U" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<ul>
<li><p>Install <a href="https://www.r-project.org">R, a free software environment for statistical computing and graphics</a> from <a href="https://cloud.r-project.org">CRAN</a>, the Comprehensive R Archive Network. I <strong>highly recommend</strong> you install a precompiled binary distribution for your operating system ‚Äì use the links up at the top of the CRAN page linked above!</p></li>
<li><p>Install RStudio‚Äôs IDE (stands for <em>integrated development environment</em>), a powerful user interface for R. Get the Open Source Edition of RStudio Desktop.</p>
<ul>
<li>You can run either the <a href="https://www.rstudio.com/products/rstudio/download/preview/">Preview version</a> or the official releases available <a href="https://www.rstudio.com/products/rstudio/#Desktop">here</a>.</li>
<li>RStudio comes with a <strong>text editor</strong>, so there is no immediate need to install a separate stand-alone editor.</li>
<li>RStudio can <strong>interface with Git(Hub)</strong>. However, you must do all the Git(Hub) set up <a href="https://happygitwithr.com">described elsewhere</a> before you can take advantage of this.</li>
</ul></li>
</ul>
<p>If you have a pre-existing installation of R and/or RStudio, I <strong>highly recommend</strong> that you reinstall both and get as current as possible. It can be considerably harder to run old software than new.</p>
<ul>
<li>If you upgrade R, you will need to update any packages you have installed. The command below should get you started, though you may need to specify more arguments if, e.g., you have been using a non-default library for your packages.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update.packages</span>(<span class="at">ask =</span> <span class="cn">FALSE</span>, <span class="at">checkBuilt =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><strong>Note:</strong> this code will only look for updates on <a href="https://cloud.r-project.org">CRAN</a>. So if you use a package that lives <em>only</em> on GitHub or if you want a development version from GitHub, you will need to update manually, e.g.¬†via <code>devtools::install_github()</code>.</p>
</div>
<div id="testing-testing" class="section level3 hasAnchor" number="3.1.2">
<h3 class="hasAnchor"><span class="header-section-number">3.1.2</span> Testing testing<a href="#testing-testing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Do whatever is appropriate for your OS to launch RStudio. You should get a window similar to the screenshot you see <a href="https://www.rstudio.com/wp-content/uploads/2014/04/rstudio-workbench.png">here</a>, but yours will be more boring because you haven‚Äôt written any code or made any figures yet!</p></li>
<li><p>Put your cursor in the pane labeled Console, which is where you interact with the live R process. Create a simple object with code like <code>x &lt;- 3 * 4</code> (followed by enter or return). Then inspect the <code>x</code> object by typing <code>x</code> followed by enter or return. You should see the value 12 print to screen. If yes, you‚Äôve succeeded in installing R and RStudio.</p></li>
</ul>
</div>
<div id="add-on-packages" class="section level3 hasAnchor" number="3.1.3">
<h3 class="hasAnchor"><span class="header-section-number">3.1.3</span> Add-on packages<a href="#add-on-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R is an extensible system and many people share useful code they have developed as a <em>package</em> via <a href="https://cloud.r-project.org">CRAN</a> and GitHub. To install a package from <a href="https://cloud.r-project.org">CRAN</a>, for example the <a href="https://CRAN.R-project.org/package=dplyr">dplyr</a> package for data manipulation, here is one way to do it in the R console (there are others).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>By including <code>dependencies = TRUE</code>, we are being explicit and extra-careful to install any additional packages the target package, dplyr in the example above, needs to have around.</p>
<p>You could use the above method to install the following packages, all of which we will use:</p>
<ul>
<li>tidyr, <a href="https://tidyr.tidyverse.org">package webpage</a></li>
<li>ggplot2, <a href="https://ggplot2.tidyverse.org">package webpage</a></li>
</ul>
</div>
<div id="further-resources" class="section level3 hasAnchor" number="3.1.4">
<h3 class="hasAnchor"><span class="header-section-number">3.1.4</span> Further resources<a href="#further-resources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The above will get your basic setup ready but here are some links if you are interested in reading a bit further.</p>
<ul>
<li><a href="https://support.rstudio.com/hc/en-us">How to Use RStudio</a></li>
<li><a href="https://support.rstudio.com/hc/en-us/articles/200552336-Getting-Help-with-R">RStudio‚Äôs leads for learning R</a></li>
<li><a href="https://cran.r-project.org/faqs.html">R FAQ</a></li>
<li><a href="http://cran.r-project.org/doc/manuals/R-admin.html">R Installation and Administration</a></li>
<li><a href="https://cran.r-project.org/doc/manuals/R-admin.html#Add_002don-packages">More about add-on packages in the R Installation and Administration Manual</a></li>
</ul>
</div>
</div>
</div>
<div id="bechdal" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Bechdel Activity<a href="#bechdal" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<iframe src="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html#24" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Bechdel activity <a href="https://github.com/DataScience4Psych/ae-02-bechdel-rmarkdown">here</a>. The compiled version should look something like the following‚Ä¶</p>
<iframe src="https://datascience4psych.github.io/ae-02-bechdel-rmarkdown/bechdel.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="thoughtful-workflow" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> Thoughtful Workflow<a href="#thoughtful-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>At this point, I recommend you pause and think about your workflow. I give you permission to spend some time and energy sorting this out! It can be as or more important than learning a new R function or package. The experts don‚Äôt talk about this much, because they‚Äôve already got a workflow; it‚Äôs something they do almost without thinking.</p>
<p>Working through subsequent material in R Markdown documents, possibly using Git and GitHub to track and share your progress, is a great idea and will leave you more prepared for your future data analysis projects. Typing individual lines of R code is but a small part of data analysis and it pays off to think holistically about your workflow.</p>
<p>If you want a lot more detail on workflows, you can wander over to the optional bit on <a href="#r_basics">r basics and workflow</a>.</p>
<div id="rmarkdown" class="section level2 hasAnchor" number="5.1">
<h2 class="hasAnchor"><span class="header-section-number">5.1</span> R Markdown<a href="#rmarkdown" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you‚Äôd rather just get on with it, here‚Äôs the abridged version.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/fIhIqTy8PVw" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>But, if you are in the mood to be entertained, start the video from the beginning.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/r5dlYNLIG4E" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html#26" width="672" height="400px" data-external="1">
</iframe>
<!--Original content: https://stat545.com/block007_first-use-rmarkdown.html-->
<p>R Markdown is an accessible way to create computational documents that combine prose and tables and figures produced by R code.</p>
<p>An introductory R Markdown workflow, including how it intersects with Git, GitHub, and RStudio, is now maintained within the Happy Git site:</p>
<p><a href="https://happygitwithr.com/rmd-test-drive.html">Test drive R Markdown</a></p>
</div>
<div id="installgit" class="section level2 hasAnchor" number="5.2">
<h2 class="hasAnchor"><span class="header-section-number">5.2</span> Git and Github<a href="#installgit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure">
<img src="https://imgs.xkcd.com/comics/git.png" alt="" />
<p class="caption">XKCD on Git</p>
</div>
<!-- source https://github.com/uo-ec607/lectures/blob/master/02-git/02-Git.Rmd -->
<p>First, it‚Äôs important to realize that Git and GitHub are distinct things. GitHub is an online hosting platform that provides an array of services built on top of the Git system. (Similar platforms include Bitbucket and GitLab.) Just like we don‚Äôt <em>need</em> Rstudio to run R code, we don‚Äôt <em>need</em> GitHub to use Git‚Ä¶ But, it will make our lives so much easier.</p>
<p>I recommend checking out Jenny Bryan‚Äôs instructions around installation, setup, and early Git usage with her book <a href="https://happygitwithr.com">Happy Git with R</a>. I have a recommended deep dive in a later chapter](#shorthappygit).</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/RIOp8biwBZ4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html#30" width="672" height="400px" data-external="1">
</iframe>
<div id="what-is-github" class="section level3 hasAnchor" number="5.2.1">
<h3 class="hasAnchor"><span class="header-section-number">5.2.1</span> What is Github?<a href="#what-is-github" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/w3jLJU7DT5E" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="git" class="section level3 hasAnchor" number="5.2.2">
<h3 class="hasAnchor"><span class="header-section-number">5.2.2</span> Git<a href="#git" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Git is a <strong>distributed Version Control System (VCS)</strong>. It is a useful tool for easily tracking changes to your code, collaborating, and sharing.</p>
<blockquote>
<p>(Wait, what?)
Okay, try this: Imagine if Dropbox and the ‚ÄúTrack changes‚Äù feature in MS Word had a baby. Git would be that baby.
In fact, it‚Äôs even better than that because Git is optimized for the things that social scientists and data scientists spend a lot of time working on (e.g.¬†code).</p>
</blockquote>
<p>The learning curve is worth it ‚Äì I promise you!</p>
<p>With Git, you can track the changes you make to your project so you always have a record of what you‚Äôve worked on and can easily revert back to an older version if need be. It also makes working with others easier -‚Äî groups of people can work together on the same project and merge their changes into one final source!</p>
<p>GitHub is a way to use the same power of Git all online with an easy-to-use interface. It‚Äôs used across the software world and beyond to collaborate and maintain the history of projects.</p>
<blockquote>
<p>There‚Äôs a high probability that your favorite app, program or package is built using Git-based tools. (RStudio is a case in point.)</p>
</blockquote>
<p>Scientists and academic researchers are starting to use it as well. Benefits of version control and collaboration tools aside, Git(Hub) helps to operationalize the ideals of open science and reproducibility. Journals have increasingly strict requirements regarding reproducibility and data access. GH makes this easy (DOI integration, off-the-shelf licenses, etc.). I run my <a href="https://github.com/R-Computing-Lab">entire lab on GH</a>; this entire course is running on github; these lecture notes are hosted on github‚Ä¶</p>
</div>
</div>
<div id="getting-help-with-r" class="section level2 hasAnchor" number="5.3">
<h2 class="hasAnchor"><span class="header-section-number">5.3</span> Getting Help with R<a href="#getting-help-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html">here</a> if they do not appear below. Check out this helpful post on <a href="https://www.r-project.org/posting-guide.html">asking good R questions‚Ä¶</a></p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/O2wfi7Z0Py4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d02_toolkit/d02_toolkit.html#41" width="672" height="400px" data-external="1">
</iframe>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0101_welcome.Rmd-->
</div>
</div>
<div id="r_basics" class="section level1 hasAnchor" number="6">
<h1 class="hasAnchor"><span class="header-section-number">6</span> R basics and workflows<a href="#r_basics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Who is R? Why is R troubling PhD students?<a href="https://twitter.com/AcademicChatter?ref_src=twsrc%5Etfw">@AcademicChatter</a> <a href="https://twitter.com/hashtag/AcademicTwitter?src=hash&amp;ref_src=twsrc%5Etfw">#AcademicTwitter</a></p>&mdash; Dr. Marie Curie (@CurieDr) <a href="https://twitter.com/CurieDr/status/1355911682585931777?ref_src=twsrc%5Etfw">January 31, 2021</a></blockquote>

<p>There is an implicit contract between computers and scripting languages. The computer will do tedious tasks for you. In return, you must be explicit in your instructions. The computer does not have the ability to extrapolate. So we have to work within the range of what it does understand. And that is where this entire course comes into play. We are learning how to communicate in a way that it does understand. So let‚Äôs begin!</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">The 8 year old is learning Python, and after a dealing with a syntax bug she asks: ‚ÄúIf the computer knows I‚Äôm missing a semicolon here, why won‚Äôt it add it itself?‚Äù<br><br>I don‚Äôt know. I really don‚Äôt know.</p>&mdash; Joe Magerramov (@_joemag_) <a href="https://twitter.com/_joemag_/status/1490899167446589443?ref_src=twsrc%5Etfw">February 8, 2022</a></blockquote>

<div id="basics-of-working-with-r-at-the-command-line-and-rstudio-goodies" class="section level2 hasAnchor" number="6.1">
<h2 class="hasAnchor"><span class="header-section-number">6.1</span> Basics of working with R at the command line and RStudio goodies<a href="#basics-of-working-with-r-at-the-command-line-and-rstudio-goodies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Launch RStudio/R.</p>
<p>Notice the default panes:</p>
<ul>
<li>Console (entire left)</li>
<li>Environment/History (tabbed in upper right)</li>
<li>Files/Plots/Packages/Help (tabbed in lower right)</li>
</ul>
<p>FYI: you can change the default location of the panes, among many other things: <a href="https://support.rstudio.com/hc/en-us/articles/200549016-Customizing-RStudio">Customizing RStudio</a>.</p>
<p>Go into the Console, where we interact with the live R process.</p>
<p>Make an assignment and then inspect the object you just created:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">4</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 12</span></span></code></pre></div>
<p>All R statements where you create objects ‚Äì ‚Äúassignments‚Äù ‚Äì have this form:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>objectName <span class="ot">&lt;-</span> value</span></code></pre></div>
<p>and in my head I hear, e.g., ‚Äúx gets 12‚Äù.</p>
<p>You will make lots of assignments. Even thought, the operator <code>&lt;-</code> is a hassle to type, resist the urge to use <code>=</code>. Technically, it would work. But it will be really confusing later. Instead, try RStudio‚Äôs keyboard shortcut: Alt + - (the minus sign).</p>
<p>Notice that RStudio auto-magically surrounds <code>&lt;-</code> with spaces, which demonstrates a useful code formatting practice. Code is miserable to read on a good day. Give your eyes a break and use spaces.</p>
<p>RStudio offers many handy <a href="https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts">keyboard shortcuts</a>. Also, Alt+Shift+K brings up a keyboard shortcut reference card.</p>
<div id="object-names" class="section level3 hasAnchor" number="6.1.1">
<h3 class="hasAnchor"><span class="header-section-number">6.1.1</span> Object names<a href="#object-names" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Object names cannot start with a digit and cannot contain certain other characters such as a comma or a space. You will be wise to adopt a <a href="https://en.wikipedia.org/wiki/Snake_case">convention for demarcating words</a> in names.</p>
<pre><code>i_use_snake_case
other.people.use.periods
evenOthersUseCamelCase</code></pre>
<p>Make another assignment:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>this_is_a_really_long_name <span class="ot">&lt;-</span> <span class="fl">2.5</span></span></code></pre></div>
<p>To inspect this assignment, try out RStudio‚Äôs completion facility: type the first few characters, press TAB, add characters until you disambiguate, then press return.</p>
<p>Make another assignment:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mason_rocks <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">^</span> <span class="dv">3</span></span></code></pre></div>
<p>Let‚Äôs try to inspect:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>masonrocks</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): object &#39;masonrocks&#39; not found</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>masn_rocks</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): object &#39;masn_rocks&#39; not found</span></span></code></pre></div>
<p>Here‚Äôs where that implicit contract comes in. The computer (and R) will do amazing things, if we can ask it to do those things in a way it understands.
Typos matter. Case matters. Precision matters. We have to work within it‚Äôs narrow range of ability. The computer isn‚Äôt accommodating, unfortunately.</p>
<p>However, if you struggle with precise typing, it might be worth your time to teach your computer to be accommodating. And as a result, you might discover that you have a real knack for programming‚Ä¶ and that knack will lead you toward quantitative psychology‚Ä¶ and teaching data science for psychologists‚Ä¶</p>
<p>In other words, <a href="https://github.com/smasongarrison/AutoHotKey_Scripts">I have some typing macros</a> and tricks that may help you. If there‚Äôs interest, I can carve out some time in-class to discuss them.</p>
</div>
<div id="functions" class="section level3 hasAnchor" number="6.1.2">
<h3 class="hasAnchor"><span class="header-section-number">6.1.2</span> Functions<a href="#functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R has a mind-blowing collection of built-in functions that are accessed like so:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">functionName</span>(<span class="at">arg1 =</span> val1, <span class="at">arg2 =</span> val2, and so on)</span></code></pre></div>
<p>Let‚Äôs try using <code>seq()</code> which makes regular sequences of numbers and, while we‚Äôre at it, demo more helpful features of RStudio.</p>
<p>Type <code>se</code> and hit TAB. A pop up shows you possible completions. Specify <code>seq()</code> by typing more to disambiguate or using the up/down arrows to select. Notice the floating tool-tip-type help that pops up, reminding you of a function‚Äôs arguments. If you want even more help, press F1 as directed to get the full documentation in the help tab of the lower right pane. Now open the parentheses and notice the automatic addition of the closing parenthesis and the placement of cursor in the middle. Type the arguments <code>1, 10</code> and hit return. RStudio also exits the parenthetical expression for you. IDEs are great.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span></code></pre></div>
<p>The above also demonstrates something about how R resolves function arguments. You can always specify in <code>name = value</code> form. But if you do not, R attempts to resolve by position. So above, it is assumed that we want a sequence <code>from = 1</code> that goes <code>to = 10</code>. Because we didn‚Äôt specify step size, the default value of <code>by</code> in the function definition is used. In this case, the default is 1. For functions I call often, I might use this resolve by position for the first argument or maybe the first two. After that, I always use <code>name = value</code>.</p>
<p>Make this assignment and notice similar help with quotation marks.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>yo <span class="ot">&lt;-</span> <span class="st">&quot;hello world&quot;</span></span></code></pre></div>
<p>If you just make an assignment, you don‚Äôt get to see the value. Then you‚Äôre tempted to immediately inspect.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span></code></pre></div>
<p>This common action can be shortened by surrounding the assignment with parentheses. These combined action causes assignment and ‚Äúprint to screen‚Äù to happen.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span></code></pre></div>
<p>Not all functions have (or require) arguments:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Tue Dec 27 09:53:32 2022&quot;</span></span></code></pre></div>
<p>Now look at your workspace ‚Äì in the upper right pane. The workspace is where user-defined objects accumulate. You can also get a listing of these objects with commands:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;check_quietly&quot;              &quot;ds4p_urls&quot;                 </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3] &quot;install_quietly&quot;            &quot;mason_rocks&quot;               </span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;pretty_install&quot;             &quot;sample_no_surprises&quot;       </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;shhh_check&quot;                 &quot;slide_url&quot;                 </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;this_is_a_really_long_name&quot; &quot;x&quot;                         </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11] &quot;y&quot;                          &quot;yo&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;check_quietly&quot;              &quot;ds4p_urls&quot;                 </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3] &quot;install_quietly&quot;            &quot;mason_rocks&quot;               </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;pretty_install&quot;             &quot;sample_no_surprises&quot;       </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;shhh_check&quot;                 &quot;slide_url&quot;                 </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;this_is_a_really_long_name&quot; &quot;x&quot;                         </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11] &quot;y&quot;                          &quot;yo&quot;</span></span></code></pre></div>
<p>If you want to remove the object named <code>y</code>, you can do this:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(y)</span></code></pre></div>
<p>To remove everything:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>or click the broom in RStudio‚Äôs Environment pane.</p>
</div>
</div>
<div id="workspace-and-working-directory" class="section level2 hasAnchor" number="6.2">
<h2 class="hasAnchor"><span class="header-section-number">6.2</span> Workspace and working directory<a href="#workspace-and-working-directory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One day you will need to quit R, go do something else and return to your analysis later.</p>
<p>One day you will have multiple analyses going that use R and you want to keep them separate.</p>
<p>One day you will need to bring data from the outside world into R and send numerical results and figures from R back out into the world.</p>
<p>To handle these real life situations, you need to make two decisions:</p>
<ul>
<li>What about your analysis is ‚Äúreal‚Äù, i.e.¬†will you save it as your lasting record of what happened?</li>
<li>Where does your analysis ‚Äúlive‚Äù?</li>
</ul>
<div id="workspace-.rdata" class="section level3 hasAnchor" number="6.2.1">
<h3 class="hasAnchor"><span class="header-section-number">6.2.1</span> Workspace, <code>.RData</code><a href="#workspace-.rdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">A lot of grad school so far has been fighting with R. R-guing, if you will</p>&mdash; Valerie Polad (@valeriepolad) <a href="https://twitter.com/valeriepolad/status/1448857970046087192?ref_src=twsrc%5Etfw">October 15, 2021</a></blockquote>

<p>As a beginning R user, it‚Äôs OK to consider your workspace ‚Äúreal‚Äù. <em>Very soon</em>, I urge you to evolve to the next level, where you consider your saved R scripts as ‚Äúreal‚Äù. (In either case, of course the input data is very much real and requires preservation!) With the input data and the R code you used, you can reproduce
<em>everything</em>. You can make your analysis fancier. You can get to the bottom of puzzling results and discover and fix bugs in your code. You can reuse the code to conduct similar analyses in new projects. You can remake a figure with different aspect ratio or save is as TIFF instead of PDF. You are ready to take questions. You are ready for the future.</p>
<p>If you regard your workspace as ‚Äúreal‚Äù (saving and reloading all the time), if you need to redo analysis ‚Ä¶ you‚Äôre going to either redo a lot of typing (making mistakes all the way) or will have to mine your R history for the commands you used. Rather than <a href="https://support.rstudio.com/hc/en-us/articles/200526217-Command-History">becoming an expert on managing the R history</a>, a better use of your time and energy is to keep your ‚Äúgood‚Äù R code in a script for future reuse.</p>
<p>Because it can be useful sometimes, note the commands you‚Äôve recently run appear in the History pane.</p>
<p>But you don‚Äôt have to choose right now and the two strategies are not incompatible. Let‚Äôs demo the save / reload the workspace approach.</p>
<p>Upon quitting R, you have to decide if you want to save your workspace, for potential restoration the next time you launch R. Depending on your set up, R or your IDE, e.g.¬†RStudio, will probably prompt you to make this decision.</p>
<p>Quit R/RStudio, either from the menu, using a keyboard shortcut, or by typing <code>q()</code> in the Console. You‚Äôll get a prompt like this:</p>
<blockquote>
<p>Save workspace image to ~/.Rdata?</p>
</blockquote>
<p><em>Note where the workspace image is to be saved</em> and then click ‚ÄúSave‚Äù.</p>
<p>Using your favorite method, visit the directory where image was saved and verify there is a file named <code>.RData</code>. You will also see a file <code>.Rhistory</code>, holding the commands submitted in your recent session.</p>
<p>Restart RStudio. In the Console you will see a line like this:</p>
<pre><code>[Workspace loaded from ~/.RData]</code></pre>
<p>indicating that your workspace has been restored. Look in the Workspace pane and you‚Äôll see the same objects as before. In the History tab of the same pane, you should also see your command history. You‚Äôre back in business. This way of starting and stopping analytical work will not serve you well for long but it‚Äôs a start.</p>
</div>
<div id="working-directory" class="section level3 hasAnchor" number="6.2.2">
<h3 class="hasAnchor"><span class="header-section-number">6.2.2</span> Working directory<a href="#working-directory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Any process running on your computer has a notion of its ‚Äúworking directory‚Äù. In R, this is where R will look, by default, for files you ask it to load. It also where, by default, any files you write to disk will go. Chances are your current working directory is the directory we inspected above, i.e.¬†the one where RStudio wanted to save the workspace.</p>
<p>You can explicitly check your working directory with:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<p>It is also displayed at the top of the RStudio console.</p>
<p>As a beginning R user, it‚Äôs OK let your home directory or any other weird directory on your computer be R‚Äôs working directory. <em>Very soon</em>, I urge you to evolve to the next level, where you organize your projects into directories and, when working on project A, set R‚Äôs working directory to the associated directory.</p>
<p><strong>Although I do not recommend it</strong>, in case you‚Äôre curious, you can set R‚Äôs working directory at the command line like so:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/myCoolProject&quot;</span>)</span></code></pre></div>
<p><strong>Although I do not recommend it</strong>, you can also use RStudio‚Äôs Files pane to navigate to a directory and then set it as working directory from the menu: <em>Session &gt; Set Working Directory &gt; To Files Pane Location</em>. (You‚Äôll see even more options there). Or within the Files pane, choose ‚ÄúMore‚Äù and ‚ÄúSet As Working Directory‚Äù.</p>
<p>But there‚Äôs a better way. A way that also puts you on the path to managing your R work like an expert.</p>
</div>
</div>
<div id="rprojs" class="section level2 hasAnchor" number="6.3">
<h2 class="hasAnchor"><span class="header-section-number">6.3</span> RStudio projects<a href="#rprojs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Keeping all the files associated with a project organized together ‚Äì input data, R scripts, results, figures ‚Äì is such a wise and common practice that RStudio has built-in support for this via its <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects"><em>projects</em></a>.</p>
<p>Let‚Äôs make one to use for the rest of this class. Do this: <em>File &gt; New Project‚Ä¶</em>. The directory name you choose here will be the project name. Call it whatever you want (or follow me for convenience).</p>
<p>I created a directory and, therefore RStudio project, called <code>swc</code> in my <code>tmp</code> directory, FYI.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/tmp/swc&quot;</span>)</span></code></pre></div>
<p>Now check that the ‚Äúhome‚Äù directory for your project is the working directory of our current R process:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<p><em>I can‚Äôt print my output here because this document itself does not reside in the RStudio Project we just created.</em></p>
<p>Let‚Äôs enter a few commands in the Console, as if we are just beginning a project:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>sig_sq <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">40</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(sig_sq))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>(avg_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.467</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(avg_x, <span class="st">&quot;avg_x.txt&quot;</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(a, b, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span></code></pre></div>
<p><img src="0102_rbasics_files/figure-html/toy-line-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.print</span>(pdf, <span class="st">&quot;toy_line_plot.pdf&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   2</span></span></code></pre></div>
<p>Let‚Äôs say this is a good start of an analysis and your ready to start preserving the logic and code. Visit the History tab of the upper right pane. Select these commands. Click ‚ÄúTo Source‚Äù. Now you have a new pane containing a nascent R script. Click on the floppy disk to save. Give it a name ending in <code>.R</code> or <code>.r</code>, I used <code>toy-line.r</code> and note that, by default, it will go in the directory associated with your project.</p>
<p>Quit RStudio. Inspect the folder associated with your project if you wish. Maybe view the PDF in an external viewer.</p>
<p>Restart RStudio. Notice that things, by default, restore to where we were earlier, e.g.¬†objects in the workspace, the command history, which files are open for editing, where we are in the file system browser, the working directory for the R process, etc. These are all Good Things.</p>
<p>Change some things about your code. Top priority would be to set a sample size <code>n</code> at the top, e.g.¬†<code>n &lt;- 40</code>, and then replace all the hard-wired 40s with <code>n</code>. Change some other minor-but-detectable stuff, e.g.¬†alter the sample size <code>n</code>, the slope of the line <code>b</code>,the color of the line ‚Ä¶ whatever. Practice the different ways to re-run the code:</p>
<ul>
<li><p>Walk through line by line by keyboard shortcut (Command+Enter) or mouse (click ‚ÄúRun‚Äù in the upper right corner of editor pane).</p></li>
<li><p>Source the entire document ‚Äì equivalent to entering <code>source('toy-line.r')</code> in the Console ‚Äì by keyboard shortcut (Shift+Command+S) or mouse (click ‚ÄúSource‚Äù in the upper right corner of editor pane or select from the mini-menu accessible from the associated down triangle).</p></li>
<li><p>Source with echo from the Source mini-menu.</p></li>
</ul>
<p>Visit your figure in an external viewer to verify that the PDF is changing as you expect.</p>
<p>In your favorite OS-specific way, search your files for <code>toy_line_plot.pdf</code> and presumably you will find the PDF itself (no surprise) but <em>also the script that created it (<code>toy-line.r</code>)</em>. This latter phenomenon is a huge win. One day you will want to remake a figure or just simply understand where it came from. If you rigorously save figures to file <strong>with R code and not ever ever ever the mouse or the clipboard</strong>, you will sing my praises one day. Trust me.</p>
</div>
<div id="tradition" class="section level2 hasAnchor" number="6.4">
<h2 class="hasAnchor"><span class="header-section-number">6.4</span> Tradition<a href="#tradition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/gRdfX7ut8gw" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>It is traditional to save R scripts with a <code>.R</code> or <code>.r</code> suffix. Follow this convention unless you have some extraordinary reason not to.</p>
<p>Comments start with one or more <code>#</code> symbols. Use them. RStudio helps you (de)comment selected lines with Ctrl+Shift+C (Windows and Linux) or Command+Shift+C (Mac).</p>
<p>Clean out the workspace, i.e.¬†pretend like you‚Äôve just revisited this project after a long absence. The broom icon or <code>rm(list = ls())</code>. Good idea to do this, restart R (available from the Session menu), re-run your analysis to truly check that the code you‚Äôre saving is complete and correct (or at least rule out obvious problems!).</p>
<p>This workflow will serve you well in the future:</p>
<ul>
<li>Create an RStudio project for an analytical project</li>
<li>Keep inputs there (we‚Äôll soon talk about importing)</li>
<li>Keep scripts there; edit them, run them in bits or as a whole from there</li>
<li>Keep outputs there (like the PDF written above)</li>
</ul>
<p>Avoid using the mouse for pieces of your analytical workflow, such as loading a dataset or saving a figure. Terribly important for reproducibility and for making it possible to retrospectively determine how a numerical table or PDF was actually produced (searching on local disk on filename, among <code>.R</code> files, will lead to the relevant script).</p>
<p>Many long-time users never save the workspace, never save <code>.RData</code> files (I‚Äôm one of them), never save or consult the history. Once you get to that point, there are options available in RStudio to deactivate the loading of <code>.RData</code> and permanently suppress the prompt on exit to save the workspace (go to <em>Tools &gt; Options &gt; General</em>).</p>
<p>For the record, when loading data into R or writing outputs to file, you can always specify the absolute path and thereby insulate yourself from the current working directory. This method is rarely necessary when using RStudio projects, and can be challenging for collaborators.</p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0102_rbasics.Rmd-->
</div>
</div>
<div id="shorthappygit" class="section level1 hasAnchor" number="7">
<h1 class="hasAnchor"><span class="header-section-number">7</span> RDD: Getting Started with Github<a href="#shorthappygit" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section is an adapted fusion of GitHub Classroom‚Äôs github-starter-course and Jenny Bryan‚Äôs <a href="https://happygitwithr.com/">happygitwithr</a>. I encourage you to check out the unabridged version of happygit as it has so much more detail.</p>
<pre><code>## ‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2 ‚îÄ‚îÄ
## ‚úî ggplot2 3.4.0      ‚úî purrr   1.0.0 
## ‚úî tibble  3.1.8      ‚úî dplyr   1.0.10
## ‚úî tidyr   1.2.1      ‚úî stringr 1.5.0 
## ‚úî readr   2.1.3      ‚úî forcats 0.5.2 
## ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
## ‚úñ dplyr::filter() masks stats::filter()
## ‚úñ dplyr::lag()    masks stats::lag()</code></pre>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Following along with <a href="https://twitter.com/SMasonGarrison?ref_src=twsrc%5Etfw">@SMasonGarrison</a>&#39;s open source data science for psychologists course has helped me finally understand <a href="https://twitter.com/github?ref_src=twsrc%5Etfw">@github</a> which has improved my work and my life so much üò≠üéâ</p>&mdash; Jen Traver (@jmtraver1) <a href="https://twitter.com/jmtraver1/status/1449752767510220807?ref_src=twsrc%5Etfw">October 17, 2021</a></blockquote>

<div id="the-basics-of-github" class="section level2 hasAnchor" number="7.1">
<h2 class="hasAnchor"><span class="header-section-number">7.1</span> The Basics of GitHub<a href="#the-basics-of-github" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The goal of this course is to give you a brief introduction to GitHub. We‚Äôll also provide you with materials for further learning and a few ideas to get you started on our platform. üöÄ</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">I just got a recruiter message as a comment on a Github commit... now that&#39;s a first. <a href="https://t.co/ON9yBzs9xt">pic.twitter.com/ON9yBzs9xt</a></p>&mdash; Dylan Garcia (@_dylanga) <a href="https://twitter.com/_dylanga/status/1492249604611522566?ref_src=twsrc%5Etfw">February 11, 2022</a></blockquote>

</div>
<div id="octocat-git-and-github" class="section level2 hasAnchor" number="7.2">
<h2 class="hasAnchor"><span class="header-section-number">7.2</span> :octocat: Git and GitHub<a href="#octocat-git-and-github" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Git is a <strong>distributed Version Control System (VCS)</strong>, which means it is a useful tool for easily tracking changes to your code, collaborating, and sharing. With Git you can track the changes you make to your project so you always have a record of what you‚Äôve worked on and can easily revert back to an older version if need be. It also makes working with others easier‚Äîgroups of people can work together on the same project and merge their changes into one final source!</p>
<p>GitHub is a way to use the same power of Git all online with an easy-to-use interface. It‚Äôs used across the software world and beyond to collaborate and maintain the history of projects.</p>
<p>GitHub is home to some of the most advanced technologies in the world. Whether you‚Äôre visualizing data or building a new game, there‚Äôs a whole community and set of tools on GitHub that can get you to the next step. This course starts with the basics of GitHub, but we‚Äôll dig into the rest later.</p>
</div>
<div id="octocat-understanding-the-github-flow" class="section level2 hasAnchor" number="7.3">
<h2 class="hasAnchor"><span class="header-section-number">7.3</span> :octocat: Understanding the GitHub flow<a href="#octocat-understanding-the-github-flow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The GitHub flow is a lightweight workflow that allows you to experiment and collaborate on your projects easily, without the risk of losing your previous work.</p>
<div id="repositories" class="section level3 hasAnchor" number="7.3.1">
<h3 class="hasAnchor"><span class="header-section-number">7.3.1</span> Repositories<a href="#repositories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A repository is where your project work happens‚Äìthink of it as your project folder. It contains all of your project‚Äôs files and revision history. You can work within a repository alone or invite others to collaborate with you on those files.</p>
</div>
<div id="cloning" class="section level3 hasAnchor" number="7.3.2">
<h3 class="hasAnchor"><span class="header-section-number">7.3.2</span> Cloning<a href="#cloning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When a repository is created with GitHub, it‚Äôs stored remotely in the ‚òÅÔ∏è. You can clone a repository to create a local copy on your computer and then use Git to sync the two. This makes it easier to fix issues, add or remove files, and push larger commits. You can also use the editing tool of your choice as opposed to the GitHub UI. Cloning a repository also pulls down all the repository data that GitHub has at that point in time, including all versions of every file and folder for the project! This can be helpful if you experiment with your project and then realize you liked a previous version more. To learn more about cloning, read <a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository">‚ÄúCloning a Repository‚Äù</a>.</p>
</div>
<div id="committing-and-pushing" class="section level3 hasAnchor" number="7.3.3">
<h3 class="hasAnchor"><span class="header-section-number">7.3.3</span> Committing and pushing<a href="#committing-and-pushing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Committing</strong> and <strong>pushing</strong> are how you can add the changes you made on your local machine to the remote repository in GitHub. That way your instructor and/or teammates can see your latest work when you‚Äôre ready to share it. You can make a commit when you have made changes to your project that you want to ‚Äúcheckpoint.‚Äù You can also add a helpful <strong>commit message</strong> to remind yourself or your teammates what work you did (e.g.¬†‚ÄúAdded a README with information about our project‚Äù).</p>
<p>Once you have a commit or multiple commits that you‚Äôre ready to add to your repository, you can use the push command to add those changes to your remote repository. Committing and pushing may feel new at first, but we promise you‚Äôll get used to it üôÇ</p>
</div>
</div>
<div id="github-terms-to-know" class="section level2 hasAnchor" number="7.4">
<h2 class="hasAnchor"><span class="header-section-number">7.4</span> üíª GitHub terms to know<a href="#github-terms-to-know" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="repositories-1" class="section level3 hasAnchor" number="7.4.1">
<h3 class="hasAnchor"><span class="header-section-number">7.4.1</span> Repositories<a href="#repositories-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We mentioned repositories already, they are where your project work happens, but let‚Äôs talk a bit more about the details of them! As you work more on GitHub you will have many repositories which may feel confusing at first. Fortunately, your <a href="https://docs.github.com/en/github/setting-up-and-managing-your-github-user-account/about-your-personal-dashboard">‚ÄúGitHub dashboard‚Äù</a> helps to easily navigate to your repositories and see useful information about them. Make sure you‚Äôre logged in to see it!</p>
<p>Repositories also contain <strong>README</strong>s. You can add a README file to your repository to tell other people why your project is useful, what they can do with your project, and how they can use it. We are using this README to communicate how to learn Git and GitHub with you. üòÑ</p>
<p>To learn more about repositories read <a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/about-repositories">‚ÄúCreating, Cloning, and Archiving Repositories</a> and <a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/about-readmes">‚ÄúAbout README‚Äôs‚Äù</a>.</p>
</div>
<div id="branches" class="section level3 hasAnchor" number="7.4.2">
<h3 class="hasAnchor"><span class="header-section-number">7.4.2</span> Branches<a href="#branches" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can use branches on GitHub to isolate work that you do not want merged into your final project just yet. Branches allow you to develop features, fix bugs, or safely experiment with new ideas in a contained area of your repository. Typically, you might create a new branch from the default branch of your repository‚Äîmain. This makes a new working copy of your repository for you to experiment with. Once your new changes have been reviewed by a teammate, or you are satisfied with them, you can merge your changes into the default branch of your repository.</p>
<p>To learn more about branching, read <a href="https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/about-branches">‚ÄúAbout Branches‚Äù</a>.</p>
</div>
<div id="forks" class="section level3 hasAnchor" number="7.4.3">
<h3 class="hasAnchor"><span class="header-section-number">7.4.3</span> Forks<a href="#forks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A fork is another way to copy a repository, but is usually used when you want to contribute to someone else‚Äôs project. Forking a repository allows you to freely experiment with changes without affecting the original project and is very popular when contributing to open source software projects!</p>
<p>To learn more about forking, read <a href="https://docs.github.com/en/github/getting-started-with-github/fork-a-repo">‚ÄúFork a repo‚Äù</a></p>
</div>
<div id="pull-requests" class="section level3 hasAnchor" number="7.4.4">
<h3 class="hasAnchor"><span class="header-section-number">7.4.4</span> Pull requests<a href="#pull-requests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When working with branches, you can use a pull request to tell others about the changes you want to make and ask for their feedback. Once a pull request is opened, you can discuss and review the potential changes with collaborators and add more changes if need be. You can add specific people as reviewers of your pull request which shows you want their feedback on your changes! Once a pull request is ready-to-go, it can be merged into your main branch.</p>
<p>To learn more about pull requests, read <a href="https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests">‚ÄúAbout Pull Requests‚Äù</a>.</p>
</div>
<div id="issues" class="section level3 hasAnchor" number="7.4.5">
<h3 class="hasAnchor"><span class="header-section-number">7.4.5</span> Issues<a href="#issues" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Issues are a way to track enhancements, tasks, or bugs for your work on GitHub. Issues are a great way to keep track of all the tasks you want to work on for your project and let others know what you plan to work on. You can also use issues to tell a favorite open source project about a bug you found or a feature you think would be great to add!</p>
<p>For larger projects, you can keep track of many issues on a project board. GitHub Projects help you organize and prioritize your work and you can read more about them <a href="https://docs.github.com/en/github/managing-your-work-on-github/about-project-boards">in this ‚ÄúAbout Project boards document</a>. You likely won‚Äôt need a project board for your assignments, but once you move on to even bigger projects, they‚Äôre a great way to organize your team‚Äôs work! You can also link together pull requests and issues to show that a fix is in progress and to automatically close the issue when someone merges the pull request.</p>
<p>To learn more about issues and linking them to your pull requests, read <a href="https://docs.github.com/en/github/managing-your-work-on-github/about-issues">‚ÄúAbout Issues‚Äù</a>.</p>
</div>
<div id="your-user-profile" class="section level3 hasAnchor" number="7.4.6">
<h3 class="hasAnchor"><span class="header-section-number">7.4.6</span> Your user profile<a href="#your-user-profile" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your profile page tells people the story of your work through the repositories you‚Äôre interested in, the contributions you‚Äôve made, and the conversations you‚Äôve had. You can also give the world a unique view into who you are with your profile README. You can use your profile to let future employers know all about you!</p>
<p>To learn more about your user profile and adding and updating your profile README, read <a href="https://docs.github.com/en/github/setting-up-and-managing-your-github-profile/managing-your-profile-readme">‚ÄúManaging Your Profile README‚Äù</a>.</p>
</div>
<div id="using-markdown-on-github" class="section level3 hasAnchor" number="7.4.7">
<h3 class="hasAnchor"><span class="header-section-number">7.4.7</span> Using markdown on GitHub<a href="#using-markdown-on-github" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You might have noticed already, but you can add some fun styling to your issues, pull requests, and files. <a href="https://guides.github.com/features/mastering-markdown/">‚ÄúMarkdown‚Äù</a> is an easy way to style your issues, pull requests, and files with some simple syntax. This can be helpful to organize your information and make it easier for others to read. You can also drop in gifs and images to help convey your point!</p>
<p>To learn more about using GitHub‚Äôs flavor of markdown, read <a href="https://docs.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax">‚ÄúBasic Writing and Formatting Syntax‚Äù</a>.</p>
</div>
<div id="engaging-with-the-github-community" class="section level3 hasAnchor" number="7.4.8">
<h3 class="hasAnchor"><span class="header-section-number">7.4.8</span> Engaging with the GitHub community<a href="#engaging-with-the-github-community" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The GitHub community is vast. There are many types of people who use GitHub in their day to day‚Äîstudents like you, professional developers, hobbyists working on open source projects, and explorers who are just jumping into the world of software development on their own. There are many ways you can interact with the larger GitHub community, but here are three places where you can start.</p>
<div id="starring-repositories" class="section level4 hasAnchor" number="7.4.8.1">
<h4 class="hasAnchor"><span class="header-section-number">7.4.8.1</span> Starring repositories<a href="#starring-repositories" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you find a repository interesting or you want to keep track of it, star it! When you star a repository it‚Äôs also used as a signal to surface better recommendations on github.com/explore. If you‚Äôd like to get back to your starred repositories you can do so via your user profile.</p>
<p>To learn more about starring repositories, read <a href="https://docs.github.com/en/github/getting-started-with-github/saving-repositories-with-stars">‚ÄúSaving Repositories with Stars‚Äù</a>.</p>
</div>
<div id="following-users" class="section level4 hasAnchor" number="7.4.8.2">
<h4 class="hasAnchor"><span class="header-section-number">7.4.8.2</span> Following users<a href="#following-users" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can follow people on GitHub to receive notifications about their activity and discover projects in their communities. When you follow a user, their public GitHub activity will show up on your dashboard so you can see all the cool things they are working on.</p>
<p>To learn more about following users, read <a href="https://docs.github.com/en/github/getting-started-with-github/following-people">‚ÄúFollowing People‚Äù</a>.</p>
</div>
<div id="browsing-github-explore" class="section level4 hasAnchor" number="7.4.8.3">
<h4 class="hasAnchor"><span class="header-section-number">7.4.8.3</span> Browsing GitHub Explore<a href="#browsing-github-explore" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GitHub Explore is a great place to do just that ‚Ä¶ explore :smile: You can find new projects, events, and developers to interact with. You can check out the GitHub Explore website <a href="https://github.com/explore">at github.com/explore</a>. The more you intereact with GitHub the more tailored your Explore view will be.</p>
</div>
</div>
</div>
<div id="install-intro" class="section level2 hasAnchor" number="7.5">
<h2 class="hasAnchor"><span class="header-section-number">7.5</span> Half the battle<a href="#install-intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Getting all the necessary software installed, configured, and playing nicely together is honestly half the battle when first adopting Git. Brace yourself for some pain. The upside is that you can give yourself a pat on the back once you get through this. And you WILL get through this.</p>
<p>You will find far more resources for how to <em>use Git</em> than for installation and configuration. Why? The experts ‚Ä¶</p>
<ul>
<li>Have been doing this for years. It‚Äôs simply not hard for them anymore.</li>
<li>Probably use some flavor of Unix. They may secretly (or not so secretly) take pride in neither using nor knowing Windows.</li>
<li>Get more satisfaction and reward for thinking and writing about Git concepts and workflows than Git installation.</li>
</ul>
<p>In their defense, it‚Äôs hard to write installation instructions. Failures can be specific to an individual OS or even individual computer.</p>
</div>
<div id="github-acct" class="section level2 hasAnchor" number="7.6">
<h2 class="hasAnchor"><span class="header-section-number">7.6</span> Register a GitHub account<a href="#github-acct" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Register an account with GitHub. It‚Äôs free!</p>
<ul>
<li><a href="https://github.com" class="uri">https://github.com</a></li>
</ul>
<div id="username-advice" class="section level3 hasAnchor" number="7.6.1">
<h3 class="hasAnchor"><span class="header-section-number">7.6.1</span> Username advice<a href="#username-advice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You will be able to upgrade to a paid level of service, apply discounts, join organizations, etc. in the future, so don‚Äôt fret about any of that now. <strong>Except your username. You might want to give that some thought.</strong></p>
<p>A few tips, which sadly tend to contradict each other:</p>
<ul>
<li>Incorporate your actual name! People like to know who they‚Äôre dealing with. Also makes your username easier for people to guess or remember.</li>
<li>Reuse your username from other contexts, e.g., Twitter or Slack. But, of course, someone with no GitHub activity will probably be squatting on that.</li>
<li>Pick a username you will be comfortable revealing to your future boss.</li>
<li>Shorter is better than longer.</li>
<li>Be as unique as possible in as few characters as possible. In some settings GitHub auto-completes or suggests usernames.</li>
<li>Make it timeless. Don‚Äôt highlight your current university, employer, or place of residence, e.g.¬†JennyFromTheBlock.</li>
<li>Avoid words laden with special meaning in programming. In Jenny‚Äôs first inept efforts to script around the GitHub API, she assigned lots of issues to <a href="https://github.com/na">the guy with username <code>NA</code></a> because my vector of GitHub usernames contained missing values. A variant of <a href="https://xkcd.com/327/">Little Bobby Tables</a>.</li>
<li>Avoid the use of upper vs.¬†lower case to separate words. We highly recommend all lowercase. GitHub treats usernames in a case insensitive way, but using all lowercase is kinder to people doing downstream regular expression work with usernames, in various languages. A better strategy for word separation is to use a hyphen <code>-</code> or underscore <code>_</code>.</li>
</ul>
<p>You can change your username later, but better to get this right the first time.</p>
<ul>
<li><a href="https://help.github.com/articles/changing-your-github-username/" class="uri">https://help.github.com/articles/changing-your-github-username/</a></li>
<li><a href="https://help.github.com/articles/what-happens-when-i-change-my-username/" class="uri">https://help.github.com/articles/what-happens-when-i-change-my-username/</a></li>
</ul>
</div>
<div id="free-private-repos" class="section level3 hasAnchor" number="7.6.2">
<h3 class="hasAnchor"><span class="header-section-number">7.6.2</span> Free private repos<a href="#free-private-repos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>GitHub offers free unlimited private repositories for all users. These free private repositories support up to three external collaborators, making them a perfect place for your personal projects, for job applications, and testing things out before making your project open source.</p>
<p>Go ahead and register your free account NOW and then pursue any special offer that applies to you:</p>
<ul>
<li><p>Students, faculty, and educational/research staff: <a href="https://education.github.com">GitHub Education</a>.</p></li>
<li><p>GitHub ‚ÄúOrganizations‚Äù can be extremely useful for courses or research/lab groups,</p>
<ul>
<li>where you need some coordination across a set of repos and users.</li>
</ul></li>
<li><p>Official nonprofit organizations and charities: <a href="https://github.com/nonprofit">GitHub for Good</a></p></li>
</ul>
</div>
</div>
<div id="install_git" class="section level2 hasAnchor" number="7.7">
<h2 class="hasAnchor"><span class="header-section-number">7.7</span> Install Git<a href="#install_git" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You need Git, so you can use it at the command line and so RStudio can call it.</p>
<p>If there‚Äôs any chance it‚Äôs installed already, verify that, rejoice, and skip this step.</p>
<p>Otherwise, find installation instructions below for your operating system.</p>
<div id="git-already-installed" class="section level3 hasAnchor" number="7.7.1">
<h3 class="hasAnchor"><span class="header-section-number">7.7.1</span> Git already installed?<a href="#git-already-installed" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Go to the shell (<a href="https://happygitwithr.com/shell.html">More info on shell from Jenny Bryan</a>). Enter <code>which git</code> to request the path to your Git executable:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> git</span></code></pre></div>
<p>and <code>git --version</code> to see its version:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">--version</span></span></code></pre></div>
<p>If you are successful, that‚Äôs great! You have Git already. No need to install! Move on.</p>
<p>If, instead, you see something more like <code>git: command not found</code>, keep reading.</p>
<p>macOS users might get an immediate offer to install command line developer tools. Yes, you should accept! Click ‚ÄúInstall‚Äù and read more below.</p>
</div>
</div>
<div id="install-git-windows" class="section level2 hasAnchor" number="7.8">
<h2 class="hasAnchor"><span class="header-section-number">7.8</span> Windows<a href="#install-git-windows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Option 1</strong> (<em>highly recommended</em>): Install <a href="https://git-for-windows.github.io/">Git for Windows</a>, also known as <code>msysgit</code> or ‚ÄúGit Bash‚Äù, to get Git in addition to some other useful tools, such as the Bash shell. Yes, all those names are totally confusing, but you might encounter them elsewhere and I want you to be well-informed.</p>
<p>We like this because Git for Windows leaves the Git executable in a conventional location, which will help you and other programs, e.g.¬†RStudio, find it and use it. This also supports a transition to more expert use, because the ‚ÄúGit Bash‚Äù shell will be useful as you venture outside of R/RStudio.</p>
<ul>
<li><strong>NOTE:</strong> When asked about ‚ÄúAdjusting your PATH environment‚Äù, make sure to select ‚ÄúGit from the command line and also from 3rd-party software‚Äù. Otherwise, we believe it is good to accept the defaults.</li>
<li>Note that RStudio for Windows prefers for Git to be installed below <code>C:/Program Files</code> and this appears to be the default. This implies, for example, that the Git executable on my Windows system is found at <code>C:/Program Files/Git/bin/git.exe</code>. Unless you have specific reasons to otherwise, follow this convention.</li>
</ul>
<p>This also leaves you with a Git client, though not a very good one. So check out Git clients the Jenny recommends</p>
<p>FYI, this appears to be equivalent to what you would download from here: <a href="https://git-scm.com/download/" class="uri">https://git-scm.com/download/</a>.</p>
<p>Additional approaches for Windows can be found <a href="https://happygitwithr.com/install-git.html#install-git-windows">here</a></p>
<div id="macos" class="section level3 hasAnchor" number="7.8.1">
<h3 class="hasAnchor"><span class="header-section-number">7.8.1</span> macOS<a href="#macos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although I (Mason) have limited knowledge about the inner workings of mac, I do know of quantitative psychologists who use macs with R, including Bill Revelle ‚Äì author of the psych package and Full Professor at Northwestern.</p>
<p><strong>Option 1</strong> (<em>highly recommended</em>): Install the Xcode command line tools (<strong>not all of Xcode</strong>), which includes Git.</p>
<p>Go to the shell and enter one of these commands to elicit an offer to install developer command line tools:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">--version</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config</span></code></pre></div>
<p>Accept the offer! Click on ‚ÄúInstall‚Äù.</p>
<p>Here‚Äôs another way to request this installation, more directly:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">xcode-select</span> <span class="at">--install</span></span></code></pre></div>
<p>We just happen to find this Git-based trigger apropos.</p>
<p>Note also that, after upgrading macOS, you might need to re-do the above and/or re-agree to the Xcode license agreement. We have seen this cause the RStudio Git pane to disappear on a system where it was previously working. Use commands like those above to tickle Xcode into prompting you for what it needs, then restart RStudio.</p>
<p><strong>Option 2</strong> (<em>recommended</em>): Install Git from here: <a href="http://git-scm.com/downloads" class="uri">http://git-scm.com/downloads</a>.</p>
<ul>
<li><p>This option arguably sets you up the best for the future. It will certainly get you the latest version of Git of all approaches described here.</p></li>
<li><p>The GitHub home for the macOS installer is here: <a href="https://github.com/timcharper/git_osx_installer" class="uri">https://github.com/timcharper/git_osx_installer</a>.</p>
<ul>
<li>At that link, you can find more info if something goes wrong or you are working on an old version of macOS.</li>
</ul></li>
</ul>
<p>Additional approaches for macOS can be found <a href="https://happygitwithr.com/install-git.html#macos">here</a></p>
</div>
</div>
<div id="hello-git" class="section level2 hasAnchor" number="7.9">
<h2 class="hasAnchor"><span class="header-section-number">7.9</span> Introduce yourself to Git<a href="#hello-git" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the shell (<a href="https://happygitwithr.com/shell.html">More info on shell from Jenny Bryan</a>):</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.name <span class="st">&#39;Jane Doe&#39;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.email <span class="st">&#39;jane@example.com&#39;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> <span class="at">--list</span></span></code></pre></div>
<p>substituting your name and <strong>the email associated with your GitHub account</strong>.</p>
<p>The <a href="https://usethis.r-lib.org">usethis package</a> offers an alternative approach. You can set your Git user name and email from within R:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## install if needed (do this exactly once):</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages(&quot;usethis&quot;)</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_git_config</span>(<span class="at">user.name =</span> <span class="st">&quot;Jane Doe&quot;</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">user.email =</span> <span class="st">&quot;jane@example.org&quot;</span>)</span></code></pre></div>
<div id="more-about-git-config" class="section level3 hasAnchor" number="7.9.1">
<h3 class="hasAnchor"><span class="header-section-number">7.9.1</span> More about <code>git config</code><a href="#more-about-git-config" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An easy way to get into a shell from RStudio is <em>Tools &gt; Terminal</em> or <em>Tools &gt; Shell</em>. (<a href="https://happygitwithr.com/shell.html">More info on shell from Jenny Bryan</a>).</p>
<p>Special Windows gotchas: If you are struggling on Windows, consider there are different types of shell and you might be in the wrong one. You want to be in a ‚ÄúGit Bash‚Äù shell, as opposed to Power Shell or the legacy <code>cmd.exe</code> command prompt. This might also be a reason to do this configuration via the usethis package in R.</p>
<p>What user name should you give to Git? This does not have to be your GitHub user name, although it can be. Another good option is your actual first name and last name. If you commit from different machines, sometimes people work that info into the user name. Your commits will be labeled with this user name, so make it informative to potential collaborators and future you.</p>
<p>What email should you give to Git? This email <strong>must</strong> be the email associated with your GitHub account.</p>
<p>These commands return nothing. You can check that Git understood what you typed by looking at the output of <code>git config --global --list</code>.</p>
</div>
<div id="git-editor" class="section level3 hasAnchor" number="7.9.2">
<h3 class="hasAnchor"><span class="header-section-number">7.9.2</span> Configure the Git editor<a href="#git-editor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another Git option that many people eventually configure is the editor. At some point, you will fail to give Git what it wants in terms of a commit message and it will kick you into an editor. This can be distressing, if it‚Äôs not your editor of choice and you don‚Äôt even know how to save and quit. You can enforce your will with something along these lines:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> core.editor <span class="st">&quot;emacs&quot;</span></span></code></pre></div>
<p>Substitute your preferred editor for <code>"emacs"</code> here. Software Carpentry‚Äôs Git lesson has a comprehensive listing of the exact <code>git config</code> command needed for <a href="http://swcarpentry.github.io/git-novice/02-setup/">many combinations of OS and editor</a>.</p>
</div>
</div>
<div id="git-client" class="section level2 hasAnchor" number="7.10">
<h2 class="hasAnchor"><span class="header-section-number">7.10</span> Install a Git client<a href="#git-client" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Although having a git client is optional, I <strong>highly recommend</strong> it for the same reasons as I recommend having Rstudio.</p>
<p>Learning to use version control can be rough at first. I found the use of a GUI ‚Äì as opposed to the command line ‚Äì extremely helpful when I was getting started. I call this sort of helper application a Git client. It‚Äôs really a Git(Hub) client because it also helps you interact with GitHub or other remotes.</p>
<div id="what-is-a-git-client-why-would-you-want-one" class="section level3 hasAnchor" number="7.10.1">
<h3 class="hasAnchor"><span class="header-section-number">7.10.1</span> What is a Git client? Why would you want one?<a href="#what-is-a-git-client-why-would-you-want-one" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>‚ÄúGit‚Äù is really just a collection of individual commands you execute in the shell. This interface is not appealing for everyone. Some may prefer to do Git operations via a client with a graphical interface.</p>
<p>Git and your Git client are not the same thing, just like R and RStudio are not the same thing. A Git client and an <a href="https://en.wikipedia.org/wiki/Integrated_development_environment">integrated development environment</a>, such as RStudio, are not necessary to use Git or R, respectively. But they make the experience more pleasant because they reduce the amount of <a href="http://www.pgbovine.net/command-line-bullshittery.htm">command line bullshittery</a> and provide a richer visual representation of the current state.</p>
<p>RStudio offers a very basic Git client via its Git pane. I use this often for simple operations, but you probably want another, more powerful one as well.</p>
<p>Fair warning: for some tasks, you must use the command line. But the more powerful your Git client is, the less often this happens. The visual overview given by your Git client can also be invaluable for understanding the current state of things, even when preparing calls to command line Git.</p>
<p>Fantastic news: because all of the clients are just forming and executing Git commands on your behalf, you don‚Äôt have to pick one. You can literally do one operation from the command line, do another from RStudio, and another from SourceTree, one after the other, and it just works. <em>Very rarely, both clients will scan the repo at the same time and you‚Äôll get an error message about <code>.git/index.lock</code>. Try the operation again at least once before doing any further troubleshooting.</em></p>
</div>
<div id="a-picture-is-worth-a-thousand-words" class="section level3 hasAnchor" number="7.10.2">
<h3 class="hasAnchor"><span class="header-section-number">7.10.2</span> A picture is worth a thousand words<a href="#a-picture-is-worth-a-thousand-words" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here‚Äôs a screenshot of SourceTree (see below) open to the repository for this site. You get a nice graphical overview of the recent commit history, branches, and diffs, as well as a GUI that facilitates the most common Git operations.</p>
<div class="figure">
<img src="img/sourcetree-screenshot.png" alt="" />
<p class="caption">SourceTree screenshot</p>
</div>
<p>In contrast, here‚Äôs a shell session where I‚Äôve used command line Git to access some of the same information.</p>
<div class="figure">
<img src="img/command-line-git-screenshot.png" alt="" />
<p class="caption">Command line Git</p>
</div>
<p>Which do you prefer?</p>
</div>
<div id="no-one-is-giving-out-git-nerd-merit-badges" class="section level3 hasAnchor" number="7.10.3">
<h3 class="hasAnchor"><span class="header-section-number">7.10.3</span> No one is giving out Git Nerd merit badges<a href="#no-one-is-giving-out-git-nerd-merit-badges" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Work with Git in whatever way makes you most effective. Feel free to revisit your approach over time or to use different approaches for different tasks. No one can tell whether you use the command line or a GUI when they look at your Git history or your GitHub repo.</p>
<p>If your Git life happens on your own computer, there is no reason to deny yourself a GUI if that‚Äôs what you like. If you prefer working in the shell or if you frequently log into a remote server, then it makes sense to prioritize building Git skills at the command line. Do whatever works for you, but don‚Äôt do anything for the sake of purity or heroism.</p>
</div>
<div id="recommended-git-clients" class="section level3 hasAnchor" number="7.10.4">
<h3 class="hasAnchor"><span class="header-section-number">7.10.4</span> Recommended Git clients<a href="#recommended-git-clients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><a href="https://www.gitkraken.com">GitKraken</a> is a free, powerful Git(Hub) client that is Jenny Bryan‚Äôs current favorite. It‚Äôs especially exciting because it works on Windows, macOS, and Linux. This is great news, especially for long-suffering Linux users who have previously had very few options.</p></li>
<li><p><a href="https://www.sourcetreeapp.com">SourceTree</a> is another free client that Jenny highly recommends, at least on Windows <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. It was hery first and most beloved Git client, but she eventually had to give it up on macOS, due to a <a href="http://openradar.appspot.com/radar?id=1387401">long-standing bug re: leaking file handles</a> that they will clearly never fix. I still use SourceTree on Windows.</p></li>
</ul>
<p>(ref:sourcetree-install) During installation and registration, you‚Äôll need to create a free Atlassian Bitbucket account and link that to a free Atlassian Bitbucket Cloud account. Also, feel free to uncheck the checkbox about installing Mercurial (another version control system), unless you feel you need it.</p>
<ul>
<li><p>GitHub offers a free Git(Hub) client, <a href="https://desktop.github.com/">GitHub Desktop</a>, for Windows and macOS. GitHub Desktop is aimed at beginners who want the most useful features of Git front and center. The flipside is that it may not support some of the more advanced workflows exposed by the clients above. At present, this client is what I mostly use.</p></li>
<li><p>Others that I have heard positive reviews for:</p>
<ul>
<li><a href="https://magit.vc">magit</a>, for Emacs nerds<br />
</li>
<li><a href="https://gitup.co">GitUp</a></li>
<li><a href="http://www.syntevo.com/smartgit/">SmartGit</a></li>
<li><a href="https://git-cola.github.io">git-cola</a></li>
</ul></li>
<li><p>Browse <a href="http://git-scm.com/downloads/guis">even more Git(Hub) clients</a>.</p></li>
</ul>
</div>
</div>
<div id="resources" class="section level2 hasAnchor" number="7.11">
<h2 class="hasAnchor"><span class="header-section-number">7.11</span> üìö Resources<a href="#resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=w3jLJU7DT5E&amp;feature=youtu.be">A short video explaining what GitHub is</a></li>
<li><a href="https://docs.github.com/en/github/getting-started-with-github/git-and-github-learning-resources">Git and GitHub learning resources</a></li>
<li><a href="https://guides.github.com/introduction/flow/">Understanding the GitHub flow</a></li>
<li><a href="https://www.youtube.com/watch?v=H5GJfcp3p4Q&amp;feature=youtu.be">How to use GitHub branches</a></li>
<li><a href="https://githubtraining.github.io/training-manual/#/01_getting_ready_for_class">Interactive Git training materials</a></li>
<li><a href="https://lab.github.com/">GitHub‚Äôs Learning Lab</a></li>
<li><a href="https://education.github.community/">Education community forum</a></li>
<li><a href="https://github.community/">GitHub community forum</a></li>
</ul>
</div>
<div id="optional-next-steps" class="section level2 hasAnchor" number="7.12">
<h2 class="hasAnchor"><span class="header-section-number">7.12</span> üìù Optional next steps<a href="#optional-next-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Open a pull request and let your teacher know that you‚Äôve finished this course.</li>
<li>Create a new markdown file in this repository. Let them know what you learned and what you are still confused about! Experiment with different styles!</li>
<li>Create your profile README. Let the world know a little bit more about you! What are you interested in learning? What are you working on? What‚Äôs your favorite hobby? Learn more about creating your profile README in the document, <a href="https://docs.github.com/en/github/setting-up-and-managing-your-github-profile/managing-your-profile-readme">‚ÄúManaging Your Profile README‚Äù</a>.</li>
<li>Go to your user dashboard and create a new repository. Experiment with the features within that repository to familiarize yourself with them.</li>
<li><a href="https://support.github.com/contact/education">Let github know what you liked or didn‚Äôt like about the content of this course</a>. What would you like to see more of? What would be interesting or helpful to your learning journey?</li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0103_happygit.Rmd-->
</div>
</div>
<div id="lab01" class="section level1 hasAnchor" number="8">
<h1 class="hasAnchor"><span class="header-section-number">8</span> Lab: Hello R!<a href="#lab01" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The labs for this course have been adapted from a series of Rstudio tutorials.
These tutorials were initially created by <a href="https://en.wikipedia.org/wiki/Mine_%C3%87etinkaya-Rundel">Mine √áetinkaya-Rundel</a>. Mine is fantastic; her work is fantastic; and she‚Äôs just a badass!</p>
<p>I have adapted these tutorials for two reasons:</p>
<ol style="list-style-type: decimal">
<li><p>I think it useful to see other people working with R; and</p></li>
<li><p>Pragmatically, using Mine‚Äôs lab materials means that I can spend more time on other aspects of the course ‚Äì like the website, course notes, videos, feedback, learning how to embed tweets‚Ä¶</p></li>
</ol>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">That&#39;s so wonderful to hear, thank you!</p>&mdash; Mine √áetinkaya-Rundel (@minebocek) <a href="https://twitter.com/minebocek/status/1352727542537605120?ref_src=twsrc%5Etfw">January 22, 2021</a></blockquote>

<p>Seriously, you‚Äôd never know it, but every hour of finished video takes between 4 and 6 hours to make. (2 hours of writing, 1.5 hours of filming, and 2.5 hours for video editing).</p>
<div id="lab-goals" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Lab Goals<a href="#lab-goals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Recall: R is the name of the programming language itself and RStudio is a convenient interface.</p>
</blockquote>
<p>The main goal of this lab is to introduce you to R and RStudio. We will be using them throughout the course:</p>
<ul>
<li>to learn the statistical concepts discussed in the course, and</li>
<li>to analyze real data and come to informed conclusions.</li>
</ul>
<blockquote>
<p>Recall: git is a version control system (like ‚ÄúTrack Changes‚Äù features from Microsoft Word on steroids) and GitHub is the home for your Git-based projects on the Internet (like DropBox but much, much better).</p>
</blockquote>
<p>An additional goal is to introduce you to Git and GitHub, which is the collaboration and version control system that we will be using throughout the course.</p>
<p>As the labs progress, you are encouraged to explore beyond what the labs dictate; a willingness to experiment will make you a much better programmer. Before we get to that stage, however, you need to build some basic fluency in R. Today we begin with the fundamental building blocks of R and RStudio: the interface, reading in data, and basic commands.</p>
<p>To make versioning simpler, this lab is a solo lab. I want to make sure everyone gets a significant amount of time at the steering wheel, working directly with R. In the future modules,you‚Äôll learn about collaborating on GitHub and produce a single lab report for your team.</p>
</div>
<div id="getting-started" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Getting started<a href="#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Each of your assignments will begin with the following steps. They‚Äôre outlined in detail here. Going forward, each lab will start with a ‚ÄúGetting started‚Äù section but details will be a bit more sparse than this. You can always refer back to this lab for a detailed list of the steps involved for getting started with an assignment.</p>
<ul>
<li>You can find the assignment link for this lab right <a href="https://github.com/DataScience4Psych/lab-01-hello-r">here</a>. That GitHub repository (which we‚Äôll refer to as ‚Äúrepo‚Äù going forward) is a template for the assignment. You can build on it to complete your assignment.</li>
</ul>
<p><img src="img/github_template.PNG" width="977" />
<!-- to do: make clear how to do this on you own account --></p>
<ul>
<li><p>On GitHub, click on the <strong>Use this template</strong> button.</p></li>
<li><p>This option initiates the creation of a repo on your account, based on the lab template.</p></li>
</ul>
<p><img src="img/github_createfromtemplate.PNG" width="878" /></p>
<ul>
<li><p>You should now provide a name to your new repository. Lab 01 or something to that effect should work nicely.</p></li>
<li><p>I recommend making the repo public, but private is fine if you already have github pro set up.</p></li>
<li><p>Once you fill out all the required information, click on the <strong>Create Repository from Template</strong> button.</p></li>
<li><p>Now you should have your own copy of the lab!</p></li>
</ul>
<p><img src="img/newcopylab1.PNG" width="1290" /></p>
<ul>
<li>Now we need to connect your new git repo with your computer.</li>
</ul>
<p><img src="img/geturllab01.png" width="976" /></p>
<ul>
<li><p>Notice that are a few ways to interface between git and R.</p>
<ul>
<li><em>Clone</em></li>
<li><em>Open</em></li>
<li><em>Download</em></li>
</ul></li>
</ul>
<div id="option-1-use-rstudio" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Option 1: Use RStudio<a href="#option-1-use-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>From your repo, select <strong>Code</strong>.</p></li>
<li><p>Use RStudio to <strong>clone</strong> the repo.</p></li>
<li><p>Now, select <strong>Use HTTPS</strong> (this might already be selected by default, and if it is, you‚Äôll see the text <strong>Clone with HTTPS</strong> as in the image below). Click on the clipboard icon to copy the repo URL.</p></li>
</ul>
<p><img src="img/new-project-from-gh.png" width="224" /></p>
<ul>
<li>Go to RStudio. Select from the menu, <strong>new project</strong>.</li>
</ul>
<p><img src="img/lab1_newproject.PNG" width="878" /></p>
<ul>
<li>Using the new project wizard, select <strong>Version Control</strong></li>
</ul>
<p><img src="img/newprojectwizard.PNG" width="610" /></p>
<ul>
<li>Select the option for <em>Git</em></li>
</ul>
<p><img src="img/wizardgit.PNG" width="615" /></p>
<ul>
<li>Copy and paste the URL of your assignment repo into the dialog box.</li>
</ul>
<p><img src="img/clonerstudio.PNG" width="602" /></p>
<ul>
<li><p>Fill out the information for what folder you‚Äôd like to store your lab in.</p></li>
<li><p>Hit OK, and you‚Äôre good to go!</p></li>
</ul>
</div>
<div id="option-2-use-github-desktop" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Option 2: Use Github Desktop<a href="#option-2-use-github-desktop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://github.com/YRHwang90">Yoo Ri Hwang</a> wrote up a lovely demo for how to get a lab via github desktop. Her example uses lab 02, but we can use it for lab 1 as well. For example, you might want to download lab-02-plastic-waste. First, create account/password in the Github, and install desktop Github app.</p>
<p><img src="img/g1.png" width="942" /></p>
<p>Go to your repositories</p>
<p><img src="img/g2.png" width="842" /></p>
<p>Click the new button</p>
<p><img src="img/g3.png" width="435" /></p>
<p>Repositories template -&gt; DS4P/lab-02-plastic-waste</p>
<p><img src="img/g4.png" width="458" />
You can create this repositories.</p>
<p><img src="img/g5.png" width="860" /></p>
<p>Than, go to the repository that you‚Äôve just created. Click code -&gt; open with the GitHub Desktop</p>
<p><img src="img/g6.png" width="448" /></p>
<p>Click Open GitHubDesktop</p>
<p><img src="img/g7.png" width="854" /></p>
<p>You can change the local path by clicking ‚Äúchoose‚Äù. And if you click the ‚Äúclone‚Äù button, the lab02 plastic waste file would be in your local path.</p>
<p><img src="img/g8.png" width="594" /></p>
<p>Your changes should be automatically reflected in the app.</p>
<p><img src="img/g9.png" width="586" /></p>
<p>Write something in there (where I wrote ‚Äúwrite something‚Äù) and click ‚ÄúCommit to main‚Äù button</p>
<p><img src="img/g10.png" width="566" /></p>
<p>click the ‚ÄúPush Origin‚Äù button, and tada~</p>
<ul>
<li>Hit OK, and you‚Äôre good to go!</li>
</ul>
</div>
<div id="option-3-brute-force" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Option 3: Brute Force<a href="#option-3-brute-force" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>INSTRUCTIONS GO HERE</p></li>
<li><p>Hit OK, and you‚Äôre good to go!</p></li>
</ul>
</div>
</div>
<div id="warm-up" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Warm up<a href="#warm-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we introduce the data, let‚Äôs warm up with some simple exercises.</p>
<blockquote>
<p>FYI: The top portion of your R Markdown file (between the three dashed lines) is called YAML. It stands for ‚ÄúYAML Ain‚Äôt Markup Language‚Äù. It is a human friendly data serialization standard for all programming languages. All you need to know is that this area is called the YAML (we will refer to it as such) and that it contains meta information about your document.</p>
</blockquote>
<div id="yaml" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">YAML<a href="#yaml" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Open the R Markdown (Rmd) file in your project, change the author name to your name, save your changes, and then knit the document.</p>
<p><img src="img/yaml-raw-to-rendered.png" width="930" /></p>
</div>
<div id="committing-changes" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Committing changes<a href="#committing-changes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Then go to the Git pane in your RStudio.</p>
<p>If you have made <em>saved</em> changes to your Rmd file, you should see it listed here.
Click on it to select it in this list and then click on <strong>Diff</strong>.
This shows you the <em>diff</em>erence between the last committed state of the document and its current state that includes your changes.
If you‚Äôre happy with these changes, write ‚ÄúUpdate author name‚Äù in the <strong>Commit message</strong> box and hit <strong>Commit</strong>.</p>
<p><img src="img/update-author-name-commit.png" width="889" /></p>
<p>You don‚Äôt have to commit after every change, doing so would get quite cumbersome.
You should consider committing states that are <em>meaningful to you</em> for inspection, comparison, or restoration.
In the first few assignments, I‚Äôll suggest exactly when to commit and in some cases, what commit message to use.
As the semester progresses, you make these decisions.</p>
</div>
<div id="pushing-changes" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Pushing changes<a href="#pushing-changes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that you have made an update and committed this change, it‚Äôs time to push these changes to the web!
Or more specifically, to your repo on GitHub.
Why?
So that others can see your changes.
And by others, depending on your privacy settings, we mean the just you OR perhaps the world‚Ä¶</p>
<p>In order to push your changes to GitHub, click on <strong>Push</strong>.
This will prompt a dialog box where you first need to enter your user name, and then your password.
This might feel cumbersome.
Soon ‚Äì you <em>will</em> learn how to save your password so you don‚Äôt have to enter it every time.
But for this one assignment you‚Äôll have to manually enter each time you push in order to gain some experience with it.</p>
<iframe src="https://giphy.com/embed/SXqw0Vpql4sHX9pCl4" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen>
</iframe>
</div>
<div id="packages" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Packages<a href="#packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab, we will work with two packages: <strong>datasauRus</strong> and <strong>tidyverse</strong>. <strong>datasauRus</strong> contains the dataset we‚Äôll be using; <strong>tidyverse</strong> is a collection of packages for doing data analysis in a ‚Äútidy‚Äù way.</p>
<p>Install these packages by running the following commands in the console.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;datasauRus&quot;</span>)</span></code></pre></div>
<p>Now that the necessary packages are installed, you should be able to Knit your document and see the results.</p>
<p>If you‚Äôd like to run your code in the Console as well you‚Äôll also need to load the packages there. To do so, run the following in the console.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasauRus)</span></code></pre></div>
<p>Note that the packages are also loaded with the same commands in your R Markdown document.</p>
</div>
<div id="data" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Data<a href="#data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Fun fact: If it‚Äôs confusing that the data frame is called <code>datasaurus_dozen</code> when it contains 13 datasets, you‚Äôre not alone! Have you heard of a <a href="https://en.wikipedia.org/wiki/Dozen#Baker&#39;s_dozen">baker‚Äôs dozen</a>?</p>
</blockquote>
<p>The data frame we will be working with today is called <code>datasaurus_dozen</code> and it‚Äôs in the <code>datasauRus</code> package.
Actually, this single data frame contains 13 datasets, designed to show us why data visualization is important and how summary statistics alone can be misleading.
The different datasets are marked by the <code>dataset</code> variable.</p>
<p>To find out more about the dataset, type the following in your Console: <code>?datasaurus_dozen</code>.
A question mark before the name of an object will always bring up its help file.
This command must be run in the Console.</p>
</div>
</div>
<div id="exercises" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Exercises<a href="#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Based on the help file, how many rows and how many columns does the <code>datasaurus_dozen</code> file have? What are the variables included in the data frame? Add your responses to your lab report.</li>
</ol>
<p>Let‚Äôs take a look at what these datasets are. To do so we can make a <em>frequency table</em> of the dataset variable:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>datasaurus_dozen <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dataset) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="dv">13</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble:</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   13 √ó 2</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    dataset   </span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;     </span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 away      </span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 bullseye  </span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 circle    </span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 dino      </span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 dots      </span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 h_lines   </span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 high_lines</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 slant_down</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 slant_up  </span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 star      </span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 v_lines   </span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 wide_lines</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 x_shape   </span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   more</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   variable:</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   n &lt;int&gt;</span></span></code></pre></div>
<blockquote>
<p>Fun fact: Matejka, Justin, and George Fitzmaurice. ‚ÄúSame stats, different graphs: Generating datasets with varied appearance and identical statistics through simulated annealing.‚Äù Proceedings of the 2017 CHI Conference on Human Factors in Computing Systems. ACM, 2017.</p>
</blockquote>
<p>The original Datasaurus (<code>dino</code>) was created by Alberto Cairo in <a href="http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html">this great blog post</a>.
The other Dozen were generated using simulated annealing and the process is described in the paper <em>Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics</em> through Simulated Annealing by Justin Matejka and George Fitzmaurice.
In the paper, the authors simulate a variety of datasets that have the same summary statistics as the Datasaurus but have very different distributions.</p>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>Knit, commit, and push your changes to GitHub with the commit message ‚ÄúAdded answer for Ex 1‚Äù. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<ol start="2" style="list-style-type: decimal">
<li>Plot <code>y</code> vs.¬†<code>x</code> for the <code>dino</code> dataset. Then, calculate the correlation coefficient between <code>x</code> and <code>y</code> for this dataset.</li>
</ol>
<p>Below is the code you will need to complete this exercise.
Basically, the answer is already given, but you need to include relevant bits in your Rmd document and successfully knit it and view the results.</p>
<p>Start with the <code>datasaurus_dozen</code> and pipe it into the <code>filter</code> function to filter for observations where <code>dataset == "dino"</code>. Store the resulting filtered data frame as a new data frame called <code>dino_data</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dino_data <span class="ot">&lt;-</span> datasaurus_dozen <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dataset <span class="sc">==</span> <span class="st">&quot;dino&quot;</span>)</span></code></pre></div>
<p>Because a lot going on here ‚Äì let‚Äôs slow down and unpack it a bit.</p>
<p>First, the pipe operator: <code>%&gt;%</code>, takes what comes before it and sends it as the first argument to what comes after it.
So here, we‚Äôre saying <code>filter</code> the <code>datasaurus_dozen</code> data frame for observations where <code>dataset == "dino"</code>.</p>
<p>Second, the assignment operator: <code>&lt;-</code>, assigns the name <code>dino_data</code> to the filtered data frame.</p>
<p>Next, we need to visualize these data.
We will use the <code>ggplot</code> function for this. Its first argument is the data you‚Äôre visualizing.
Next we define the <code>aes</code>thetic mappings.
In other words, the columns of the data that get mapped to certain aesthetic features of the plot, e.g.¬†the <code>x</code> axis will represent the variable called <code>x</code> and the <code>y</code> axis will represent the variable called <code>y</code>.
Then, we add another layer to this plot where we define which <code>geom</code>etric shapes we want to use to represent each observation in the data.
In this case, we want these to be points, hence <code>geom_point</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dino_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="0104_lab_hellor_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>If this seems like a lot, it is.
And you will learn about the philosophy of layering data visualizations in detail next week.
For now, follow along with the code that is provided.</p>
<p>For the second part of these exercises, we need to calculate a summary statistic: the correlation coefficient.</p>
<blockquote>
<p>Recall: Correlation coefficient, often referred to as <span class="math inline">\(r\)</span> in statistics, measures the linear association between two variables.</p>
</blockquote>
<p>You will see that some of the pairs of variables we plot do not have a linear relationship between them.
This nonlinear relationships are exactly why we want to visualize first: visualize to assess the form of the relationship, and calculate <span class="math inline">\(r\)</span> only if relevant.
In this case, calculating a correlation coefficient really doesn‚Äôt make sense since the relationship between <code>x</code> and <code>y</code> is definitely not linear ‚Äì it‚Äôs dinosaurial!</p>
<p>But, for illustrative purposes, let‚Äôs calculate the correlation coefficient between <code>x</code> and <code>y</code>.</p>
<blockquote>
<p>Tip: Start with <code>dino_data</code> and calculate a summary statistic that we will call <code>r</code> as the <code>cor</code>relation between <code>x</code> and <code>y</code>.</p>
</blockquote>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dino_data <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">r =</span> <span class="fu">cor</span>(x, y))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 1</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         r</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -0.0645</span></span></code></pre></div>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>Knit, commit, and push your changes to GitHub with the commit message ‚ÄúAdded answer for Ex 2‚Äù. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<ol start="3" style="list-style-type: decimal">
<li>Plot <code>y</code> vs.¬†<code>x</code> for the <code>star</code> dataset. You can (and should) reuse code we introduced above, just replace the dataset name with the desired dataset. Then, calculate the correlation coefficient between <code>x</code> and <code>y</code> for this dataset. How does this value compare to the <code>r</code> of <code>dino</code>?</li>
</ol>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>This is another good place to pause, knit, commit changes with the commit message ‚ÄúAdded answer for Ex 3‚Äù, and push. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<ol start="4" style="list-style-type: decimal">
<li>Plot <code>y</code> vs.¬†<code>x</code> for the <code>circle</code> dataset. You can (and should) reuse code we introduced above, just replace the dataset name with the desired dataset. Then, calculate the correlation coefficient between <code>x</code> and <code>y</code> for this dataset. How does this value compare to the <code>r</code> of <code>dino</code>?</li>
</ol>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>You should pause again, commit changes with the commit message ‚ÄúAdded answer for Ex 4‚Äù, and push. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<ol start="5" style="list-style-type: decimal">
<li>Finally, let‚Äôs plot all datasets at once. In order to do this we will make use of faceting.</li>
</ol>
<blockquote>
<p>Hint: Facet by the dataset variable, placing the plots in a 3 column grid.</p>
</blockquote>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datasaurus_dozen, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> dataset))<span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> dataset, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p>And we can use the <code>group_by</code> function to generate all the summary correlation coefficients.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>datasaurus_dozen <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">r =</span> <span class="fu">cor</span>(x, y)) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="dv">13</span>)</span></code></pre></div>
<p>You‚Äôre done with the data analysis exercises, but we‚Äôd like you to do two more things:</p>
<p><img src="img/fig-resize-global.png" width="468" /></p>
<ul>
<li><strong>Resize your figures:</strong></li>
</ul>
<p>Click on the gear icon near the top of the R Markdown document, and select ‚ÄúOutput Options‚Ä¶‚Äù in the dropdown menu.
In the pop up dialog box, go to the Figures tab and change the height and width of the figures, and hit OK when done.
Then, knit your document and see how you like the new sizes.
Change and knit again and again until you‚Äôre happy with the figure sizes.
Note that these values get saved in the YAML.</p>
<p><img src="img/fig-resize-local.png" width="634" /></p>
<p>You can also use different figure sizes for different figures.
To do so, click on the gear icon within the chunk where you want to make a change.
Changing the figure sizes added new options to these chunks: <code>fig.width</code> and <code>fig.height</code>.
You can change them by defining different values directly in your R Markdown document as well.</p>
<p><img src="img/theme-highlight.png" width="467" /></p>
<ul>
<li><strong>Change the look of your report:</strong></li>
</ul>
<p>Once again, click on the gear icon in on top of the R Markdown document, and select ‚ÄúOutput Options‚Ä¶‚Äù in the dropdown menu.
In the General tab of the pop up dialog box, try out different Syntax highlighting and theme options.
Hit OK and knit your document to see how it looks.
Play around with these until you‚Äôre happy with the look.</p>
<p><br></p>
<blockquote>
<p>Pro Tip: Not sure how to use emojis on your computer? Maybe a teammate can help?</p>
</blockquote>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>Yay, you‚Äôre done! Commit all remaining changes, use the commit message ‚ÄúDone with Lab 1!</em> üí™<em>‚Äú, and push. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards. Before you wrap up the assignment, make sure all documents are updated on your GitHub repo.</em></p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0104_lab_hellor.Rmd-->
</div>
</div>
<div id="part-module-02" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 02<a href="#part-module-02" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-data-and-visualization" class="section level1 hasAnchor" number="9">
<h1 class="hasAnchor"><span class="header-section-number">9</span> Welcome to Data and Visualization<a href="#welcome-to-data-and-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce you to exploratory and graphical data analysis.
Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong><br />
You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYZmr_T3PnuxjVIlj0C0kUNI">here</a>. The slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-1" class="section level2 hasAnchor" number="9.1">
<h2 class="hasAnchor"><span class="header-section-number">9.1</span> Module Materials<a href="#module-materials-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d03_dataviz/d03_dataviz.html">Data and visualization</a></li>
<li><a href="https://datascience4psych.github.io/slides/d04_ggplot2/d04_ggplot2.html">Visualizing data with ggplot2</a></li>
<li><a href="https://datascience4psych.github.io/slides/d05_viznum/d05_viznum.html">Visualizing numerical data</a></li>
<li><a href="https://datascience4psych.github.io/slides/d06_vizcat/d06_vizcat.html">Visualizing categorical data</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module, including
<ul>
<li><a href="#basiccare">Basic care and feeding of data in R</a></li>
</ul></li>
<li>R4DS
<ul>
<li><a href="https://r4ds.had.co.nz/explore-intro.html">Data Exploratation Section</a>, including</li>
<li><a href="https://r4ds.had.co.nz/data-visualization.html">Data visualization</a></li>
<li><a href="https://r4ds.had.co.nz/exploratory-data-analysis.html">Exploratory Data Analysis</a></li>
</ul></li>
</ul></li>
<li>Activities
<ul>
<li><a href="https://github.com/DataScience4Psych/ae-03-starwars-dataviz">Star Wars!</a></li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab02">Plastic waste</a></li>
</ul></li>
</ul>
<div id="estimated-video-length-1" class="section level3 hasAnchor" number="9.1.1">
<h3 class="hasAnchor"><span class="header-section-number">9.1.1</span> Estimated Video Length<a href="#estimated-video-length-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://www.youtube.com/playlist?list=PLKrrdtYgOUYZmr_T3PnuxjVIlj0C0kUNI & https://ytplaylist-len.herokuapp.com/ -->
<p>No of videos : 9</p>
<p>Average length of video : 13 minutes, 34 seconds</p>
<p>Total length of playlist : 2 hours, 2 minutes, 11 seconds</p>
</div>
</div>
</div>
<div id="exploratory-data-analysis" class="section level1 hasAnchor" number="10">
<h1 class="hasAnchor"><span class="header-section-number">10</span> Exploratory Data Analysis<a href="#exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d03_dataviz/d03_dataviz.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/IUP3qCIjk4Q" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d03_dataviz/d03_dataviz.html" width="672" height="400px" data-external="1">
</iframe>
<div id="what-is-in-a-dataset" class="section level2 hasAnchor" number="10.1">
<h2 class="hasAnchor"><span class="header-section-number">10.1</span> What is in a dataset?<a href="#what-is-in-a-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/J6arziOCQpk" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d03_dataviz/d03_dataviz.html#23" width="672" height="400px" data-external="1">
</iframe>
<div id="why-do-we-visualize" class="section level3 hasAnchor" number="10.1.1">
<h3 class="hasAnchor"><span class="header-section-number">10.1.1</span> Why do we visualize?<a href="#why-do-we-visualize" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/E5IY1FQv0OM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d03_dataviz/d03_dataviz.html#35" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
</div>
<div id="visualizing-data-with-ggplot2" class="section level1 hasAnchor" number="11">
<h1 class="hasAnchor"><span class="header-section-number">11</span> Visualizing data with ggplot2<a href="#visualizing-data-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Does anyone else feel that their affinity for an artistic skill helps them with statistics? Just me?</p>&mdash; Valerie Polad (@valeriepolad) <a href="https://twitter.com/valeriepolad/status/1388733898926870533?ref_src=twsrc%5Etfw">May 2, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Your data visualizations suck.<br><br>In the beginning, at least. <br><br>See, that‚Äôs the secret no one tells you. We all sucked when we got started. <br><br>Make bad visualizations and share them. A lot of them. Then people will help you and they‚Äôll get better. <br><br>That‚Äôs how you learn.</p>&mdash; Oh, Friend. (@oh__friend) <a href="https://twitter.com/oh__friend/status/1469332905503731713?ref_src=twsrc%5Etfw">December 10, 2021</a></blockquote>

<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d04_ggplot2/d04_ggplot2.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/-tdEQXdx-SA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d04_ggplot2/d04_ggplot2.html" width="672" height="400px" data-external="1">
</iframe>
<div id="ggplot2-and-aesthetics" class="section level2 hasAnchor" number="11.1">
<h2 class="hasAnchor"><span class="header-section-number">11.1</span> ggplot2 and aesthetics<a href="#ggplot2-and-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/K2u2_lcgdks" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d04_ggplot2/d04_ggplot2.html#26" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="visualizing-numerical-data" class="section level1 hasAnchor" number="12">
<h1 class="hasAnchor"><span class="header-section-number">12</span> Visualizing numerical data<a href="#visualizing-numerical-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d05_viznum/d05_viznum.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/hGylk9UaM2k" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d05_viznum/d05_viznum.html" width="672" height="400px" data-external="1">
</iframe>
<div id="looking-at-data" class="section level2 hasAnchor" number="12.1">
<h2 class="hasAnchor"><span class="header-section-number">12.1</span> Looking at Data<a href="#looking-at-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/sN2gCCd2Rr8" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="more-on-visualizing-numerical-data" class="section level2 hasAnchor" number="12.2">
<h2 class="hasAnchor"><span class="header-section-number">12.2</span> More on visualizing numerical data<a href="#more-on-visualizing-numerical-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fun fact, when you screen capture with <a href="https://justgetflux.com/">f.lux</a> running in the background, f.lux is captured too.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/7OWyhBWMoM8" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d05_viznum/d05_viznum.html#12" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="visualizing-categorical-data" class="section level1 hasAnchor" number="13">
<h1 class="hasAnchor"><span class="header-section-number">13</span> Visualizing categorical data<a href="#visualizing-categorical-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d06_vizcat/d06_vizcat.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/xY819zNKdnY" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d06_vizcat/d06_vizcat.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="star-wars-activity" class="section level1 hasAnchor" number="14">
<h1 class="hasAnchor"><span class="header-section-number">14</span> Star Wars Activity!<a href="#star-wars-activity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<iframe src="https://datascience4psych.github.io/slides/d06_vizcat/d06_vizcat.html#15" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Star Wars activity <a href="https://github.com/DataScience4Psych/ae-03-starwars-dataviz">here</a>. The compiled version should look something like the following‚Ä¶</p>
<iframe src="https://datascience4psych.github.io/ae-03-starwars-dataviz/starwars.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="visualization-examples" class="section level1 hasAnchor" number="15">
<h1 class="hasAnchor"><span class="header-section-number">15</span> Visualization Examples<a href="#visualization-examples" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here are some fun examples of data visualization. Eventually, this section will include examples from previous classes. :) For now, it‚Äôs going to just include random stuff.</p>
<div id="census-reporter-data-from-north-carolina" class="section level2 hasAnchor" number="15.1">
<h2 class="hasAnchor"><span class="header-section-number">15.1</span> Census Reporter Data from North Carolina<a href="#census-reporter-data-from-north-carolina" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe id="cr-embed-04000US37-demographics-age-distribution_by_category" class="census-reporter-embed" src="https://s3.amazonaws.com/embed.censusreporter.org/1.0/iframe.html?geoID=04000US37&amp;chartDataID=demographics-age-distribution_by_category&amp;dataYear=2019&amp;releaseID=ACS_2019_1-year&amp;chartType=pie&amp;chartHeight=200&amp;chartQualifier=&amp;chartTitle=Population+by+age+category&amp;initialSort=-value&amp;statType=percentage" frameborder="0" width="100%" height="300" style="margin: 1em; max-width: 300px; float: right;">
</iframe>
<iframe id="cr-embed-04000US37-social-language-children" class="census-reporter-embed" src="https://s3.amazonaws.com/embed.censusreporter.org/1.0/iframe.html?geoID=04000US37&amp;chartDataID=social-language-children&amp;dataYear=2019&amp;releaseID=ACS_2019_1-year&amp;chartType=pie&amp;chartHeight=200&amp;chartQualifier=&amp;chartTitle=Language+at+home%2C+children+5-17&amp;initialSort=-value&amp;statType=percentage" frameborder="0" width="100%" height="300" style="margin: 1em; max-width: 300px;float: left;">
</iframe>
<script src="https://s3.amazonaws.com/embed.censusreporter.org/1.0/js/embed.chart.make.js"></script>
<iframe id="cr-embed-04000US37-social-educational_attainment_distribution" class="census-reporter-embed" src="https://s3.amazonaws.com/embed.censusreporter.org/1.0/iframe.html?geoID=04000US37&amp;chartDataID=social-educational_attainment_distribution&amp;dataYear=2019&amp;releaseID=ACS_2019_1-year&amp;chartType=histogram&amp;chartHeight=200&amp;chartQualifier=Universe%3A+Population+25+years+and+over&amp;chartTitle=Population+by+minimum+level+of+education&amp;initialSort=&amp;statType=scaled-percentage" frameborder="0" width="100%" height="300" style="margin: 1em; max-width: 720px; ">
</iframe>
<script src="https://s3.amazonaws.com/embed.censusreporter.org/1.0/js/embed.chart.make.js"></script>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0201_visualization.Rmd-->
</div>
</div>
<div id="basiccare" class="section level1 hasAnchor" number="16">
<h1 class="hasAnchor"><span class="header-section-number">16</span> Basic care and feeding of data in R<a href="#basiccare" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Feel free to ignore it if you don‚Äôt need this extra scaffolding / bit of support.</em> But I strongly encourage you to take a look, even if you think you know what you‚Äôre doing.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Bestie, don‚Äôt feel bad about ANY data set up you have üíô LuLaRoe is a billion dollar company using a GOOGLE SPREADSHEET THAT MULTIPLE PEOPLE HAD EDIT ACCESS TO üòò <a href="https://t.co/DbD7X9thUk">pic.twitter.com/DbD7X9thUk</a></p>&mdash; Chelsea Parlett-Pelleriti (@ChelseaParlett) <a href="https://twitter.com/ChelseaParlett/status/1439003000740085760?ref_src=twsrc%5Etfw">September 17, 2021</a></blockquote>

<div id="buckle-your-seatbelt" class="section level2 hasAnchor" number="16.1">
<h2 class="hasAnchor"><span class="header-section-number">16.1</span> Buckle your seatbelt<a href="#buckle-your-seatbelt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now is the time to make sure you are working in an appropriate directory on your computer, probably through the use of an <a href="#rprojs">RStudio project</a>. Enter <code>getwd()</code> in the Console to see current working directory or, in RStudio, this is displayed in the bar at the top of Console.</p>
<p>You should clean out your workspace. In RStudio, click on the ‚ÄúClear‚Äù broom icon from the Environment tab or use <em>Session &gt; Clear Workspace</em>. You can also enter <code>rm(list = ls())</code> in the Console to accomplish same.</p>
<p>Now restart R. Restarting will ensure you don‚Äôt have any packages loaded from previous calls to <code>library()</code>. In RStudio, use <em>Session &gt; Restart R</em>. Otherwise, quit R with <code>q()</code> and re-launch it.</p>
<p>Why do we do this? So that the code you write is complete and re-runnable. If you return to a clean slate often, you will root out hidden dependencies where one snippet of code only works because it relies on objects created by code saved elsewhere or, much worse, never saved at all. Similarly, an aggressive clean slate approach will expose any usage of packages that have not been explicitly loaded.</p>
<p>Finally, open a new R script and develop and run your code from there. In RStudio, use <em>File &gt; New File &gt; R Script</em>. Save this script with a name ending in <code>.r</code> or <code>.R</code>, containing no spaces or other funny stuff, and that evokes whatever it is we‚Äôre doing today. <strong>Example:</strong> <code>cm004_data-care-feeding.r</code>.</p>
<p>Another great idea is to do this in an R Markdown document. See <a href="#rmarkdown">Test drive R Markdown</a> for a refresher.</p>
</div>
<div id="data-frames-are-awesome" class="section level2 hasAnchor" number="16.2">
<h2 class="hasAnchor"><span class="header-section-number">16.2</span> Data frames are awesome<a href="#data-frames-are-awesome" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Whenever you have rectangular, spreadsheet-y data, your default data receptacle in R is a data frame. Do not depart from this practice without good reason. Data frames are awesome because‚Ä¶</p>
<ul>
<li>Data frames package related variables neatly together,
<ul>
<li>keeping them in sync vis-a-vis row order</li>
<li>applying any filtering of observations uniformly</li>
</ul></li>
<li>Most functions for inference, modeling, and graphing are happy to be passed a data frame via a <code>data =</code> argument. This has been true in base R for a long time.</li>
<li>The set of packages known as the <a href="https://www.tidyverse.org">tidyverse</a> takes this one step further and explicitly prioritizes the processing of data frames. This includes popular packages like dplyr and ggplot2. In fact the tidyverse prioritizes a special flavor of data frame, called a ‚Äútibble‚Äù.</li>
</ul>
<p>Data frames ‚Äì unlike general arrays or, specifically, matrices in R ‚Äì can hold variables of different flavors, such as character data (subject ID or name), quantitative data (white blood cell count), and categorical information (treated vs.¬†untreated). If you use homogeneous structures, like matrices, for data analysis, you are likely to make the terrible mistake of spreading a dataset out over multiple, unlinked objects. Why? Because you can‚Äôt put character data, such as subject name, into the numeric matrix that holds white blood cell count. This fragmentation is a Bad Idea.</p>
</div>
<div id="get-the-gapminder-data" class="section level2 hasAnchor" number="16.3">
<h2 class="hasAnchor"><span class="header-section-number">16.3</span> Get the Gapminder data<a href="#get-the-gapminder-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will work with some of the data from the <a href="https://www.gapminder.org">Gapminder project</a>. Jenny Bryan has released this data as an <a href="https://CRAN.R-project.org/package=gapminder">R package</a>, so we can install it from CRAN like so:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;gapminder&quot;</span>)</span></code></pre></div>
<p>Now load the package:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
</div>
<div id="meet-the-gapminder-data-frame-or-tibble" class="section level2 hasAnchor" number="16.4">
<h2 class="hasAnchor"><span class="header-section-number">16.4</span> Meet the <code>gapminder</code> data frame or ‚Äútibble‚Äù<a href="#meet-the-gapminder-data-frame-or-tibble" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By loading the gapminder package, we now have access to a data frame by the same name. Get an overview of this with <code>str()</code>, which displays the structure of an object.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tibble [1,704 √ó 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ country  : Factor w/ 142 levels &quot;Afghanistan&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ continent: Factor w/ 5 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372..</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</span></span></code></pre></div>
<p><code>str()</code> will provide a sensible description of almost anything and, worst case, nothing bad can actually happen. When in doubt, just <code>str()</code> some of the recently created objects to get some ideas about what to do next.</p>
<p>We could print the <code>gapminder</code> object itself to screen. However, if you‚Äôve used R before, you might be reluctant to do this, because large datasets just fill up your Console and provide very little insight.</p>
<p>This is the first big win for <strong>tibbles</strong>. The <a href="https://tidyverse.tidyverse.org">tidyverse</a> offers a special case of R‚Äôs default data frame: the ‚Äútibble‚Äù, which is a nod to the actual class of these objects, <code>tbl_df</code>.</p>
<p>If you have not already done so, install the tidyverse meta-package now:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>Now load it:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2 ‚îÄ‚îÄ</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî ggplot2 3.4.0      ‚úî purrr   1.0.0 </span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tibble  3.1.8      ‚úî dplyr   1.0.10</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tidyr   1.2.1      ‚úî stringr 1.5.0 </span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî readr   2.1.3      ‚úî forcats 0.5.2 </span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::filter() masks stats::filter()</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::lag()    masks stats::lag()</span></span></code></pre></div>
<p>Now we can boldly print <code>gapminder</code> to screen! It is a tibble (and also a regular data frame) and the tidyverse provides a nice print method that shows the most important stuff and doesn‚Äôt fill up your Console.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## see? it&#39;s still a regular data frame, but also a tibble</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gapminder)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>gapminder</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,704 √ó 6</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1,694 more rows</span></span></code></pre></div>
<p>If you are dealing with plain vanilla data frames, you can rein in data frame printing explicitly with <code>head()</code> and <code>tail()</code>. Or turn it into a tibble with <code>as_tibble()</code>!</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gapminder)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 6</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Afghanistan Asia       1977    38.4 14880372      786.</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(gapminder)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 6</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   country  continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Zimbabwe Africa     1982    60.4  7636524      789.</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Zimbabwe Africa     1987    62.4  9216418      706.</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Zimbabwe Africa     1992    60.4 10704340      693.</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Zimbabwe Africa     1997    46.8 11404948      792.</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Zimbabwe Africa     2002    40.0 11926563      672.</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Zimbabwe Africa     2007    43.5 12311143      470.</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(iris)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 150 √ó 5</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3          4.7         3.2          1.3         0.2 setosa </span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4          4.6         3.1          1.5         0.2 setosa </span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5          5           3.6          1.4         0.2 setosa </span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6          5.4         3.9          1.7         0.4 setosa </span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7          4.6         3.4          1.4         0.3 setosa </span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8          5           3.4          1.5         0.2 setosa </span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9          4.4         2.9          1.4         0.2 setosa </span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10          4.9         3.1          1.5         0.1 setosa </span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 140 more rows</span></span></code></pre></div>
<p>More ways to query basic info on a data frame:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gapminder)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;country&quot;   &quot;continent&quot; &quot;year&quot;      &quot;lifeExp&quot;   &quot;pop&quot;       &quot;gdpPercap&quot;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(gapminder)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(gapminder)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gapminder)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1704    6</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(gapminder)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1704</span></span></code></pre></div>
<p>A statistical overview can be obtained with <code>summary()</code>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gapminder)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         country        continent        year         lifeExp    </span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Afghanistan:  12   Africa  :624   Min.   :1952   Min.   :23.6  </span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Albania    :  12   Americas:300   1st Qu.:1966   1st Qu.:48.2  </span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Algeria    :  12   Asia    :396   Median :1980   Median :60.7  </span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Angola     :  12   Europe  :360   Mean   :1980   Mean   :59.5  </span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Argentina  :  12   Oceania : 24   3rd Qu.:1993   3rd Qu.:70.8  </span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Australia  :  12                  Max.   :2007   Max.   :82.6  </span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (Other)    :1632                                               </span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       pop             gdpPercap     </span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :6.00e+04   Min.   :   241  </span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:2.79e+06   1st Qu.:  1202  </span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :7.02e+06   Median :  3532  </span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :2.96e+07   Mean   :  7215  </span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:1.96e+07   3rd Qu.:  9325  </span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :1.32e+09   Max.   :113523  </span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>Although we haven‚Äôt begun our formal coverage of visualization yet, it‚Äôs so important for smell-testing dataset that we will make a few figures anyway. Here we use only base R graphics, which are very basic.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lifeExp <span class="sc">~</span> year, gapminder)</span></code></pre></div>
<p><img src="0202_datafeeding_files/figure-html/first-plots-base-R-1.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lifeExp <span class="sc">~</span> gdpPercap, gapminder)</span></code></pre></div>
<p><img src="0202_datafeeding_files/figure-html/first-plots-base-R-2.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lifeExp <span class="sc">~</span> <span class="fu">log</span>(gdpPercap), gapminder)</span></code></pre></div>
<p><img src="0202_datafeeding_files/figure-html/first-plots-base-R-3.png" width="672" /></p>
<!--JB: This is a non-sequitur here ... where came from originally?
> Sidebar on equals: A single equal sign `=` is most commonly used to specify values of arguments when calling functions in R, e.g. `group = continent`. It can be used for assignment but we advise against that, in favor of `<-`. A double equal sign `==` is a binary comparison operator, akin to less than `<` or greater than `>`, returning the logical value `TRUE` in the case of equality and `FALSE` otherwise. Although you may not yet understand exactly why, `subset = country == "Colombia"` restricts operation -- scatterplotting, in above examples -- to observations where the country is Colombia.
-->
<p>Let‚Äôs go back to the result of <code>str()</code> to talk about what a data frame is.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tibble [1,704 √ó 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ country  : Factor w/ 142 levels &quot;Afghanistan&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ continent: Factor w/ 5 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372..</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</span></span></code></pre></div>
<p>A data frame is a special case of a <em>list</em>, which is used in R to hold just about anything. Data frames are a special case where the length of each list component is the same. Data frames are superior to matrices in R because they can hold vectors of different flavors, e.g.¬†numeric, character, and categorical data can be stored together. This comes up a lot!</p>
</div>
<div id="look-at-the-variables-inside-a-data-frame" class="section level2 hasAnchor" number="16.5">
<h2 class="hasAnchor"><span class="header-section-number">16.5</span> Look at the variables inside a data frame<a href="#look-at-the-variables-inside-a-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To specify a single variable from a data frame, use the dollar sign <code>$</code>. Let‚Äôs explore the numeric variable for life expectancy.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 28.8 30.3 32.0 34.0 36.1 38.4</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    23.6    48.2    60.7    59.5    70.8    82.6</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(gapminder<span class="sc">$</span>lifeExp)</span></code></pre></div>
<p><img src="0202_datafeeding_files/figure-html/histogram-lifeExp-1.png" width="672" /></p>
<p>The year variable is an integer variable, but since there are so few unique values it also functions a bit like a categorical variable.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gapminder<span class="sc">$</span>year)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1952    1966    1980    1980    1993    2007</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gapminder<span class="sc">$</span>year)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 2002 2007 </span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  142  142  142  142  142  142  142  142  142  142  142  142</span></span></code></pre></div>
<p>The variables for country and continent hold truly categorical information, which is stored as a <em>factor</em> in R.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gapminder<span class="sc">$</span>continent)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;factor&quot;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gapminder<span class="sc">$</span>continent)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Africa Americas     Asia   Europe  Oceania </span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      624      300      396      360       24</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(gapminder<span class="sc">$</span>continent)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Africa&quot;   &quot;Americas&quot; &quot;Asia&quot;     &quot;Europe&quot;   &quot;Oceania&quot;</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(gapminder<span class="sc">$</span>continent)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<p>The <strong>levels</strong> of the factor <code>continent</code> are ‚ÄúAfrica‚Äù, ‚ÄúAmericas‚Äù, etc. and this is what‚Äôs usually presented to your eyeballs by R. In general, the levels are friendly human-readable character strings, like ‚Äúmale/female‚Äù and ‚Äúcontrol/treated‚Äù. But <em>never ever ever</em> forget that, under the hood, R is really storing integer codes 1, 2, 3, etc. Look at the result from <code>str(gapminder$continent)</code> if you are skeptical.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder<span class="sc">$</span>continent)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Factor w/ 5 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...</span></span></code></pre></div>
<p>This <a href="https://en.wikipedia.org/wiki/Janus">Janus</a>-like nature of factors means they are rich with booby traps for the unsuspecting but they are a necessary evil. I recommend you resolve to learn how to <a href="#factors-boss">properly care and feed for factors</a>. The pros far outweigh the cons. Specifically in modelling and figure-making, factors are anticipated and accommodated by the functions and packages you will want to exploit.</p>
<p>Here we count how many observations are associated with each continent and, as usual, try to portray that info visually. This makes it much easier to quickly see that African countries are well represented in this dataset.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gapminder<span class="sc">$</span>continent)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Africa Americas     Asia   Europe  Oceania </span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      624      300      396      360       24</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(gapminder<span class="sc">$</span>continent))</span></code></pre></div>
<p><img src="0202_datafeeding_files/figure-html/tabulate-continent-1.png" width="672" /></p>
<p>In the figures below, we see how factors can be put to work in figures. The <code>continent</code> factor is easily mapped into ‚Äúfacets‚Äù or colors and a legend by the ggplot2 package. <em>Making figures with ggplot2 is covered a bit later. So feel free to just sit back and enjoy these plots or mindlessly copy/paste.</em></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## we exploit the fact that ggplot2 was installed and loaded via the tidyverse</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(gapminder, continent <span class="sc">!=</span> <span class="st">&quot;Oceania&quot;</span>),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="co"># just initializes</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="co"># log the x axis the right way</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="co"># scatterplot</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent)) <span class="co"># map continent to color</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚Ñπ Please use `linewidth` instead.</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> continent) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="0202_datafeeding_files/figure-html/factors-nice-for-plots-1.png" width="49%" /><img src="0202_datafeeding_files/figure-html/factors-nice-for-plots-2.png" width="49%" /><img src="0202_datafeeding_files/figure-html/factors-nice-for-plots-3.png" width="49%" /><img src="0202_datafeeding_files/figure-html/factors-nice-for-plots-4.png" width="49%" /></p>
<!---JB:
EXERCISES I have used and let languish.
Let's get the data for just 2007.
How many rows?
How many observations per continent?
Scatterplot life expectancy against GDP per capita.
Variants of that: indicate continent by color, do for just one continent, do for multiple continents at once but in separate plots

```r
hDat <- subset(gapminder, subset = year == 2007)
str(hDat)
#> tibble [142 √ó 6] (S3: tbl_df/tbl/data.frame)
#>  $ country  : Factor w/ 142 levels "Afghanistan",..: 1 2 3 4 5 6 7 8 9 10 ...
#>  $ continent: Factor w/ 5 levels "Africa","Americas",..: 3 4 1 1 2 5 4 3 3 4 ...
#>  $ year     : int [1:142] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...
#>  $ lifeExp  : num [1:142] 43.8 76.4 72.3 42.7 75.3 ...
#>  $ pop      : int [1:142] 31889923 3600523 33333216 12420476 40301927 20434176..
#>  $ gdpPercap: num [1:142] 975 5937 6223 4797 12779 ...
table(hDat$continent)
#> 
#>   Africa Americas     Asia   Europe  Oceania 
#>       52       25       33       30        2
#xyplot(lifeExp ~ gdpPercap, hDat)
#xyplot(lifeExp ~ gdpPercap, hDat, group = continent, auto.key = TRUE)
#xyplot(lifeExp ~ gdpPercap | continent, hDat)
```
## if you want just some rows and/or just some variables, for inspection or to
## assign as a new object, use subset()
subset(gapminder, subset = country == "Cambodia")
subset(gapminder, subset = country %in% c("Japan", "Belgium"))
subset(gapminder, subset = year == 1952)
subset(gapminder, subset = country == "Uruguay", select = c(country, year, lifeExp))

plot(lifeExp ~ year, gapminder, subset = country == "Zimbabwe")
plot(lifeExp ~ log(gdpPercap), gapminder, subset = year == 2007)

## exercise:
## get data for which life expectancy is less than 32 years
## assign to an object
## how many rows? how many observations per continent?
--->
</div>
<div id="recap" class="section level2 hasAnchor" number="16.6">
<h2 class="hasAnchor"><span class="header-section-number">16.6</span> Recap<a href="#recap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Use data frames!!!</p></li>
<li><p>Use the <a href="https://tidyverse.tidyverse.org">tidyverse</a>!!! This will provide a special type of data frame called a ‚Äútibble‚Äù that has nice default printing behavior, among other benefits.</p></li>
<li><p>When in doubt, <code>str()</code> something or print something.</p></li>
<li><p>Always understand the basic extent of your data frames: number of rows and columns.</p></li>
<li><p>Understand what flavor the variables are.</p></li>
<li><p>Use factors!!! But with intention and care.</p></li>
<li><p>Do basic statistical and visual sanity checking of each variable.</p></li>
<li><p>Refer to variables by name, e.g., <code>gapminder$lifeExp</code>, not by column number. Your code will be more hardy and readable.</p></li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0202_datafeeding.Rmd-->
</div>
</div>
<div id="lab02" class="section level1 hasAnchor" number="17">
<h1 class="hasAnchor"><span class="header-section-number">17</span> Lab: Global plastic waste<a href="#lab02" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Plastic pollution is a major and growing problem, negatively affecting oceans and wildlife health. <a href="https://ourworldindata.org/plastic-pollution">Our World in Data</a> has a lot of great data at various levels including globally, per country, and over time. For this lab, we focus on data from 2010.</p>
<p>Additionally, National Geographic ran a data visualization communication contest on plastic waste as seen <a href="https://www.nationalgeographic.org/funding-opportunities/innovation-challenges/plastic/dataviz/">here</a>.</p>
<div id="learning-goals" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Learning goals<a href="#learning-goals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Visualizing numerical and categorical data and interpreting visualizations</li>
<li>Recreating visualizations</li>
<li>Getting more practice using with R, RStudio, Git, and GitHub</li>
</ul>
</div>
<div id="getting-started-1" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Getting started<a href="#getting-started-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go to the course GitHub organization and locate the assignment repo template, which should be named <code>lab-02-plastic-waste</code>. If you‚Äôre in the right place, it should look like the following.</p>
<p><img src="img/repo-begin.png" width="1329" /></p>
<p>Fork or use the template to make your own repo, and then clone it in RStudio.</p>
<p>First, open the R Markdown document <code>lab-02.Rmd</code> and Knit it. Make sure it compiles without errors. The output will be in the file markdown <code>.md</code> file with the same name.</p>
<div id="packages-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Packages<a href="#packages-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We‚Äôll use the <strong>tidyverse</strong> package for this analysis. Run the following code in the Console to load this package.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Data<a href="#data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The dataset for this assignment can be found as a csv file in the <code>data</code> folder of your repository. You can read it in using the following.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>plastic_waste <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/plastic-waste.csv&quot;</span>)</span></code></pre></div>
<p>The variable descriptions are as follows:</p>
<ul>
<li><code>code</code>: 3 Letter country code</li>
<li><code>entity</code>: Country name</li>
<li><code>continent</code>: Continent name</li>
<li><code>year</code>: Year</li>
<li><code>gdp_per_cap</code>: GDP per capita constant 2011 international $, rate</li>
<li><code>plastic_waste_per_cap</code>: Amount of plastic waste per capita in kg/day</li>
<li><code>mismanaged_plastic_waste_per_cap</code>: Amount of mismanaged plastic waste per capita in kg/day</li>
<li><code>mismanaged_plastic_waste</code>: Tonnes of mismanaged plastic waste</li>
<li><code>coastal_pop</code>: Number of individuals living on/near coast</li>
<li><code>total_pop</code>: Total population according to Gapminder</li>
</ul>
</div>
</div>
<div id="warm-up-1" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Warm up<a href="#warm-up-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Recall that RStudio is divided into four panes. Without looking, can you name them all and briefly describe their purpose?</li>
<li>Verify that the dataset has loaded into the Environment. How many observations are in the dataset? Clicking on the dataset in the Environment will allow you to inspect it more carefully. Alternatively, you can type <code>View(plastic_waste)</code> into the Console to do this.</li>
</ul>
<blockquote>
<p><strong>Hint:</strong> If you‚Äôre not sure, run the command <code>?NA</code> which will lead you to the documentation.</p>
</blockquote>
<ul>
<li>Have a quick look at the data and notice that there are cells taking the value <code>NA</code> ‚Äì what does this mean?</li>
</ul>
</div>
<div id="exercises-1" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Exercises<a href="#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs start by taking a look at the distribution of plastic waste per capita in 2010.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plastic_waste, <span class="fu">aes</span>(<span class="at">x =</span> plastic_waste_per_cap)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 51 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="0203_lab_plasticwaste_files/figure-html/plastic_waste_per_cap-hist-1.png" width="672" /></p>
<p>One country stands out as an unusual observation at the top of the distribution. One way of identifying this country is to filter the data for countries where plastic waste per capita is greater than 3.5 kg/person.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>plastic_waste <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(plastic_waste_per_cap <span class="sc">&gt;</span> <span class="fl">3.5</span>)</span></code></pre></div>
<pre><code>##   code              entity     continent year gdp_per_cap plastic_waste_per_cap
## 1  TTO Trinidad and Tobago North America 2010    31260.91                   3.6
##   mismanaged_plastic_waste_per_cap mismanaged_plastic_waste coastal_pop
## 1                             0.19                    94066     1358433
##   total_pop
## 1   1341465</code></pre>
<p>Did you expect this result? You might consider doing some research on Trinidad and Tobago to see why plastic waste per capita is so high there, or whether this is a data error.</p>
<p>1.1. Plot, using histograms, the distribution of plastic waste per capita faceted by continent. What can you say about how the continents compare to each other in terms of their plastic waste per capita?</p>
<blockquote>
<p><strong>NOTE:</strong> From this point onwards, the plots and the output of the code are not displayed in the lab instructions, but you can and should the code and view the results yourself.</p>
</blockquote>
<p>Another way of visualizing numerical data is using density plots.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plastic_waste,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> plastic_waste_per_cap)) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p>And compare distributions across continents by coloring density curves by continent.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plastic_waste, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> plastic_waste_per_cap, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p>The resulting plot may be a little difficult to read, so let‚Äôs also fill the curves in with colors as well.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plastic_waste, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> plastic_waste_per_cap, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> continent, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p>The overlapping colors make it difficult to tell what‚Äôs happening with the distributions. The first plotted in continents get covered by continents plotted over them.</p>
<p>We can change the transparency level of the fill color to help with this problem.</p>
<p>The <code>alpha</code> argument takes values between 0 and 1: 0 is completely transparent and 1 is completely opaque. There is no way to tell what value will work best, so you just need to try a few.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plastic_waste, </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> plastic_waste_per_cap, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> continent, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p>This plot still doesn‚Äôt look great‚Ä¶</p>
<p>2.1. Recreate the density plots above using a different (lower) alpha level that works better for displaying the density curves for all continents.</p>
<p>2.2. Describe why we defined the <code>color</code> and <code>fill</code> of the curves by mapping aesthetics of the plot but we defined the <code>alpha</code> level as a characteristic of the plotting geom.</p>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>Now is a good time to knit your document and commit and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<p>And yet another way to visualize this relationship is using side-by-side box plots.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plastic_waste, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> continent, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> plastic_waste_per_cap)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p>3.1. Convert your side-by-side box plots from the previous task to <a href="http://ggplot2.tidyverse.org/reference/geom_violin.html">violin plots</a>. What do the violin plots reveal that box plots do not? What features are apparent in the box plots but not in the violin plots?</p>
<blockquote>
<p><strong>Remember:</strong> We use <code>geom_point()</code> to make scatterplots.</p>
</blockquote>
<p>4.1. Visualize the relationship between plastic waste per capita and mismanaged plastic waste per capita using a scatterplot. Describe the relationship.</p>
<p>4.2. Color the points in the scatterplot by continent. Does there seem to be any clear distinctions between continents with respect to how plastic waste per capita and mismanaged plastic waste per capita are associated?</p>
<p>4.3. Visualize the relationship between plastic waste per capita and total population as well as plastic waste per capita and coastal population. You will need to make two separate plots. Do either of these pairs of variables appear to be more strongly linearly associated?</p>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>Now is another good time to knit your document and commit and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
</div>
<div id="wrapping-up" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Wrapping up<a href="#wrapping-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you still have some time left, move on to the remaining exercises below.</p>
<blockquote>
<p><strong>Hint:</strong> The x-axis is a calculated variable. One country with plastic waste per capita over 3 kg/day has been filtered out. And the data are not only represented with points on the plot but also a smooth curve. The term ‚Äúsmooth‚Äù should help you <a href="https://ggplot2.tidyverse.org/reference/index.html#section-geoms">pick which geom to use</a>.</p>
</blockquote>
<p>5.1. Recreate the following plot, and interpret what you see in context of the data.</p>
<p><img src="0203_lab_plasticwaste_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è Knit, <em>commit, and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards and review the md document on GitHub to make sure you‚Äôre happy with the final state of your work.</em></p>
<p>Once you‚Äôre done, check to make sure your latest changes are on GitHub and readable.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p><img src="img/repo-end.png" width="1329" /></p>
<!--chapter:end:0203_lab_plasticwaste.Rmd-->
</div>
</div>
<div id="part-module-03" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 03<a href="#part-module-03" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-the-tidyverse" class="section level1 hasAnchor" number="18">
<h1 class="hasAnchor"><span class="header-section-number">18</span> Welcome to the tidyverse!<a href="#welcome-to-the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce you to the key ideas of data wrangling and the grammar of tidyverse. In essence, data wrangling is the process of transforming and mapping data from one ‚Äúraw‚Äù data form into a better-suited format. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYaHmjzdRvfg0yhOIYQnfjwE">here</a>. The slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-2" class="section level2 hasAnchor" number="18.1">
<h2 class="hasAnchor"><span class="header-section-number">18.1</span> Module Materials<a href="#module-materials-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d07_tidy/d07_tidy.html">Tidy data</a></li>
<li><a href="https://datascience4psych.github.io/slides/d08_grammar/d08_grammar.html">Grammar of data wrangling</a></li>
<li><a href="https://datascience4psych.github.io/slides/d09_wrangle/d09_wrangle.html">Hands on Data Wrangling</a></li>
<li><a href="https://datascience4psych.github.io/slides/d10_dfs/d10_dfs.html">Working with Multiple Data Frames</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module, including
<ul>
<li><a href="#dplyr_intro">Introduction to dplyr</a></li>
<li><a href="#merges">Merges on Github</a></li>
</ul></li>
<li>R4DS
<ul>
<li><a href="https://r4ds.had.co.nz/wrangle-intro.html">Data Wrangling</a>, including
<ul>
<li><a href="https://r4ds.had.co.nz/tidy-data.html">Tidy Data</a></li>
<li><a href="https://r4ds.had.co.nz/pipes.html">Pipes</a></li>
</ul></li>
</ul></li>
</ul></li>
<li>Activities
<ul>
<li><a href="https://github.com/DataScience4Psych/ae-04-hotels-datawrangling">Hotels!</a></li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab03">Nobel Laureates</a></li>
</ul></li>
</ul>
</div>
<div id="estimated-video-length-2" class="section level2 hasAnchor" number="18.2">
<h2 class="hasAnchor"><span class="header-section-number">18.2</span> Estimated Video Length<a href="#estimated-video-length-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--https://ytplaylist-len.herokuapp.com/ -->
<p>No of videos : 8</p>
<p>Average length of video : 14 minutes, 11 seconds</p>
<p>Total length of playlist : 1 hour, 53 minutes, 34 seconds</p>
</div>
</div>
<div id="tidy-data" class="section level1 hasAnchor" number="19">
<h1 class="hasAnchor"><span class="header-section-number">19</span> Tidy data<a href="#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d07_tidy/d07_tidy.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/wdDKr92ZT3s" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d07_tidy/d07_tidy.html" width="672" height="400px" data-external="1">
</iframe>
<div id="data-structures-in-r" class="section level2 hasAnchor" number="19.1">
<h2 class="hasAnchor"><span class="header-section-number">19.1</span> Data structures in R<a href="#data-structures-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/fE2zILoY53Y" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d07_tidy/d07_tidy.html#11" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="grammar-of-data-wrangling" class="section level1 hasAnchor" number="20">
<h1 class="hasAnchor"><span class="header-section-number">20</span> Grammar of data wrangling<a href="#grammar-of-data-wrangling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d08_grammar/d08_grammar.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/XLj1sJWIv84" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d08_grammar/d08_grammar.html" width="672" height="400px" data-external="1">
</iframe>
<div id="piping" class="section level2 hasAnchor" number="20.1">
<h2 class="hasAnchor"><span class="header-section-number">20.1</span> Piping<a href="#piping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/nOrblReuiiA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d08_grammar/d08_grammar.html#19" width="672" height="400px" data-external="1">
</iframe>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0301_tools.Rmd-->
</div>
</div>
<div id="dplyr_intro" class="section level1 hasAnchor" number="21">
<h1 class="hasAnchor"><span class="header-section-number">21</span> Introduction to dplyr<a href="#dplyr_intro" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--Original content: https://stat545.com/block009_dplyr-intro.html-->
<!-- add me: https://allisonhorst.shinyapps.io/dplyr-learnr/ -->
<p><a href="https://dplyr.tidyverse.org">dplyr</a> is a package for data manipulation, developed by Hadley Wickham and Romain Francois. It is built to be fast, highly expressive, and open-minded about how your data is stored. It is installed as part of the <a href="https://tidyverse.tidyverse.org">tidyverse</a> meta-package and, as a core package, it is among those loaded via <code>library(tidyverse)</code>.</p>
<p>dplyr‚Äôs roots are in an earlier package called <a href="http://plyr.had.co.nz">plyr</a>, which implements the <a href="https://www.jstatsoft.org/article/view/v040i01">‚Äúsplit-apply-combine‚Äù strategy for data analysis</a> <span class="citation">(<a href="#ref-wickham2011a" role="doc-biblioref">Hadley Wickham 2011b</a>)</span>. Where plyr covers a diverse set of inputs and outputs (e.g., arrays, data frames, lists), dplyr has a laser-like focus on data frames or, in the tidyverse, ‚Äútibbles‚Äù. dplyr is a package-level treatment of the <code>ddply()</code> function from plyr, because ‚Äúdata frame in, data frame out‚Äù proved to be so incredibly important.</p>
<p>Have no idea what I‚Äôm talking about? Not sure if you care? If you use these base R functions: <code>subset()</code>, <code>apply()</code>, <code>[sl]apply()</code>, <code>tapply()</code>, <code>aggregate()</code>, <code>split()</code>, <code>do.call()</code>, <code>with()</code>, <code>within()</code>, then you should keep reading. Also, if you use <code>for()</code> loops a lot, you might enjoy learning other ways to iterate over rows or groups of rows or variables in a data frame.</p>
<div id="load-dplyr-and-gapminder" class="section level3 hasAnchor" number="21.0.1">
<h3 class="hasAnchor"><span class="header-section-number">21.0.1</span> Load dplyr and gapminder<a href="#load-dplyr-and-gapminder" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I choose to load the tidyverse, which will load dplyr, among other packages we‚Äôll use incidentally below.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2 ‚îÄ‚îÄ</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî ggplot2 3.4.0      ‚úî purrr   1.0.0 </span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tibble  3.1.8      ‚úî dplyr   1.0.10</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tidyr   1.2.1      ‚úî stringr 1.5.0 </span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî readr   2.1.3      ‚úî forcats 0.5.2 </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::filter() masks stats::filter()</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::lag()    masks stats::lag()</span></span></code></pre></div>
<p>Also load gapminder.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
</div>
<div id="say-hello-to-the-gapminder-tibble" class="section level3 hasAnchor" number="21.0.2">
<h3 class="hasAnchor"><span class="header-section-number">21.0.2</span> Say hello to the <code>gapminder</code> tibble<a href="#say-hello-to-the-gapminder-tibble" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>gapminder</code> data frame is a special kind of data frame: a tibble.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>gapminder</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,704 √ó 6</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1,694 more rows</span></span></code></pre></div>
<p>It‚Äôs tibble-ness is why we get nice compact printing. For a reminder of the problems with base data frame printing, go type <code>iris</code> in the R Console or, better yet, print a data frame to screen that has lots of columns.</p>
<p>Note how <code>gapminder</code>‚Äôs <code>class()</code> includes <code>tbl_df</code>; the ‚Äútibble‚Äù terminology is a nod to this.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gapminder)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</span></span></code></pre></div>
<p>Some functions, like <code>print()</code>, know about tibbles and do something special. However, other functions do not, like <code>summary()</code>. In those cases, the tibble will be treated the same as a regular data because every tibble is also a regular data frame.</p>
<p>To turn any data frame into a tibble, use <code>as_tibble()</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(iris)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 150 √ó 5</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3          4.7         3.2          1.3         0.2 setosa </span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4          4.6         3.1          1.5         0.2 setosa </span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5          5           3.6          1.4         0.2 setosa </span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6          5.4         3.9          1.7         0.4 setosa </span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7          4.6         3.4          1.4         0.3 setosa </span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8          5           3.4          1.5         0.2 setosa </span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9          4.4         2.9          1.4         0.2 setosa </span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10          4.9         3.1          1.5         0.1 setosa </span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 140 more rows</span></span></code></pre></div>
</div>
<div id="think-before-you-create-excerpts-of-your-data" class="section level2 hasAnchor" number="21.1">
<h2 class="hasAnchor"><span class="header-section-number">21.1</span> Think before you create excerpts of your data ‚Ä¶<a href="#think-before-you-create-excerpts-of-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you feel the urge to store a little snippet of your data:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>(canada <span class="ot">&lt;-</span> gapminder[<span class="dv">241</span><span class="sc">:</span><span class="dv">252</span>, ])</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 6</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Canada  Americas   1952    68.8 14785584    11367.</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Canada  Americas   1957    70.0 17010154    12490.</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Canada  Americas   1962    71.3 18985849    13462.</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Canada  Americas   1967    72.1 20819767    16077.</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Canada  Americas   1972    72.9 22284500    18971.</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Canada  Americas   1977    74.2 23796400    22091.</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Canada  Americas   1982    75.8 25201900    22899.</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Canada  Americas   1987    76.9 26549700    26627.</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Canada  Americas   1992    78.0 28523502    26343.</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Canada  Americas   1997    78.6 30305843    28955.</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 Canada  Americas   2002    79.8 31902268    33329.</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 Canada  Americas   2007    80.7 33390141    36319.</span></span></code></pre></div>
<p>Stop and ask yourself ‚Ä¶</p>
<blockquote>
<p>Do I want to create mini datasets for each level of some factor (or unique combination of several factors) ‚Ä¶ in order to compute or graph something?</p>
</blockquote>
<p>If YES, <strong>use proper data aggregation techniques</strong> or faceting in ggplot2 ‚Äì <strong>don‚Äôt subset the data</strong>. Or, more realistic, only subset the data as a temporary measure while you develop your elegant code for computing on or visualizing these data subsets.</p>
<p>If NO, then maybe you really do need to store a copy of a subset of the data. But seriously consider whether you can achieve your goals by simply using the <code>subset =</code> argument of, e.g., the <code>lm()</code> function, to limit computation to your excerpt of choice. Lots of functions offer a <code>subset =</code> argument!</p>
<p>Copies and excerpts of your data clutter your workspace, invite mistakes, and sow general confusion. Avoid whenever possible.</p>
<p>Reality can also lie somewhere in between. You will find the workflows presented below can help you accomplish your goals with minimal creation of temporary, intermediate objects.</p>
</div>
<div id="use-filter-to-subset-data-row-wise" class="section level2 hasAnchor" number="21.2">
<h2 class="hasAnchor"><span class="header-section-number">21.2</span> Use <code>filter()</code> to subset data row-wise<a href="#use-filter-to-subset-data-row-wise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>filter()</code> takes logical expressions and returns the rows for which all are <code>TRUE</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, lifeExp <span class="sc">&lt;</span> <span class="dv">29</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 √ó 6</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   country     continent  year lifeExp     pop gdpPercap</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Afghanistan Asia       1952    28.8 8425333      779.</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Rwanda      Africa     1992    23.6 7290203      737.</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, country <span class="sc">==</span> <span class="st">&quot;Rwanda&quot;</span>, year <span class="sc">&gt;</span> <span class="dv">1979</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 6</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   country continent  year lifeExp     pop gdpPercap</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Rwanda  Africa     1982    46.2 5507565      882.</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Rwanda  Africa     1987    44.0 6349365      848.</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Rwanda  Africa     1992    23.6 7290203      737.</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Rwanda  Africa     1997    36.1 7212583      590.</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Rwanda  Africa     2002    43.4 7852401      786.</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Rwanda  Africa     2007    46.2 8860588      863.</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Rwanda&quot;</span>, <span class="st">&quot;Afghanistan&quot;</span>))</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 24 √ó 6</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.</span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 14 more rows</span></span></code></pre></div>
<p>Compare with some base R code to accomplish the same things:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>gapminder[gapminder<span class="sc">$</span>lifeExp <span class="sc">&lt;</span> <span class="dv">29</span>, ] <span class="do">## repeat `gapminder`, [i, j] indexing is distracting</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(gapminder, country <span class="sc">==</span> <span class="st">&quot;Rwanda&quot;</span>) <span class="do">## almost same as filter; quite nice actually</span></span></code></pre></div>
<p>Under no circumstances should you subset your data the way I did at first:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>excerpt <span class="ot">&lt;-</span> gapminder[<span class="dv">241</span><span class="sc">:</span><span class="dv">252</span>, ]</span></code></pre></div>
<p>Why is this approach a terrible idea?</p>
<ul>
<li>It is not self-documenting. What is so special about rows 241 through 252?</li>
<li>It is fragile. This line of code will produce different results if someone changes the row order of <code>gapminder</code>, e.g.¬†sorts the data earlier in the script.</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, country <span class="sc">==</span> <span class="st">&quot;Canada&quot;</span>)</span></code></pre></div>
<p>This call explains itself and is fairly robust.</p>
</div>
<div id="meet-the-new-pipe-operator" class="section level2 hasAnchor" number="21.3">
<h2 class="hasAnchor"><span class="header-section-number">21.3</span> Meet the new pipe operator<a href="#meet-the-new-pipe-operator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we go any further, we should exploit the new pipe operator that the tidyverse imports from the <a href="https://magrittr.tidyverse.org">magrittr</a> package by Stefan Bache. This is going to change your data analytical life. You no longer need to enact multi-operation commands by nesting them inside each other, like so many <a href="https://en.wikipedia.org/wiki/Matryoshka_doll">Russian nesting dolls</a>. This new syntax leads to code that is much easier to write and to read.</p>
<p>Here‚Äôs what it looks like: <code>%&gt;%</code>. The RStudio keyboard shortcut: Ctrl+Shift+M (Windows), Cmd+Shift+M (Mac).</p>
<p>Let‚Äôs demo, then I‚Äôll explain.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 6</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Afghanistan Asia       1977    38.4 14880372      786.</span></span></code></pre></div>
<p>This code is equivalent to <code>head(gapminder)</code>. The pipe operator takes the thing on the left-hand-side and <strong>pipes</strong> it into the function call on the right-hand-side ‚Äì literally, drops it in as the first argument.</p>
<p>Never fear, you can still specify other arguments to this function! To see the first 3 rows of <code>gapminder</code>, we could say <code>head(gapminder, 3)</code> or this:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 √ó 6</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Afghanistan Asia       1962    32.0 10267083      853.</span></span></code></pre></div>
<p>I‚Äôve advised you to think ‚Äúgets‚Äù whenever you see the assignment operator, <code>&lt;-</code>. Similarly, you should think ‚Äúthen‚Äù whenever you see the pipe operator, <code>%&gt;%</code>.</p>
<p>You are probably not impressed yet, but the magic will soon happen.</p>
</div>
<div id="use-select-to-subset-the-data-on-variables-or-columns." class="section level2 hasAnchor" number="21.4">
<h2 class="hasAnchor"><span class="header-section-number">21.4</span> Use <code>select()</code> to subset the data on variables or columns.<a href="#use-select-to-subset-the-data-on-variables-or-columns." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Back to dplyr‚Ä¶.</p>
<p>Use <code>select()</code> to subset the data on variables or columns. Here‚Äôs a conventional call:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(gapminder, year, lifeExp)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,704 √ó 2</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     year lifeExp</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1952    28.8</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  1957    30.3</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  1962    32.0</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  1967    34.0</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  1972    36.1</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  1977    38.4</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  1982    39.9</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  1987    40.8</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  1992    41.7</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1997    41.8</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1,694 more rows</span></span></code></pre></div>
<p>And here‚Äôs the same operation, but written with the pipe operator and piped through <code>head()</code>:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">4</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 √ó 2</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year lifeExp</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  1952    28.8</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  1957    30.3</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  1962    32.0</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  1967    34.0</span></span></code></pre></div>
<p>Think: ‚ÄúTake <code>gapminder</code>, then select the variables year and lifeExp, then show the first 4 rows.‚Äù</p>
</div>
<div id="revel-in-the-convenience" class="section level2 hasAnchor" number="21.5">
<h2 class="hasAnchor"><span class="header-section-number">21.5</span> Revel in the convenience<a href="#revel-in-the-convenience" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here‚Äôs the data for Cambodia, but only certain variables:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Cambodia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, lifeExp)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 2</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     year lifeExp</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1952    39.4</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  1957    41.4</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  1962    43.4</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  1967    45.4</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  1972    40.3</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  1977    31.2</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  1982    51.0</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  1987    53.9</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  1992    55.8</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1997    56.5</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2002    56.8</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2007    59.7</span></span></code></pre></div>
<p>and what a typical base R call would look like:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>gapminder[gapminder<span class="sc">$</span>country <span class="sc">==</span> <span class="st">&quot;Cambodia&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;lifeExp&quot;</span>)]</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 2</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     year lifeExp</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1952    39.4</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  1957    41.4</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  1962    43.4</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  1967    45.4</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  1972    40.3</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  1977    31.2</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  1982    51.0</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  1987    53.9</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  1992    55.8</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1997    56.5</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2002    56.8</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2007    59.7</span></span></code></pre></div>
</div>
<div id="pure-predictable-pipeable" class="section level2 hasAnchor" number="21.6">
<h2 class="hasAnchor"><span class="header-section-number">21.6</span> Pure, predictable, pipeable<a href="#pure-predictable-pipeable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We‚Äôve barely scratched the surface of dplyr but I want to point out key principles you may start to appreciate. If you‚Äôre new to R or ‚Äúprogramming with data‚Äù, feel free skip this section and <a href="#handson">move on</a>.</p>
<p>dplyr‚Äôs verbs, such as <code>filter()</code> and <code>select()</code>, are what‚Äôs called <a href="https://en.wikipedia.org/wiki/Pure_function">pure functions</a>. To quote from Wickham‚Äôs <a href="http://adv-r.had.co.nz/Functions.html">Advanced R Programming book</a> <span class="citation">(<a href="#ref-wickham2015a" role="doc-biblioref">2015</a>)</span>:</p>
<blockquote>
<p>The functions that are the easiest to understand and reason about are pure functions: functions that always map the same input to the same output and have no other impact on the workspace. In other words, pure functions have no side effects: they don‚Äôt affect the state of the world in any way apart from the value they return.</p>
</blockquote>
<p>In fact, these verbs are a special case of pure functions: they take the same flavor of object as input and output. Namely, a data frame or one of the other data receptacles dplyr supports.</p>
<p>And finally, the data is <strong>always</strong> the very first argument of the verb functions.</p>
<p>These design choices are deliberate. When combined with the new pipe operator, the result is a highly effective, low friction <a href="http://adv-r.had.co.nz/dsl.html">domain-specific language</a> for data analysis.</p>
<p>Furthermore, <a href="https://www.rstudio.com/resources/cheatsheets/">cheatsheets</a> are really great resources to learn functions. Click the link to download it!</p>
<p>Go to the next <a href="#handson">section</a>, for more dplyr!</p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0302_dplyr.Rmd-->
</div>
</div>
<div id="handson" class="section level1 hasAnchor" number="22">
<h1 class="hasAnchor"><span class="header-section-number">22</span> Hands on Data Wrangling<a href="#handson" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="working-with-a-single-data-frame" class="section level2 hasAnchor" number="22.1">
<h2 class="hasAnchor"><span class="header-section-number">22.1</span> Working with a single data frame<a href="#working-with-a-single-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/eeKBSjv7K6E" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d09_wrangle/d09_wrangle.html">here</a>) if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d09_wrangle/d09_wrangle.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="activity-04-hotels" class="section level2 hasAnchor" number="22.2">
<h2 class="hasAnchor"><span class="header-section-number">22.2</span> Activity 04: Hotels!<a href="#activity-04-hotels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe src="https://datascience4psych.github.io/slides/d09_wrangle/d09_wrangle.html#18" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Hotels activity <a href="https://github.com/DataScience4Psych/ae-04-hotels-datawrangling">here</a>. The compiled version should look something like the following‚Ä¶</p>
<iframe src="https://datascience4psych.github.io/ae-04-hotels-datawrangling/hotels-datawrangling.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="dplyr_single" class="section level2 hasAnchor" number="22.3">
<h2 class="hasAnchor"><span class="header-section-number">22.3</span> ODD: Single table dplyr functions<a href="#dplyr_single" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This optional deep dive covers more detail on dplyr.</p>
<!--Original content: https://stat545.com/block010_dplyr-end-single-table.html-->
<p>Previously, on <a href="#dplyr_intro">Introduction to dplyr</a>, we used two very important verbs and an operator:</p>
<ul>
<li><code>filter()</code> for subsetting data with row logic</li>
<li><code>select()</code> for subsetting data variable- or column-wise</li>
<li>the pipe operator <code>%&gt;%</code>, which feeds the LHS as the first argument to the expression on the RHS</li>
</ul>
<p>We also discussed dplyr‚Äôs role inside the tidyverse and tibbles:</p>
<ul>
<li>dplyr is a core package in the <a href="https://github.com/hadley/tidyverse">tidyverse</a> meta-package. Because we often make incidental usage of the others, we will load dplyr and the others via <code>library(tidyverse)</code>.</li>
<li>The tidyverse embraces a special flavor of data frame, called a tibble. The <code>gapminder</code> dataset is stored as a tibble.</li>
</ul>
<p>This time, we‚Äôre going to dive a bit deeper into dplyr.</p>
<div id="load-dplyr-and-gapminder-1" class="section level3 hasAnchor" number="22.3.1">
<h3 class="hasAnchor"><span class="header-section-number">22.3.1</span> Load dplyr and gapminder<a href="#load-dplyr-and-gapminder-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I choose to load the tidyverse, which will load dplyr, among other packages we use incidentally below.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2 ‚îÄ‚îÄ</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî ggplot2 3.4.0      ‚úî purrr   1.0.0 </span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tibble  3.1.8      ‚úî dplyr   1.0.10</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tidyr   1.2.1      ‚úî stringr 1.5.0 </span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî readr   2.1.3      ‚úî forcats 0.5.2 </span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::filter() masks stats::filter()</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::lag()    masks stats::lag()</span></span></code></pre></div>
<p>Also load <code>gapminder.</code></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
</div>
<div id="create-a-copy-of-gapminder" class="section level3 hasAnchor" number="22.3.2">
<h3 class="hasAnchor"><span class="header-section-number">22.3.2</span> Create a copy of <code>gapminder</code><a href="#create-a-copy-of-gapminder" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We‚Äôre going to make changes to the <code>gapminder</code> tibble. To eliminate any fear that you‚Äôre damaging the data that comes with the package, we create an explicit copy of <code>gapminder</code> for our experiments.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(my_gap <span class="ot">&lt;-</span> gapminder)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,704 √ó 6</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1,694 more rows</span></span></code></pre></div>
<p><strong>Pay close attention</strong> to when we evaluate statements but let the output just print to screen:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## let output print to screen, but do not store</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Canada&quot;</span>)</span></code></pre></div>
<p>‚Ä¶ versus when we assign the output to an object, possibly overwriting an existing object.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## store the output as an R object</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>my_precious <span class="ot">&lt;-</span> my_gap <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Canada&quot;</span>)</span></code></pre></div>
</div>
<div id="use-mutate-to-add-new-variables" class="section level3 hasAnchor" number="22.3.3">
<h3 class="hasAnchor"><span class="header-section-number">22.3.3</span> Use <code>mutate()</code> to add new variables<a href="#use-mutate-to-add-new-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Imagine we wanted to recover each country‚Äôs GDP. After all, the Gapminder data has a variable for population and GDP per capita. Let‚Äôs multiply them together.</p>
<p><code>mutate()</code> is a function that defines and inserts new variables into a tibble. You can refer to existing variables by name.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp =</span> pop <span class="sc">*</span> gdpPercap)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,704 √ó 7</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap          gdp</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.  6567086330.</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.  7585448670.</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.  8758855797.</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.  9648014150.</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.  9678553274.</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786. 11697659231.</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978. 12598563401.</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852. 11820990309.</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649. 10595901589.</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635. 14121995875.</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1,694 more rows</span></span></code></pre></div>
<p>Hmmmm ‚Ä¶ those GDP numbers are almost uselessly large and abstract. Consider the <a href="https://fivethirtyeight.com/features/xkcd-randall-munroe-qanda-what-if/">advice of Randall Munroe of xkcd</a>:</p>
<blockquote>
<p>One thing that bothers me is large numbers presented without context‚Ä¶ ‚ÄòIf I added a zero to this number, would the sentence containing it mean something different to me?‚Äô If the answer is ‚Äòno,‚Äô maybe the number has no business being in the sentence in the first place.‚Äù</p>
</blockquote>
<p>Maybe it would be more meaningful to consumers of my tables and figures to stick with GDP per capita. But what if I reported GDP per capita, <em>relative to some benchmark country</em>. Since Canada is my adopted home, I‚Äôll go with that.</p>
<p>I need to create a new variable that is <code>gdpPercap</code> divided by Canadian <code>gdpPercap</code>, taking care that I always divide two numbers that pertain to the same year.</p>
<p>How I achieve this:</p>
<ol style="list-style-type: decimal">
<li>Filter down to the rows for Canada.</li>
<li>Create a new temporary variable in <code>my_gap</code>:
<ol style="list-style-type: lower-roman">
<li>Extract the <code>gdpPercap</code> variable from the Canadian data.</li>
<li>Replicate it once per country in the dataset, so it has the right length.</li>
</ol></li>
<li>Divide raw <code>gdpPercap</code> by this Canadian figure.</li>
<li>Discard the temporary variable of replicated Canadian <code>gdpPercap</code>.</li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>ctib <span class="ot">&lt;-</span> my_gap <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Canada&quot;</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="do">## this is a semi-dangerous way to add this variable</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="do">## I&#39;d prefer to join on year, but we haven&#39;t covered joins yet</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>my_gap <span class="ot">&lt;-</span> my_gap <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tmp =</span> <span class="fu">rep</span>(ctib<span class="sc">$</span>gdpPercap, <span class="fu">nlevels</span>(country)),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdpPercapRel =</span> gdpPercap <span class="sc">/</span> tmp,</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tmp =</span> <span class="cn">NULL</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Note that, <code>mutate()</code> builds new variables sequentially so you can reference earlier ones (like <code>tmp</code>) when defining later ones (like <code>gdpPercapRel</code>). Also, you can get rid of a variable by setting it to <code>NULL</code>.</p>
<p>How could we sanity check that this worked? The Canadian values for <code>gdpPercapRel</code> better all be 1!</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Canada&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, gdpPercapRel)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 3</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country  year gdpPercapRel</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;   &lt;int&gt;        &lt;dbl&gt;</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Canada   1952            1</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Canada   1957            1</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Canada   1962            1</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Canada   1967            1</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Canada   1972            1</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Canada   1977            1</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Canada   1982            1</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Canada   1987            1</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Canada   1992            1</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Canada   1997            1</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 Canada   2002            1</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 Canada   2007            1</span></span></code></pre></div>
<p>I perceive Canada to be a ‚Äúhigh GDP‚Äù country, so I predict that the distribution of <code>gdpPercapRel</code> is located below 1, possibly even well below. Check your intuition!</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_gap<span class="sc">$</span>gdpPercapRel)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.01    0.06    0.17    0.33    0.45    9.53</span></span></code></pre></div>
<p>The relative GDP per capita numbers are, in general, well below 1. We see that most of the countries covered by this dataset have substantially lower GDP per capita, relative to Canada, across the entire time period.</p>
<p>Remember: Trust No One. Including (especially?) yourself. Always try to find a way to check that you‚Äôve done what meant to. Prepare to be horrified.</p>
</div>
<div id="use-arrange-to-row-order-data-in-a-principled-way" class="section level3 hasAnchor" number="22.3.4">
<h3 class="hasAnchor"><span class="header-section-number">22.3.4</span> Use <code>arrange()</code> to row-order data in a principled way<a href="#use-arrange-to-row-order-data-in-a-principled-way" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>arrange()</code> reorders the rows in a data frame. Imagine you wanted this data ordered by year then country, as opposed to by country then year.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year, country)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,704 √ó 7</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent  year lifeExp      pop gdpPercap gdpPercapRel</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.       0.0686</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Albania     Europe     1952    55.2  1282697     1601.       0.141 </span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Algeria     Africa     1952    43.1  9279525     2449.       0.215 </span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Angola      Africa     1952    30.0  4232095     3521.       0.310 </span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Argentina   Americas   1952    62.5 17876956     5911.       0.520 </span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Australia   Oceania    1952    69.1  8691212    10040.       0.883 </span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Austria     Europe     1952    66.8  6927772     6137.       0.540 </span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Bahrain     Asia       1952    50.9   120447     9867.       0.868 </span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Bangladesh  Asia       1952    37.5 46886859      684.       0.0602</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Belgium     Europe     1952    68    8730405     8343.       0.734 </span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1,694 more rows</span></span></code></pre></div>
<p>Or maybe you want just the data from 2007, sorted on life expectancy?</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(lifeExp)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 142 √ó 7</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country                  continent  year lifeExp      pop gdpPercap gdpPerc‚Ä¶¬π</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;                    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Swaziland                Africa     2007    39.6  1133066     4513.    0.124 </span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Mozambique               Africa     2007    42.1 19951656      824.    0.0227</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Zambia                   Africa     2007    42.4 11746035     1271.    0.0350</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Sierra Leone             Africa     2007    42.6  6144562      863.    0.0237</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Lesotho                  Africa     2007    42.6  2012649     1569.    0.0432</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Angola                   Africa     2007    42.7 12420476     4797.    0.132 </span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Zimbabwe                 Africa     2007    43.5 12311143      470.    0.0129</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan              Asia       2007    43.8 31889923      975.    0.0268</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Central African Republic Africa     2007    44.7  4369038      706.    0.0194</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Liberia                  Africa     2007    45.7  3193942      415.    0.0114</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 132 more rows, and abbreviated variable name ¬π‚ÄãgdpPercapRel</span></span></code></pre></div>
<p>Oh, you‚Äôd like to sort on life expectancy in <strong>desc</strong>ending order? Then use <code>desc()</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lifeExp))</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 142 √ó 7</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country          continent  year lifeExp       pop gdpPercap gdpPercapRel</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;            &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Japan            Asia       2007    82.6 127467972    31656.        0.872</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Hong Kong, China Asia       2007    82.2   6980412    39725.        1.09 </span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Iceland          Europe     2007    81.8    301931    36181.        0.996</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Switzerland      Europe     2007    81.7   7554661    37506.        1.03 </span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Australia        Oceania    2007    81.2  20434176    34435.        0.948</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Spain            Europe     2007    80.9  40448191    28821.        0.794</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Sweden           Europe     2007    80.9   9031088    33860.        0.932</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Israel           Asia       2007    80.7   6426679    25523.        0.703</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 France           Europe     2007    80.7  61083916    30470.        0.839</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Canada           Americas   2007    80.7  33390141    36319.        1    </span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 132 more rows</span></span></code></pre></div>
<p>I advise that your analyses NEVER rely on rows or variables being in a specific order. But it‚Äôs still true that human beings write the code and the interactive development process can be much nicer if you reorder the rows of your data as you go along. Also, once you are preparing tables for human eyeballs, it is imperative that you step up and take control of row order.</p>
</div>
<div id="use-rename-to-rename-variables" class="section level3 hasAnchor" number="22.3.5">
<h3 class="hasAnchor"><span class="header-section-number">22.3.5</span> Use <code>rename()</code> to rename variables<a href="#use-rename-to-rename-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When I first cleaned this Gapminder excerpt, I was a <a href="https://en.wikipedia.org/wiki/Camel_case"><code>camelCase</code></a> person, but now I‚Äôm all about <a href="https://en.wikipedia.org/wiki/Snake_case"><code>snake_case</code></a>. So I am vexed by the variable names I chose when I cleaned this data years ago. Let‚Äôs rename some variables!</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">life_exp =</span> lifeExp,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_percap =</span> gdpPercap,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">gdp_percap_rel =</span> gdpPercapRel)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,704 √ó 7</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent  year life_exp      pop gdp_percap gdp_percap_rel</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;    &lt;dbl&gt;    &lt;int&gt;      &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia       1952     28.8  8425333       779.         0.0686</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan Asia       1957     30.3  9240934       821.         0.0657</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan Asia       1962     32.0 10267083       853.         0.0634</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Afghanistan Asia       1967     34.0 11537966       836.         0.0520</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Afghanistan Asia       1972     36.1 13079460       740.         0.0390</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Afghanistan Asia       1977     38.4 14880372       786.         0.0356</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Afghanistan Asia       1982     39.9 12881816       978.         0.0427</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Afghanistan Asia       1987     40.8 13867957       852.         0.0320</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Afghanistan Asia       1992     41.7 16317921       649.         0.0246</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Afghanistan Asia       1997     41.8 22227415       635.         0.0219</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 1,694 more rows</span></span></code></pre></div>
<p>I did NOT assign the post-rename object back to <code>my_gap</code> because that would make the chunks in this tutorial harder to copy/paste and run out of order. In real life, I would probably assign this back to <code>my_gap</code>, in a data preparation script, and proceed with the new variable names.</p>
</div>
<div id="select-can-rename-and-reposition-variables" class="section level3 hasAnchor" number="22.3.6">
<h3 class="hasAnchor"><span class="header-section-number">22.3.6</span> <code>select()</code> can rename and reposition variables<a href="#select-can-rename-and-reposition-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You‚Äôve seen simple use of <code>select()</code>. There are two tricks you might enjoy:</p>
<ol style="list-style-type: decimal">
<li><code>select()</code> can rename the variables you request to keep.</li>
<li><code>select()</code> can be used with <code>everything()</code> to hoist a variable up to the front of the tibble.</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Burundi&quot;</span>, year <span class="sc">&gt;</span> <span class="dv">1996</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">yr =</span> year, lifeExp, gdpPercap) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gdpPercap, <span class="fu">everything</span>())</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 √ó 3</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   gdpPercap    yr lifeExp</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      463.  1997    45.3</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      446.  2002    47.4</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      430.  2007    49.6</span></span></code></pre></div>
<p><code>everything()</code> is one of several helpers for variable selection. Read its help to see the rest.</p>
</div>
<div id="group_by-is-a-mighty-weapon" class="section level3 hasAnchor" number="22.3.7">
<h3 class="hasAnchor"><span class="header-section-number">22.3.7</span> <code>group_by()</code> is a mighty weapon<a href="#group_by-is-a-mighty-weapon" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I have found <del>friends and family</del> collaborators love to ask seemingly innocuous questions like, ‚Äúwhich country experienced the sharpest 5-year drop in life expectancy?‚Äù. In fact, that is a totally natural question to ask. But if you are using a language that doesn‚Äôt know about data, it‚Äôs an incredibly annoying question to answer.</p>
<p>dplyr offers powerful tools to solve this class of problem:</p>
<ul>
<li><code>group_by()</code> adds extra structure to your dataset ‚Äì grouping information ‚Äì which lays the groundwork for computations within the groups.</li>
<li><code>summarize()</code> takes a dataset with <span class="math inline">\(n\)</span> observations, computes requested summaries, and returns a dataset with 1 observation.</li>
<li>Window functions take a dataset with <span class="math inline">\(n\)</span> observations and return a dataset with <span class="math inline">\(n\)</span> observations.</li>
<li><code>mutate()</code> and <code>summarize()</code> will honor groups.</li>
<li>You can also do very general computations on your groups with <code>do()</code>, though elsewhere in this course, I advocate for other approaches that I find more intuitive, using the <a href="https://purrr.tidyverse.org">purrr package</a>.</li>
</ul>
<p>Combined with the verbs you already know, these new tools allow you to solve an extremely diverse set of problems with relative ease.</p>
<div id="counting-things-up" class="section level4 hasAnchor" number="22.3.7.1">
<h4 class="hasAnchor"><span class="header-section-number">22.3.7.1</span> Counting things up<a href="#counting-things-up" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let‚Äôs start with simple counting. How many observations do we have per continent?</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 2</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   continent     n</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;     &lt;int&gt;</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Africa      624</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Americas    300</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Asia        396</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Europe      360</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Oceania      24</span></span></code></pre></div>
<p>Let us pause here to think about the tidyverse. You could get these same frequencies using <code>table()</code> from base R.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gapminder<span class="sc">$</span>continent)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Africa Americas     Asia   Europe  Oceania </span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      624      300      396      360       24</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">table</span>(gapminder<span class="sc">$</span>continent))</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  &#39;table&#39; int [1:5(1d)] 624 300 396 360 24</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;dimnames&quot;)=List of 1</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ : chr [1:5] &quot;Africa&quot; &quot;Americas&quot; &quot;Asia&quot; &quot;Europe&quot; ...</span></span></code></pre></div>
<p>But the object of class <code>table</code> that is returned makes downstream computation a bit fiddlier than you‚Äôd like. For example, it‚Äôs too bad the continent levels come back only as <em>names</em> and not as a proper factor, with the original set of levels. This is an example of how the tidyverse smooths transitions where you want the output of step <code>i</code> to become the input of step <code>i + 1</code>.</p>
<p>The <code>tally()</code> function is a convenience function that knows to count rows. It honors groups.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>()</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 2</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   continent     n</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;     &lt;int&gt;</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Africa      624</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Americas    300</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Asia        396</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Europe      360</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Oceania      24</span></span></code></pre></div>
<p>The <code>count()</code> function is an even more convenient function that does both grouping and counting.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(continent)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 2</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   continent     n</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;     &lt;int&gt;</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Africa      624</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Americas    300</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Asia        396</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Europe      360</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Oceania      24</span></span></code></pre></div>
<p>What if we wanted to add the number of unique countries for each continent? You can compute multiple summaries inside <code>summarize()</code>. Use the <code>n_distinct()</code> function to count the number of distinct countries within each continent.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_countries =</span> <span class="fu">n_distinct</span>(country))</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 3</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   continent     n n_countries</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;     &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Africa      624          52</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Americas    300          25</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Asia        396          33</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Europe      360          30</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Oceania      24           2</span></span></code></pre></div>
</div>
<div id="general-summarization" class="section level4 hasAnchor" number="22.3.7.2">
<h4 class="hasAnchor"><span class="header-section-number">22.3.7.2</span> General summarization<a href="#general-summarization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The functions you‚Äôll apply within <code>summarize()</code> include classical statistical summaries, like <code>mean()</code>, <code>median()</code>, <code>var()</code>, <code>sd()</code>, <code>mad()</code>, <code>IQR()</code>, <code>min()</code>, and <code>max()</code>. Remember they are functions that take <span class="math inline">\(n\)</span> inputs and distill them down into 1 output.</p>
<p>Although this may be statistically ill-advised, let‚Äôs compute the average life expectancy by continent.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_lifeExp =</span> <span class="fu">mean</span>(lifeExp))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 2</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   continent avg_lifeExp</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;           &lt;dbl&gt;</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Africa           48.9</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Americas         64.7</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Asia             60.1</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Europe           71.9</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Oceania          74.3</span></span></code></pre></div>
<!--TODO: summarize_at() is soft deprecated as of dplyr 0.8.0-->
<p><code>summarize_at()</code> applies the same summary function(s) to multiple variables. Let‚Äôs compute average and median life expectancy and GDP per capita by continent by year‚Ä¶but only for 1952 and 2007.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1952</span>, <span class="dv">2007</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="fu">vars</span>(lifeExp, gdpPercap), <span class="fu">list</span>( <span class="sc">~</span> <span class="fu">mean</span>(.), <span class="sc">~</span> <span class="fu">median</span>(.)))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 √ó 6</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   continent [5]</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    continent  year lifeExp_mean gdpPercap_mean lifeExp_median gdpPercap_median</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;     &lt;int&gt;        &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Africa     1952         39.1          1253.           38.8             987.</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Africa     2007         54.8          3089.           52.9            1452.</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Americas   1952         53.3          4079.           54.7            3048.</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Americas   2007         73.6         11003.           72.9            8948.</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Asia       1952         46.3          5195.           44.9            1207.</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Asia       2007         70.7         12473.           72.4            4471.</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Europe     1952         64.4          5661.           65.9            5142.</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Europe     2007         77.6         25054.           78.6           28054.</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Oceania    1952         69.3         10298.           69.3           10298.</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Oceania    2007         80.7         29810.           80.7           29810.</span></span></code></pre></div>
<p>Let‚Äôs focus just on Asia. What are the minimum and maximum life expectancies seen by year?</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">min_lifeExp =</span> <span class="fu">min</span>(lifeExp),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_lifeExp =</span> <span class="fu">max</span>(lifeExp))</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 3</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     year min_lifeExp max_lifeExp</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt;       &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1952        28.8        65.4</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  1957        30.3        67.8</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  1962        32.0        69.4</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  1967        34.0        71.4</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  1972        36.1        73.4</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  1977        31.2        75.4</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  1982        39.9        77.1</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  1987        40.8        78.7</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  1992        41.7        79.4</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1997        41.8        80.7</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2002        42.1        82  </span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2007        43.8        82.6</span></span></code></pre></div>
<p>Of course it would be much more interesting to see <em>which</em> country contributed these extreme observations. Is the minimum (maximum) always coming from the same country? We tackle that with window functions shortly.</p>
</div>
</div>
<div id="grouped-mutate" class="section level3 hasAnchor" number="22.3.8">
<h3 class="hasAnchor"><span class="header-section-number">22.3.8</span> Grouped mutate<a href="#grouped-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes you don‚Äôt want to collapse the <span class="math inline">\(n\)</span> rows for each group into one row. You want to keep your groups, but compute within them.</p>
<div id="computing-with-group-wise-summaries" class="section level4 hasAnchor" number="22.3.8.1">
<h4 class="hasAnchor"><span class="header-section-number">22.3.8.1</span> Computing with group-wise summaries<a href="#computing-with-group-wise-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let‚Äôs make a new variable that is the years of life expectancy gained (lost) relative to 1952, for each individual country. We group by country and use <code>mutate()</code> to make a new variable. The <code>first()</code> function extracts the first value from a vector. Notice that <code>first()</code> is operating on the vector of life expectancies <em>within each country group</em>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lifeExp_gain =</span> lifeExp <span class="sc">-</span> <span class="fu">first</span>(lifeExp)) <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">1963</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 426 √ó 4</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   country [142]</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country      year lifeExp lifeExp_gain</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;int&gt;   &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan  1952    28.8         0   </span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan  1957    30.3         1.53</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan  1962    32.0         3.20</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Albania      1952    55.2         0   </span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Albania      1957    59.3         4.05</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Albania      1962    64.8         9.59</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Algeria      1952    43.1         0   </span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Algeria      1957    45.7         2.61</span></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Algeria      1962    48.3         5.23</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Angola       1952    30.0         0   </span></span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 416 more rows</span></span></code></pre></div>
<p>Within country, we take the difference between life expectancy in year <span class="math inline">\(i\)</span> and life expectancy in 1952. Therefore we always see zeroes for 1952 and, for most countries, a sequence of positive and increasing numbers.</p>
</div>
<div id="window-functions" class="section level4 hasAnchor" number="22.3.8.2">
<h4 class="hasAnchor"><span class="header-section-number">22.3.8.2</span> Window functions<a href="#window-functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Window functions take <span class="math inline">\(n\)</span> inputs and give back <span class="math inline">\(n\)</span> outputs. Furthermore, the output depends on all the values. So <code>rank()</code> is a window function but <code>log()</code> is not. Here we use window functions based on ranks and offsets.</p>
<p>Let‚Äôs revisit the worst and best life expectancies in Asia over time, but retaining info about <em>which</em> country contributes these extreme values.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, country, lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">min_rank</span>(<span class="fu">desc</span>(lifeExp)) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">|</span> <span class="fu">min_rank</span>(lifeExp) <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 24 √ó 3</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   year [12]</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     year country     lifeExp</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt; &lt;fct&gt;         &lt;dbl&gt;</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1952 Afghanistan    28.8</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  1952 Israel         65.4</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  1957 Afghanistan    30.3</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  1957 Israel         67.8</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  1962 Afghanistan    32.0</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  1962 Israel         69.4</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  1967 Afghanistan    34.0</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  1967 Japan          71.4</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  1972 Afghanistan    36.1</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1972 Japan          73.4</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  1977 Cambodia       31.2</span></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  1977 Japan          75.4</span></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13  1982 Afghanistan    39.9</span></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14  1982 Japan          77.1</span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15  1987 Afghanistan    40.8</span></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16  1987 Japan          78.7</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17  1992 Afghanistan    41.7</span></span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18  1992 Japan          79.4</span></span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19  1997 Afghanistan    41.8</span></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20  1997 Japan          80.7</span></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21  2002 Afghanistan    42.1</span></span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22  2002 Japan          82  </span></span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23  2007 Afghanistan    43.8</span></span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24  2007 Japan          82.6</span></span></code></pre></div>
<p>We see that (min = Afghanistan, max = Japan) is the most frequent result, but Cambodia and Israel pop up at least once each as the min or max, respectively. That table should make you impatient for our upcoming work on tidying and reshaping data! Wouldn‚Äôt it be nice to have one row per year?</p>
<p>How did that actually work? First, I store and view a partial that leaves off the <code>filter()</code> statement. All of these operations should be familiar.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>asia <span class="ot">&lt;-</span> my_gap <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, country, lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>asia</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 396 √ó 3</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   year [12]</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     year country     lifeExp</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt; &lt;fct&gt;         &lt;dbl&gt;</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1952 Afghanistan    28.8</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  1957 Afghanistan    30.3</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  1962 Afghanistan    32.0</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  1967 Afghanistan    34.0</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  1972 Afghanistan    36.1</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  1977 Afghanistan    38.4</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  1982 Afghanistan    39.9</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  1987 Afghanistan    40.8</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  1992 Afghanistan    41.7</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1997 Afghanistan    41.8</span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 386 more rows</span></span></code></pre></div>
<p>Now we apply a window function ‚Äì <code>min_rank()</code>. Since <code>asia</code> is grouped by year, <code>min_rank()</code> operates within mini-datasets, each for a specific year. Applied to the variable <code>lifeExp</code>, <code>min_rank()</code> returns the rank of each country‚Äôs observed life expectancy. FYI, the <code>min</code> part just specifies how ties are broken. Here is an explicit peek at these within-year life expectancy ranks, in both the (default) ascending and descending order.</p>
<p>For concreteness, I use <code>mutate()</code> to actually create these variables, even though I dropped this in the solution above. Let‚Äôs look at a bit of that.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>asia <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">le_rank =</span> <span class="fu">min_rank</span>(lifeExp),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">le_desc_rank =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(lifeExp))) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Afghanistan&quot;</span>, <span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;Thailand&quot;</span>), year <span class="sc">&gt;</span> <span class="dv">1995</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 √ó 5</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   year [3]</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year country     lifeExp le_rank le_desc_rank</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;fct&gt;         &lt;dbl&gt;   &lt;int&gt;        &lt;int&gt;</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  1997 Afghanistan    41.8       1           33</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2002 Afghanistan    42.1       1           33</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2007 Afghanistan    43.8       1           33</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  1997 Japan          80.7      33            1</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2002 Japan          82        33            1</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2007 Japan          82.6      33            1</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  1997 Thailand       67.5      12           22</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  2002 Thailand       68.6      12           22</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9  2007 Thailand       70.6      12           22</span></span></code></pre></div>
<p>Afghanistan tends to present 1‚Äôs in the <code>le_rank</code> variable, Japan tends to present 1‚Äôs in the <code>le_desc_rank</code> variable and other countries, like Thailand, present less extreme ranks.</p>
<p>You can understand the original <code>filter()</code> statement now:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">min_rank</span>(<span class="fu">desc</span>(lifeExp)) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">|</span> <span class="fu">min_rank</span>(lifeExp) <span class="sc">&lt;</span> <span class="dv">2</span>)</span></code></pre></div>
<p>These two sets of ranks are formed on-the-fly, within year group, and <code>filter()</code> retains rows with rank less than 2, which means ‚Ä¶ the row with rank = 1. Since we do for ascending and descending ranks, we get both the min and the max.</p>
<p>If we had wanted just the min OR the max, an alternative approach using <code>top_n()</code> would have worked.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, country, lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#top_n(1, wt = lifeExp)        ## gets the min</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">1</span>, <span class="at">wt =</span> <span class="fu">desc</span>(lifeExp)) <span class="do">## gets the max</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 3</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   year [12]</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     year country     lifeExp</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt; &lt;fct&gt;         &lt;dbl&gt;</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  1952 Afghanistan    28.8</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2  1957 Afghanistan    30.3</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3  1962 Afghanistan    32.0</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4  1967 Afghanistan    34.0</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5  1972 Afghanistan    36.1</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6  1977 Cambodia       31.2</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7  1982 Afghanistan    39.9</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8  1987 Afghanistan    40.8</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9  1992 Afghanistan    41.7</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10  1997 Afghanistan    41.8</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11  2002 Afghanistan    42.1</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12  2007 Afghanistan    43.8</span></span></code></pre></div>
</div>
</div>
<div id="grand-finale" class="section level3 hasAnchor" number="22.3.9">
<h3 class="hasAnchor"><span class="header-section-number">22.3.9</span> Grand Finale<a href="#grand-finale" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So let‚Äôs answer that ‚Äúsimple‚Äù question: which country experienced the sharpest 5-year drop in life expectancy? Recall that this excerpt of the Gapminder data only has data every five years, e.g.¬†for 1952, 1957, etc. So this really means looking at life expectancy changes between adjacent timepoints.</p>
<p>At this point, that‚Äôs just too easy, so let‚Äôs do it by continent while we‚Äôre at it.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>my_gap <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, continent, lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, country) <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## within country, take (lifeExp in year i) - (lifeExp in year i - 1)</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## positive means lifeExp went up, negative means it went down</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">le_delta =</span> lifeExp <span class="sc">-</span> <span class="fu">lag</span>(lifeExp)) <span class="sc">%&gt;%</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## within country, retain the worst lifeExp change = smallest or most negative</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">worst_le_delta =</span> <span class="fu">min</span>(le_delta, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## within continent, retain the row with the lowest worst_le_delta</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="at">wt =</span> worst_le_delta) <span class="sc">%&gt;%</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(worst_le_delta)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;continent&#39;. You can override using the</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `.groups` argument.</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 3</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   continent [5]</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   continent country     worst_le_delta</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;     &lt;fct&gt;                &lt;dbl&gt;</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Africa    Rwanda             -20.4  </span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Asia      Cambodia            -9.10 </span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Americas  El Salvador         -1.51 </span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Europe    Montenegro          -1.46 </span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Oceania   Australia            0.170</span></span></code></pre></div>
<p>Ponder that for a while. The subject matter and the code. Mostly you‚Äôre seeing what genocide looks like in dry statistics on average life expectancy.</p>
<p>Break the code into pieces, starting at the top, and inspect the intermediate results. That‚Äôs certainly how I was able to <em>write</em> such a thing. These commands do not <a href="https://tinyurl.com/athenaforehead">leap fully formed out of anyone‚Äôs forehead</a> ‚Äì they are built up gradually, with lots of errors and refinements along the way. I‚Äôm not even sure it‚Äôs a great idea to do so much manipulation in one fell swoop. Is the statement above really hard for you to read? If yes, then by all means break it into pieces and make some intermediate objects. Your code should be easy to write and read when you‚Äôre done.</p>
<p>In later tutorials, we‚Äôll explore more of dplyr, such as operations based on two datasets.</p>
</div>
<div id="resources-1" class="section level3 hasAnchor" number="22.3.10">
<h3 class="hasAnchor"><span class="header-section-number">22.3.10</span> Resources<a href="#resources-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>dplyr official stuff:</p>
<ul>
<li>Package home <a href="https://CRAN.R-project.org/package=dplyr">on CRAN</a>.
<ul>
<li>Note there are several vignettes, with the <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">introduction</a> being the most relevant right now.</li>
<li>The <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/window-functions.html">one on window functions</a> will also be interesting to you now.</li>
</ul></li>
<li>Development home <a href="https://github.com/hadley/dplyr">on GitHub</a>.</li>
</ul>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">RStudio Data Transformation Cheat Sheet</a>, covering dplyr. Remember you can get to these via <em>Help &gt; Cheatsheets.</em></p>
<p><a href="https://r4ds.had.co.nz/transform.html">Data transformation</a> chapter of <a href="https://r4ds.had.co.nz">R for Data Science</a> <span class="citation">(<a href="#ref-wickham2016" role="doc-biblioref">Hadley Wickham and Grolemund 2016</a>)</span>.</p>
<!--TODO: This should probably be updated with something more recent-->
<p><a href="https://github.com/tjmahr/MadR_Pipelines">Excellent slides</a> on pipelines and dplyr by TJ Mahr, talk given to the Madison R Users Group.</p>
<!--TODO: This should probably be updated with something more recent-->
<p>Blog post <a href="https://www.dataschool.io/dplyr-tutorial-for-faster-data-manipulation-in-r/">Hands-on dplyr tutorial for faster data manipulation in R</a> by Data School, that includes a link to an R Markdown document and links to videos.</p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0303_hands.Rmd-->
</div>
</div>
</div>
<div id="working-with-multiple-data-frames" class="section level1 hasAnchor" number="23">
<h1 class="hasAnchor"><span class="header-section-number">23</span> Working with multiple data frames<a href="#working-with-multiple-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/fgA7Ou2e9aA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d10_dfs/d10_dfs.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d10_dfs/d10_dfs.html" width="672" height="400px" data-external="1">
</iframe>
<div id="case-studies-in-joining" class="section level2 hasAnchor" number="23.1">
<h2 class="hasAnchor"><span class="header-section-number">23.1</span> Case Studies in Joining<a href="#case-studies-in-joining" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/VHOwnMW8msg" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d10_dfs/d10_dfs.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d10_dfs/d10_dfs.html#26" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="merges" class="section level1 hasAnchor" number="24">
<h1 class="hasAnchor"><span class="header-section-number">24</span> ODD: Merges and Collaboration<a href="#merges" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This optional deep dive is about merge conflicts. You are welcome to try it with your classmates.</p>
<div id="learning-goal" class="section level2 hasAnchor" number="24.1">
<h2 class="hasAnchor"><span class="header-section-number">24.1</span> Learning goal<a href="#learning-goal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Collaborating on GitHub and resolving merge conflicts</li>
</ul>
</div>
<div id="merges-and-merge-conflicts" class="section level2 hasAnchor" number="24.2">
<h2 class="hasAnchor"><span class="header-section-number">24.2</span> Merges and merge conflicts<a href="#merges-and-merge-conflicts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We‚Äôre going to make things a little more interesting and let all of you make changes and push those changes to your team repository. Sometimes things will go swimmingly, and sometimes you‚Äôll run into merge conflicts. So our first task today is to walk you through a merge conflict!</p>
<ul>
<li>Pushing to a repo replaces the code on GitHub with the code you have on your computer.</li>
<li>If a collaborator has made a change to your repo on GitHub that you haven‚Äôt incorporated into your local work, GitHub will stop you from pushing to the repo because this could overwrite your collaborator‚Äôs work!</li>
<li>So you need to explicitly ‚Äúmerge‚Äù your collaborator‚Äôs work before you can push.</li>
<li>If your and your collaborator‚Äôs changes are in different files or in different parts of the same file, git merges the work for you automatically when you *pull*.</li>
<li>If you both changed the same part of a file, git will produce a **merge conflict** because it doesn‚Äôt know how which change you want to keep and which change you want to overwrite.</li>
</ul>
<p>Git will put conflict markers in your code that look like:</p>
<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD 

See also: [dplyr documentation](https://dplyr.tidyverse.org/)   

======= 

See also [ggplot2 documentation](https://ggplot2.tidyverse.org/)  

&gt;&gt;&gt;&gt;&gt;&gt;&gt; some1alpha2numeric3string4</code></pre>
<p>The <code>===</code>s separate <em>your</em> changes (top) from <em>their</em> changes (bottom).</p>
<p>Note that on top you see the word <code>HEAD</code>, which indicates that these are your changes.</p>
<p>And at the bottom you see <code>some1alpha2numeric3string4</code> (well, it probably looks more like <code>28e7b2ceb39972085a0860892062810fb812a08f</code>).</p>
<p>This is the <strong>hash</strong> (a unique identifier) of the commit your collaborator made with the conflicting change.</p>
<p>Your job is to <em>reconcile</em> the changes: edit the file so that it incorporates the best of both versions and delete the <code>&lt;&lt;&lt;</code>, <code>===</code>, and <code>&gt;&gt;&gt;</code> lines. Then you can stage and commit the result.</p>
</div>
<div id="merge-conflict-activity" class="section level2 hasAnchor" number="24.3">
<h2 class="hasAnchor"><span class="header-section-number">24.3</span> Merge conflict activity<a href="#merge-conflict-activity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="setup" class="section level3 hasAnchor" number="24.3.1">
<h3 class="hasAnchor"><span class="header-section-number">24.3.1</span> Setup<a href="#setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Clone the repo and open the .Rmd file.</li>
<li>Assign the numbers 1, 2, 3, and 4 to each of the team members. If your team has fewer than 4 people, some people will need to have multiple numbers. If your team has more than 4 people, some people will need to share some numbers.</li>
</ul>
</div>
<div id="lets-cause-a-merge-conflict" class="section level3 hasAnchor" number="24.3.2">
<h3 class="hasAnchor"><span class="header-section-number">24.3.2</span> Let‚Äôs cause a merge conflict!<a href="#lets-cause-a-merge-conflict" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our goal is to see two different types of merges: first we‚Äôll see a type of merge that git can‚Äôt figure out on its own how to do on its own (a <strong>merge conflict</strong>) and requires human intervention, then another type of where that git can figure out how to do without human intervention.</p>
<p>Doing this will require some tight choreography, so pay attention!</p>
<p>Take turns in completing the exercise, only one member at a time. <strong>Others should just watch, not doing anything on their own projects (this includes not even pulling changes!)</strong> until they are instructed to. If you feel like you won‚Äôt be able to resist the urge to touch your computer when it‚Äôs not your turn, we recommend putting your hands in your pockets or sitting on them!</p>
<p><strong>Before starting</strong>: everyone should have the repo cloned and know which role number(s) they are.</p>
<p><strong>Role 1:</strong></p>
<ul>
<li>Change the team name to your actual team name.</li>
<li>Knit, commit, push.</li>
</ul>
<p>üõë Make sure the previous role has finished before moving on to the next step.</p>
<p><strong>Role 2:</strong></p>
<ul>
<li>Change the team name to some other word.</li>
<li>Knit, commit, push. You should get an error.</li>
<li>Pull. Take a look at the document with the merge conflict.</li>
<li>Clear the merge conflict by editing the document to choose the correct/preferred change.</li>
<li>Knit.</li>
<li><strong>Click the Stage checkbox</strong> for all files in your Git tab. Make sure they all have check marks, not filled-in boxes.</li>
<li>Commit and push.</li>
</ul>
<p>üõë Make sure the previous role has finished before moving on to the next step.</p>
<p><strong>Role 3:</strong></p>
<ul>
<li>Change the a label of the first code chunk</li>
<li>Knit, commit, push. You should get an error.</li>
<li>Pull. No merge conflicts should occur, but you should see a message about merging.</li>
<li>Now push.</li>
</ul>
<p>üõë Make sure the previous role has finished before moving on to the next step.</p>
<p><strong>Role 4:</strong></p>
<ul>
<li>Change the label of the first code chunk to something other than previous role did.</li>
<li>Knit, commit, push. You should get an error.</li>
<li>Pull. Take a look at the document with the merge conflict. Clear the merge conflict by choosing the correct/preferred change. Commit, and push.</li>
</ul>
<p>üõë Make sure the previous role has finished before moving on to the next step.</p>
<p><strong>Everyone:</strong> Pull, and observe the changes in your document.</p>
</div>
</div>
<div id="tips-for-collaborating-via-github" class="section level2 hasAnchor" number="24.4">
<h2 class="hasAnchor"><span class="header-section-number">24.4</span> Tips for collaborating via GitHub<a href="#tips-for-collaborating-via-github" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Always pull first before you start working.</li>
<li>Resolve a merge conflict (commit and push) <em>before</em> continuing your work. Never do new work while resolving a merge conflict.</li>
<li>Knit, commit, and push often to minimize merge conflicts and/or to make merge conflicts easier to resolve.</li>
<li>If you find yourself in a situation that is difficult to resolve, ask questions as soon as possible. Don‚Äôt let it linger and get bigger.</li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0304_merges.Rmd-->
</div>
</div>
<div id="lab03" class="section level1 hasAnchor" number="25">
<h1 class="hasAnchor"><span class="header-section-number">25</span> Lab: Nobel laureates<a href="#lab03" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In January 2017, Buzzfeed published an article on why Nobel laureates show immigration is so important for American science. You can read the article <a href="https://www.buzzfeednews.com/article/peteraldhous/immigration-and-science">here</a>. In the article, they show that while most living Nobel laureates in the sciences are based in the US, many of them were born in other countries. This reality is one reason why scientific leaders say that immigration is vital for progress. In this lab we will work with the data from this article to recreate some of their visualizations as well as explore new questions.</p>
<div id="learning-goals-1" class="section level2 hasAnchor" number="25.1">
<h2 class="hasAnchor"><span class="header-section-number">25.1</span> Learning goals<a href="#learning-goals-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Replicating published results</li>
<li>Data wrangling and visualization</li>
</ul>
</div>
<div id="lab-prep" class="section level2 hasAnchor" number="25.2">
<h2 class="hasAnchor"><span class="header-section-number">25.2</span> Lab prep<a href="#lab-prep" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>Task:</strong> Read the Buzzfeed article titled <a href="https://www.buzzfeednews.com/article/peteraldhous/immigration-and-science"><em>These Nobel Prize Winners Show Why Immigration Is So Important For American Science</em></a><em>.</em> We will be replicating this analysis in the lab. So it‚Äôs crucial that you‚Äôre familiar with it ahead of time.</li>
</ul>
</div>
<div id="getting-started-2" class="section level2 hasAnchor" number="25.3">
<h2 class="hasAnchor"><span class="header-section-number">25.3</span> Getting started<a href="#getting-started-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go to the course GitHub organization and locate the lab repo, which should be named something like <code>lab-03-nobel-laureates</code>.
Either Fork it or copy it as a template. Then clone it in RStudio.
First, open the R Markdown document <code>lab-03.Rmd</code> and Knit it.
Make sure it compiles without errors.
The output will be in the file markdown <code>.md</code> file with the same name.</p>
<div id="warm-up-2" class="section level3 hasAnchor" number="25.3.1">
<h3 class="hasAnchor"><span class="header-section-number">25.3.1</span> Warm up<a href="#warm-up-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we introduce the data, let‚Äôs warm up with some simple exercises.</p>
<ul>
<li>Update the YAML, changing the author name to your name, and <strong>knit</strong> the document.</li>
<li>Commit your changes with a meaningful commit message.</li>
<li>Push your changes to GitHub.</li>
<li>Go to your repo on GitHub and confirm that your changes are visible in your Rmd <strong>and</strong> md files. If anything is missing, commit and push again.</li>
</ul>
</div>
<div id="packages-2" class="section level3 hasAnchor" number="25.3.2">
<h3 class="hasAnchor"><span class="header-section-number">25.3.2</span> Packages<a href="#packages-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We‚Äôll use the <strong>tidyverse</strong> package for much of the data wrangling.
This package is already installed for you.
You can load them by running the following in your Console:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data-2" class="section level3 hasAnchor" number="25.3.3">
<h3 class="hasAnchor"><span class="header-section-number">25.3.3</span> Data<a href="#data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The dataset for this assignment can be found as a csv (comma separated values) file in the <code>data</code> folder of your repository.
You can read it in using the following.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>nobel <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/nobel.csv&quot;</span>)</span></code></pre></div>
<p>The variable descriptions are as follows:</p>
<ul>
<li><code>id</code>: ID number</li>
<li><code>firstname</code>: First name of laureate</li>
<li><code>surname</code>: Surname</li>
<li><code>year</code>: Year prize won</li>
<li><code>category</code>: Category of prize</li>
<li><code>affiliation</code>: Affiliation of laureate</li>
<li><code>city</code>: City of laureate in prize year</li>
<li><code>country</code>: Country of laureate in prize year</li>
<li><code>born_date</code>: Birth date of laureate</li>
<li><code>died_date</code>: Death date of laureate</li>
<li><code>gender</code>: Gender of laureate</li>
<li><code>born_city</code>: City where laureate was born</li>
<li><code>born_country</code>: Country where laureate was born</li>
<li><code>born_country_code</code>: Code of country where laureate was born</li>
<li><code>died_city</code>: City where laureate died</li>
<li><code>died_country</code>: Country where laureate died</li>
<li><code>died_country_code</code>: Code of country where laureate died</li>
<li><code>overall_motivation</code>: Overall motivation for recognition</li>
<li><code>share</code>: Number of other winners award is shared with</li>
<li><code>motivation</code>: Motivation for recognition</li>
</ul>
<p>In a few cases, the name of the city/country changed after laureate was given (e.g., in 1975, Bosnia and Herzegovina was called the Socialist Federative Republic of Yugoslavia).
In these cases the variables below reflect a different name than their counterparts without the suffix `_original`.</p>
<ul>
<li><code>born_country_original</code>: Original country where laureate was born</li>
<li><code>born_city_original</code>: Original city where laureate was born</li>
<li><code>died_country_original</code>: Original country where laureate died</li>
<li><code>died_city_original</code>: Original city where laureate died</li>
<li><code>city_original</code>: Original city where laureate lived at the time of winning the award</li>
<li><code>country_original</code>: Original country where laureate lived at the time of winning the award</li>
</ul>
</div>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="25.4">
<h2 class="hasAnchor"><span class="header-section-number">25.4</span> Exercises<a href="#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="get-to-know-your-data" class="section level3 hasAnchor" number="25.4.1">
<h3 class="hasAnchor"><span class="header-section-number">25.4.1</span> Get to know your data<a href="#get-to-know-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>How many observations and how many variables are in the dataset? Use inline code to answer this question. What does each row represent?</li>
</ol>
<p>There are some observations in this dataset that we will exclude from our analysis to match the Buzzfeed results.</p>
<ol start="2" style="list-style-type: decimal">
<li>Create a new data frame called <code>nobel_living</code> that filters for</li>
</ol>
<ul>
<li>laureates for whom <code>country</code> is available</li>
<li>laureates who are people as opposed to organizations (organizations are denoted with <code>"org"</code> as their <code>gender</code>)</li>
<li>laureates who are still alive (their <code>died_date</code> is <code>NA</code>)</li>
</ul>
<p>Confirm that once you have filtered for these characteristics you are left with a data frame with 228 observations, once again using inline code.</p>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è Knit, <em>commit, and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
</div>
<div id="most-living-nobel-laureates-were-based-in-the-us-when-they-won-their-prizes" class="section level3 hasAnchor" number="25.4.2">
<h3 class="hasAnchor"><span class="header-section-number">25.4.2</span> Most living Nobel laureates were based in the US when they won their prizes<a href="#most-living-nobel-laureates-were-based-in-the-us-when-they-won-their-prizes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>‚Ä¶ says the Buzzfeed article.
Let‚Äôs see if that‚Äôs true.</p>
<p>First, we‚Äôll create a new variable to identify whether the laureate was in the US when they won their prize.
We‚Äôll use the <code>mutate()</code> function for this.
The following pipeline mutates the <code>nobel_living</code> data frame by adding a new variable called <code>country_us</code>.
We use an if statement to create this variable.
The first argument in the <code>if_else()</code> function we‚Äôre using to write this if statement is the condition we‚Äôre testing for.
If <code>country</code> is equal to <code>"USA"</code>, we set <code>country_us</code> to <code>"USA"</code>.
If not, we set the <code>country_us</code> to <code>"Other"</code>.</p>
<blockquote>
<p>Note: We can achieve the same result using the <code>fct_other()</code> function we‚Äôve seen before (i.e.¬†with <code>country_us = fct_other(country, "USA")</code>). We decided to use the <code>if_else()</code> here to show you one example of an if statement in R.</p>
</blockquote>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>nobel_living <span class="ot">&lt;-</span> nobel_living <span class="sc">%&gt;%</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_us =</span> <span class="fu">if_else</span>(country <span class="sc">==</span> <span class="st">&quot;USA&quot;</span>, <span class="st">&quot;USA&quot;</span>, <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Next, we will limit our analysis to only the following categories: Physics, Medicine, Chemistry, and Economics.</p>
<blockquote>
<p>Note: Technically, the Nobel Prize in Economics is a memorial prize. It was established in 1968. If you want to annoy an economist, point that distinction out to them‚Ä¶ More info <a href="https://en.wikipedia.org/wiki/Nobel_Memorial_Prize_in_Economic_Sciences">here</a> if you want to learn some more.</p>
</blockquote>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>nobel_living_science <span class="ot">&lt;-</span> nobel_living <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Physics&quot;</span>, <span class="st">&quot;Medicine&quot;</span>, <span class="st">&quot;Chemistry&quot;</span>, <span class="st">&quot;Economics&quot;</span>))</span></code></pre></div>
<p>For the next exercise, work with the <code>nobel_living_science</code> data frame you created above.
You‚Äôll need to define this data frame in your R Markdown document, even though the next exercise doesn‚Äôt explicitly ask you to do so.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Create a faceted bar plot visualizing the relationship between the category of prize and whether the laureate was in the US when they won the nobel prize.
Interpret your visualization, and say a few words about whether the Buzzfeed headline is supported by the data.</p>
<ul>
<li>Your visualization should be faceted by category.</li>
<li>For each facet you should have two bars, one for winners in the US and one for Other.</li>
<li>Flip the coordinates so the bars are horizontal, not vertical.</li>
</ul></li>
</ol>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è Knit, <em>commit, and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
</div>
</div>
<div id="but-of-those-us-based-nobel-laureates-many-were-born-in-other-countries" class="section level2 hasAnchor" number="25.5">
<h2 class="hasAnchor"><span class="header-section-number">25.5</span> But of those US-based Nobel laureates, many were born in other countries<a href="#but-of-those-us-based-nobel-laureates-many-were-born-in-other-countries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p><strong>Hint:</strong> You should be able to <del>cheat</del> borrow from code you used earlier to create the <code>country_us</code> variable.</p>
</blockquote>
<ol start="4" style="list-style-type: decimal">
<li><p>Create a new variable called <code>born_country_us</code> that has the value <code>"USA"</code> if the laureate is born in the US, and <code>"Other"</code> otherwise.
How many of the winners are born in the US?</p></li>
<li><p>Add a second variable to your visualization from Exercise 3 based on whether the laureate was born in the US or not.
Based on your visualization, do the data appear to support Buzzfeed‚Äôs claim?
Explain your reasoning in 1-2 sentences.</p>
<ul>
<li>Your final visualization should contain a facet for each category.</li>
<li>Within each facet, there should be a bar for whether the laureate won the award in the US or not.</li>
<li>Each bar should have segments for whether the laureate was born in the US or not.</li>
</ul></li>
</ol>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è Knit, <em>commit, and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<div id="heres-where-those-immigrant-nobelists-were-born" class="section level3 hasAnchor" number="25.5.1">
<h3 class="hasAnchor"><span class="header-section-number">25.5.1</span> Here‚Äôs where those immigrant Nobelists were born<a href="#heres-where-those-immigrant-nobelists-were-born" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Note: Your bar plot won‚Äôt exactly match the one from the Buzzfeed article. This is likely because the data has been updated since the article was published.</p>
</blockquote>
<ol start="6" style="list-style-type: decimal">
<li>In a single pipeline, filter for laureates who won their prize in the US, but were born outside of the US, and then create a frequency table (with the <code>count()</code> function) for their birth country (<code>born_country</code>) and arrange the resulting data frame in descending order of number of observations for each country. Which country is the most common?</li>
</ol>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è Knit, <em>commit, and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards and review the md document on GitHub to make sure you‚Äôre happy with the final state of your work.</em></p>
<p>Now go back through your write up to make sure you‚Äôve answered all questions and all of your R chunks are properly labeled.</p>
</div>
</div>
<div id="interested-in-how-buzzfeed-made-their-visualizations" class="section level2 hasAnchor" number="25.6">
<h2 class="hasAnchor"><span class="header-section-number">25.6</span> Interested in how Buzzfeed made their visualizations?<a href="#interested-in-how-buzzfeed-made-their-visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The plots in the Buzzfeed article are called waffle plots.
You can find the code used for making these plots in Buzzfeed‚Äôs GitHub repo (yes, they have one!) <a href="https://buzzfeednews.github.io/2017-01-immigration-and-science/">here</a>.
You‚Äôre not expected to recreate them as part of your assignment, but you‚Äôre welcomed to do so for fun!</p>
<!--chapter:end:0305_lab_nobellaureates.Rmd-->
</div>
</div>
<div id="part-module-04" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 04<a href="#part-module-04" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-data-diving-with-types" class="section level1 hasAnchor" number="26">
<h1 class="hasAnchor"><span class="header-section-number">26</span> Welcome to Data Diving with Types<a href="#welcome-to-data-diving-with-types" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to dive into data types and data importing. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYYWFcel6_vp8__RUKLxhX4y">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-3" class="section level2 hasAnchor" number="26.1">
<h2 class="hasAnchor"><span class="header-section-number">26.1</span> Module Materials<a href="#module-materials-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d11_types/d11_types.html">Data types and recoding</a></li>
<li><a href="https://datascience4psych.github.io/slides/d12_import/d12_import.html">Importing data</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module</li>
<li>R4DS
<ul>
<li><a href="https://r4ds.had.co.nz/wrangle-intro.html">Wrangle</a></li>
<li><a href="https://r4ds.had.co.nz/transform.html">Data Transformation</a></li>
<li><a href="https://r4ds.had.co.nz/data-import.html">Data Importing</a></li>
</ul></li>
</ul></li>
<li>Activities
<ul>
<li><a href="https://github.com/DataScience4Psych/ae-05-hotels-datatypes">Hotels, again!</a></li>
<li><a href="https://github.com/DataScience4Psych/ae-06-nobels-sales-dataimport">Data Import</a></li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab04">Visualizing spatial data</a></li>
</ul></li>
</ul>
</div>
<div id="estimated-video-length-3" class="section level2 hasAnchor" number="26.2">
<h2 class="hasAnchor"><span class="header-section-number">26.2</span> Estimated Video Length<a href="#estimated-video-length-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No of videos : 9</p>
<p>Average length of video : 8 minutes, 28 seconds</p>
<p>Total length of playlist : 1 hour, 16 minutes, 15 seconds</p>
</div>
</div>
<div id="data-types-and-recoding" class="section level1 hasAnchor" number="27">
<h1 class="hasAnchor"><span class="header-section-number">27</span> Data types and recoding<a href="#data-types-and-recoding" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d11_types/d11_types.html">here</a> if they do not appear below.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">That‚Äôs when you realize you can educate those you work with to give you better data, better questions to answer, etc., so that you can give them better insights. You have more power than you think!</p>&mdash; Isabella R. Ghement (@IsabellaGhement) <a href="https://twitter.com/IsabellaGhement/status/1473649548778106889?ref_src=twsrc%5Etfw">December 22, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Wonderful visual illustration of data types in <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a>! ü§©<br><br>Image credits:<a href="https://t.co/ESrtYBwtNm">https://t.co/ESrtYBwtNm</a><br><br>For further reading, see:<a href="https://t.co/nrR59hLniV">https://t.co/nrR59hLniV</a><a href="https://twitter.com/hashtag/DataScience?src=hash&amp;ref_src=twsrc%5Etfw">#DataScience</a> <a href="https://t.co/iO0key2mnh">pic.twitter.com/iO0key2mnh</a></p>&mdash; Indrajeet Patil (‡§á‡§Ç‡§¶‡•ç‡§∞‡§ú‡•Ä‡§§ ‡§™‡§æ‡§ü‡•Ä‡§≤) (@patilindrajeets) <a href="https://twitter.com/patilindrajeets/status/1476171334400954371?ref_src=twsrc%5Etfw">December 29, 2021</a></blockquote>

<div id="why-should-you-care-about-data-types" class="section level2 hasAnchor" number="27.1">
<h2 class="hasAnchor"><span class="header-section-number">27.1</span> Why should you care about data types?<a href="#why-should-you-care-about-data-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/1pErauWQTQY" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="data-types" class="section level2 hasAnchor" number="27.2">
<h2 class="hasAnchor"><span class="header-section-number">27.2</span> Data types!<a href="#data-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/d8pBipXpDVU" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html#14" width="672" height="400px" data-external="1">
</iframe>
<div id="another-hotels-activity" class="section level3 hasAnchor" number="27.2.1">
<h3 class="hasAnchor"><span class="header-section-number">27.2.1</span> Another Hotels Activity<a href="#another-hotels-activity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html#24" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Hotels activity <a href="https://github.com/DataScience4Psych/ae-05-hotels-datatypes">here</a>. The compiled version should look something like the following‚Ä¶</p>
<iframe src="https://datascience4psych.github.io/ae-05-hotels-datatypes/type-coercion.html" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="special-values" class="section level2 hasAnchor" number="27.3">
<h2 class="hasAnchor"><span class="header-section-number">27.3</span> Special Values<a href="#special-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/3YoFhEKvieA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html#26" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="data-classes" class="section level2 hasAnchor" number="27.4">
<h2 class="hasAnchor"><span class="header-section-number">27.4</span> Data classes<a href="#data-classes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/9yNpsBKyXRE" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html#35" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="working-with-factors" class="section level2 hasAnchor" number="27.5">
<h2 class="hasAnchor"><span class="header-section-number">27.5</span> Working with factors<a href="#working-with-factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/yeEnw9rMJe4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html#45" width="672" height="400px" data-external="1">
</iframe>
<div id="an-another-hotels-activity" class="section level3 hasAnchor" number="27.5.1">
<h3 class="hasAnchor"><span class="header-section-number">27.5.1</span> (An) Another Hotels Activity<a href="#an-another-hotels-activity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html#50" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Hotels activity <a href="https://github.com/DataScience4Psych/ae-05-hotels-datatypes">here</a>. The compiled version should look something like the following‚Ä¶</p>
<iframe src="https://datascience4psych.github.io/ae-05-hotels-datatypes/hotels-forcats.html" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="working-with-dates" class="section level2 hasAnchor" number="27.6">
<h2 class="hasAnchor"><span class="header-section-number">27.6</span> Working with Dates<a href="#working-with-dates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/R6cEDlzCBfQ" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d11_types/d11_types.html#52" width="672" height="400px" data-external="1">
</iframe>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0401_data.Rmd-->
</div>
</div>
<div id="importing-data" class="section level1 hasAnchor" number="28">
<h1 class="hasAnchor"><span class="header-section-number">28</span> Importing data!<a href="#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="importing-data-1" class="section level2 hasAnchor" number="28.1">
<h2 class="hasAnchor"><span class="header-section-number">28.1</span> Importing data!<a href="#importing-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/hnUGwlyqx1M" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d12_import/d12_import.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d12_import/d12_import.html" width="672" height="400px" data-external="1">
</iframe>
<div id="another-activity" class="section level3 hasAnchor" number="28.1.1">
<h3 class="hasAnchor"><span class="header-section-number">28.1.1</span> Another Activity<a href="#another-activity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://datascience4psych.github.io/slides/d12_import/d12_import.html#9" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Nobels and sales activities <a href="https://github.com/DataScience4Psych/ae-06-nobels-sales-dataimport">here</a>.</p>
</div>
</div>
<div id="importing-and-variable-types" class="section level2 hasAnchor" number="28.2">
<h2 class="hasAnchor"><span class="header-section-number">28.2</span> Importing and Variable Types!<a href="#importing-and-variable-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/g7G8ZTnDSv8" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d12_import/d12_import.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d12_import/d12_import.html#17" width="672" height="400px" data-external="1">
</iframe>
<div id="more-activity" class="section level3 hasAnchor" number="28.2.1">
<h3 class="hasAnchor"><span class="header-section-number">28.2.1</span> More Activity<a href="#more-activity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://datascience4psych.github.io/slides/d12_import/d12_import.html#22" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the Nobels and sales activities <a href="https://github.com/DataScience4Psych/ae-06-nobels-sales-dataimport">here</a>.</p>
</div>
</div>
<div id="vroom" class="section level2 hasAnchor" number="28.3">
<h2 class="hasAnchor"><span class="header-section-number">28.3</span> Vroom!<a href="#vroom" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/EmB1yyzRX0c" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides [here][#d12_import] if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d12_import/d12_import.html#30" width="672" height="400px" data-external="1">
</iframe>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Live look at me opening a &quot;dataset&quot; <a href="https://t.co/eaBEguiA11">pic.twitter.com/eaBEguiA11</a></p>&mdash; Darren Dahly https://mastodon.social/@statsepi (@statsepi) <a href="https://twitter.com/statsepi/status/1323619993263755264?ref_src=twsrc%5Etfw">November 3, 2020</a></blockquote>

</div>
</div>
<div id="import-export" class="section level1 hasAnchor" number="29">
<h1 class="hasAnchor"><span class="header-section-number">29</span> Writing and reading files<a href="#import-export" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This deep dive has been adapted from Jenny Bryan‚Äôs Stat545.</p>
<div id="file-io-overview" class="section level2 hasAnchor" number="29.1">
<h2 class="hasAnchor"><span class="header-section-number">29.1</span> File I/O overview<a href="#file-io-overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For the most part, we‚Äôve been working with (p)reprocessed data, like the Gapminder data from the gapminder data package or data from any of the labs. In other words, we haven‚Äôt been explicitly writing any data or derived results to file. In real life (and in this class), you‚Äôll have to bring rectangular data into and out of R. Sometimes you‚Äôll need to do same for non-rectangular objects.</p>
<p>How do you do this? What issues should you think about?</p>
<div id="data-import-mindset" class="section level3 hasAnchor" number="29.1.1">
<h3 class="hasAnchor"><span class="header-section-number">29.1.1</span> Data import mindset<a href="#data-import-mindset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data import generally feels one of two ways:</p>
<ul>
<li>‚ÄúSurprise me!‚Äù You probably have to adopt this attitude when you first get a dataset. You are just happy to import without an error. You start to explore. You discover flaws in the data and/or the import. You address them. Lather, rinse, repeat.</li>
<li>‚ÄúAnother day in paradise.‚Äù This attitude is when you bring in a tidy dataset you have maniacally cleaned in one or more cleaning scripts. There should be no surprises. You should express your expectations about the data in formal assertions at the very start of these downstream scripts.</li>
</ul>
<p>In the second case, and as the first cases progresses, you actually know a lot about how the data is / should be. My main import advice: <strong>use the arguments of your import function to get as far as you can, as fast as possible</strong>. Novice code often has a great deal of unnecessary post import fussing around. Read the docs for the import functions and take maximum advantage of the arguments to control the import.</p>
</div>
<div id="data-export-mindset" class="section level3 hasAnchor" number="29.1.2">
<h3 class="hasAnchor"><span class="header-section-number">29.1.2</span> Data export mindset<a href="#data-export-mindset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There will be many occasions when you need to write data from R. Two main examples:</p>
<ul>
<li>a tidy ready-to-analyze dataset that you heroically created from messy data</li>
<li>a numerical result from data aggregation or modelling or statistical inference</li>
</ul>
<p>First tip: <strong>today‚Äôs outputs are tomorrow‚Äôs inputs</strong>. Think back on all the pain you have suffered importing data and don‚Äôt inflict such pain on yourself!</p>
<p>Second tip: don‚Äôt be too cute or clever. A plain text file that is readable by a human being in a text editor should be your default until you have <strong>actual proof</strong> that this will not work. Reading and writing to exotic or proprietary formats will be the first thing to break in the future or on a different computer. It also creates barriers for anyone who has a different toolkit than you do. Be software-agnostic. Aim for future-proof and forgetfu-proof.</p>
<p>How does this approach fit with our emphasis on dynamic reporting via R Markdown? There is a time and place for everything. There are projects and documents where the scope and personnel will allow you to geek out with knitr and R Markdown. But there are lots of good reasons why (parts of) an analysis should not (only) be embedded in a dynamic report. Maybe you are just doing data cleaning to produce a valid input dataset. Maybe you are making a small but crucial contribution to a giant multi-author paper. Etc. Also remember there are other tools and workflows for making something reproducible. I‚Äôm looking at you, <a href="https://kbroman.org/minimal_make/">make</a>.</p>
</div>
</div>
<div id="lets-begin" class="section level2 hasAnchor" number="29.2">
<h2 class="hasAnchor"><span class="header-section-number">29.2</span> Let‚Äôs Begin!<a href="#lets-begin" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-the-tidyverse" class="section level3 hasAnchor" number="29.2.1">
<h3 class="hasAnchor"><span class="header-section-number">29.2.1</span> Load the tidyverse<a href="#load-the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main package we will be using is <a href="https://readr.tidyverse.org">readr</a>, which provides drop-in substitute functions for <code>read.table()</code> and friends. However, to make some points about data export and import, it is nice to reorder factor levels. For that, we will use the <a href="https://forcats.tidyverse.org">forcats</a> package, which is also included in the tidyverse package.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2 ‚îÄ‚îÄ</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî ggplot2 3.4.0      ‚úî purrr   1.0.0 </span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tibble  3.1.8      ‚úî dplyr   1.0.10</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tidyr   1.2.1      ‚úî stringr 1.5.0 </span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî readr   2.1.3      ‚úî forcats 0.5.2 </span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::filter() masks stats::filter()</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::lag()    masks stats::lag()</span></span></code></pre></div>
</div>
<div id="locate-the-gapminder-data" class="section level3 hasAnchor" number="29.2.2">
<h3 class="hasAnchor"><span class="header-section-number">29.2.2</span> Locate the Gapminder data<a href="#locate-the-gapminder-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We could load the data from the package as usual, but instead we will load it from tab delimited file. The gapminder package includes the data normally found in the <code>gapminder</code> data frame as a <code>.tsv</code>. So let‚Äôs get the path to that file on <em>your</em> system using the <a href="https://fs.r-lib.org/index.html"><code>fs</code> package</a>.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>(gap_tsv <span class="ot">&lt;-</span> <span class="fu">path_package</span>(<span class="st">&quot;gapminder&quot;</span>, <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;gapminder.tsv&quot;</span>))</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; C:/Users/smaso/AppData/Local/R/win-library/4.2/gapminder/extdata/gapminder.tsv</span></span></code></pre></div>
</div>
<div id="bring-rectangular-data-in" class="section level3 hasAnchor" number="29.2.3">
<h3 class="hasAnchor"><span class="header-section-number">29.2.3</span> Bring rectangular data in<a href="#bring-rectangular-data-in" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The workhorse data import function of readr is <code>read_delim()</code>. Here we‚Äôll use a variant, <code>read_tsv()</code>, that anticipates tab-delimited data:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(gap_tsv)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 1704 Columns: 6</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Delimiter: &quot;\t&quot;</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; chr (2): country, continent</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dbl (4): year, lifeExp, pop, gdpPercap</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚Ñπ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder, <span class="at">give.attr =</span> <span class="cn">FALSE</span>)</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; spc_tbl_ [1,704 √ó 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ country  : chr [1:1704] &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Afghani&quot;..</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ continent: chr [1:1704] &quot;Asia&quot; &quot;Asia&quot; &quot;Asia&quot; &quot;Asia&quot; ...</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ year     : num [1:1704] 1952 1957 1962 1967 1972 ...</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop      : num [1:1704] 8425333 9240934 10267083 11537966 13079460 ...</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</span></span></code></pre></div>
<p>For full flexibility re: specifying the delimiter, you can always use <code>readr::read_delim()</code>.</p>
<p>There‚Äôs a similar convenience wrapper for comma-separated values, <code>read_csv()</code>.</p>
<p>The most noticeable difference between the readr functions and base is that readr does NOT convert strings to factors by default. In the grand scheme of things, this default behavior is better, although we go ahead and convert them to factor here. Do not be deceived ‚Äì in general, you will do less post-import fussing if you use readr.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">factor</span>(country),</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">continent =</span> <span class="fu">factor</span>(continent))</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tibble [1,704 √ó 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ country  : Factor w/ 142 levels &quot;Afghanistan&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ continent: Factor w/ 5 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ year     : num [1:1704] 1952 1957 1962 1967 1972 ...</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop      : num [1:1704] 8425333 9240934 10267083 11537966 13079460 ...</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</span></span></code></pre></div>
<div id="bring-rectangular-data-in-summary" class="section level4 hasAnchor" number="29.2.3.1">
<h4 class="hasAnchor"><span class="header-section-number">29.2.3.1</span> Bring rectangular data in ‚Äì summary<a href="#bring-rectangular-data-in-summary" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Default to <code>readr::read_delim()</code> and friends. Use the arguments!</p>
<p>The Gapminder data is too clean and simple to show off the great features of readr, so I encourage you to check out the part of the introduction vignette on <a href="https://cran.r-project.org/web/packages/readr/vignettes/readr.html">column types</a>. There are many variable types that you will be able to parse correctly upon import, thereby eliminating a great deal of post-import fussing.</p>
</div>
</div>
</div>
<div id="compute-something-worthy-of-export" class="section level2 hasAnchor" number="29.3">
<h2 class="hasAnchor"><span class="header-section-number">29.3</span> Compute something worthy of export<a href="#compute-something-worthy-of-export" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We need compute something worth writing to file. Let‚Äôs create a country-level summary of maximum life expectancy.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>gap_life_exp <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, continent) <span class="sc">%&gt;%</span> </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">life_exp =</span> <span class="fu">max</span>(lifeExp)) <span class="sc">%&gt;%</span> </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;country&#39;. You can override using the</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `.groups` argument.</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>gap_life_exp</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 142 √ó 3</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent life_exp</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;        &lt;dbl&gt;</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia          43.8</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Albania     Europe        76.4</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Algeria     Africa        72.3</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Angola      Africa        42.7</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Argentina   Americas      75.3</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Australia   Oceania       81.2</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Austria     Europe        79.8</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Bahrain     Asia          75.6</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Bangladesh  Asia          64.1</span></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Belgium     Europe        79.4</span></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 132 more rows</span></span></code></pre></div>
<p>The <code>gap_life_exp</code> data frame is an example of an intermediate result that we want to store for the future and for downstream analyses or visualizations.</p>
<div id="write-rectangular-data-out" class="section level3 hasAnchor" number="29.3.1">
<h3 class="hasAnchor"><span class="header-section-number">29.3.1</span> Write rectangular data out<a href="#write-rectangular-data-out" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The workhorse export function for rectangular data in readr is <code>write_delim()</code> and friends. Let‚Äôs use <code>write_csv()</code> to get a comma-delimited file.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(gap_life_exp, <span class="st">&quot;gap_life_exp.csv&quot;</span>)</span></code></pre></div>
<p>Let‚Äôs look at the first few lines of <code>gap_life_exp.csv</code>. If you‚Äôre following along, you should be able to open this file or, in a shell, use <code>head()</code> on it.</p>
<pre><code>country,continent,life_exp
Afghanistan,Asia,43.828
Albania,Europe,76.423
Algeria,Africa,72.301
Angola,Africa,42.731
Argentina,Americas,75.32</code></pre>
<p>This output is pretty decent looking, though there is no visible alignment or separation into columns. Had we used the base function <code>read.csv()</code>, we would be seeing rownames and lots of quotes, unless we had explicitly shut that down. Nicer default behavior is the main reason we are using <code>readr::write_csv()</code> over <code>write.csv()</code>.</p>
<ul>
<li>It‚Äôs not really fair to complain about the lack of visible alignment. Remember we are <a href="https://twitter.com/vsbuffalo/statuses/358699162679787521">‚Äúwriting data for computers‚Äù</a>. If you really want to browse around the file, use <code>View()</code> in RStudio or open it in Microsoft Excel (!) but don‚Äôt succumb to the temptation to start doing artisanal data manipulations there ‚Ä¶ get back to R and construct commands that you can re-run the next 15 times you import/clean/aggregate/export the same dataset. Trust me, it will happen.</li>
</ul>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">If I had one thing to tell biologists learning bioinformatics, it would be &quot;write code for humans, write data for computers&quot;.</p>&mdash; Vince Buffalo (@vsbuffalo) <a href="https://twitter.com/vsbuffalo/status/358699162679787521?ref_src=twsrc%5Etfw">July 20, 2013</a></blockquote>

</div>
<div id="invertibility" class="section level3 hasAnchor" number="29.3.2">
<h3 class="hasAnchor"><span class="header-section-number">29.3.2</span> Invertibility<a href="#invertibility" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It turns out these self-imposed rules are often in conflict with one another:</p>
<ul>
<li>Write to plain text files</li>
<li>Break analysis into pieces: the output of script <code>i</code> is an input for script <code>i + 1</code></li>
<li>Be the boss of factors: order the levels in a meaningful, usually non-alphabetical way</li>
<li>Avoid duplication of code and data</li>
</ul>
<p><strong>Example:</strong> after performing the country-level summarization, we reorder the levels of the country factor, based on life expectancy. This reordering operation is conceptually important and must be embodied in R commands stored in a script. However, as soon as we write <code>gap_life_exp</code> to a plain text file, that meta-information about the countries is lost. Upon re-import with <code>read_delim()</code> and friends, we are back to alphabetically ordered factor levels. Any measure we take to avoid this loss immediately breaks another one of our rules.</p>
<p>So what do I do? I must admit I save (and re-load) R-specific binary files. Right after I save the plain text file. <a href="https://www.wisegeek.com/what-does-it-mean-to-wear-belt-and-suspenders.htm">Belt and suspenders</a>!</p>
<p>I have toyed with the idea of writing import helper functions for a specific project, that would re-order factor levels in principled ways. They could be defined in one file and called from many. This would also have a very natural implementation within <a href="https://www.carlboettiger.info/2012/05/06/research-workflow.html">a workflow where each analytic project is an R package</a>. But so far it has seemed too much like <a href="https://seths.blog/2005/03/dont_shave_that/">yak shaving</a>. I‚Äôm intrigued by a recent discussion of putting such information in YAML frontmatter (see Martin Fenner‚Äôs blog post <a href="https://blog.datacite.org/using-yaml-frontmatter-with-csv/">Using YAML frontmatter with CSV</a>).</p>
</div>
<div id="reordering-the-levels-of-the-country-factor" class="section level3 hasAnchor" number="29.3.3">
<h3 class="hasAnchor"><span class="header-section-number">29.3.3</span> Reordering the levels of the country factor<a href="#reordering-the-levels-of-the-country-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I reorder the country factor levels according to the life expectancy summary we‚Äôve already computed.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">levels</span>(gap_life_exp<span class="sc">$</span>country)) <span class="co"># alphabetical order</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Afghanistan&quot; &quot;Albania&quot;     &quot;Algeria&quot;     &quot;Angola&quot;      &quot;Argentina&quot;  </span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6] &quot;Australia&quot;</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>gap_life_exp <span class="ot">&lt;-</span> gap_life_exp <span class="sc">%&gt;%</span> </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">fct_reorder</span>(country, life_exp))</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">levels</span>(gap_life_exp<span class="sc">$</span>country)) <span class="co"># in increasing order of maximum life expectancy</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sierra Leone&quot; &quot;Angola&quot;       &quot;Afghanistan&quot;  &quot;Liberia&quot;      &quot;Rwanda&quot;      </span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6] &quot;Mozambique&quot;</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gap_life_exp)</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 3</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   country     continent life_exp</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;       &lt;fct&gt;        &lt;dbl&gt;</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Afghanistan Asia          43.8</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Albania     Europe        76.4</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Algeria     Africa        72.3</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Angola      Africa        42.7</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Argentina   Americas      75.3</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Australia   Oceania       81.2</span></span></code></pre></div>
<p>Note that the <strong>row order of <code>gap_life_exp</code> has not changed</strong>. I could choose to reorder the rows of the data frame if, for example, I was about to prepare a table to present to people. But I‚Äôm not, so I won‚Äôt.</p>
</div>
<div id="saverds-and-readrds" class="section level3 hasAnchor" number="29.3.4">
<h3 class="hasAnchor"><span class="header-section-number">29.3.4</span> <code>saveRDS()</code> and <code>readRDS()</code><a href="#saverds-and-readrds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you have a data frame AND you have exerted yourself to rationalize the factor levels, you have my blessing to save it to file in a way that will preserve this hard work upon re-import. Use <code>saveRDS()</code>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(gap_life_exp, <span class="st">&quot;gap_life_exp.rds&quot;</span>)</span></code></pre></div>
<p><code>saveRDS()</code> serializes an R object to a binary file. It‚Äôs not a file you will able to open in an editor, diff nicely with Git(Hub), or share with non-R friends. It‚Äôs a special purpose, limited use function that I use in specific situations.</p>
<p>The opposite of <code>saveRDS()</code> is <code>readRDS()</code>. You must assign the return value to an object. I highly recommend you assign back to the same name as before. Why confuse yourself?!?</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gap_life_exp)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>gap_life_exp</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): object &#39;gap_life_exp&#39; not found</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>gap_life_exp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;gap_life_exp.rds&quot;</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>gap_life_exp</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 142 √ó 3</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country     continent life_exp</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;fct&gt;        &lt;dbl&gt;</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan Asia          43.8</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Albania     Europe        76.4</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Algeria     Africa        72.3</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Angola      Africa        42.7</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Argentina   Americas      75.3</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Australia   Oceania       81.2</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Austria     Europe        79.8</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Bahrain     Asia          75.6</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Bangladesh  Asia          64.1</span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Belgium     Europe        79.4</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 132 more rows</span></span></code></pre></div>
<p><code>saveRDS()</code> has more arguments, in particular <code>compress</code> for controlling compression, so read the help for more advanced usage. It is also very handy for saving non-rectangular objects, like a fitted regression model, that took a nontrivial amount of time to compute.</p>
<p>You will eventually hear about <code>save()</code> + <code>load()</code> and even <code>save.image()</code>. You may even see them in documentation and tutorials, but don‚Äôt be tempted. Just say no. These functions encourage unsafe practices, like storing multiple objects together and even entire workspaces. There are legitimate uses of these functions, but not in your typical data analysis.</p>
</div>
<div id="retaining-factor-levels-upon-re-import" class="section level3 hasAnchor" number="29.3.5">
<h3 class="hasAnchor"><span class="header-section-number">29.3.5</span> Retaining factor levels upon re-import<a href="#retaining-factor-levels-upon-re-import" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is a concrete demonstration of how non-alphabetical factor level order is lost with <code>write_delim()</code> / <code>read_delim()</code> workflows but maintained with <code>saveRDS()</code> / <code>readRDS()</code>.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>(country_levels <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">original =</span> <span class="fu">head</span>(<span class="fu">levels</span>(gap_life_exp<span class="sc">$</span>country))))</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 1</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   original    </span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;       </span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Sierra Leone</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Angola      </span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Afghanistan </span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Liberia     </span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Rwanda      </span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Mozambique</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(gap_life_exp, <span class="st">&quot;gap_life_exp.csv&quot;</span>)</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(gap_life_exp, <span class="st">&quot;gap_life_exp.rds&quot;</span>)</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gap_life_exp)</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gap_life_exp) <span class="co"># will cause error! proving gap_life_exp is really gone </span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in head(gap_life_exp): object &#39;gap_life_exp&#39; not found</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>gap_via_csv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;gap_life_exp.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">factor</span>(country))</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 142 Columns: 3</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Delimiter: &quot;,&quot;</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; chr (2): country, continent</span></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dbl (1): life_exp</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚Ñπ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>gap_via_rds <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;gap_life_exp.rds&quot;</span>)</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>country_levels <span class="ot">&lt;-</span> country_levels <span class="sc">%&gt;%</span> </span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">via_csv =</span> <span class="fu">head</span>(<span class="fu">levels</span>(gap_via_csv<span class="sc">$</span>country)),</span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">via_rds =</span> <span class="fu">head</span>(<span class="fu">levels</span>(gap_via_rds<span class="sc">$</span>country)))</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>country_levels</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 3</span></span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   original     via_csv     via_rds     </span></span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;       </span></span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Sierra Leone Afghanistan Sierra Leone</span></span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Angola       Albania     Angola      </span></span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Afghanistan  Algeria     Afghanistan </span></span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Liberia      Angola      Liberia     </span></span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Rwanda       Argentina   Rwanda      </span></span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Mozambique   Australia   Mozambique</span></span></code></pre></div>
<p>Note how the original, post-reordering country factor levels are restored using the <code>saveRDS()</code> / <code>readRDS()</code> strategy but revert to alphabetical ordering using <code>write_csv()</code> / <code>read_csv()</code>.</p>
</div>
<div id="dput-and-dget" class="section level3 hasAnchor" number="29.3.6">
<h3 class="hasAnchor"><span class="header-section-number">29.3.6</span> <code>dput()</code> and <code>dget()</code><a href="#dput-and-dget" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One last method of saving and restoring data deserves a mention: <code>dput()</code> and <code>dget()</code>. <code>dput()</code> offers this odd combination of features: it creates a plain text representation of an R object which still manages to be quite opaque. If you use the <code>file =</code> argument, <code>dput()</code> can write this representation to file but you won‚Äôt be tempted to actually read that thing. <code>dput()</code> creates an R-specific-but-not-binary representation. Let‚Äôs try it out.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">## first restore gap_life_exp with our desired country factor level order</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>gap_life_exp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;gap_life_exp.rds&quot;</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dput</span>(gap_life_exp, <span class="st">&quot;gap_life_exp-dput.txt&quot;</span>)</span></code></pre></div>
<p>Now let‚Äôs look at the first few lines of the file <code>gap_life_exp-dput.txt</code>.</p>
<pre><code>structure(list(country = structure(c(3L, 107L, 74L, 2L, 98L, 
138L, 128L, 102L, 49L, 125L, 26L, 56L, 96L, 47L, 75L, 85L, 18L, 
12L, 37L, 24L, 133L, 13L, 16L, 117L, 84L, 82L, 53L, 9L, 28L, 
120L, 22L, 104L, 114L, 109L, 115L, 23L, 73L, 97L, 66L, 71L, 15L, 
29L, 20L, 122L, 134L, 40L, 35L, 123L, 38L, 126L, 60L, 25L, 7L, 
39L, 59L, 141L, 86L, 140L, 51L, 63L, 64L, 52L, 121L, 135L, 132L, </code></pre>
<p>Huh? Don‚Äôt worry about it. Remember we are <a href="https://twitter.com/vsbuffalo/statuses/358699162679787521">‚Äúwriting data for computers‚Äù</a>. The partner function <code>dget()</code> reads this representation back in.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>gap_life_exp_dget <span class="ot">&lt;-</span> <span class="fu">dget</span>(<span class="st">&quot;gap_life_exp-dput.txt&quot;</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>country_levels <span class="ot">&lt;-</span> country_levels <span class="sc">%&gt;%</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">via_dput =</span> <span class="fu">head</span>(<span class="fu">levels</span>(gap_life_exp_dget<span class="sc">$</span>country)))</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>country_levels</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 √ó 4</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   original     via_csv     via_rds      via_dput    </span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;       </span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Sierra Leone Afghanistan Sierra Leone Sierra Leone</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Angola       Albania     Angola       Angola      </span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Afghanistan  Algeria     Afghanistan  Afghanistan </span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Liberia      Angola      Liberia      Liberia     </span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Rwanda       Argentina   Rwanda       Rwanda      </span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Mozambique   Australia   Mozambique   Mozambique</span></span></code></pre></div>
<p>Note how the original, post-reordering country factor levels are restored using the <code>dput()</code> / <code>dget()</code> strategy.</p>
<p>But why on earth would you ever do this?</p>
<p>The main application of this is <a href="https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example">the creation of highly portable, self-contained minimal examples</a>. For example, if you want to pose a question on a forum or directly to an expert, it might be required or just plain courteous to NOT attach any data files. You will need a monolithic, plain text blob that defines any necessary objects and has the necessary code. <code>dput()</code> can be helpful for producing the piece of code that defines the object. If you <code>dput()</code> without specifying a file, you can copy the return value from Console and paste into a script. Or you can write to file and copy from there or add R commands below.</p>
</div>
<div id="other-types-of-objects-to-use-dput-or-saverds-on" class="section level3 hasAnchor" number="29.3.7">
<h3 class="hasAnchor"><span class="header-section-number">29.3.7</span> Other types of objects to use <code>dput()</code> or <code>saveRDS()</code> on<a href="#other-types-of-objects-to-use-dput-or-saverds-on" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>My special dispensation to abandon human-readable, plain text files is even broader than I‚Äôve let on. Above, I give my blessing to store data.frames via <code>dput()</code> and/or <code>saveRDS()</code>, when you‚Äôve done some rational factor level re-ordering. The same advice and mechanics apply a bit more broadly: you‚Äôre also allowed to use R-specific file formats to save vital non-rectangular objects, such as a fitted nonlinear mixed effects model or a classification and regression tree.</p>
</div>
</div>
<div id="clean-up" class="section level2 hasAnchor" number="29.4">
<h2 class="hasAnchor"><span class="header-section-number">29.4</span> Clean up<a href="#clean-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We‚Äôve written several files in this tutorial. Some of them are not of lasting value or have confusing filenames. I choose to delete them, while demonstrating some of the many functions R offers for interacting with the filesystem. It‚Äôs up to you whether you want to submit this command or not.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.remove</span>(<span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;^gap_life_exp&quot;</span>))</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span></code></pre></div>
<div id="pitfalls-of-delimited-files" class="section level3 hasAnchor" number="29.4.1">
<h3 class="hasAnchor"><span class="header-section-number">29.4.1</span> Pitfalls of delimited files<a href="#pitfalls-of-delimited-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If a delimited file contains fields where a human being has typed, be proactive! Expect the unexpected. People do all sorts of things. Especially people who aren‚Äôt in the business of programming and have never had to compute on text. Claim: a person‚Äôs regular expression skill is inversely proportional to the skill required to handle the files they create. Implication: if someone has never heard of regular expressions, prepare for lots of pain working with their files.</p>
<p>When the header fields (often, but not always, the variable names) or actual data contain the delimiter, it can lead to parsing and import failures. Two popular delimiters are the comma <code>,</code> and the TAB <code>\t</code> and humans tend to use these when typing. If you can design this problem away during data capture, such as by using a drop down menu on an input form, by all means do so. Sometimes this is impossible or undesirable and you must deal with fairly free form text. That‚Äôs a good time to allow/force text to be protected with quotes, because it will make parsing the delimited file go more smoothly.</p>
<p>Sometimes, instead of rigid tab-delimiting, whitespace is used as the delimiter. That is, in fact, the default for both <code>read.table()</code> and <code>write.table()</code>. Assuming you will write/read variable names from the first line (a.k.a. the <code>header</code> in <code>write.table()</code> and <code>read.table()</code>), they must be valid R variable names ‚Ä¶ or they will be coerced into something valid. So, for these two reasons, it is good practice to use ‚Äúone word‚Äù variable names whenever possible. If you need to evoke multiple words, use <code>snake_case</code> or <code>camelCase</code> to cope. <strong>Example:</strong> the header entry for the field holding the subject‚Äôs last name should be <code>last_name</code> or <code>lastName</code> NOT <code>last name</code>. With the readr package, ‚Äúcolumn names are left as is, not munged into valid R identifiers (i.e.¬†there is no <code>check.names = TRUE</code>)‚Äù. So you can get away with whitespace in variable names and yet I recommend that you do not.</p>
</div>
</div>
<div id="resources-2" class="section level2 hasAnchor" number="29.5">
<h2 class="hasAnchor"><span class="header-section-number">29.5</span> Resources<a href="#resources-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="http://r4ds.had.co.nz/data-import.html">Data import</a> chapter of <a href="https://r4ds.had.co.nz">R for Data Science</a> by Hadley Wickham and Garrett Grolemund <span class="citation">(<a href="#ref-wickham2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>White et al.‚Äôs ‚ÄúNine simple ways to make it easier to (re)use your data‚Äù <span class="citation">(<a href="#ref-white2013" role="doc-biblioref">2013</a>)</span>.</p>
<ul>
<li>First appeared <a href="https://doi.org/10.7287/peerj.preprints.7v2">in PeerJ Preprints</a></li>
<li>Published in <a href="https://ojs.library.queensu.ca/index.php/IEE/article/view/4608">Ideas in Ecology and Evolution in 2013</a></li>
<li>Section 4 ‚ÄúUse Standard Data Formats‚Äù is especially good reading.</li>
</ul>
<p>Wickham‚Äôs paper on tidy data in the Journal of Statistical Software <span class="citation">(<a href="#ref-wickham2014" role="doc-biblioref">2014</a>)</span>.</p>
<ul>
<li>Available as a PDF <a href="http://vita.had.co.nz/papers/tidy-data.pdf">here</a></li>
</ul>
<p>Data Manipulation in R by Phil Spector <span class="citation">(<a href="#ref-spector2008" role="doc-biblioref">2008</a>)</span>.</p>
<ul>
<li>Available via <a href="https://www.springer.com/gp/book/9780387747309">SpringerLink</a></li>
<li><a href="https://www.stat.berkeley.edu/%7Espector/">Author‚Äôs webpage</a></li>
<li><a href="https://books.google.com/books?id=grfuq1twFe4C&amp;lpg=PP1&amp;dq=data%2520manipulation%2520spector&amp;pg=PP1#v=onepage&amp;q&amp;f=false">GoogleBooks search</a></li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0402_import.Rmd-->
</div>
</div>
<div id="odd-transformations-data" class="section level1 hasAnchor" number="30">
<h1 class="hasAnchor"><span class="header-section-number">30</span> ODD: Transformations data!<a href="#odd-transformations-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This optional deep dive covers data transformations, and Tukey‚Äôs ladder of powers. (It isn‚Äôt complete right now‚Ä¶)</p>
<div id="transforming-data-tukeys-ladder-of-powers" class="section level2 hasAnchor" number="30.1">
<h2 class="hasAnchor"><span class="header-section-number">30.1</span> Transforming Data: Tukey‚Äôs Ladder of Powers<a href="#transforming-data-tukeys-ladder-of-powers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- http://blackwell.math.yorku.ca/math4939/lectures/transforming_data_tukeys_ladder_of_powers.R -->
<p>This material is based on <span class="citation">Fox (<a href="#ref-fox2016applied" role="doc-biblioref">2016</a>)</span> ch.¬†4, pp.¬†28 - 80.</p>
<p>We will use the following data set(s) from <span class="citation">Fox (<a href="#ref-fox2016applied" role="doc-biblioref">2016</a>)</span>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download these files manually.</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure to the directory to the file in which this file was saved</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fox_data &lt;- &quot;http://socserv.socsci.mcmaster.ca/jfox/Books/Applied-Regression-3E/datasets/&quot;</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co">#download.file(paste0(fox_data,&#39;UnitedNations.txt&#39;),&#39;UnitedNations.txt&#39;)</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;spida2&quot;</span>))  devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;gmonette/spida2&#39;</span>)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: spida2</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;p3d&quot;</span>))  <span class="fu">install.packages</span>(<span class="st">&quot;p3d&quot;</span>, <span class="at">repos =</span> <span class="st">&quot;http://R-Forge.R-project.org&quot;</span>)</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: p3d</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: rgl</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: car</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: carData</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: mgcv</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: nlme</span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;nlme&#39;</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:spida2&#39;:</span></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     getData</span></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; This is mgcv 1.8-41. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</span></span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;p3d&#39;</span></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:car&#39;:</span></span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Identify3d</span></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:spida2&#39;:</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     cell, center, ConjComp, dell, disp, ell, ell.conj, ellbox, ellplus,</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ellpt, ellptc, elltan, elltanc, uv</span></span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:knitr&#39;:</span></span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     spin</span></span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(p3d)</span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spida2)</span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra)</span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: lattice</span></span>
<span id="cb138-40"><a href="#cb138-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-41"><a href="#cb138-41" aria-hidden="true" tabindex="-1"></a><span class="co"># read data</span></span>
<span id="cb138-42"><a href="#cb138-42" aria-hidden="true" tabindex="-1"></a>un <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&#39;data/UnitedNations.txt&#39;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-43"><a href="#cb138-43" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(un)</span>
<span id="cb138-44"><a href="#cb138-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                region  tfr contraception educationMale educationFemale lifeMale</span></span>
<span id="cb138-45"><a href="#cb138-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Afghanistan      Asia 6.90            NA            NA              NA     45.0</span></span>
<span id="cb138-46"><a href="#cb138-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Albania        Europe 2.60            NA            NA              NA     68.0</span></span>
<span id="cb138-47"><a href="#cb138-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algeria        Africa 3.81            52          11.1             9.9     67.5</span></span>
<span id="cb138-48"><a href="#cb138-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; American.Samoa   Asia   NA            NA            NA              NA     68.0</span></span>
<span id="cb138-49"><a href="#cb138-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Andorra        Europe   NA            NA            NA              NA       NA</span></span>
<span id="cb138-50"><a href="#cb138-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Angola         Africa 6.69            NA            NA              NA     44.9</span></span>
<span id="cb138-51"><a href="#cb138-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                lifeFemale infantMortality GDPperCapita economicActivityMale</span></span>
<span id="cb138-52"><a href="#cb138-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Afghanistan          46.0             154         2848                 87.5</span></span>
<span id="cb138-53"><a href="#cb138-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Albania              74.0              32          863                   NA</span></span>
<span id="cb138-54"><a href="#cb138-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algeria              70.3              44         1531                 76.4</span></span>
<span id="cb138-55"><a href="#cb138-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; American.Samoa       73.0              11           NA                 58.8</span></span>
<span id="cb138-56"><a href="#cb138-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Andorra                NA              NA           NA                   NA</span></span>
<span id="cb138-57"><a href="#cb138-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Angola               48.1             124          355                   NA</span></span>
<span id="cb138-58"><a href="#cb138-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                economicActivityFemale illiteracyMale illiteracyFemale</span></span>
<span id="cb138-59"><a href="#cb138-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Afghanistan                       7.2         52.800            85.00</span></span>
<span id="cb138-60"><a href="#cb138-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Albania                            NA             NA               NA</span></span>
<span id="cb138-61"><a href="#cb138-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algeria                           7.8         26.100            51.00</span></span>
<span id="cb138-62"><a href="#cb138-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; American.Samoa                   42.4          0.264             0.36</span></span>
<span id="cb138-63"><a href="#cb138-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Andorra                            NA             NA               NA</span></span>
<span id="cb138-64"><a href="#cb138-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Angola                             NA             NA               NA</span></span>
<span id="cb138-65"><a href="#cb138-65" aria-hidden="true" tabindex="-1"></a>un<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">rownames</span>(un)</span></code></pre></div>
<p>Finding transformations to make regressions behave</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gd</span>() </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(infantMortality <span class="sc">~</span> GDPperCapita, un)</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(<span class="fu">log</span>(infantMortality) <span class="sc">~</span> <span class="fu">log</span>(GDPperCapita), un)</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<p>John Tukey suggested this simple toolkit, like a set drill bits of varying sizes, to modify the shape of distributions and the shape of relationships between variables. The basic idea stems from the fact that functions of the form</p>
<p><span class="math display">\[y&#39; = y^p, \quad y &gt; 0\]</span>
have a graph that is concave up if <span class="math inline">\(p &gt;1\)</span>, and concave down if <span class="math inline">\(0&lt;p&lt;1\)</span>.</p>
<p>For <span class="math inline">\(p &lt; 0\)</span>,</p>
<p><span class="math display">\[y&#39; = - y^p, \quad y &gt; 0\]</span></p>
<p>The graph is also concave down.</p>
<p>This graph leaves out <span class="math inline">\(p=0\)</span> but we will see shortly that <span class="math inline">\(y&#39; = \ln y\)</span> is the sensible transformation that corresponds to <span class="math inline">\(p = 0\)</span>.</p>
<p>Now, we standardize the family of power transformations so that they have the value 0 when <span class="math inline">\(y = 1\)</span> and so their derivative is equal to 1 when <span class="math inline">\(y=1\)</span>.</p>
<p>For <span class="math inline">\(p \ne 0\)</span>, this yields <span class="math display">\[y&#39; = \frac{y^p - 1}{p}\]</span></p>
<p>Note that, by l‚ÄôH√¥pital‚Äôs rule:</p>
<p><span class="math display">\[\lim_{p \to 0} \frac{y^p - 1}{p}= \lim_{p \to 0}\, e^{\, p \ln y} \ln  y = \ln  y\]</span></p>
<p>We define a function that produces this transformation. The easy way to define it is:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="cf">function</span>(y, p) {</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(y) </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> (y<span class="sc">^</span>p <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>p </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co"># test:</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>,.<span class="dv">5</span>)</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>x <span class="co"># note that these transformations are really intended for y &gt; 0</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -1.0 -0.5  0.0  0.5  1.0  1.5  2.0  2.5  3.0</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(x, <span class="dv">2</span>) </span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.000 -0.375 -0.500 -0.375  0.000  0.625  1.500  2.625  4.000</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(x, <span class="dv">0</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">name</span>(x)</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(y): NaNs produced</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -1   -0.5      0    0.5      1    1.5      2    2.5      3 </span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    NaN    NaN   -Inf -0.693  0.000  0.405  0.693  0.916  1.099</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(x, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">name</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>  cbind</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           .</span></span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1    2.000</span></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -0.5  3.000</span></span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0      -Inf</span></span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.5  -1.000</span></span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     0.000</span></span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1.5   0.333</span></span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     0.500</span></span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2.5   0.600</span></span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     0.667</span></span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(exp) <span class="co"># easy plotting of a function</span></span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">pow</span>(x, <span class="at">p=</span><span class="dv">2</span>)) <span class="co"># anonymous function or &#39;lambda&#39;</span></span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">pow</span>(x, <span class="at">p=</span>.<span class="dv">5</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>)) </span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<p>But this approach has the disadvantage that it works correctly only for a single value of <span class="math inline">\(p\)</span> because the statement <code>if(p == 0)</code> only tests the first element of <code>p</code>.</p>
</div>
<div id="vectorizing-a-function" class="section level2 hasAnchor" number="30.2">
<h2 class="hasAnchor"><span class="header-section-number">30.2</span> Vectorizing a function<a href="#vectorizing-a-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Most operators in R are <strong>vectorized</strong> so they work element-wise when their arguments are vectors. When the arguments have incompatible lengths, the shorter argument is <strong>recycled</strong> to have the same length as the longer one. That is why the following produces sensible results:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">9</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>z <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  4  6 10</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>z <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># 1 is recycled so the result is equivalent to the previous line</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  4  6 10</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>z <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  4  7 12</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>z <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="co"># recycles but gives a warning</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in z + c(1, 2): longer object length is not a multiple of shorter object</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; length</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  4  7 10</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>z <span class="sc">+</span> z</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  6 10 18</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>z<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  9 25 81</span></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>z<span class="sc">^</span>z</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.70e+01 3.12e+03 3.87e+08</span></span></code></pre></div>
<p>We can use <code>ifelse</code> which works on a vector instead of a single value.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="cf">function</span>(y, p) {</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(p, <span class="at">length.out =</span> <span class="fu">length</span>(y))</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rep</span>(y, <span class="at">length.out =</span> <span class="fu">length</span>(p))</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(p<span class="sc">==</span><span class="dv">0</span>, <span class="fu">log</span>(y), (y<span class="sc">^</span>p <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>p) </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co"># test:</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(y): NaNs produced</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.00 -Inf 0.00 1.00 8.67 7.50</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.0 -0.5  0.0  1.5  4.0  7.5</span></span></code></pre></div>
<p>With a bit more work, we can avoid unnecessary evaluations:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="cf">function</span>(y, p) {</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(p, <span class="at">length.out =</span> <span class="fu">length</span>(y))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rep</span>(y, <span class="at">length.out =</span> <span class="fu">length</span>(p))</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  y[p<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(y[p<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  y[p<span class="sc">!=</span><span class="dv">0</span>] <span class="ot">&lt;-</span> (y[p<span class="sc">!=</span><span class="dv">0</span>]<span class="sc">^</span>p[p<span class="sc">!=</span><span class="dv">0</span>] <span class="sc">-</span><span class="dv">1</span>) <span class="sc">/</span> p[p<span class="sc">!=</span><span class="dv">0</span>]</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  y</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Test:</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">0</span>) <span class="sc">==</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 0.000 0.500 0.667 0.750 0.800 0.833 0.857 0.875 0.889 0.900</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,.<span class="dv">5</span>)</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 0.000 0.828 1.464 2.000 2.472 2.899 3.292 3.657 4.000 4.325</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="fu">pow</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 0.00e+00 6.93e-01 2.00e+00 7.50e+00 4.13e+01 3.24e+02 3.36e+03 4.37e+04</span></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] 6.83e+05 1.25e+07</span></span></code></pre></div>
<p>Let‚Äôs plot this transformation for a range of values of <span class="math inline">\(p\)</span>. The value of <code>expand.grid</code> is a data frame whose rows consist of the Cartesian product (i.e.¬†all possible combinations) of its arguments.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expand.grid</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>), <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   a x</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 A 1</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 B 1</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 A 2</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 B 2</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 A 3</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 B 3</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">y =</span> <span class="fu">seq</span>(.<span class="dv">01</span>,<span class="dv">3</span>,.<span class="dv">01</span>), <span class="at">p =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span>.<span class="dv">5</span>,<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dd)</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2400    2</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dd)</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      y  p</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.01 -2</span></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.02 -2</span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.03 -2</span></span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.04 -2</span></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0.05 -2</span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 0.06 -2</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a><span class="fu">some</span>(dd) <span class="co"># 10 rows at random</span></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         y  p</span></span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24   0.24 -2</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39   0.39 -2</span></span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 270  2.70 -2</span></span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 330  0.30 -1</span></span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 385  0.85 -1</span></span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 954  0.54  0</span></span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1671 1.71  1</span></span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1726 2.26  1</span></span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1838 0.38  2</span></span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1881 0.81  2</span></span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>yval <span class="ot">&lt;-</span> <span class="fu">with</span>(dd, <span class="fu">pow</span>(y,p))</span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(yval <span class="sc">~</span> y<span class="sc">|</span> <span class="fu">factor</span>(p), dd, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(yval <span class="sc">~</span> y<span class="sc">|</span> <span class="fu">factor</span>(p), dd, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fu">max</span>(dd<span class="sc">$</span>yval)))</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(yval <span class="sc">~</span> y , dd, <span class="at">groups =</span> p, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fu">max</span>(dd<span class="sc">$</span>yval)))</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(yval <span class="sc">~</span> y , dd, </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> p, </span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fu">max</span>(dd<span class="sc">$</span>yval)))</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gd</span>(<span class="dv">8</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="co"># number of colours needed</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(yval <span class="sc">~</span> y , dd, </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> p, </span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fu">max</span>(dd<span class="sc">$</span>yval)))</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-8-5.png" width="672" /></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(yval <span class="sc">~</span> y , dd, </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> p, </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">space =</span> <span class="st">&#39;right&#39;</span>,<span class="at">lines =</span> T, <span class="at">points =</span> F),</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fu">max</span>(dd<span class="sc">$</span>yval)))</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-8-6.png" width="672" /></p>
<p>It‚Äôs much better to have the legend in the same order as the lines in the graph. We can turn <code>p</code> into a factor and reverse its order.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>po <span class="ot">&lt;-</span> <span class="fu">factor</span>(dd<span class="sc">$</span>p)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>po <span class="ot">&lt;-</span> <span class="fu">reorder</span>(dd<span class="sc">$</span>po, <span class="sc">-</span>dd<span class="sc">$</span>p)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(yval <span class="sc">~</span> y , dd, </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">groups =</span> po, </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">space =</span> <span class="st">&#39;right&#39;</span>,<span class="at">lines =</span> T, <span class="at">points =</span> F, <span class="at">title=</span><span class="st">&#39;power&#39;</span>),</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fu">max</span>(dd<span class="sc">$</span>yval)))</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>From quantile plots:</p>
<p>Uniform quantiles‚Ä¶</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xqplot</span>(un)</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-10-1.png" width="672" /><img src="0403_transformations_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>Normal quantiles</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xqplot</span>(un, <span class="at">ptype =</span> <span class="st">&#39;normal&#39;</span>)</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-11-1.png" width="672" /><img src="0403_transformations_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p>We see that none of the numeric variables have normal distributions.</p>
<ul>
<li>‚Äòage‚Äô is somewhat platykurtic compared with a normal</li>
<li>‚ÄòcompositeHourlyWages‚Äô has both a categorical (0) and a continuous component</li>
<li>‚Äòeducation‚Äô is also platykurtic</li>
<li>‚Äòworking‚Äô is dichotomous</li>
<li>‚ÄòfamilyIncome‚Äô is skewed to the right</li>
</ul>
<p>Note that the fact that <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span> variables are not normal does not mean that the conditional distribution of <span class="math inline">\(y\)</span> given <span class="math inline">\(x\)</span> is not normal.</p>
<p>Let‚Äôs explore wages of working women as a function of education.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>un <span class="sc">%&gt;%</span> </span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xyplot</span>(infantMortality <span class="sc">~</span> GDPperCapita, .) <span class="sc">+</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer</span>(<span class="fu">panel.loess</span>(..., <span class="at">lwd =</span> <span class="dv">2</span>))</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot showing curvature in relationship</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="fu">trellis.focus</span>()</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="fu">panel.identify</span>(<span class="at">labels=</span><span class="fu">rownames</span>(un))</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; integer(0)</span></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="fu">trellis.unfocus</span>()</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>un <span class="sc">%&gt;%</span> </span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xyplot</span>(<span class="fu">log</span>(infantMortality) <span class="sc">~</span> GDPperCapita <span class="sc">|</span> region, .) <span class="sc">+</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer</span>(<span class="fu">panel.loess</span>(..., <span class="at">lwd =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="0403_transformations_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>un <span class="sc">%&gt;%</span> <span class="fu">subset</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;United.States&#39;</span>,<span class="st">&#39;Canada&#39;</span>))</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                region  tfr contraception educationMale educationFemale lifeMale</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Canada        America 1.61            66          17.2            17.8     76.1</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; United.States America 1.96            71          15.4            16.2     73.4</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               lifeFemale infantMortality GDPperCapita economicActivityMale</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Canada              81.8               6        18943                 72.4</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; United.States       80.1               7        26037                 74.9</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               economicActivityFemale illiteracyMale illiteracyFemale</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Canada                          57.6             NA               NA</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; United.States                   59.3           2.24             2.23</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     country</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Canada               Canada</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; United.States United.States</span></span></code></pre></div>
<p>between wage and education, and heteroskedasticity in wage as a function of education.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(p3d)</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="co">#slid %&gt;% </span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  xyplot(sqrt(wage) ~ education, .) + </span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  layer(panel.loess(...))</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Init3d()</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot3d(log(infantMortality) ~ GDPperCapita + lifeFemale | region, un)</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Id3d()</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Id3d(&#39;United.States&#39;)</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Id3d(&#39;Canada&#39;)</span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a><span class="co">#rownames(un)</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="co">#names(un)</span></span></code></pre></div>
</div>
<div id="box-cox-transformation" class="section level2 hasAnchor" number="30.3">
<h2 class="hasAnchor"><span class="header-section-number">30.3</span> Box Cox Transformation<a href="#box-cox-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/vGOpEpjz2Ks" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>This video was made by <a href="https://www.youtube.com/channel/UCYNVcihAKkRW-bhzIrguvVw">math et al</a>. I like their channel and found this video to be a good one.</p>
<div id="additional-resources" class="section level3 hasAnchor" number="30.3.1">
<h3 class="hasAnchor"><span class="header-section-number">30.3.1</span> Additional Resources<a href="#additional-resources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Salvatore S. Mangiafico‚Äôs Summary and Analysis of Extension Program Evaluation in R, <a href="http://rcompanion.org/handbook/">rcompanion.org/handbook/</a>. <a href="http://rcompanion.org/documents/RHandbookProgramEvaluation.pdf">Pdf version</a></p></li>
<li><p><a href="http://www.unige.ch/ses/sococ/cl//stat/eda/ladder.html" class="uri">http://www.unige.ch/ses/sococ/cl//stat/eda/ladder.html</a></p></li>
<li><p><a href="https://www.statisticshowto.com/tukey-ladder-of-powers/" class="uri">https://www.statisticshowto.com/tukey-ladder-of-powers/</a></p></li>
<li><p><a href="http://blackwell.math.yorku.ca/math4939/lectures/transforming_data_tukeys_ladder_of_powers.html" class="uri">http://blackwell.math.yorku.ca/math4939/lectures/transforming_data_tukeys_ladder_of_powers.html</a></p></li>
<li><p><a href="https://thomaselove.github.io/431-notes/re-expression-tukeys-ladder-box-cox-plot.html" class="uri">https://thomaselove.github.io/431-notes/re-expression-tukeys-ladder-box-cox-plot.html</a></p></li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0403_transformations.Rmd-->
</div>
</div>
</div>
<div id="lab04" class="section level1 hasAnchor" number="31">
<h1 class="hasAnchor"><span class="header-section-number">31</span> Lab: Visualizing spatial data<a href="#lab04" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="la-quinta-is-spanish-for-next-to-dennys-pt.-1" class="section level2 hasAnchor" number="31.1">
<h2 class="hasAnchor"><span class="header-section-number">31.1</span> La Quinta is Spanish for ‚Äònext to Denny‚Äôs‚Äô, Pt. 1<a href="#la-quinta-is-spanish-for-next-to-dennys-pt.-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="img/mitch-hedgeberg-lqd.jpg" width="640" /></p>
<p>Have you ever taken a road trip in the US and thought to yourself ‚ÄúI wonder what La Quinta means‚Äù. Well, the late comedian <a href="https://en.wikipedia.org/wiki/Mitch_Hedberg">Mitch Hedberg</a> has joked that it‚Äôs Spanish for <em>next to Denny‚Äôs</em>.</p>
<p>If you‚Äôre not familiar with these two establishments, <a href="https://www.dennys.com/">Denny‚Äôs</a> is a casual diner chain that is open 24 hours and <a href="http://www.lq.com/">La Quinta Inn and Suites</a> is a hotel chain.</p>
<p>These two establishments tend to be clustered together, or at least this observation is a joke made famous by Mitch Hedberg. In this lab, we explore the validity of this joke and along the way learn some more data wrangling and tips for visualizing spatial data.</p>
<p>This lab was inspired by John Reiser‚Äôs post in his <em>New Jersey geographer</em> blog. You can read that analysis <a href="http://njgeo.org/2014/01/30/mitch-hedberg-and-gis/">here</a>. Reiser‚Äôs blog post focuses on scraping data from Denny‚Äôs and La Quinta Inn and Suites websites using Python. In this lab, we focus on visualization and analysis of those data. However, it‚Äôs worth noting that the data scraping was also done in R. Later in the course,we will discuss web scraping using R . But for now, we‚Äôre focusing on the data that has already been scraped and tidied up for you.</p>
</div>
<div id="getting-started-3" class="section level2 hasAnchor" number="31.2">
<h2 class="hasAnchor"><span class="header-section-number">31.2</span> Getting started<a href="#getting-started-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go to the course GitHub organization and locate the lab repo, which should be named something like <code>lab-04-viz-sp-data</code>.
Either Fork it or copy it as a template. Then clone it in RStudio. First, open the R Markdown document <code>lab-04.Rmd</code> and Knit it. Make sure it compiles without errors. The output will be in the file markdown <code>.md</code> file with the same name.</p>
<div id="packages-3" class="section level3 hasAnchor" number="31.2.1">
<h3 class="hasAnchor"><span class="header-section-number">31.2.1</span> Packages<a href="#packages-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab, we will use the <strong>tidyverse</strong> and <strong>dsbox</strong> packages. The *dsbox** package is not on CRAN yet; instead it is hosted on github. You will have to download and <a href="https://github.com/rstudio-education/dsbox#installation">install it yourself</a>. This piece of code should help get you started.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;rstudio-education/dsbox&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsbox) </span></code></pre></div>
<p>If you cannot get <code>dsbox</code> to install, you can also download the two datasets we will be using manually <a href="https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/laquinta.rda">here</a> and <a href="https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/dennys.rda">here</a> .</p>
<pre><code>githubURL_1 &lt;- &quot;https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/laquinta.rda&quot;

githubURL_2 &lt;- &quot;https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/dennys.rda&quot;

load(url(githubURL_1))
load(url(githubURL_2))
</code></pre>
</div>
<div id="project-name" class="section level3 hasAnchor" number="31.2.2">
<h3 class="hasAnchor"><span class="header-section-number">31.2.2</span> Project name<a href="#project-name" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Currently your project is called <em>Untitled Project</em>. Update the name of your project to be ‚ÄúLab 04 - Visualizing spatial data‚Äù.</p>
</div>
<div id="warm-up-3" class="section level3 hasAnchor" number="31.2.3">
<h3 class="hasAnchor"><span class="header-section-number">31.2.3</span> Warm up<a href="#warm-up-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we introduce the data, let‚Äôs warm up with some simple exercises.</p>
</div>
<div id="yaml-1" class="section level3 hasAnchor" number="31.2.4">
<h3 class="hasAnchor"><span class="header-section-number">31.2.4</span> YAML<a href="#yaml-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Open the R Markdown (Rmd) file in your project, change the author name to your name, and knit the document.</p>
</div>
<div id="commiting-and-pushing-changes" class="section level3 hasAnchor" number="31.2.5">
<h3 class="hasAnchor"><span class="header-section-number">31.2.5</span> Commiting and pushing changes<a href="#commiting-and-pushing-changes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Go to the <strong>Git</strong> pane in your RStudio.</li>
<li>View the <strong>Diff</strong> and confirm that you are happy with the changes.</li>
<li>Add a commit message like ‚ÄúUpdate team name‚Äù in the <strong>Commit message</strong> box and hit <strong>Commit</strong>.</li>
<li>Click on <strong>Push</strong>. This action will prompt a dialogue box where you first need to enter your user name, and then your password.</li>
</ul>
</div>
</div>
<div id="the-data" class="section level2 hasAnchor" number="31.3">
<h2 class="hasAnchor"><span class="header-section-number">31.3</span> The data<a href="#the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The datasets we‚Äôll use are called <code>dennys</code> and <code>laquinta</code> from the <strong>dsbox</strong> package.
Note that these data were scraped from <a href="https://locations.dennys.com/">here</a> and <a href="https://www.lq.com/en/findandbook/hotel-listings.html">here</a>, respectively.</p>
<p>To help with our analysis we will also use a dataset on US states:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/states.csv&quot;</span>)</span></code></pre></div>
<p>Each observation in this dataset represents a state, including DC. Along with the name of the state we have the two-letter abbreviation and we have the geographic area of the state (in square miles).</p>
</div>
<div id="exercises-3" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Exercises<a href="#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>What are the dimensions of the Denny‚Äôs dataset? (Hint: Use inline R code and functions like <code>nrow</code> and <code>ncol</code> to compose your answer.) What does each row in the dataset represent? What are the variables?</p></li>
<li><p>What are the dimensions of the La Quinta‚Äôs dataset? What does each row in the dataset represent? What are the variables?</p></li>
</ol>
<p>We would like to limit our analysis to Denny‚Äôs and La Quinta locations in the United States.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Take a look at the websites that the data come from (linked above). Are there any La Quinta‚Äôs locations outside of the US? If so, which countries? What about Denny‚Äôs?</p></li>
<li><p>Now take a look at the data. What would be some ways of determining whether or not either establishment has any locations outside the US using just the data (and not the websites). Don‚Äôt worry about whether you know how to implement this, just brainstorm some ideas. Write down at least one as your answer, but you‚Äôre welcomed to write down a few options too.</p></li>
</ol>
<p>We will determine whether or not the establishment has a location outside the US using the <code>state</code> variable in the <code>dn</code> and <code>lq</code> datasets. We know exactly which states are in the US, and we have this information in the <code>states</code> dataframe we loaded.</p>
<ol start="5" style="list-style-type: decimal">
<li>Find the Denny‚Äôs locations that are outside the US, if any. To do so, filter the Denny‚Äôs locations for observations where <code>state</code> is not in <code>states$abbreviation</code>. The code for this is given below. Note that the <code>%in%</code> operator matches the states listed in the <code>state</code> variable to those listed in <code>states$abbreviation</code>. The <code>!</code> operator means <strong>not</strong>. Are there any Denny‚Äôs locations outside the US?</li>
</ol>
<blockquote>
<p>Hint: Some of the abbreviations may not be familiar to you. Professor Google might be able to help.</p>
</blockquote>
<blockquote>
<p>‚ÄúFilter for <code>state</code>s that are not in <code>states$abbreviation</code>.‚Äù</p>
</blockquote>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>dn <span class="sc">%&gt;%</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(state <span class="sc">%in%</span> states<span class="sc">$</span>abbreviation))</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Add a country variable to the Denny‚Äôs dataset and set all observations equal to <code>"United States"</code>. Remember, you can use the <code>mutate</code> function for adding a variable. Make sure to save the result of this as <code>dn</code> again so that the stored data frame contains the new variable going forward.</li>
</ol>
<blockquote>
<p>Comment: We don‚Äôt need to tell R how many times to repeat the character string ‚ÄúUnited States‚Äù to fill in the data for all observations, R takes care of that automatically.</p>
</blockquote>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>dn <span class="sc">%&gt;%</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="st">&quot;United States&quot;</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><p>Find the La Quinta locations that are outside the US, and figure out which country they are in. This might require some googling. Take notes, you will need to use this information in the next exercise.</p></li>
<li><p>Add a country variable to the La Quinta dataset. Use the <code>case_when</code> function to populate this variable. You‚Äôll need to refer to your notes from Exercise 7 about which country the non-US locations are in. Here is some starter code to get you going:</p></li>
</ol>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>lq <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">case_when</span>(</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">%in%</span> state.abb     <span class="sc">~</span> <span class="st">&quot;United States&quot;</span>,</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ON&quot;</span>, <span class="st">&quot;BC&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Canada&quot;</span>,</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">&quot;ANT&quot;</span>           <span class="sc">~</span> <span class="st">&quot;Colombia&quot;</span>,</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>    ...                      <span class="co"># fill in the rest</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
<p><span class="newthought">Going forward</span> we will work with the data from the United States only. All Denny‚Äôs locations are in the United States, so we don‚Äôt need to worry about them. However we do need to filter the La Quinta dataset for locations in United States.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>lq <span class="ot">&lt;-</span> lq <span class="sc">%&gt;%</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>)</span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>Which states have the most and fewest Denny‚Äôs locations? What about La Quinta? Is this surprising? Why or why not?</li>
</ol>
<p>Next, let‚Äôs calculate which states have the most Denny‚Äôs locations <em>per thousand square miles</em>. This requires <em>join</em>ining information from the frequency tables you created in the previous set with information from the <code>states</code> data frame.</p>
<p>First, we count how many observations are in each state, which will give us a data frame with two variables: <code>state</code> and <code>n</code>. Then, we join this data frame with the <code>states</code> data frame. However note that the variables in the <code>states</code> data frame that has the two-letter abbreviations is called <code>abbreviation</code>. So when we‚Äôre joining the two data frames we specify that the <code>state</code> variable from the Denny‚Äôs data should be matched <code>by</code> the <code>abbreviation</code> variable from the <code>states</code> data:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>dn <span class="sc">%&gt;%</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(states, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;state&quot;</span> <span class="ot">=</span> <span class="st">&quot;abbreviation&quot;</span>))</span></code></pre></div>
<p>Before you move on the the next question, run the code above and take a look at the output. In the next exercise, you will need to build on this pipe.</p>
<ol start="10" style="list-style-type: decimal">
<li>Which states have the most Denny‚Äôs locations per thousand square miles? What about La Quinta?</li>
</ol>
<p>Next, we put the two datasets together into a single data frame. However before we do so, we need to add an identifier variable. We‚Äôll call this <code>establishment</code> and set the value to <code>"Denny's"</code> and <code>"La Quinta"</code> for the <code>dn</code> and <code>lq</code> data frames, respectively.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>dn <span class="ot">&lt;-</span> dn <span class="sc">%&gt;%</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">establishment =</span> <span class="st">&quot;Denny&#39;s&quot;</span>)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>lq <span class="ot">&lt;-</span> lq <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">establishment =</span> <span class="st">&quot;La Quinta&quot;</span>)</span></code></pre></div>
<p>Because the two data frames have the same columns, we can easily bind them with the <code>bind_rows</code> function:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>dn_lq <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dn, lq)</span></code></pre></div>
<p>We can plot the locations of the two establishments using a scatter plot, and color the points by the establishment type. Note that the latitude is plotted on the x-axis and the longitude on the y-axis.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dn_lq, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> longitude,</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> latitude,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">color =</span> establishment)) <span class="sc">+</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>The following two questions ask you to create visualizations. These visualizations should follow best practices you learned in class, such as informative titles, axis labels, etc. See <a href="http://ggplot2.tidyverse.org/reference/labs.html" class="uri">http://ggplot2.tidyverse.org/reference/labs.html</a> for help with the syntax. You can also choose different themes to change the overall look of your plots, see <a href="http://ggplot2.tidyverse.org/reference/ggtheme.html" class="uri">http://ggplot2.tidyverse.org/reference/ggtheme.html</a> for help with these.</p>
<ol start="11" style="list-style-type: decimal">
<li><p>Filter the data for observations in North Carolina only, and recreate the plot. You should also adjust the transparency of the points, by setting the <code>alpha</code> level, so that it‚Äôs easier to see the overplotted ones. Visually, does Mitch Hedberg‚Äôs joke appear to hold here?</p></li>
<li><p>Now filter the data for observations in Texas only, and recreate the plot, with an appropriate <code>alpha</code> level. Visually, does Mitch Hedberg‚Äôs joke appear to hold here?</p></li>
</ol>
<p>That‚Äôs it for now! In the next lab, we will take a more quantitative approach to answering these questions.</p>
<!--chapter:end:0404_lab_dennys.Rmd-->
</div>
</div>
<div id="part-module-05" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 05<a href="#part-module-05" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-tips-for-effective-data-visualization" class="section level1 hasAnchor" number="32">
<h1 class="hasAnchor"><span class="header-section-number">32</span> Welcome to Tips for effective data visualization<a href="#welcome-to-tips-for-effective-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce ideas related to effective data visualization. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYYMIguiV1F8RagMYibTY4iW">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-4" class="section level2 hasAnchor" number="32.1">
<h2 class="hasAnchor"><span class="header-section-number">32.1</span> Module Materials<a href="#module-materials-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides
<ul>
<li><a href="https://datascience4psych.github.io/slides/d13_goodviz/d13_goodviz.html">Tips for effective data visualization</a></li>
<li><a href="https://datascience4psych.github.io/slides/d13_goodviz/d13b_moreggplot.html">Deep Diving into ggplot</a></li>
</ul></li>
<li>Activities
<ul>
<li><a href="https://github.com/DataScience4Psych/ae-07-brexit-story-dataviz">Brexit</a></li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab05">More Dennys</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li><a href="http://vita.had.co.nz/papers/layered-grammar.html">A layered grammar of graphics</a></li>
<li>All subchapters of this module</li>
<li><a href="https://r4ds.had.co.nz/">r4ds</a>
<ul>
<li><a href="https://r4ds.had.co.nz/graphics-for-communication.html">Graphics for communication</a></li>
<li><a href="https://r4ds.had.co.nz/data-visualisation.html">Data visualisation</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="estimated-video-length-4" class="section level2 hasAnchor" number="32.2">
<h2 class="hasAnchor"><span class="header-section-number">32.2</span> Estimated Video Length<a href="#estimated-video-length-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No of videos : 7</p>
<p>Average length of video : 12 minutes, 23 seconds</p>
<p>Total length of playlist : 1 hour, 26 minutes, 46 seconds</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Me to the first drafts of my data visualizations : <a href="https://t.co/oorGsjxe9Z">pic.twitter.com/oorGsjxe9Z</a></p>&mdash; Chelsea Parlett-Pelleriti (@ChelseaParlett) <a href="https://twitter.com/ChelseaParlett/status/1361516386925744129?ref_src=twsrc%5Etfw">February 16, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">A piece of advice that I constantly think about from grad school:<br><br>Design your tables and figures as though that&#39;s the only thing your reviewers are reading.</p>&mdash; Joshua P. Darr (@joshuadarr) <a href="https://twitter.com/joshuadarr/status/1466150736283242498?ref_src=twsrc%5Etfw">December 1, 2021</a></blockquote>

</div>
</div>
<div id="designing-effective-visualizations" class="section level1 hasAnchor" number="33">
<h1 class="hasAnchor"><span class="header-section-number">33</span> Designing effective visualizations<a href="#designing-effective-visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/H9NHHs5VKZc" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d13_goodviz/d13_goodviz.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d13_goodviz/d13_goodviz.html" width="672" height="400px" data-external="1">
</iframe>
<div id="principles-for-effective-visualizations" class="section level2 hasAnchor" number="33.1">
<h2 class="hasAnchor"><span class="header-section-number">33.1</span> Principles for effective visualizations!<a href="#principles-for-effective-visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/oxLB5rg3prA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d13_goodviz/d13_goodviz.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d13_goodviz/d13_goodviz.html#7" width="672" height="400px" data-external="1">
</iframe>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">My very favorite example about truncating the y-axis. <a href="https://t.co/h6jxCQqgz5">https://t.co/h6jxCQqgz5</a></p>&mdash; Dr. Jess Hartnett üìä (@Notawful) <a href="https://twitter.com/Notawful/status/1457441237787676672?ref_src=twsrc%5Etfw">November 7, 2021</a></blockquote>

</div>
</div>
<div id="deeper-diving-into-ggplot2" class="section level1 hasAnchor" number="34">
<h1 class="hasAnchor"><span class="header-section-number">34</span> Deeper Diving into ggplot2!<a href="#deeper-diving-into-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/xLBMJMkwc-U" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d13_goodviz/d13b_moreggplot.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d13_goodviz/d13b_moreggplot.html" width="672" height="400px" data-external="1">
</iframe>
<div id="what-are-the-components-of-a-plot" class="section level2 hasAnchor" number="34.1">
<h2 class="hasAnchor"><span class="header-section-number">34.1</span> What are the components of a plot?<a href="#what-are-the-components-of-a-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Eg6hH-1qX5I" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d13_goodviz/d13b_moreggplot.html#15" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="stats-geoms-and-positions" class="section level2 hasAnchor" number="34.2">
<h2 class="hasAnchor"><span class="header-section-number">34.2</span> Stats, Geoms, and Positions<a href="#stats-geoms-and-positions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/SklAl8uyuv4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d13_goodviz/d13b_moreggplot.html#27" width="672" height="400px" data-external="1">
</iframe>
<div id="jitter-to-the-rescue" class="section level3 hasAnchor" number="34.2.1">
<h3 class="hasAnchor"><span class="header-section-number">34.2.1</span> Jitter to the rescue!<a href="#jitter-to-the-rescue" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">now with jitter: <a href="https://t.co/XziQHdYN4s">pic.twitter.com/XziQHdYN4s</a></p>&mdash; Mijke Rhemtulla (@mijkenijk) <a href="https://twitter.com/mijkenijk/status/1365913365755822089?ref_src=twsrc%5Etfw">February 28, 2021</a></blockquote>

</div>
</div>
<div id="scales-and-coordinates" class="section level2 hasAnchor" number="34.3">
<h2 class="hasAnchor"><span class="header-section-number">34.3</span> Scales and Coordinates<a href="#scales-and-coordinates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/vn8RToV1cc4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d13_goodviz/d13b_moreggplot.html#39" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="how-this-all-works-with-minard" class="section level2 hasAnchor" number="34.4">
<h2 class="hasAnchor"><span class="header-section-number">34.4</span> How this all works with Minard<a href="#how-this-all-works-with-minard" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/9nWaGrEMA54" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d13_goodviz/d13b_moreggplot.html#57" width="672" height="400px" data-external="1">
</iframe>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0501_goodviz.Rmd-->
</div>
</div>
<div id="plots-behaving-badly" class="section level1 hasAnchor" number="35">
<h1 class="hasAnchor"><span class="header-section-number">35</span> Plots Behaving Badly<a href="#plots-behaving-badly" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section is based on talk by Karl W. Broman titled ‚ÄúHow to Display Data Badly‚Äù in which he described how the default plots offered by Microsoft Excel ‚Äúobscure your data and annoy your readers‚Äù. His lecture was inspired by Howard Wainer‚Äôs 1984 paper: How to display data badly. American Statistician 38(2): 137‚Äì147. Howard was the first to elucidate the principles of the bad display of data. But according to Karl ‚ÄúThe now widespread use of Microsoft Excel has resulted in remarkable advances in the field.‚Äù</p>
<div id="general-principles" class="section level2 hasAnchor" number="35.1">
<h2 class="hasAnchor"><span class="header-section-number">35.1</span> General Principles<a href="#general-principles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>General principles</p>
<p>The aims of good data graphics is to display data accurately and clearly. Some rules for displaying data badly:</p>
<ul>
<li>Display as little information as possible.</li>
<li>Obscure what you do show (with chart junk).</li>
<li>Use pseudo-3d and color gratuitously.</li>
<li>Make a pie chart (preferably in color and 3d).</li>
<li>Use a poorly chosen scale.</li>
<li>Ignore significant figures.</li>
</ul>
<div id="piecharts" class="section level3 hasAnchor" number="35.1.1">
<h3 class="hasAnchor"><span class="header-section-number">35.1.1</span> Piecharts<a href="#piecharts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Say we want the report the results from a poll asking about browser preference (taken in August 2013). The standard way of displaying these is with a piechart:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(browsers,</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Browser Usage (August 2013)&quot;</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>But as stated by the help file for the <code>pie</code> function:</p>
<blockquote>
<p>Pie charts are a very bad way of displaying information. The eye is good at judging linear measures and bad at judging relative areas. A bar chart or dot chart is a preferable way of displaying this type of data.</p>
</blockquote>
<p>To see this, look at the figure above an try to determine the percentages just from looking at the plot. Simply showing the numbers is not only clear but it saves on printing costs.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>browsers</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Opera  Safari Firefox      IE  Chrome </span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       1       9      20      26      44</span></span></code></pre></div>
<p>If you do want to plot them, then a barplot is appropriate:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(browsers,</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Browser Usage (August 2013)&quot;</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-5-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Note that we can now pretty easily determine the percentages by following a horizontal line to the x-axis. Do avoid 3-D version as they obfuscate the plot and remove this particular advantage.</p>
<p><img src="img/fig2b.png" width="671" style="display: block; margin: auto;" /></p>
<p>Note that even worse that piecharts are donut plots.</p>
<p><img src="img/Donut-Chart.svg.png" width="1024" /></p>
<p>The reason is that by removing the center we remove one of the visual cues for determining the different areas: the angles. There is no reason to ever use a donut to display data.</p>
</div>
<div id="barplots-as-data-summaries" class="section level3 hasAnchor" number="35.1.2">
<h3 class="hasAnchor"><span class="header-section-number">35.1.2</span> Barplots as data summaries<a href="#barplots-as-data-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although barplots are useful for showing percentages, they are incorrectly used to display data from two groups begin compared. Specifically, barplots are created with height equal to the group means and an antenna is added at the top to represent standard errors. This plot is simply showing two numbers per groups and the plot adds nothing:</p>
<p><img src="img/fig1c.png" width="335" style="display: block; margin: auto;" /></p>
<p>Much more informative is to summarizing with a boxplot. If the number of points is small enough, we might as well add them to the plot. When the number of points is too large for us to see them, just showing a boxplot is preferable.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(&quot;downloader&quot;)</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co">#tmpfile &lt;- tempfile()</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co">#download(&quot;https://github.com/kbroman/Talk_Graphs/raw/master/R/fig1.RData&quot;)</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/badgraphfig1.RData&quot;</span>)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rafalib)</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Treatment=</span>x,</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">Control=</span>y)</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(<span class="at">xlab =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span>,</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="dv">0</span>)</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stripchart</span>(</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertical =</span> <span class="cn">TRUE</span>,</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;jitter&quot;</span>,</span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="dv">1</span></span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Note how much more we see here: the center, spread, range and the points themselves while in the barplot we only see the mean and the SE and the SE has more to do with sample size than the spread of the data.</p>
<p>This problem is magnified when our data has outliers or very large tails. Note that from this plot there appears to be very large and consistent difference between the two groups:</p>
<p><img src="img/fig3c.png" width="336" style="display: block; margin: auto;" /></p>
<p>A quick look at the data demonstrates that this difference is mostly driven by just two points. A version showing the data in the log-scale is much more informative.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#download(&quot;https://github.com/kbroman/Talk_Graphs/raw/master/R/fig3.RData&quot;,tmpfile) ##overwrite</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="co">#load(tmpfile)</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/badgraphfig3.RData&quot;</span>)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rafalib)</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Treatment =</span> x,</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">Control =</span> y)</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span>,</span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span>,</span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">0</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in (function (z, notch = FALSE, width = NULL, varwidth = FALSE, :</span></span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Duplicated arguments xlab = &quot;Group&quot;, ylab = &quot;Response&quot; are disregarded</span></span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(</span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertical =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;jitter&quot;</span>,</span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="dv">1</span></span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(</span>
<span id="cb176-32"><a href="#cb176-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb176-33"><a href="#cb176-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span>,</span>
<span id="cb176-34"><a href="#cb176-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb176-35"><a href="#cb176-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span>,</span>
<span id="cb176-36"><a href="#cb176-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb176-37"><a href="#cb176-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="dv">0</span></span>
<span id="cb176-38"><a href="#cb176-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb176-39"><a href="#cb176-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in (function (z, notch = FALSE, width = NULL, varwidth = FALSE, :</span></span>
<span id="cb176-40"><a href="#cb176-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Duplicated arguments xlab = &quot;Group&quot;, ylab = &quot;Response&quot; are disregarded</span></span>
<span id="cb176-41"><a href="#cb176-41" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb176-42"><a href="#cb176-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stripchart</span>(</span>
<span id="cb176-43"><a href="#cb176-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertical =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-44"><a href="#cb176-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;jitter&quot;</span>,</span>
<span id="cb176-45"><a href="#cb176-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb176-46"><a href="#cb176-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-47"><a href="#cb176-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="dv">1</span></span>
<span id="cb176-48"><a href="#cb176-48" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="show-the-scatterplot" class="section level3 hasAnchor" number="35.1.3">
<h3 class="hasAnchor"><span class="header-section-number">35.1.3</span> Show the scatterplot<a href="#show-the-scatterplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The purpose of many statistical analyses is to determine relationships between two variables. Sample correlations are typically reported and sometimes plots are displayed to show this. However, showing just the regression line is one way to display your data baldy as it hides the scatter. Surprisingly plots such as the following are commonly seen:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#download(&quot;https://github.com/kbroman/Talk_Graphs/raw/master/R/fig4.RData&quot;,tmpfile)</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/badgraphfig4.RData&quot;</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit<span class="sc">$</span>coef, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">round</span>(fit<span class="sc">$</span>coef, <span class="dv">4</span>)</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">78</span>, <span class="dv">200</span>, <span class="fu">paste</span>(<span class="st">&quot;y =&quot;</span>, b[<span class="dv">1</span>], <span class="st">&quot;+&quot;</span>, b[<span class="dv">2</span>], <span class="st">&quot;x&quot;</span>), <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(x, y), <span class="dv">4</span>) <span class="co"># 0.8567</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">78</span>, <span class="dv">187</span>, <span class="fu">expression</span>(<span class="fu">paste</span>(rho, <span class="st">&quot; = 0.8567&quot;</span>)), <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Showing the data is much more informative:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit<span class="sc">$</span>coef, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
<div id="high-correlation-does-not-imply-replication" class="section level2 hasAnchor" number="35.2">
<h2 class="hasAnchor"><span class="header-section-number">35.2</span> High correlation does not imply replication<a href="#high-correlation-does-not-imply-replication" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When new technologies or laboratory techniques are introduced, we are often shown scatter plots and correlations from replicated samples. High correlations are used to demonstrate that the new technique is reproducible. But correlation can be very misleading. Below is a scatter plot showing data from replicated samples run on a high throughput technology. This technology outputs 12,626 simultaneously measurements.</p>
<p>In the plot on the left we see the original data which shows very high correlation. But the data follows a distribution with very fat tails. Note that 95% of the data is below the green line. The plot on the right is in the log scale.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;)</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BiocManager::install(&quot;Biobase&quot;)</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="co"># BiocManager::install(&quot;SpikeInSubset&quot;)</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biobase)</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SpikeInSubset)</span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mas95)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">exprs</span>(mas95)[, <span class="dv">1</span>] <span class="do">##original measures were not logged</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">exprs</span>(mas95)[, <span class="dv">2</span>]</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r,</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  g,</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.2</span>,</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(E[<span class="dv">1</span>])),</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(E[<span class="dv">2</span>])),</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;corr=&quot;</span>, <span class="fu">signif</span>(<span class="fu">cor</span>(r, g), <span class="dv">3</span>))</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(a,</span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>              x,</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>              y,</span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">p =</span> <span class="fl">0.95</span>) {</span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x <span class="sc">&lt;=</span> a <span class="sc">&amp;</span> y <span class="sc">&lt;=</span> a) <span class="sc">-</span> p</span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a>a95 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(</span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>  f,</span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="dv">2000</span>,</span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="dv">20000</span>,</span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> r,</span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> g)<span class="sc">$</span>root</span>
<span id="cb180-31"><a href="#cb180-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-32"><a href="#cb180-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(a95, <span class="sc">-</span><span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb180-33"><a href="#cb180-33" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(</span>
<span id="cb180-34"><a href="#cb180-34" aria-hidden="true" tabindex="-1"></a>  <span class="dv">8500</span>,</span>
<span id="cb180-35"><a href="#cb180-35" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb180-36"><a href="#cb180-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;95% of data below this line&quot;</span>,</span>
<span id="cb180-37"><a href="#cb180-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="dv">1</span>,</span>
<span id="cb180-38"><a href="#cb180-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb180-39"><a href="#cb180-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb180-40"><a href="#cb180-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-41"><a href="#cb180-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-42"><a href="#cb180-42" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">log2</span>(r)</span>
<span id="cb180-43"><a href="#cb180-43" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">log2</span>(g)</span>
<span id="cb180-44"><a href="#cb180-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-45"><a href="#cb180-45" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r,g,</span>
<span id="cb180-46"><a href="#cb180-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb180-47"><a href="#cb180-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.2</span>,</span>
<span id="cb180-48"><a href="#cb180-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb180-49"><a href="#cb180-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(log[<span class="dv">2</span>], <span class="st">&quot; &quot;</span>, E[<span class="dv">1</span>])),</span>
<span id="cb180-50"><a href="#cb180-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(log[<span class="dv">2</span>], <span class="st">&quot; &quot;</span>, E[<span class="dv">2</span>])),</span>
<span id="cb180-51"><a href="#cb180-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;corr=&quot;</span>, <span class="fu">signif</span>(<span class="fu">cor</span>(r, g), <span class="dv">3</span>))</span>
<span id="cb180-52"><a href="#cb180-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-53"><a href="#cb180-53" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-15-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Although the correlation is reduced in the log-scale, it is very close to 1 in both cases. Does this mean these data are reproduced? To examine how well the second vector reproduces the first
What we need to study the differences so we should instead plot that. In this plot we plot the difference (in the log scale) versus the average:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((r <span class="sc">+</span> g) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>     (r <span class="sc">-</span> g),</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.2</span>,</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Ave{ &quot;</span>, log[<span class="dv">2</span>], <span class="st">&quot; &quot;</span>, E[<span class="dv">1</span>], <span class="st">&quot;, &quot;</span>, log[<span class="dv">2</span>], <span class="st">&quot; &quot;</span>, E[<span class="dv">2</span>], <span class="st">&quot; }&quot;</span>)),</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(log[<span class="dv">2</span>], <span class="st">&quot; { &quot;</span>, E[<span class="dv">1</span>], <span class="st">&quot; / &quot;</span>, E[<span class="dv">2</span>], <span class="st">&quot; }&quot;</span>)),</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;SD=&quot;</span>, <span class="fu">signif</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((r <span class="sc">-</span> g) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>     )), <span class="dv">3</span>))</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-16-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>These are referred to as Bland-Altman plots or MA plots in the genomics literature and will say more later. In this plot we see that the typical difference in the log (base 2) scale between two replicated measures is about 1. This means that when measurements should be the same we will, on average, observe 2 fold difference. We can now compare this variability to the differences we want to detect and decide if this technology is precise enough for our purposes.</p>
</div>
<div id="barpots-for-paired-data" class="section level2 hasAnchor" number="35.3">
<h2 class="hasAnchor"><span class="header-section-number">35.3</span> Barpots for paired data<a href="#barpots-for-paired-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A common task in data analysis is the comparison of two groups. When the dataset is small and data are paired, for example outcomes before and after a treatment, an unfortunate display that is used is the barplot with two colors:</p>
<p><img src="img/fig6r_e.png" width="707" style="display: block; margin: auto;" /></p>
<p>There are various better ways of showing these data to illustrate there is an increase after treatment. One is to simply make a scatterplot and which shows that most points are above the identity line. Another alternative is plot the differences against the before values.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12201970</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>before <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>after <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, before <span class="sc">*</span> <span class="fl">1.05</span>, <span class="dv">2</span>)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>li <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(before, after))</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>ymx <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(after <span class="sc">-</span> before))</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>  before,</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>  after,</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Before&quot;</span>,</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;After&quot;</span>,</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> li,</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> li</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>  before,</span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>  after <span class="sc">-</span> before,</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Before&quot;</span>,</span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>ymx, ymx),</span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Change (After - Before)&quot;</span>,</span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Line plots are not a bad choice, although I find them harder to follow than the previous two. Boxplots show you the increase, but lose the paired information.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="dv">6</span>, <span class="dv">2</span>))</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mypar</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  z,</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(before, after),</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span>,</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;Before&quot;</span>, <span class="st">&quot;After&quot;</span>))</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>), before, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>), after, <span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(before,</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>        after,</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Before&quot;</span>, <span class="st">&quot;After&quot;</span>),</span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="gratuitous-3d" class="section level2 hasAnchor" number="35.4">
<h2 class="hasAnchor"><span class="header-section-number">35.4</span> Gratuitous 3D<a href="#gratuitous-3d" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The follow figure shows three curves. Pseudo 3D is used but it is not clear way. Maybe to separate the three curves? Note how difficult it is to determine the values of the curves at any given point:</p>
<p><img src="img/fig8b.png" width="335" style="display: block; margin: auto;" /></p>
<p>This plot can be made better by simply using color to distinguish the three lines:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co">#download(&quot;https://github.com/kbroman/Talk_Graphs/raw/master/R/fig8dat.csv&quot;,tmpfile)</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data//fig8dat.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  x[, <span class="dv">1</span>],</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  x[, <span class="dv">2</span>],</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;log Dose&quot;</span>,</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Proportion survived&quot;</span>,</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="dv">1</span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[, <span class="dv">1</span>], x[, <span class="dv">3</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[, <span class="dv">1</span>], x[, <span class="dv">4</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">1</span>,</span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.4</span>,</span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;Drug A&quot;</span>, <span class="st">&quot;Drug B&quot;</span>, <span class="st">&quot;Drug C&quot;</span>),</span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="ignoring-important-factors" class="section level2 hasAnchor" number="35.5">
<h2 class="hasAnchor"><span class="header-section-number">35.5</span> Ignoring important factors<a href="#ignoring-important-factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this example we generate data with a simulation. We are studying a dose response relationship between two groups treatment and control. We have three groups of measurements for both control and treatment. Comparing treatment and control using the common barplot:</p>
<p><img src="img/fig9d.png" width="777" style="display: block; margin: auto;" /></p>
<p>Instead we should show each curve. We can use color to distinguish treatment and control and dashed and solid lines to distinguish the original data from the mean of the three groups.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  y1,</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Dose&quot;</span>,</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Response&quot;</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x,</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>        z[, i],</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="dv">1</span>,</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x,</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>        y[, i],</span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="dv">2</span>,</span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, ym, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, zm, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treated&quot;</span>))</span></code></pre></div>
<p><img src="0502_plots_to_avoid_files/figure-html/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="too-many-significant-digits" class="section level2 hasAnchor" number="35.6">
<h2 class="hasAnchor"><span class="header-section-number">35.6</span> Too many significant digits<a href="#too-many-significant-digits" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By default, statistical software like R return many significant digits. This does not mean we should report them. Cutting and pasting directly from R is a bad idea as you might end up showing a table like this for, say, heights of basketball players:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>heights <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(<span class="dv">8</span>, <span class="dv">73</span>, <span class="dv">3</span>),</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">rnorm</span>(<span class="dv">8</span>, <span class="dv">73</span>, <span class="dv">3</span>),</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">rnorm</span>(<span class="dv">8</span>, <span class="dv">80</span>, <span class="dv">3</span>),</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">rnorm</span>(<span class="dv">8</span>, <span class="dv">78</span>, <span class="dv">3</span>),</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">rnorm</span>(<span class="dv">8</span>, <span class="dv">78</span>, <span class="dv">3</span>))</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(heights) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SG&quot;</span>, <span class="st">&quot;PG&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;PF&quot;</span>, <span class="st">&quot;SF&quot;</span>)</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(heights) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;team&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>heights</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          SG   PG    C   PF   SF</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 1 76.4 76.2 81.7 75.3 77.2</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 2 74.1 71.1 80.3 81.6 73.0</span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 3 71.5 69.0 85.8 80.1 72.8</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 4 78.7 72.8 81.3 76.3 82.9</span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 5 73.4 73.3 79.2 79.7 80.3</span></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 6 72.9 71.8 77.4 81.7 80.4</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 7 68.4 73.0 79.1 71.2 77.2</span></span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 8 73.8 75.6 83.0 75.6 87.7</span></span></code></pre></div>
<p>Note we are reporting precision up to 0.00001 inches. Do you know of a tape measure with that much
precision? This can be easily remedied:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(heights,<span class="dv">1</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          SG   PG    C   PF   SF</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 1 76.4 76.2 81.7 75.3 77.2</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 2 74.1 71.1 80.3 81.6 73.0</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 3 71.5 69.0 85.8 80.1 72.8</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 4 78.7 72.8 81.3 76.3 82.9</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 5 73.4 73.3 79.2 79.7 80.3</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 6 72.9 71.8 77.4 81.7 80.4</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 7 68.4 73.0 79.1 71.2 77.2</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; team 8 73.8 75.6 83.0 75.6 87.7</span></span></code></pre></div>
</div>
<div id="displaying-data-well" class="section level2 hasAnchor" number="35.7">
<h2 class="hasAnchor"><span class="header-section-number">35.7</span> Displaying data well<a href="#displaying-data-well" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In general you should follow these principles:</p>
<ul>
<li>Be accurate and clear.</li>
<li>Let the data speak.</li>
<li>Show as much information as possible, taking care not to obscure the message.</li>
<li>Science not sales: avoid unnecessary frills (esp.¬†gratuitous 3d).</li>
<li>In tables, every digit should be meaningful. Don‚Äôt drop ending 0s.</li>
</ul>
</div>
<div id="some-further-reading" class="section level2 hasAnchor" number="35.8">
<h2 class="hasAnchor"><span class="header-section-number">35.8</span> Some further reading:<a href="#some-further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>ER Tufte (1983) The visual display of quantitative information.
Graphics Press.</p></li>
<li><p>ER Tufte (1990) Envisioning information. Graphics Press.</p></li>
<li><p>ER Tufte (1997) Visual explanations. Graphics Press.</p></li>
<li><p>WS Cleveland (1993) Visualizing data. Hobart Press.</p></li>
<li><p>WS Cleveland (1994) The elements of graphing data. CRC Press.</p></li>
<li><p>A Gelman, C Pasarica, R Dodhia (2002) Let‚Äôs practice what we preach:
Turning tables into graphs. The American Statistician 56:121-130</p></li>
<li><p>NB Robbins (2004) Creating more effective graphs. Wiley</p></li>
<li><p><a href="http://bang.clearscience.info/?p=546">Nature Methods columns</a></p></li>
</ul>
</div>
</div>
<div id="odd-design-choices-in-data-visualization" class="section level1 hasAnchor" number="36">
<h1 class="hasAnchor"><span class="header-section-number">36</span> ODD: Design choices in data visualization<a href="#odd-design-choices-in-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>I have curated this collection of external video sources on design choices in data visualization.</p>
<div id="how-to-spot-a-misleading-graph" class="section level2 hasAnchor" number="36.1">
<h2 class="hasAnchor"><span class="header-section-number">36.1</span> How to spot a misleading graph<a href="#how-to-spot-a-misleading-graph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When they‚Äôre used well, graphs can help us intuitively grasp complex data. But as visual software has enabled more usage of graphs throughout all media, it has also made them easier to use in a careless or dishonest way ‚Äî and as it turns out, there are plenty of ways graphs can mislead and outright manipulate. Lea Gaslowitz shares some things to look out for.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/E91bGT9BjYk" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="data-visualization-and-misrepresentation" class="section level2 hasAnchor" number="36.2">
<h2 class="hasAnchor"><span class="header-section-number">36.2</span> Data Visualization and Misrepresentation<a href="#data-visualization-and-misrepresentation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This animation was produced by some of my colleagues at Brown.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/x-rDVXVwW9s" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="vox-on-how-coronavirus-charts-can-mislead-us" class="section level2 hasAnchor" number="36.3">
<h2 class="hasAnchor"><span class="header-section-number">36.3</span> Vox on How coronavirus charts can mislead us<a href="#vox-on-how-coronavirus-charts-can-mislead-us" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/O-3Mlj3MQ_Q" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="vox-on-shut-up-about-the-y-axis.-it-shouldnt-always-start-at-zero." class="section level2 hasAnchor" number="36.4">
<h2 class="hasAnchor"><span class="header-section-number">36.4</span> Vox on Shut up about the y-axis. It shouldn‚Äôt always start at zero.<a href="#vox-on-shut-up-about-the-y-axis.-it-shouldnt-always-start-at-zero." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/14VYnFhBKcY" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Also a nice example of appropriately choosing a y-axis window (cf. <a href="https://twitter.com/sharoz?ref_src=twsrc%5Etfw">@sharoz</a>) <a href="https://t.co/wCiOeyTo6k">https://t.co/wCiOeyTo6k</a></p>&mdash; Brenton Wiernik üè≥Ô∏è‚Äçüåà (@bmwiernik) <a href="https://twitter.com/bmwiernik/status/1362437077820968960?ref_src=twsrc%5Etfw">February 18, 2021</a></blockquote>

</div>
<div id="gloriously-terrible-plots" class="section level2 hasAnchor" number="36.5">
<h2 class="hasAnchor"><span class="header-section-number">36.5</span> Gloriously Terrible Plots!!<a href="#gloriously-terrible-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">this is the worst figure i&#39;ve ever made in R. completely useless. 10/10 would make this aRt again <a href="https://t.co/8BN9j5H2C0">pic.twitter.com/8BN9j5H2C0</a></p>&mdash; jamie (@_quinntuition) <a href="https://twitter.com/_quinntuition/status/1380564902578913287?ref_src=twsrc%5Etfw">April 9, 2021</a></blockquote>

<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0502_plots_to_avoid.Rmd-->
</div>
</div>
<div id="secrets" class="section level1 hasAnchor" number="37">
<h1 class="hasAnchor"><span class="header-section-number">37</span> ODD: Secrets of a happy graphing life<a href="#secrets" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter is an optional deep dive (ODD) that might be useful to you.</p>
<!--Original content: https://stat545.com/block016_secrets-happy-graphing.html-->
<div id="load-gapminder-and-the-tidyverse" class="section level2 hasAnchor" number="37.1">
<h2 class="hasAnchor"><span class="header-section-number">37.1</span> Load gapminder and the tidyverse<a href="#load-gapminder-and-the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="hidden-data-wrangling-problems" class="section level2 hasAnchor" number="37.2">
<h2 class="hasAnchor"><span class="header-section-number">37.2</span> Hidden data wrangling problems<a href="#hidden-data-wrangling-problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you are struggling to make a figure, don‚Äôt assume it‚Äôs a problem between you and ggplot2. Stop and ask yourself which of these rules you are breaking:</p>
<ul>
<li>Keep stuff in data frames</li>
<li>Keep your data frames <em>tidy</em>; be willing to reshape your data often</li>
<li>Use factors and be the boss of them</li>
</ul>
<p>In my experience, the vast majority of graphing agony is due to insufficient data wrangling. Tackle your latent data storage and manipulation problems and your graphing problem often melts away.</p>
</div>
<div id="keep-stuff-in-data-frames" class="section level2 hasAnchor" number="37.3">
<h2 class="hasAnchor"><span class="header-section-number">37.3</span> Keep stuff in data frames<a href="#keep-stuff-in-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I see a fair amount of early-career code where variables are <em>copied out</em> of a data frame, to exist as stand-alone objects in the workspace.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>life_exp <span class="ot">&lt;-</span> gapminder<span class="sc">$</span>lifeExp</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> gapminder<span class="sc">$</span>year</span></code></pre></div>
<p>Historically, ggplot2 has had an incredibly strong preference for variables in data frames. It used to be a requirement for the main data frame underpinning a plot. Although this requirement is no longer the case, it is still a good idea to keep your variables associated with their data frames.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> life_exp)) <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="0503_secrets_happy_graphics_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><strong>Just leave the variables in place and pass the associated data frame!</strong> This advice applies to base and lattice graphics as well. It is not specific to ggplot2.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> life_exp)) <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="0503_secrets_happy_graphics_files/figure-html/data-in-situ-1.png" width="672" /></p>
<p>What if we wanted to filter the data by country, continent, or year? This is much easier to do safely if all affected variables live together in a data frame, not as individual objects that can get ‚Äúout of sync.‚Äù</p>
<p>Don‚Äôt write-off ggplot2 as a highly opinionated outlier! In fact, keeping data in data frames and computing and visualizing it <em>in situ</em> are widely regarded as best practices. The option to pass a data frame via <code>data =</code> is a common feature of many high-use R functions, e.g.¬†<code>lm()</code>, <code>aggregate()</code>, <code>plot()</code>, and <code>t.test()</code>, so make this your default <em>modus operandi</em>.</p>
<div id="explicit-data-frame-creation-via-tibbletibble-and-tibbletribble" class="section level3 hasAnchor" number="37.3.1">
<h3 class="hasAnchor"><span class="header-section-number">37.3.1</span> Explicit data frame creation via <code>tibble::tibble()</code> and <code>tibble::tribble()</code><a href="#explicit-data-frame-creation-via-tibbletibble-and-tibbletribble" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If your data is already lying around and it‚Äôs <strong>not</strong> in a data frame, ask yourself ‚Äúwhy not?‚Äù. Did you create those variables? Maybe you should have created them in a data frame in the first place! The <code>tibble()</code> function is an improved version of the built-in <code>data.frame()</code>, which makes it possible to define one variable in terms of another and which won‚Äôt turn character data into factor. If constructing tiny tibbles ‚Äúby hand‚Äù, <code>tribble()</code> can be an even handier function, in which your code will be laid out like the table you are creating. These functions should remove the most common excuses for data frame procrastination and avoidance.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>my_dat <span class="ot">&lt;-</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> x <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;delta&quot;</span>, <span class="st">&quot;epsilon&quot;</span>)</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="do">## if you&#39;re truly &quot;hand coding&quot;, tribble() is an alternative</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>my_dat <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> x, <span class="sc">~</span> y,    <span class="sc">~</span> text,</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>,   <span class="dv">1</span>,   <span class="st">&quot;alpha&quot;</span>,</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>,   <span class="dv">4</span>,    <span class="st">&quot;beta&quot;</span>,</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>,   <span class="dv">9</span>,   <span class="st">&quot;gamma&quot;</span>,</span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>,  <span class="dv">16</span>,   <span class="st">&quot;delta&quot;</span>,</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>,  <span class="dv">25</span>, <span class="st">&quot;epsilon&quot;</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(my_dat)</span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tibble [5 √ó 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ x   : num [1:5] 1 2 3 4 5</span></span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ y   : num [1:5] 1 4 9 16 25</span></span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ text: chr [1:5] &quot;alpha&quot; &quot;beta&quot; &quot;gamma&quot; &quot;delta&quot; ...</span></span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_dat,</span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> text))</span></code></pre></div>
<p><img src="0503_secrets_happy_graphics_files/figure-html/data_frame-love-1.png" width="672" /></p>
<p>Together with <code>dplyr::mutate()</code>, which adds new variables to a data frame, this gives you the tools to work within data frames whenever you‚Äôre handling related variables of the same length.</p>
</div>
<div id="sidebar-with" class="section level3 hasAnchor" number="37.3.2">
<h3 class="hasAnchor"><span class="header-section-number">37.3.2</span> Sidebar: <code>with()</code><a href="#sidebar-with" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sadly, not all functions offer a <code>data =</code> argument. Take <code>cor()</code>, for example, which computes correlation. This does <strong>not</strong> work:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(year, lifeExp, <span class="at">data =</span> gapminder)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in cor(year, lifeExp, data = gapminder): unused argument (data = gapminder)</span></span></code></pre></div>
<p>Sure, you can always just repeat the data frame name like so:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(gapminder<span class="sc">$</span>year, gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.436</span></span></code></pre></div>
<p>but people hate typing. I suspect subconscious dread of repeatedly typing <code>gapminder</code> is what motivates those who copy variables into stand-alone objects in the workspace.</p>
<p>The <code>with()</code> function is a better workaround. Provide the data frame as the first argument. The second argument is an expression that will be evaluated in a special environment. It could be a single command or a multi-line snippet of code. What‚Äôs special is that you can refer to variables in the data frame by name.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(gapminder,</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">cor</span>(year, lifeExp))</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.436</span></span></code></pre></div>
<p>If you use the magrittr package, another option is to use the <code>%$%</code> operator to expose the variables inside a data frame for further computation:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%$%</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(year, lifeExp)</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.436</span></span></code></pre></div>
</div>
</div>
<div id="worked-example" class="section level2 hasAnchor" number="37.4">
<h2 class="hasAnchor"><span class="header-section-number">37.4</span> Worked example<a href="#worked-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Inspired by this question from a student when we first started using ggplot2: How can I focus in on country, Japan for example, and plot all the quantitative variables against year?</p>
<p>Your first instinct might be to filter the Gapminder data for Japan and then loop over the variables, creating separate plots which need to be glued together. And, indeed, this can be done. But in my opinion, the data reshaping route is more ‚ÄúR native‚Äù given our current ecosystem, than the loop way.</p>
<div id="reshape-your-data" class="section level3 hasAnchor" number="37.4.1">
<h3 class="hasAnchor"><span class="header-section-number">37.4.1</span> Reshape your data<a href="#reshape-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We filter the Gapminder data and keep only Japan. Then we use <code>tidyr::gather()</code> to <em>gather</em> up the variables <code>pop</code>, <code>lifeExp</code>, and <code>gdpPercap</code> into a single <code>value</code> variable, with a companion variable <code>key</code>.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>japan_dat <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Japan&quot;</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>japan_tidy <span class="ot">&lt;-</span> japan_dat <span class="sc">%&gt;%</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> var,</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> value,</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>         pop, lifeExp, gdpPercap)</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(japan_dat)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 12  6</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(japan_tidy)</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 36  5</span></span></code></pre></div>
<p>The filtered <code>japan_dat</code> has 12 rows. Since we are gathering or stacking three variables in <code>japan_tidy</code>, it makes sense to see three times as many rows, namely 36 in the reshaped result.</p>
</div>
<div id="iterate-over-the-variables-via-faceting" class="section level3 hasAnchor" number="37.4.2">
<h3 class="hasAnchor"><span class="header-section-number">37.4.2</span> Iterate over the variables via faceting<a href="#iterate-over-the-variables-via-faceting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have the data we need in a tidy data frame, with a proper factor representing the variables we want to ‚Äúiterate‚Äù over, we just have to facet.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(japan_tidy, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> var, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>, <span class="dv">2011</span>, <span class="dv">15</span>))</span></code></pre></div>
<p><img src="0503_secrets_happy_graphics_files/figure-html/japan-1.png" width="672" /></p>
</div>
<div id="recap-1" class="section level3 hasAnchor" number="37.4.3">
<h3 class="hasAnchor"><span class="header-section-number">37.4.3</span> Recap<a href="#recap-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here‚Äôs the minimal code to produce our Japan example.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>japan_tidy <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Japan&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> var, <span class="at">value =</span> value, pop, lifeExp, gdpPercap)</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(japan_tidy, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> var, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>, <span class="dv">2011</span>, <span class="dv">15</span>))</span></code></pre></div>
<p>This snippet demonstrates the payoffs from the rules we laid out at the start:</p>
<ul>
<li>We isolate the Japan data into its own <strong>data frame</strong>.</li>
<li>We <strong>reshape</strong> the data. We gather three columns into one, because we want to depict them via position along the y-axis in the plot.</li>
<li>We use a <strong>factor</strong> to distinguish the observations that belong in each mini-plot, which then becomes a simple application of faceting.</li>
<li>This is an example of expedient data reshaping. I don‚Äôt actually believe that <code>gdpPercap</code>, <code>lifeExp</code>, and <code>pop</code> naturally belong together in one variable. But gathering them was by far the easiest way to get this plot.</li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
</div>
</div>
</div>
<div id="save-figs" class="section level1 hasAnchor" number="38">
<h1 class="hasAnchor"><span class="header-section-number">38</span> Writing figures to file<a href="#save-figs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--Original content: https://stat545.com/block017_write-figure-to-file.html-->
<p>It is not always appropriate or sufficient for figures to exist <em>only</em> inside a dynamic report, such as an R Markdown document. You should know how to write key figures to file for downstream use in a variety of settings.</p>
<p>During development, you need the immediate feedback from seeing your figures appear in a screen device, such as the RStudio Plots pane. Once you‚Äôre satisfied, make sure you have all of the commands to produce the figure saved in an R script. You want <em>everything</em>, nachos to cheesecake: data import, any necessary manipulation, then plotting.</p>
<p>Now what? How do you preserve the figure in a file?</p>
<div id="step-away-from-the-mouse" class="section level2 hasAnchor" number="38.1">
<h2 class="hasAnchor"><span class="header-section-number">38.1</span> Step away from the mouse<a href="#step-away-from-the-mouse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Do not</em> succumb to the temptation of a mouse-based process. If might feel handy at the time, but you will regret it. This workflow establishes no link between the source code and the figure product. So when ‚Äì not if ‚Äì you need to remake the figure with a different color scheme or aspect ratio or graphics device, you will struggle to dig up the proper source code. Use one of the methods below to avoid this predicament.</p>
</div>
<div id="good-names-are-like-breadcrumbs" class="section level2 hasAnchor" number="38.2">
<h2 class="hasAnchor"><span class="header-section-number">38.2</span> Good names are like breadcrumbs<a href="#good-names-are-like-breadcrumbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you save figure-making code in a source file and you give figure files machine-readable, self-documenting names, your future self will be able to find its way back to this code.</p>
<p>Hypothetical: a <a href="https://imgur.com/ewmBeQG">zombie project</a> comes back to life and your collaborator presents you with <a href="https://twitter.com/JohnDCook/status/522377493417033728">a figure you made 18 months ago</a>. Can you remake <code>fig08_scatterplot-lifeExp-vs-year.pdf</code> as a TIFF and with smooth regression? Fun times!</p>
<p>This filename offers several properties to help you find the code that produced it:</p>
<ul>
<li><p><strong>Human-readability</strong>: It‚Äôs helpful to know you‚Äôre searching for a scatterplot and maybe which variables are important. It gives important context for your personal archaeological dig.</p></li>
<li><p><strong>Specificity</strong>: Note how specific and descriptive the name of this figure file is; we didn‚Äôt settle for the generic <code>fig08.pdf</code> or <code>scatterplot.pdf</code>. This makes the name at least somewhat unique, which will help you search your home directory for files containing part or all of this filename.</p></li>
<li><p><strong>Machine-readability</strong>: Every modern OS provides a way to search your hard drive for a file with a specific name or containing a specific string. This will be easier if the name contains no spaces, punctuation, or other funny stuff. If you use conventional extensions, you can even narrow the search to files ending in <code>.R</code> or <code>.Rmd</code>.</p></li>
</ul>
<p>All of these human practices will help you zero in on the R code you need, so you can modify, re-run, and reuse.</p>
</div>
<div id="graphics-devices" class="section level2 hasAnchor" number="38.3">
<h2 class="hasAnchor"><span class="header-section-number">38.3</span> Graphics devices<a href="#graphics-devices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Read the <a href="https://rdrr.io/r/grDevices/Devices.html">R help for <code>Devices</code></a> to learn about graphics devices in general and which are available on your system (<em>obviously requires that you read your local help</em>).</p>
<p>It is essential to understand the difference between <a href="https://en.wikipedia.org/wiki/Vector_graphics">vector graphics</a> and <a href="https://en.wikipedia.org/wiki/Raster_graphics">raster graphics</a>. Vector graphics are represented in terms of shapes and lines, whereas raster graphics are pixel-based.</p>
<ul>
<li><strong>Vector</strong> examples: PDF, postscript, SVG
<ul>
<li>Pros: re-size gracefully, good for print. SVG is where the web is heading, though we are not necessarily quite there yet.</li>
</ul></li>
<li><strong>Raster</strong> examples: PNG, JPEG, BMP, GIF
<ul>
<li>Cons: look awful ‚Äúblown up‚Äù ‚Ä¶ in fact, look awful quite frequently</li>
<li>Pros: play very nicely with Microsoft Office products and the web. Files can be blessedly small!</li>
</ul></li>
</ul>
<p>Tough love: you will not be able to pick vector or raster or a single device and use it all the time. You must think about your downstream use cases and plan accordingly. It is entirely possible that you should save key figures <strong>in more than one format</strong> for maximum flexibility in the future. Worst case, if you obey the rules given here, you can always remake the figure to save in a new format.</p>
<p>For what its worth, most of Jenny Bryan‚Äôs figures exist as <code>pdf()</code>, <code>png()</code>, or both. Although it is not true yet, SVG will hopefully become the new standard, offering the resizability of vector graphics but with web-friendliness as well.</p>
<p>Here are two good posts from the <a href="https://blog.revolutionanalytics.com">Revolutions Analytics blog</a> with tips for saving figures to file:</p>
<ul>
<li><a href="https://blog.revolutionanalytics.com/2009/01/10-tips-for-making-your-r-graphics-look-their-best.html">10 tips for making your R graphics look their best</a></li>
<li><a href="https://blog.revolutionanalytics.com/2011/07/r-svg-graphics.html">High-quality R graphics on the Web with SVG</a></li>
</ul>
</div>
<div id="write-figures-to-file-with-ggsave" class="section level2 hasAnchor" number="38.4">
<h2 class="hasAnchor"><span class="header-section-number">38.4</span> Write figures to file with <code>ggsave()</code><a href="#write-figures-to-file-with-ggsave" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you are using ggplot2, write figures to file with <a href="https://rdrr.io/cran/ggplot2/man/ggsave.html"><code>ggsave()</code></a>.</p>
<p>If you are staring at a plot you just made on your screen, you can call <code>ggsave()</code>, specifying only a filename:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;my-awesome-graph.png&quot;</span>)</span></code></pre></div>
<p>It makes a sensible decision about everything else. In particular, as long as you use a conventional extension, it will guess what type of graphics file you want. If you need control over, e.g., width, height, or dpi, roll up your sleeves and <a href="https://rdrr.io/cran/ggplot2/man/ggsave.html">use the arguments</a>.</p>
<div id="passing-a-plot-object-to-ggsave" class="section level3 hasAnchor" number="38.4.1">
<h3 class="hasAnchor"><span class="header-section-number">38.4.1</span> Passing a plot object to <code>ggsave()</code><a href="#passing-a-plot-object-to-ggsave" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After the filename, the most common argument you will provide is <code>plot =</code>, which is the second argument by position. If you‚Äôve been building up a plot with the typical ggplot2 workflow, you will pass the resulting object to <code>ggsave()</code>. <strong>Example:</strong></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co"># during development, you will uncomment next line to print p to screen</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;fig-io-practice.png&quot;</span>, p)</span></code></pre></div>
<p>See below for gotchas and FAQs when making figures in a non-interactive setting!</p>
</div>
<div id="scaling" class="section level3 hasAnchor" number="38.4.2">
<h3 class="hasAnchor"><span class="header-section-number">38.4.2</span> Scaling<a href="#scaling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Figures need to be prepared differently for a presentation versus a poster versus a manuscript. You need to fiddle with the size of text, such as the title and axis labels, relative to the entire plot area. There are at least two ways to do this, with slightly different effects and workflows.</p>
<p><strong>Via the <code>scale =</code> argument to <code>ggsave()</code></strong>: This actually changes the physical size of the plot, but as an interesting side effect, it changes the relative size of the title and axis labels. Therefore, tweaking this can be a quick-and-dirty way to get different versions of a figure appropriate for a presentation versus a poster versus a manuscript. You can still insert the figure downstream with a different physical size, though you may need to adjust the dpi accordingly on the front end. When <code>scale &lt; 1</code>, various plot elements will be bigger relative to the plotting area; when <code>scale &gt; 1</code>, these elements will be smaller. YMMV but <code>scale = 0.8</code> often works well for posters and slides. Figure @ref(fig:exaggerated-scale) shows two versions of a figure, with exaggerated values of <code>scale</code>, to illustrate its effect.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> lifeExp)) <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;scale = 0.6&quot;</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;scale = 2&quot;</span>)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/fig-io-practice-scale-0.6.png&quot;</span>, p1, <span class="at">scale =</span> <span class="fl">0.6</span>)</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Saving 4.2 x 3 in image</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/fig-io-practice-scale-2.png&quot;</span>, p2, <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Saving 14 x 10 in image</span></span></code></pre></div>
<div class="figure">
<img src="img/figures-io-p1.png" alt="Two versions of a figure with exaggerated values of `scale`" width="50%" /><img src="img/figures-io-p2.png" alt="Two versions of a figure with exaggerated values of `scale`" width="50%" />
<p class="caption">
(#fig:exaggerated-scale)Two versions of a figure with exaggerated values of <code>scale</code>
</p>
</div>
<p><strong>Via the <code>base_size</code> of the active theme</strong>: The <code>base_size</code> of the <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html#arguments">theme</a> refers to the base font size. This is NOT a theme element that can be modified via <code>ggplot(...) + theme(...)</code>. Rather, it‚Äôs an argument to various functions that set theme elements. Therefore, to get the desired effect you need to create a complete theme, specifying the desired <code>base_size</code>. By setting <code>base size &lt; 12</code>, the default value, you shrink text elements and by setting <code>base_size &gt; 12</code>, you make them larger. Figure @ref(fig:exaggerated-base-size) shows two versions of a figure, with exaggerated values of <code>base_size</code>, to illustrate its effect.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;base_size = 20&quot;</span>) <span class="sc">+</span> <span class="fu">theme_grey</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;base_size = 3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_grey</span>(<span class="at">base_size =</span> <span class="dv">3</span>)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/fig-io-practice-base-size-20.png&quot;</span>, p3)</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Saving 7 x 5 in image</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;img/fig-io-practice-base-size-3.png&quot;</span>, p4)</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Saving 7 x 5 in image</span></span></code></pre></div>
<div class="figure">
<img src="img/figures-io-p3.png" alt="Two versions of a figure with exaggerated values of `base_size`" width="50%" /><img src="img/figures-io-p4.png" alt="Two versions of a figure with exaggerated values of `base_size`" width="50%" />
<p class="caption">
(#fig:exaggerated-base-size)Two versions of a figure with exaggerated values of <code>base_size</code>
</p>
</div>
<p><em>Thanks to <a href="https://twitter.com/cashoes_">Casey Shannon</a> for tips about <code>scale =</code> and this <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/">cheatsheet from Zev Ross</a> for tips about <code>base_size</code>.</em></p>
</div>
</div>
<div id="write-non-ggplot2-figures-to-file" class="section level2 hasAnchor" number="38.5">
<h2 class="hasAnchor"><span class="header-section-number">38.5</span> Write non-ggplot2 figures to file<a href="#write-non-ggplot2-figures-to-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall that <code>ggsave()</code> is recommended if you‚Äôre using ggplot2. But if you‚Äôre using base graphics or lattice, here‚Äôs generic advice for writing figures to file. To be clear, this <em>also</em> works for ggplot2 graphs, but I can‚Äôt think of any good reasons to NOT use <code>ggsave()</code>.</p>
<p>Edit your source code in the following way: precede the figure-making code by opening a graphics device and follow it with a command that closes the device. Here‚Äôs an example:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;test-fig-proper.pdf&quot;</span>)    <span class="co"># starts writing a PDF to file</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)                    <span class="co"># makes the actual plot</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()                     <span class="co"># closes the PDF file</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   2</span></span></code></pre></div>
<p>You will see that there‚Äôs a new file in the working directory:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;^test-fig*&quot;</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;test-fig-proper.pdf&quot;</span></span></code></pre></div>
<p>If you run this code interactively, don‚Äôt be surprised when you don‚Äôt see the figure appear in your screen device. While you‚Äôre sending graphics output to, e.g.¬†the <code>pdf()</code> device, you‚Äôll be ‚Äúflying blind‚Äù, which is why it‚Äôs important to work out the graphics commands in advance. This is like using <code>sink()</code>, which diverts the output you‚Äôd normally see in R Console.</p>
<p>Read the <a href="https://rdrr.io/r/grDevices/Devices.html">R help for <code>Devices</code></a> to learn about graphics devices in general and which are available on your system (<em>obviously requires that you read your local help</em>). If you need control over, e.g., width, height, or dpi, roll up your sleeves and use the arguments to the graphics device function you are using. There are many.</p>
<p>If you are staring at a plot you just made on your screen, here‚Äôs a handy short cut for writing a figure to file:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)    <span class="co"># makes the actual plot</span></span></code></pre></div>
<p><img src="0503_secrets_happy_graphics_files/figure-html/dev-print-demo-1.png" width="672" /></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.print</span>(pdf, <span class="st">&quot;test-fig-quick-dirty.pdf&quot;</span>)    <span class="co"># copies the plot to a the PDF file</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   2</span></span></code></pre></div>
<p>You will see there‚Äôs now another new file in the working directory:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">&quot;^test-fig*&quot;</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;test-fig-proper.pdf&quot;      &quot;test-fig-quick-dirty.pdf&quot;</span></span></code></pre></div>
<p>The appeal of this method is that you will literally copy the figure in front of your eyeballs to file, which is pleasingly immediate. There‚Äôs also less code to repeatedly (de-)comment as you run and re-run the script during development.</p>
<p>Why is this method improper? Various aspects of a figure ‚Äì such as font size ‚Äì are determined by the target graphics device and its physical size. Therefore, it is best practice to open your desired graphics device explicitly, using any necessary arguments to control height, width, fonts, etc. Make your plot. And close the device. But for lots of everyday plots the <code>dev.print()</code> method works just fine.</p>
<p>If you call up the help file for [<code>dev.off()</code>, <code>dev.print()</code>, and friends][rdocs-dev], you can learn about many other functions for controlling graphics devices.</p>
</div>
<div id="preemptive-answers-to-some-faqs" class="section level2 hasAnchor" number="38.6">
<h2 class="hasAnchor"><span class="header-section-number">38.6</span> Preemptive answers to some FAQs<a href="#preemptive-answers-to-some-faqs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="despair-over-non-existent-or-empty-figures" class="section level3 hasAnchor" number="38.6.1">
<h3 class="hasAnchor"><span class="header-section-number">38.6.1</span> Despair over non-existent or empty figures<a href="#despair-over-non-existent-or-empty-figures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Certain workflows are suited to interactive development and will break when played back non-interactively or at arm‚Äôs length. Wake up and pay attention when you cross these lines:</p>
<ul>
<li>You package graph-producing code into a function or put it inside a loop or other iterative machine.</li>
<li>You run an R script non-interactively, e.g.¬†via <code>source()</code>, <code>Rscript</code>, or <code>R CMD batch</code>.</li>
</ul>
<p><strong>Basic issue</strong>: When working interactively, if you inspect the plot object <code>p</code> by entering <code>p</code> at the command line, the plot gets printed to screen. You‚Äôre actually enjoying the result of <code>print(p)</code>, but it‚Äôs easy to not realize this. To get the same result from code run non-interactively, you will need to call <code>print()</code> explicitly yourself.</p>
<p>Here I wrap plotting commands inside a function. The function on the left will fail to produce a PNG, whereas the function on the right will produce a good PNG. Both assume the Gapminder data is present as <code>gapminder</code> and that ggplot2 has been loaded.</p>
<table>
<tr>
<td valign="top">
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="do">## implicit print --&gt; no PNG</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>f_despair <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="st">&quot;test-fig-despair.png&quot;</span>)</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gapminder,</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp))</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()    </span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a><span class="fu">f_despair</span>()</span></code></pre></div>
</td>
<td valign="top">
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="do">## explicit print --&gt; good PNG</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>f_joy <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">png</span>(<span class="st">&quot;test-fig-joy.png&quot;</span>)</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gapminder,</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp))</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p) <span class="do">## &lt;-- VERY IMPORTANT!!!</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()    </span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="fu">f_joy</span>() </span></code></pre></div>
</td>
</tr>
</table>
<p>Other versions of this fiasco result in a figure file that is, frustratingly, empty. If you expect a figure, but it‚Äôs missing or empty, <strong>remember to print the plot explicitly.</strong></p>
<p>It is worth noting here that the <code>ggsave()</code> workflow is not vulnerable to this gotcha, which is yet another reason to prefer it when using ggplot2.</p>
<p>Some relevant threads on stackoverflow:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/9206110/using-png-function-not-working-when-called-within-a-function">Using png not working when called within a function</a></li>
<li><a href="https://stackoverflow.com/questions/6675066/ggplots-qplot-does-not-execute-on-sourcing">ggplot‚Äôs qplot does not execute on sourcing</a></li>
<li><a href="https://stackoverflow.com/questions/7034647/save-ggplot-within-a-function">Save ggplot within a function</a></li>
</ul>
</div>
<div id="mysterious-empty-rplots.pdf-file" class="section level3 hasAnchor" number="38.6.2">
<h3 class="hasAnchor"><span class="header-section-number">38.6.2</span> Mysterious empty <code>Rplots.pdf</code> file<a href="#mysterious-empty-rplots.pdf-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Note: <a href="https://github.com/tidyverse/ggplot2/issues/1326">This has been fixed as of ggplot2 v2.0.0</a>. Hallelujah! I will leave this here for a while, since old versions of a package like ggplot2 linger around for months and years.</em></p>
<p>When creating and writing figures from R running non-interactively, you can inadvertently trigger a request to query the active graphics device. For example, <code>ggsave()</code> might try to ascertain the physical size of the current device. But when running non-interactively there is often no such device available, which can lead to the unexpected creation of <code>Rplots.pdf</code> so this request can be fulfilled.</p>
<p>I don‚Äôt know of a reliable way to suppress this behavior uniformly and I just peacefully coexist with <code>Rplots.pdf</code> when this happens. That is, I just delete it.</p>
<p>Some relevant threads on stackoverflow:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/17348359/how-to-stop-r-from-creating-empty-rplots-pdf-file-when-using-ggsave-and-rscript">How to stop R from creating empty Rplots.pdf file when using ggsave and Rscript</a></li>
</ul>
</div>
</div>
<div id="chunk-name-determines-figure-file-name" class="section level2 hasAnchor" number="38.7">
<h2 class="hasAnchor"><span class="header-section-number">38.7</span> Chunk name determines figure file name<a href="#chunk-name-determines-figure-file-name" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Circling back, we return to the topic of figures produced via an R chunk in an R Markdown file. If you are writing <a href="#r-markdown-step3">GitHub-flavored markdown or keeping the intermediate markdown</a>, your figures will also be saved to file. Rendering <code>foo.Rmd</code> will leave behind <code>foo.md</code>, maybe <code>foo.html</code>, and a directory <code>foo_files</code>, containing any figures created in the document. By default, they will have meaningless names, like <code>unnamed-chunk-7.png</code>. This makes it difficult to find specific figures, e.g.¬†for unplanned use in another setting. However, if you name an R chunk, this name will be baked into the figure file name.</p>
<!--JB: the "live" version of the chunk I include verbatim below -->
<p><strong>Example:</strong> here‚Äôs an R chunk called <code>scatterplot-lifeExp-vs-year</code>:</p>
<pre><code>```{r scatterplot-lifeExp-vs-year}
p &lt;- ggplot(gapminder, aes(x = year, y = lifeExp)) + geom_jitter()
p
```</code></pre>
<p>And it will lead to the creation of a suitably named figure file (you may see other figures produced in the document as well):</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>book_figs <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">path</span>(<span class="st">&quot;_bookdown_files&quot;</span>, <span class="st">&quot;stat545_files&quot;</span>, <span class="st">&quot;figure-html&quot;</span>)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_ls</span>(book_figs, <span class="at">regexp =</span> <span class="st">&quot;scatterplot-lifeExp&quot;</span>)</span></code></pre></div>
<p>If you have concrete plans to use a figure elsewhere, you should probably write it to file using an explicit method described above. But the chunk-naming trick is a nice way to avoid that work, while maintaining flexibility for the future.</p>
</div>
<div id="clean-up-1" class="section level2 hasAnchor" number="38.8">
<h2 class="hasAnchor"><span class="header-section-number">38.8</span> Clean up<a href="#clean-up-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs delete the temp files we‚Äôve created.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file_delete</span>(<span class="fu">dir_ls</span>(<span class="fu">path</span>(<span class="st">&quot;img&quot;</span>),<span class="at">regexp =</span> <span class="st">&quot;fig-io-practice&quot;</span>))</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="fu">file_delete</span>(<span class="fu">dir_ls</span>(<span class="st">&quot;.&quot;</span>, <span class="at">regexp =</span> <span class="st">&quot;test-fig&quot;</span>))</span></code></pre></div>
<!--chapter:end:0503_secrets_happy_graphics.Rmd-->
</div>
</div>
<div id="lab05" class="section level1 hasAnchor" number="39">
<h1 class="hasAnchor"><span class="header-section-number">39</span> Lab: Wrangling spatial data<a href="#lab05" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="la-quinta-is-spanish-for-next-to-dennys-pt.-2" class="section level2 hasAnchor" number="39.1">
<h2 class="hasAnchor"><span class="header-section-number">39.1</span> La Quinta is Spanish for <em>next to Denny‚Äôs</em>, Pt. 2‚Äù<a href="#la-quinta-is-spanish-for-next-to-dennys-pt.-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="img/mitch-hedgeberg-lqd.jpg" width="640" /></p>
<p>In this lab, we revisit the Denny‚Äôs and La Quinta Inn and Suites data we visualized in the previous lab.</p>
</div>
<div id="getting-started-4" class="section level2 hasAnchor" number="39.2">
<h2 class="hasAnchor"><span class="header-section-number">39.2</span> Getting started<a href="#getting-started-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Go to the course organization on GitHub.</p></li>
<li><p>Find your lab repo.</p></li>
</ul>
<div id="packages-4" class="section level3 hasAnchor" number="39.2.1">
<h3 class="hasAnchor"><span class="header-section-number">39.2.1</span> Packages<a href="#packages-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab, we will use the <strong>tidyverse</strong> and <strong>dsbox</strong> packages. The *dsbox** package is not on CRAN yet; instead it is hosted on github. You will have to download and <a href="https://github.com/rstudio-education/dsbox#installation">install it yourself</a>. This piece of code should help get you started.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;rstudio-education/dsbox&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsbox) </span></code></pre></div>
<p>If you cannot get dsbox to install, you can also download the two datasets we will be using manually <a href="https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/laquinta.rda">here</a> and <a href="https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/dennys.rda">here</a>.</p>
<pre><code>githubURL_1 &lt;- &quot;https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/laquinta.rda&quot;

githubURL_2 &lt;- &quot;https://github.com/DataScience4Psych/DataScience4Psych/raw/main/data/raw-data/dennys.rda&quot;

load(url(githubURL_1))
load(url(githubURL_2))</code></pre>
</div>
<div id="housekeeping" class="section level3 hasAnchor" number="39.2.2">
<h3 class="hasAnchor"><span class="header-section-number">39.2.2</span> Housekeeping<a href="#housekeeping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="password-caching" class="section level4 hasAnchor" number="39.2.2.1">
<h4 class="hasAnchor"><span class="header-section-number">39.2.2.1</span> Password caching<a href="#password-caching" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you would like your git password cached for a week for this project, type the following in the Terminal:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> credential.helper <span class="st">&#39;cache --timeout 604800&#39;</span></span></code></pre></div>
</div>
<div id="project-name-1" class="section level4 hasAnchor" number="39.2.2.2">
<h4 class="hasAnchor"><span class="header-section-number">39.2.2.2</span> Project name<a href="#project-name-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Currently your project is called <em>Untitled Project</em>. Update the name of your project to be ‚ÄúLab 05 - Wrangling spatial data‚Äù.</p>
</div>
</div>
</div>
<div id="warm-up-4" class="section level2 hasAnchor" number="39.3">
<h2 class="hasAnchor"><span class="header-section-number">39.3</span> Warm up<a href="#warm-up-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we introduce the data, let‚Äôs warm up with some simple exercises.</p>
<div id="yaml-2" class="section level3 hasAnchor" number="39.3.1">
<h3 class="hasAnchor"><span class="header-section-number">39.3.1</span> YAML<a href="#yaml-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Open the R Markdown (Rmd) file in your project, change the author name to your name, and knit the document.</p>
</div>
<div id="commiting-and-pushing-changes-1" class="section level3 hasAnchor" number="39.3.2">
<h3 class="hasAnchor"><span class="header-section-number">39.3.2</span> Commiting and pushing changes:<a href="#commiting-and-pushing-changes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Go to the <strong>Git</strong> pane in your RStudio.</li>
<li>View the <strong>Diff</strong> and confirm that you are happy with the changes.</li>
<li>Add a commit message like ‚ÄúUpdate team name‚Äù in the <strong>Commit message</strong> box and hit <strong>Commit</strong>.</li>
<li>Click on <strong>Push</strong>. This action will prompt a dialogue box where you first need to enter your user name, and then your password.</li>
</ul>
</div>
</div>
<div id="the-data-1" class="section level2 hasAnchor" number="39.4">
<h2 class="hasAnchor"><span class="header-section-number">39.4</span> The data<a href="#the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The datasets we‚Äôll use are called <code>dennys</code> and <code>laquinta</code> from the <strong>dsbox</strong> package.</p>
</div>
<div id="exercises-4" class="section level2 hasAnchor" number="39.5">
<h2 class="hasAnchor"><span class="header-section-number">39.5</span> Exercises<a href="#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Filter the Denny‚Äôs dataframe for Alaska (AK) and save the result as <code>dn_ak</code>. How many Denny‚Äôs locations are there in Alaska?</li>
</ol>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>dn_ak <span class="ot">&lt;-</span> dn <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">&quot;AK&quot;</span>)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dn_ak)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Filter the La Quinta dataframe for Alaska (AK) and save the result as <code>lq_ak</code>. How many La Quinta locations are there in Alaska?</li>
</ol>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>lq_ak <span class="ot">&lt;-</span> lq <span class="sc">%&gt;%</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">&quot;AK&quot;</span>)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(lq_ak)</span></code></pre></div>
<p>Next we‚Äôll calculate the distance between all Denny‚Äôs and all La Quinta locations in Alaska. Let‚Äôs take this step by step:</p>
<p><strong>Step 1:</strong> There are 3 Denny‚Äôs and 2 La Quinta locations in Alaska.
(If you answered differently above, you might want to recheck your answers.)</p>
<p><img src="img/dennys-laquinta-sketches/dennys-laquinta-sketches.001.png" width="300" height="300" /></p>
<p><strong>Step 2:</strong> Let‚Äôs focus on the first Denny‚Äôs location. We‚Äôll need to
calculate two distances for it: (1) distance between Denny‚Äôs 1 and
La Quinta 1 and (2) distance between Denny‚Äôs 1 and La Quinta (2).</p>
<p><img src="img/dennys-laquinta-sketches/dennys-laquinta-sketches.002.png" width="300" height="150" /></p>
<p><strong>Step 3:</strong> Now let‚Äôs consider all Denny‚Äôs locations.</p>
<p><img src="img/dennys-laquinta-sketches/dennys-laquinta-sketches.003.png" width="300" height="450" /></p>
<ol start="3" style="list-style-type: decimal">
<li>How many pairings are there between all Denny‚Äôs and all La Quinta locations in Alaska, i.e., how many distances do we need to calculate between the locations of these establishments in Alaska?</li>
</ol>
<p>In order to calculate these distances, we need to first restructure our data to pair the Denny‚Äôs and La Quinta locations. To do so, we will join the two data frames. We have six join options in R. Each of these join functions take at least three arguments: <code>x</code>, <code>y</code>, and <code>by</code>.</p>
<ul>
<li><code>x</code> and <code>y</code> are data frames to join</li>
<li><code>by</code> is the variable(s) to join by</li>
</ul>
<p>Four of these join functions combine variables from the two dataframes:</p>
<blockquote>
<p>Note: These functions are called <strong>mutating joins</strong>.</p>
</blockquote>
<ul>
<li><p><code>inner_join()</code>: return all rows from <code>x</code> where there are matching values in <code>y</code>, and all columns from <code>x</code> and <code>y</code>.</p></li>
<li><p><code>left_join()</code>: return all rows from <code>x</code>, and all columns from <code>x</code> and <code>y</code>. Rows in x with no match in y will have NA values in the new columns.</p></li>
<li><p><code>right_join()</code>: return all rows from <code>y</code>, and all columns from <code>x</code> and <code>y</code>. Rows in y with no match in x will have NA values in the new columns.</p></li>
<li><p><code>full_join()</code>: return all rows and all columns from both <code>x</code> and <code>y</code>, where there are not matching values, returns NA for the one missing.</p></li>
</ul>
<p>And the other two join functions only keep cases from the left-hand data frame, and are called <strong>filtering joins</strong>. We‚Äôll learn about these another time, but you can find out more about the join functions in the help files for any one of them, e.g.¬†<code>?full_join</code>.</p>
<p>In practice, we mostly use mutating joins. In this case, we want to keep all rows and columns from both <code>dn_ak</code> and <code>lq_ak</code> data frames. So we will use a <code>full_join</code>.</p>
<div class="figure">
<img src="img/dennys-laquinta-sketches/dennys-laquinta-sketches.004.png" width="300" height="300" alt="" />
<p class="caption">Full join of Denny‚Äôs and La Quinta locations in AK</p>
</div>
<p>Let‚Äôs join the data on Denny‚Äôs and La Quinta locations in Alaska, and take a look at what it looks like:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>dn_lq_ak <span class="ot">&lt;-</span> <span class="fu">full_join</span>(dn_ak, lq_ak, <span class="at">by =</span> <span class="st">&quot;state&quot;</span>)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>dn_lq_ak</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>How many observations are in the joined <code>dn_lq_ak</code> data frame? What are the names of the variables in this data frame.</li>
</ol>
<p><code>.x</code> in the variable names means the variable comes from the <code>x</code> data frame (the first argument in the <code>full_join</code> call, i.e.¬†<code>dn_ak</code>), and <code>.y</code> means the variable comes from the <code>y</code> data frame. These variables are renamed to include <code>.x</code> and <code>.y</code> because the two data frames have the same variables and it‚Äôs not possible to have two variables in a data frame with the exact same name.</p>
<p>Now that we have the data in the format we wanted, all that is left is to calculate the distances between the pairs.</p>
<ol start="5" style="list-style-type: decimal">
<li>What function from the tidyverse do we use the add a new variable to a data frame while keeping the existing variables?</li>
</ol>
<p>One way of calculating the distance between any two points on the earth is to use the Haversine distance formula. This formula takes into account the fact that the earth is not flat, but instead spherical.</p>
<p>This function is not available in R, but we can save the following function to a file called <code>haversine.R</code> that we can load and then use:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>haversine <span class="ot">&lt;-</span> <span class="cf">function</span>(long1, lat1, long2, lat2, <span class="at">round =</span> <span class="dv">3</span>) {</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to radians</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  long1 <span class="ot">=</span> long1 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  lat1  <span class="ot">=</span> lat1  <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  long2 <span class="ot">=</span> long2 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  lat2  <span class="ot">=</span> lat2  <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">=</span> <span class="dv">6371</span> <span class="co"># Earth mean radius in km</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">=</span> <span class="fu">sin</span>((lat2 <span class="sc">-</span> lat1)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">cos</span>(lat1) <span class="sc">*</span> <span class="fu">cos</span>(lat2) <span class="sc">*</span> <span class="fu">sin</span>((long2 <span class="sc">-</span> long1)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> R <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">asin</span>(<span class="fu">sqrt</span>(a))</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">round</span>(d,round) ) <span class="co"># distance in km</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This function takes five arguments:</p>
<ul>
<li>Longitude and latitude of the first location</li>
<li>Longitude and latitude of the second location</li>
<li>A parameter by which to round the responses</li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><p>Calculate the distances between all pairs of Denny‚Äôs and La Quinta locations and save this variable as <code>distance</code>. Make sure to save this variable in THE <code>dn_lq_ak</code> data frame so that you can use it later.</p></li>
<li><p>Calculate the minimum distance between a Denny‚Äôs and La Quinta for each Denny‚Äôs location. To do so we group by Denny‚Äôs locations and calculate a new variable that stores the information for the minimum distance.</p></li>
</ol>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>dn_lq_ak_mindist <span class="ot">&lt;-</span> dn_lq_ak <span class="sc">%&gt;%</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(address.x) <span class="sc">%&gt;%</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">closest =</span> <span class="fu">min</span>(distance))</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li><p>Describe the distribution of the distances Denny‚Äôs and the nearest La Quinta locations in Alaska. Also include an appripriate visualization and relevant summary statistics.</p></li>
<li><p>Repeat the same analysis for North Carolina: (i) filter Denny‚Äôs and La Quinta Data Frames for NC, (ii) join these data frames to get a complete list of all possible pairings, (iii) calculate the distances between all possible pairings of Denny‚Äôs and La Quinta in NC, (iv) find the minimum distance between each Denny‚Äôs and La Quinta location, (v) visualize and describe the distribution of these shortest distances using appropriate summary statistics.</p></li>
<li><p>Repeat the same analysis for Texas.</p></li>
<li><p>Repeat the same analysis for a state of your choosing, different than the ones we covered so far.</p></li>
<li><p>Among the states you examined, where is Mitch Hedberg‚Äôs joke most likely to hold true? Explain your reasoning.</p></li>
</ol>
<!--chapter:end:0504_lab_laquinta.Rmd-->
</div>
</div>
<div id="part-module-06" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 06<a href="#part-module-06" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="mod06" class="section level1 hasAnchor" number="40">
<h1 class="hasAnchor"><span class="header-section-number">40</span> Welcome to Confounding and Communication!<a href="#mod06" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module introduces ideas related to study design and science communication. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYYV_KDod3Mk9-RmtFXii9Dv">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>. Note that you only have to do one of the labs. Pick either (or both if you want‚Ä¶)</p>
<div id="module-materials-5" class="section level2 hasAnchor" number="40.1">
<h2 class="hasAnchor"><span class="header-section-number">40.1</span> Module Materials<a href="#module-materials-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d14_confound/d14_confound.html">Scientific studies and confounding</a></li>
<li><a href="https://datascience4psych.github.io/slides/d15_goodtalk/d15_goodtalk.html">Communicating data science results effectively</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>Judea Pearl on <a href="https://ftp.cs.ucla.edu/pub/stat_ser/r414-reprint.pdf">Understanding Simpson‚Äôs Paradox</a></li>
<li>R4DS on <a href="https://r4ds.had.co.nz/communicate-intro.html">communication</a>, including
<ul>
<li><a href="https://r4ds.had.co.nz/graphics-for-communication.html">Graphics for Communication</a></li>
</ul></li>
<li>All subchapters of this module</li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab06">Ugly Charts</a></li>
</ul></li>
</ul>
</div>
<div id="video-length" class="section level2 hasAnchor" number="40.2">
<h2 class="hasAnchor"><span class="header-section-number">40.2</span> Video Length<a href="#video-length" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No of videos : 5</p>
<p>Average length of video : 11 minutes, 16 seconds</p>
<p>Total length of playlist : 56 minutes, 20 seconds</p>
</div>
</div>
<div id="scientific-studies-and-confounding" class="section level1 hasAnchor" number="41">
<h1 class="hasAnchor"><span class="header-section-number">41</span> Scientific studies and confounding!<a href="#scientific-studies-and-confounding" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">And don&#39;t even start thinking about latent variables... <a href="https://t.co/kDRZeYlFe2">https://t.co/kDRZeYlFe2</a></p>&mdash; JK Flake üìàüìè (@JkayFlake) <a href="https://twitter.com/JkayFlake/status/1475533542302093315?ref_src=twsrc%5Etfw">December 27, 2021</a></blockquote>

<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d14_confound/d14_confound.html">here</a> if they do not appear below.</p>
<div id="scientific-studies" class="section level2 hasAnchor" number="41.1">
<h2 class="hasAnchor"><span class="header-section-number">41.1</span> Scientific studies<a href="#scientific-studies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/OHfk4dbzNBc" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d14_confound/d14_confound.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="climate-change-a-conditional-probability-case-study" class="section level2 hasAnchor" number="41.2">
<h2 class="hasAnchor"><span class="header-section-number">41.2</span> Climate Change: A Conditional Probability Case Study<a href="#climate-change-a-conditional-probability-case-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Fv-yucms7lQ" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d14_confound/d14_confound.html#20" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="introducing-simpsons-paradox-with-a-case-study" class="section level2 hasAnchor" number="41.3">
<h2 class="hasAnchor"><span class="header-section-number">41.3</span> Introducing Simpson‚Äôs Paradox with a case study<a href="#introducing-simpsons-paradox-with-a-case-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/My68gFE_usU" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d14_confound/d14_confound.html#29" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="revisiting-simpsons-paradox" class="section level2 hasAnchor" number="41.4">
<h2 class="hasAnchor"><span class="header-section-number">41.4</span> Revisiting Simpson‚Äôs Paradox<a href="#revisiting-simpsons-paradox" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/vVq_G-a6K30" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d14_confound/d14_confound.html#37" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="communicating-data-science-results-effectively" class="section level1 hasAnchor" number="42">
<h1 class="hasAnchor"><span class="header-section-number">42</span> Communicating data science results effectively!<a href="#communicating-data-science-results-effectively" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d15_goodtalk/d15_goodtalk.html">here</a> if they do not appear below.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">This ‚¨áÔ∏è. If you want to be a collaborative statistician, you need to be able to talk to and help people who don&#39;t have the same training as you. It&#39;s not their job to be able to talk like they have a degree in statistics. <a href="https://t.co/XcvXazNHEw">https://t.co/XcvXazNHEw</a></p>&mdash; Daphna Harel (daphnaharel at mastodon.social) (@DaphnaHarel) <a href="https://twitter.com/DaphnaHarel/status/1366792094279495685?ref_src=twsrc%5Etfw">March 2, 2021</a></blockquote>

<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/xGP08paoAKI" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d15_goodtalk/d15_goodtalk.html" width="672" height="400px" data-external="1">
</iframe>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0601_confounds.Rmd-->
</div>
<div id="lab06" class="section level1 hasAnchor" number="43">
<h1 class="hasAnchor"><span class="header-section-number">43</span> Lab: Ugly charts and Simpson‚Äôs paradox<a href="#lab06" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The two data visualized embedded in this lab violate many data visualization best practices.
Improve these visualizations using R and the tips for effective visualizations that we‚Äôve introduced.
You should produce one visualization per dataset.
Your visualization should be accompanied by a brief paragraph describing the choices you made in your improvement, specifically discussing what you didn‚Äôt like in the original plots and why, and how you addressed them in the visualization you created.</p>
<p>The learning goals for this lab are:</p>
<ul>
<li>Telling a story with data</li>
<li>Data visualization best practices</li>
<li>Reshaping data</li>
</ul>
<div id="getting-started-5" class="section level2 hasAnchor" number="43.1">
<h2 class="hasAnchor"><span class="header-section-number">43.1</span> Getting started<a href="#getting-started-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go to the course GitHub organization and locate your lab repo. Either Fork it or copy it as a template. Then clone it in RStudio.
Refer to Lab 01 if you would like to see step-by-step instructions for cloning a repo into an RStudio project.</p>
<p>First, open the R Markdown document and Knit it. Make sure it compiles without errors. (Also, remember to check the final version after you upload!)</p>
<p>The output will be in the file markdown <code>.md</code> file with the same name.</p>
<div id="housekeeping-1" class="section level3 hasAnchor" number="43.1.1">
<h3 class="hasAnchor"><span class="header-section-number">43.1.1</span> Housekeeping<a href="#housekeeping-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Remember: Your email address is the address tied to your GitHub account and your name should be first and last name.</p>
</blockquote>
<p>Before we can get started we need to take care of some required housekeeping.
Specifically, we need to do some configuration so that RStudio can communicate with GitHub.
This requires two pieces of information: your email address and your name.</p>
<p>Run the following (but update it for your name and email!) in the Console to configure git:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">use_git_config</span>(<span class="at">user.name =</span> <span class="st">&quot;Your Name&quot;</span>, </span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">user.email =</span> <span class="st">&quot;your.email@address.com&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="packages-5" class="section level2 hasAnchor" number="43.2">
<h2 class="hasAnchor"><span class="header-section-number">43.2</span> Packages<a href="#packages-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Run the following code in the Console to load this package.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="take-a-sad-plot-and-make-it-better" class="section level2 hasAnchor" number="43.3">
<h2 class="hasAnchor"><span class="header-section-number">43.3</span> Take a sad plot and make it better<a href="#take-a-sad-plot-and-make-it-better" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="instructional-staff-employment-trends" class="section level3 hasAnchor" number="43.3.1">
<h3 class="hasAnchor"><span class="header-section-number">43.3.1</span> Instructional staff employment trends<a href="#instructional-staff-employment-trends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The American Association of University Professors (AAUP) is a nonprofit membership association of faculty and other academic professionals.
<a href="https://www.aaup.org/sites/default/files/files/AAUP_Report_InstrStaff-75-11_apr2013.pdf">This report</a> compiled by the AAUP shows trends in instructional staff employees between 1975 and 2011, and contains an image very similar to the one given below.</p>
<p><img src="img/staff-employment.png" width="822" /></p>
<p>Let‚Äôs start by loading the data used to create this plot.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>staff <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/instructional-staff.csv&quot;</span>)</span></code></pre></div>
<p>Each row in this dataset represents a faculty type, and the columns are the years for which we have data.
The values are percentage of hires of that type of faculty for each year.</p>
<pre><code>## # A tibble: 5 √ó 12
##   facult‚Ä¶¬π `1975` `1989` `1993` `1995` `1999` `2001` `2003` `2005` `2007` `2009`
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 Full-Ti‚Ä¶   29     27.6   25     24.8   21.8   20.3   19.3   17.8   17.2   16.8
## 2 Full-Ti‚Ä¶   16.1   11.4   10.2    9.6    8.9    9.2    8.8    8.2    8      7.6
## 3 Full-Ti‚Ä¶   10.3   14.1   13.6   13.6   15.2   15.5   15     14.8   14.9   15.1
## 4 Part-Ti‚Ä¶   24     30.4   33.1   33.2   35.5   36     37     39.3   40.5   41.1
## 5 Graduat‚Ä¶   20.5   16.5   18.1   18.8   18.7   19     20     19.9   19.5   19.4
## # ‚Ä¶ with 1 more variable: `2011` &lt;dbl&gt;, and abbreviated variable name
## #   ¬π‚Äãfaculty_type</code></pre>
<p>In order to recreate this visualization we need to first reshape the data to have one variable for faculty type and one variable for year.
In other words, we will convert the data from wide format to long format.</p>
<p>But before we do so, a thought exercise: <em>How many rows will the long-format data have?</em> It will have a row for each combination of year and faculty type.
If there are 5 faculty types and 11 years of data, how many rows will we have?</p>
<p>We do the wide to long conversion using a new function: <code>pivot_longer()</code>.
The animation below show how this function works, as well as its counterpart <code>pivot_wider()</code>.</p>
<p><img src="img/tidyr-longer-wider.gif" /><!-- --></p>
<p>The function has the following arguments:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(data, cols, <span class="at">names_to =</span> <span class="st">&quot;name&quot;</span>)</span></code></pre></div>
<ul>
<li>The first argument is <code>data</code> as usual.</li>
<li>The second argument, <code>cols</code>, is where you specify which columns to pivot into longer format ‚Äì in this case all columns except for the <code>faculty_type</code></li>
<li>The third argument, <code>names_to</code>, is a string specifying the name of the column to create from the data stored in the column names of data ‚Äì in this case <code>year</code></li>
</ul>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>staff_long <span class="ot">&lt;-</span> staff <span class="sc">%&gt;%</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>faculty_type, <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(value))</span></code></pre></div>
<p>Let‚Äôs take a look at what the new longer data frame looks like.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>staff_long</span></code></pre></div>
<pre><code>## # A tibble: 55 √ó 3
##    faculty_type              year  value
##    &lt;chr&gt;                     &lt;chr&gt; &lt;dbl&gt;
##  1 Full-Time Tenured Faculty 1975   29  
##  2 Full-Time Tenured Faculty 1989   27.6
##  3 Full-Time Tenured Faculty 1993   25  
##  4 Full-Time Tenured Faculty 1995   24.8
##  5 Full-Time Tenured Faculty 1999   21.8
##  6 Full-Time Tenured Faculty 2001   20.3
##  7 Full-Time Tenured Faculty 2003   19.3
##  8 Full-Time Tenured Faculty 2005   17.8
##  9 Full-Time Tenured Faculty 2007   17.2
## 10 Full-Time Tenured Faculty 2009   16.8
## # ‚Ä¶ with 45 more rows</code></pre>
<p>And now let‚Äôs plot is as a line plot.
A possible approach for creating a line plot where we color the lines by faculty type is the following:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>staff_long <span class="sc">%&gt;%</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> value, <span class="at">color =</span> faculty_type)) <span class="sc">+</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<pre><code>## `geom_line()`: Each group consists of only one observation.
## ‚Ñπ Do you need to adjust the group aesthetic?</code></pre>
<p><img src="0602_lab_charts_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
<p>But note that this results in a message as well as an unexpected plot.
The message is saying that there is only one observation for each faculty type year combination.
We can fix this using the <code>group</code> aesthetic following.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>staff_long <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> value,</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> faculty_type,</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> faculty_type)) <span class="sc">+</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Include the line plot you made above in your report and make sure the figure width is large enough to make it legible.
&gt; Also fix the title, axis labels, and legend label.</p></li>
<li><p>Suppose the objective of this plot was to show that the proportion of part-time faculty have gone up over time compared to other instructional staff types.
&gt; What changes would you propose making to this plot to tell this story?</p></li>
</ol>
<p>‚úÖ ‚¨ÜÔ∏è <em>Commit and push your changes to GitHub with an appropriate commit message again. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
</div>
<div id="fisheries" class="section level3 hasAnchor" number="43.3.2">
<h3 class="hasAnchor"><span class="header-section-number">43.3.2</span> Fisheries<a href="#fisheries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fisheries and Aquaculture Department of the Food and Agriculture Organization of the United Nations collects data on fisheries production of countries.
<a href="https://en.wikipedia.org/wiki/Fishing_industry_by_country">This Wikipedia page</a> lists fishery production of countries for 2016.
For each country, tonnage from capture and aquaculture are listed.
Note that countries whose total harvest was less than 100,000 tons are not included in the visualization.</p>
<p>A researcher shared with you the following visualization they created based on these data <!--üò≥-->.</p>
<p><img src="img/fisheries.png" width="1121" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Can you help them make improve it? First, brainstorm how you would improve it. Then create the improved visualization and write up the changes/decisions you made as bullet points. It‚Äôs ok if some of your improvements are aspirational, i.e.¬†you don‚Äôt know how to implement it, but you think it‚Äôs a good idea. Ask a tutor for help, but also keep an eye on the time. Implement what you can and leave note identifying the aspirational improvements.</li>
</ol>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>fisheries <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/fisheries.csv&quot;</span>)</span></code></pre></div>
<p>‚úÖ ‚¨ÜÔ∏è <em>Commit and push your changes to GitHub with an appropriate commit message again. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
</div>
</div>
<div id="stretch-practice-with-smokers-in-whickham" class="section level2 hasAnchor" number="43.4">
<h2 class="hasAnchor"><span class="header-section-number">43.4</span> Stretch Practice with Smokers in Whickham<a href="#stretch-practice-with-smokers-in-whickham" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="img/whickham.png" width="527" /></p>
<p>A study of conducted in Whickham, England recorded participants‚Äô age, smoking status at baseline, and then 20 years later recorded their health outcome.</p>
<div id="packages-6" class="section level3 hasAnchor" number="43.4.1">
<h3 class="hasAnchor"><span class="header-section-number">43.4.1</span> Packages<a href="#packages-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, we will work with the <code>mosaicData</code> package.</p>
<p>Because this is first time we‚Äôre using the <code>mosaicData</code> package, you need to make sure to install it first by running <code>install.packages("mosaicData")</code> in the console.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaicData) </span></code></pre></div>
<p>Note that these packages are also loaded in your R Markdown document.</p>
</div>
<div id="the-data-2" class="section level3 hasAnchor" number="43.4.2">
<h3 class="hasAnchor"><span class="header-section-number">43.4.2</span> The data<a href="#the-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data is in the <code>mosaicData</code> package. You can load it with</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Whickham)</span></code></pre></div>
<p>Take a peek at the codebook with</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>?Whickham</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>()</span></code></pre></div>
</div>
<div id="exercises-5" class="section level3 hasAnchor" number="43.4.3">
<h3 class="hasAnchor"><span class="header-section-number">43.4.3</span> Exercises<a href="#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>What type of study do you think these data come from: observational
or experiment? Why?</p></li>
<li><p>How many observations are in this dataset? What does each observation
represent?</p></li>
<li><p>How many variables are in this dataset? What type of variable is each?
Display each variable using an appropriate visualization.</p></li>
<li><p>What would you expect the relationship between smoking status and health outcome to be?</p></li>
<li><p>Create a visualization depicting the relationship between smoking status and health outcome. Briefly describe the relationship, and evaluate whether this meets your expectations. Additionally, calculate the relevant conditional probabilities to help your narrative. Here is some code to get you started:</p></li>
</ol>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>Whickham <span class="sc">%&gt;%</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(smoker, outcome)</span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Create a new variable called <code>age_cat</code> using the following scheme:</li>
</ol>
<ul>
<li><code>age &lt;= 44 ~ "18-44"</code></li>
<li><code>age &gt; 44 &amp; age &lt;= 64 ~ "45-64"</code></li>
<li><code>age &gt; 64 ~ "65+"</code></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Re-create the visualization depicting the relationship between smoking status and health outcome, faceted by <code>age_cat</code>. What changed? What might explain this change? Extend the contingency table from earlier by
breaking it down by age category and use it to help your narrative.</li>
</ol>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>Whickham <span class="sc">%&gt;%</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(smoker, age_cat, outcome)</span></code></pre></div>
</div>
</div>
<div id="wrapping-up-1" class="section level2 hasAnchor" number="43.5">
<h2 class="hasAnchor"><span class="header-section-number">43.5</span> Wrapping up<a href="#wrapping-up-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go back through your write up to make sure you‚Äôre following coding style guidelines we discussed in class.
Make any edits as needed.</p>
<p>Also, make sure all of your R chunks are properly labeled, and your figures are reasonably sized.</p>
</div>
<div id="more-ugly-charts" class="section level2 hasAnchor" number="43.6">
<h2 class="hasAnchor"><span class="header-section-number">43.6</span> More ugly charts<a href="#more-ugly-charts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Want to see more ugly charts?</p>
<ul>
<li><a href="https://flowingdata.com/category/visualization/ugly-visualization/">Flowing Data - Ugly Charts</a></li>
<li><a href="https://www.reddit.com/r/dataisugly/">Reddit - Data is ugly</a></li>
<li><a href="http://www.datavis.ca/gallery/missed.php">Missed Opportunities and Graphical Failures</a></li>
<li><a href="http://users.stat.umn.edu/~rend0020/Teaching/STAT8801-resources/graphics/index.html">(Mostly Bad) Graphics and Tables</a></li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0602_lab_charts.Rmd-->
</div>
</div>
<div id="part-module-07" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 07<a href="#part-module-07" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-web-scraping" class="section level1 hasAnchor" number="44">
<h1 class="hasAnchor"><span class="header-section-number">44</span> Welcome to web scraping<a href="#welcome-to-web-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce you to the basic ideas behind web scraping. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/watch?list=PLKrrdtYgOUYZxvEvQ8-PcWrOY_dwY_ETI">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>. In the original filming, this unit was module 07.</p>
<div id="module-materials-6" class="section level2 hasAnchor" number="44.1">
<h2 class="hasAnchor"><span class="header-section-number">44.1</span> Module Materials<a href="#module-materials-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d16_webscraping/d16_webscraping.html">Webscraping</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module</li>
<li>R4DS,
<ul>
<li>Section on <a href="https://r4ds.had.co.nz/functions.html">functions</a></li>
</ul></li>
<li><a href="https://smac-group.github.io/ds/section-web-scraping.html">Wrap Scraping from An Introduction to Statistical Programming Methods with R</a></li>
</ul></li>
<li>Activities
<ul>
<li><a href="https://github.com/DataScience4Psych/ae-08-imdb-webscraping">Scraping IMDB</a></li>
</ul></li>
<li>Lab
<ul>
<li>[Better Viz][lab07]</li>
</ul></li>
</ul>
</div>
<div id="estimated-video-length-5" class="section level2 hasAnchor" number="44.2">
<h2 class="hasAnchor"><span class="header-section-number">44.2</span> Estimated Video Length<a href="#estimated-video-length-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No of videos : 3</p>
<p>Average length of video : 14 minutes, 40 seconds</p>
<p>Total length of playlist : 44 minutes</p>
</div>
</div>
<div id="scraping-the-web" class="section level1 hasAnchor" number="45">
<h1 class="hasAnchor"><span class="header-section-number">45</span> Scraping the web<a href="#scraping-the-web" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d16_webscraping/d16_webscraping.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/iy11CqHnfcM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d16_webscraping/d16_webscraping.html" width="672" height="400px" data-external="1">
</iframe>
<div id="using-the-selectorgadget" class="section level2 hasAnchor" number="45.1">
<h2 class="hasAnchor"><span class="header-section-number">45.1</span> Using the SelectorGadget!<a href="#using-the-selectorgadget" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/B7tGbfDgx3c" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d16_webscraping/d16_webscraping.html#12" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="top-250-movies-on-imdb" class="section level2 hasAnchor" number="45.2">
<h2 class="hasAnchor"><span class="header-section-number">45.2</span> Top 250 movies on IMDB!<a href="#top-250-movies-on-imdb" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/c0s1Im0Q7rA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d16_webscraping/d16_webscraping.html#25" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="activity-08-imdb" class="section level2 hasAnchor" number="45.3">
<h2 class="hasAnchor"><span class="header-section-number">45.3</span> Activity 08: IMDB!<a href="#activity-08-imdb" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe src="https://datascience4psych.github.io/slides/d16_webscraping/d16_webscraping.html#28" width="672" height="400px" data-external="1">
</iframe>
<iframe src="https://datascience4psych.github.io/slides/d16_webscraping/d16_webscraping.html#68" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for the IMDB activity <a href="https://github.com/DataScience4Psych/ae-08-imdb-webscraping">here</a>.</p>
</div>
<div id="useful-regex-things" class="section level2 hasAnchor" number="45.4">
<h2 class="hasAnchor"><span class="header-section-number">45.4</span> Useful RegEx things‚Ä¶<a href="#useful-regex-things" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">The only cheat sheet I am going to tape to my wall! üòÖ<a href="https://t.co/NMgtnI5cC9">https://t.co/NMgtnI5cC9</a><br><br>I don&#39;t want to have two problems (<a href="https://t.co/isLUg0C8Cu">https://t.co/isLUg0C8Cu</a>) üò¨<a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> <a href="https://twitter.com/hashtag/regex?src=hash&amp;ref_src=twsrc%5Etfw">#regex</a> <a href="https://t.co/9Jf3cDEg4F">pic.twitter.com/9Jf3cDEg4F</a></p>&mdash; Indrajeet Patil (‡§á‡§Ç‡§¶‡•ç‡§∞‡§ú‡•Ä‡§§ ‡§™‡§æ‡§ü‡•Ä‡§≤) (@patilindrajeets) <a href="https://twitter.com/patilindrajeets/status/1463508045103869963?ref_src=twsrc%5Etfw">November 24, 2021</a></blockquote>

<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0701_scraping.Rmd-->
</div>
</div>
<div id="data-usually-finds-me" class="section level1 hasAnchor" number="46">
<h1 class="hasAnchor"><span class="header-section-number">46</span> Data usually finds me<a href="#data-usually-finds-me" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>This document is based on my SAM talk on ‚ÄúI don‚Äôt go looking for Data ‚Ä¶ Data usually finds me,‚Äù from 2020.Here is a <a href="https://github.com/DataScience4Psych/DataScience4Psych/raw/main/admin/pdf/sam_vfinal.pdf">link to the slides of that talk</a>.</p>
</blockquote>
<div id="i-dont-go-looking-for-data-data-usually-finds-me" class="section level2 hasAnchor" number="46.1">
<h2 class="hasAnchor"><span class="header-section-number">46.1</span> I don‚Äôt go looking for Data ‚Ä¶ Data usually finds me<a href="#i-dont-go-looking-for-data-data-usually-finds-me" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The most interesting aspects of my work (or at least to me) are the aspects related to finding data. However, this part is also the least documented. In my case, it primarily lives in footnotes, personal statements, and appendices.</p>
</div>
<div id="two-major-approaches" class="section level2 hasAnchor" number="46.2">
<h2 class="hasAnchor"><span class="header-section-number">46.2</span> Two Major Approaches<a href="#two-major-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This approach can be applied to many aspects of our work, but it is particularly helpful in providing a framework for my experiences with data.</p>
<p>The exploratory approach is descriptive and is data-driven. Data scientists often apply this approach. In contrast, the confirmatory approach is question driven, and aimed at testing specific hypotheses. Research scientists often apply this approach, but not always.</p>
<div id="where-do-you-start" class="section level3 hasAnchor" number="46.2.1">
<h3 class="hasAnchor"><span class="header-section-number">46.2.1</span> Where do you start?<a href="#where-do-you-start" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Do you start with the question or with the data?</p>
</div>
</div>
<div id="confirmatory-approach-to-archival-data" class="section level2 hasAnchor" number="46.3">
<h2 class="hasAnchor"><span class="header-section-number">46.3</span> Confirmatory Approach to Archival Data<a href="#confirmatory-approach-to-archival-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The confirmatory approach to archival data is question driven. What types of questions? These can include questions related to theories, measures, subjects, models, replicability, or even externally-motivated questions. Theory-based questions include questions like ‚ÄúDo smart girls delay sex? Measurement based questions can ask things like‚ÄùIs Coding Speed from the ASVAB a decent proxy for conscientiousness?‚Äú. Questions about subjects include‚ÄùWhere can I find Twins Raised Apart?‚Äù Modeling questions can include things like How do I illustrate my dual mediated survival model? Replication: Can I replicate my finding in another sample? Externally-inspired questions can include things like Can I address reviewer two‚Äôs concern about reliability of difference scores?</p>
<p>These questions narrow your search‚Ä¶ Otherwise the scope of data is overwhelming. The wonderful Kathy Shields helped me add a section to the WFU library website to get you started <a href="https://guides.zsr.wfu.edu/psychology">guides.zsr.wfu.edu/psychology</a>. My favorite three places to look for specific datasets are the University of Michigan‚Äôs Inter-university Consortium for Political and Social Research (<a href="http://icpsr.org">ICPSR</a>), Harvard‚Äôs <a href="http://dataverse.harvard.edu/">Dataverse</a> and the US government‚Äôs <a href="https://catalog.data.gov/dataset">Data.gov</a>. To give you a sense of scale, ICPSR has approximately 15,000 digitized data sets. Harvard has about 95,000. Data.gov has about 250,000.</p>
</div>
<div id="exploratory-approach" class="section level2 hasAnchor" number="46.4">
<h2 class="hasAnchor"><span class="header-section-number">46.4</span> Exploratory Approach<a href="#exploratory-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The exploratory approach to archival data is data driven. Often you already have a data set in mind. Most of my earliest experiences fall into this category. These are also the most interesting experiences. But, how does data find you? Data can find you in numerous ways including referrals, reading, rumor, and random chance. A referral example would be when a speaker tells you about an intergenerational data set partially run by the BLS. You may also just stumble across it in your readings, such as when a historian using aspects of a marriage study. A rumor may inspire you, such as observing that a control group is mentioned in the original write-up of the Terman study (1921ish). Serendipity might lead you to fly to SPSP, talk to the person sitting next to you about a study you were in‚Ä¶</p>
<p>Now in this case places to start looking will be driven by your specific needs. Sometimes, your specific dataset is already: digitized, de-identified, and clearly located. Sometimes, only parts of it are‚Ä¶ Other times, it gets interesting‚Ä¶</p>
</div>
<div id="data-retrieval-ranges-wildly" class="section level2 hasAnchor" number="46.5">
<h2 class="hasAnchor"><span class="header-section-number">46.5</span> Data Retrieval Ranges Wildly<a href="#data-retrieval-ranges-wildly" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data retrieval ranges wildly. It can be as easy as downloading a data set. Or it can be as unwieldy as:</p>
<ul>
<li>Applying for access to the ‚Äúdigitized‚Äù dataset on the Dataverse for an econometrics class</li>
<li>Waiting for a panel of two researchers to convene for approval</li>
<li>Learning that one researcher (E. Lowell Kelly) on the panel died in 1986 and the other (James Conley) is nowhere to be found.</li>
<li>Teaming up with a 2nd-year assistant professor (Josh Jackson) to find Conley</li>
<li>Tracking down James Connolly, who legally changed his name in 1992 (or so) from James Conley</li>
<li>Convincing Jim to share the data</li>
<li>Determining where the data are</li>
<li>Retrieving boxes from the basement of:
<ul>
<li><p>Henry A. Murray Research Archive (Part of Harvard‚Äôs Dataverse)</p></li>
<li><p>Jim Connolly‚Äôs office</p></li>
<li><p>Bentley Library (Part of Michigan‚Äôs ICPSR)</p></li>
</ul></li>
</ul>
<p>There is a silver lining to difficult data retrieval. The more hurdles between you and the data the less likely it is that you‚Äôll be scooped.</p>
</div>
<div id="bit-of-context-marriage-study" class="section level2 hasAnchor" number="46.6">
<h2 class="hasAnchor"><span class="header-section-number">46.6</span> Bit of Context: Marriage Study<a href="#bit-of-context-marriage-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="list-of-data-places" class="section level2 hasAnchor" number="46.7">
<h2 class="hasAnchor"><span class="header-section-number">46.7</span> List of Data Places<a href="#list-of-data-places" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Greatest Hits:</p>
<ul>
<li><p>ICPSR, (<a href="http://icpsr.org" class="uri">http://icpsr.org</a>)</p></li>
<li><p>Harvard Dataverse (<a href="http://dataverse.harvard.edu/" class="uri">http://dataverse.harvard.edu/</a>),</p></li>
<li><p>Dryad,(<a href="http://datadryad.org" class="uri">http://datadryad.org</a>)</p></li>
<li><p>OSF (<a href="http://osf.io/" class="uri">http://osf.io/</a>),</p></li>
<li><p>Figshare (<a href="http://figshare.com/" class="uri">http://figshare.com/</a>)</p></li>
<li><p>Nature‚Äôs list of repositories <a href="https://www.nature.com/sdata/policies/repositories" class="uri">https://www.nature.com/sdata/policies/repositories</a></p></li>
</ul>
<p>Other Places
* <a href="https://guides.zsr.wfu.edu/c.php?g=34362&amp;p=7117614">ZSR Guide</a>
* <a href="https://osf.io/ra8yg/" class="uri">https://osf.io/ra8yg/</a></p>
</div>
<div id="great-papers-to-get-you-started" class="section level2 hasAnchor" number="46.8">
<h2 class="hasAnchor"><span class="header-section-number">46.8</span> Great Papers to Get You Started<a href="#great-papers-to-get-you-started" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>If you‚Äôre interested in neuroimaging,</li>
</ul>
<p><a href="https://link.springer.com/article/10.1007/s12021-021-09519-6">Madan, C.R. Scan Once, Analyse Many: Using Large Open-Access Neuroimaging Datasets to Understand the Brain. Neuroinform (2021). https://doi.org/10.1007/s12021-021-09519-6</a></p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">It&#39;s officially published and all!<br>&quot;Scan Once, Analyse Many: Using large open-access neuroimaging datasets to understand the brain&quot;<a href="https://t.co/Ubi4nBTqRx">https://t.co/Ubi4nBTqRx</a><br><br>It&#39;s written to be an introductory guide for those entering the world of neuroimaging using secondary data, <br>1/2</p>&mdash; Dr Christopher Madan üêòüß†üíª (he/him) (@cMadan) <a href="https://twitter.com/cMadan/status/1392130356988547076?ref_src=twsrc%5Etfw">May 11, 2021</a></blockquote>

<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0702_getdata.Rmd-->
</div>
</div>
<div id="api-wrappers" class="section level1 hasAnchor" number="47">
<h1 class="hasAnchor"><span class="header-section-number">47</span> Use API-wrapping packages<a href="#api-wrappers" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These readings are adapted from Jenny Bryan‚Äôs stat545 and were originally written by Andrew MacDonald. I‚Äôve added bits and pieces.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Google trends analytics is helpful in the study of global web search patterns.<br><br>The {gtrends} function from {gtrendsR} üì¶ helps extract and visualize this data for specified periods and geolocations üîé<a href="https://t.co/yS01ELq5q4">https://t.co/yS01ELq5q4</a><a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> <a href="https://twitter.com/hashtag/DataScience?src=hash&amp;ref_src=twsrc%5Etfw">#DataScience</a> <a href="https://t.co/mhGTSXB2rN">pic.twitter.com/mhGTSXB2rN</a></p>&mdash; R Function A Day (@rfunctionaday) <a href="https://twitter.com/rfunctionaday/status/1381848183928729600?ref_src=twsrc%5Etfw">April 13, 2021</a></blockquote>

<div id="introduction" class="section level2 hasAnchor" number="47.1">
<h2 class="hasAnchor"><span class="header-section-number">47.1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>All this and more is described at the <a href="https://github.com/ropensci/webservices">rOpenSci repository of R tools for interacting with the internet</a>.</strong></p>
<p>There are many ways to obtain data from the internet; let‚Äôs consider four categories:</p>
<ul>
<li><em>Click-and-download</em> - on the internet as a ‚Äúflat‚Äù file, such as CSV, XLS.</li>
<li><em>Install-and-play</em> - an API for which someone has written a handy R package.</li>
<li><em>API-query</em> - published with an unwrapped API.</li>
<li><em>Scraping</em> - implicit in an HTML website.</li>
</ul>
</div>
<div id="click-and-download" class="section level2 hasAnchor" number="47.2">
<h2 class="hasAnchor"><span class="header-section-number">47.2</span> Click-and-Download<a href="#click-and-download" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the simplest case, the data you need is already on the internet in a tabular format. There are a couple of strategies here:</p>
<ul>
<li>Use <code>read.csv</code> or <code>readr::read_csv</code> to read the data straight into R.</li>
<li>Use the command line program <code>curl</code> to do that work, and place it in a <code>Makefile</code> or shell script (see the <a href="#automation-overview">section on <code>make</code></a> for more on this).</li>
</ul>
<p>The second case is most useful when the data you want has been provided in a format that needs cleanup. For example, the World Value Survey makes several datasets available as Excel sheets. The safest option here is to download the <code>.xls</code> file, then read it into R with <code>readxl::read_excel()</code> or something similar. An exception to this is data provided as Google Spreadsheets, which can be read straight into R using the <a href="https://github.com/jennybc/googlesheets"><code>googlesheets</code></a> package.</p>
<div id="from-ropensci-web-services-page" class="section level3 hasAnchor" number="47.2.1">
<h3 class="hasAnchor"><span class="header-section-number">47.2.1</span> From rOpenSci web services page:<a href="#from-ropensci-web-services-page" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From rOpenSci‚Äôs <a href="https://github.com/ropensci/webservices">CRAN Task View: Web Technologies and Services</a>:</p>
<ul>
<li><code>downloader::download()</code> for SSL.</li>
<li><code>curl::curl()</code> for SSL.</li>
<li><code>httr::GET</code> data read this way needs to be parsed later with <code>read.table()</code>.</li>
<li><code>rio::import()</code> can ‚Äúread a number of common data formats directly from an <code>https://</code> URL‚Äù. Isn‚Äôt that very similar to the previous?</li>
</ul>
<p>What about packages that install data?</p>
</div>
</div>
<div id="data-supplied-on-the-web" class="section level2 hasAnchor" number="47.3">
<h2 class="hasAnchor"><span class="header-section-number">47.3</span> Data supplied on the web<a href="#data-supplied-on-the-web" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many times, the data that you want is not already organized into one or a few tables that you can read directly into R. More frequently, you find this data is given in the form of an API. <strong>A</strong>pplication <strong>P</strong>rogramming <strong>I</strong>nterfaces (APIs) are descriptions of the kind of requests that can be made of a certain piece of software, and descriptions of the kind of answers that are returned.</p>
<p>Many sources of data ‚Äì databases, websites, services ‚Äì have made all (or part) of their data available via APIs over the internet. Computer programs (‚Äúclients‚Äù) can make requests of the server, and the server will respond by sending data (or an error message). This client can be many kinds of other programs or websites, including R running from your laptop.</p>
</div>
<div id="install-and-play" class="section level2 hasAnchor" number="47.4">
<h2 class="hasAnchor"><span class="header-section-number">47.4</span> Install-and-play<a href="#install-and-play" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many common web services and APIs have been ‚Äúwrapped‚Äù, i.e.¬†R functions have been written around them which send your query to the server and format the response.</p>
<p>Why would we want this?</p>
<ul>
<li>Provenance</li>
<li>Reproducible</li>
<li>Updating</li>
<li>Ease</li>
<li>Scaling</li>
</ul>
<div id="load-the-tidyverse-1" class="section level3 hasAnchor" number="47.4.1">
<h3 class="hasAnchor"><span class="header-section-number">47.4.1</span> Load the tidyverse<a href="#load-the-tidyverse-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="sightings-of-birds-rebird" class="section level3 hasAnchor" number="47.4.2">
<h3 class="hasAnchor"><span class="header-section-number">47.4.2</span> Sightings of birds: rebird<a href="#sightings-of-birds-rebird" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://github.com/ropensci/rebird">rebird</a> is an R interface for the <a href="http://ebird.org/content/ebird/">eBird</a> database. eBird lets birders upload sightings of birds, and allows everyone access to those data. rebird is on CRAN.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;rebird&quot;)</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rebird)</span></code></pre></div>
<div id="search-birds-by-geography" class="section level4 hasAnchor" number="47.4.2.1">
<h4 class="hasAnchor"><span class="header-section-number">47.4.2.1</span> Search birds by geography<a href="#search-birds-by-geography" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The eBird website categorizes some popular locations as ‚ÄúHotspots‚Äù. These are areas where there are both lots of birds and lots of birders. One such location is at Iona Island, near Vancouver. You can see data for this Hotspot at <a href="http://ebird.org/ebird/hotspot/L261851">http://ebird.org/ebird/hotspot/L261851</a>.</p>
<p>At that link, you will see a page like this:</p>
<div class="figure">
<img src="img/Iona_island.png" alt="Iona Island" width="80%" />
<p class="caption">
(#fig:ebird-iona-island)Iona Island
</p>
</div>
<p>The data already looks to be organized in a data frame! rebird allows us to read these data directly into R (the ID code for Iona Island is <strong>‚ÄúL261851‚Äù</strong>).</p>
<!--TODO: The following chunks are broken; ebird now requires an API key.-->
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ebirdhotspot</span>(<span class="at">locID =</span> <span class="st">&quot;L261851&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<p>We can use the function <code>ebirdgeo()</code> to get a list for an area (note that South and West are negative):</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>vanbirds <span class="ot">&lt;-</span> <span class="fu">ebirdgeo</span>(<span class="at">lat =</span> <span class="fl">49.2500</span>, <span class="at">lng =</span> <span class="sc">-</span><span class="fl">123.1000</span>)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>vanbirds <span class="sc">%&gt;%</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<p><strong>Note</strong>: Check the defaults on this function (e.g.¬†radius of circle, time of year).</p>
<p>We can also search by ‚Äúregion‚Äù, which refers to short codes which serve as common shorthands for different political units. For example, France is represented by the letters <strong>FR</strong>.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>frenchbirds <span class="ot">&lt;-</span> <span class="fu">ebirdregion</span>(<span class="st">&quot;FR&quot;</span>)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>frenchbirds <span class="sc">%&gt;%</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<p>Find out <em>when</em> a bird has been seen in a certain place! Choosing a name from <code>vanbirds</code> above (the Bald Eagle):</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>eagle <span class="ot">&lt;-</span> <span class="fu">ebirdgeo</span>(<span class="at">species =</span> <span class="st">&#39;Haliaeetus leucocephalus&#39;</span>, <span class="at">lat =</span> <span class="dv">42</span>, <span class="at">lng =</span> <span class="sc">-</span><span class="dv">76</span>)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>eagle <span class="sc">%&gt;%</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<p>rebird <strong>knows where you are</strong>:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ebirdgeo</span>(<span class="at">species =</span> <span class="st">&#39;Buteo lagopus&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="geonames" class="section level3 hasAnchor" number="47.4.3">
<h3 class="hasAnchor"><span class="header-section-number">47.4.3</span> Searching geographic info: geonames<a href="#geonames" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://ropensci.org">rOpenSci</a> has a package called <a href="https://docs.ropensci.org/geonames/">geonames</a> for accessing the <a href="https://www.geonames.org">GeoNames API</a>. First, install the geonames package from CRAN and load it.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;geonames&quot;)</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geonames)</span></code></pre></div>
<p>The <a href="https://docs.ropensci.org/geonames/">geonames package website</a> tells us that there are a few things we need to do before we can use geonames to access the GeoNames API:</p>
<ol style="list-style-type: decimal">
<li>Go to <a href="https://www.geonames.org/login">the GeoNames site</a> and create a new user account.</li>
<li>Check your email and follow the instructions to activate your account.</li>
<li>Click [here] to enable the free web services for your account (Note! You must be logged into your GeoNames account already for the link to work).</li>
<li>Tell R your GeoNames username.</li>
</ol>
<p>To do the last step, we could run this line in R‚Ä¶</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">geonamesUsername=</span><span class="st">&quot;my_user_name&quot;</span>)</span></code></pre></div>
<p>‚Ä¶but this is insecure. We don‚Äôt want to risk committing this line and pushing it to our public GitHub page!</p>
<p>Instead, we can add this line to our <code>.Rprofile</code> so it will be hidden. One way to edit your <code>.Rprofile</code> is with the helper function <code>edit_r_profile()</code> from the <a href="https://usethis.r-lib.org">usethis</a> package. Install/load the usethis package and run <code>edit_r_profile()</code> in the R Console:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;usethis&quot;)</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">edit_r_profile</span>()</span></code></pre></div>
<p>This will open up your <code>.Rprofile</code> file. Add <code>options(geonamesUsername="my_user_name")</code> on a new line (replace ‚Äúmy_user_name‚Äù with your GeoNames username).</p>
<p><strong>Important</strong>: Make sure your <code>.Rprofile</code> ends with a blank line!</p>
<p>Save the file, close it, and restart R. Now we‚Äôre ready to start using geonames to search the GeoNames API.</p>
<p>(Also see the <a href="https://happygitwithr.com/credential-caching.html">Cache credentials for HTTPS</a> chapter of <a href="https://happygitwithr.com">Happy Git and GitHub for the useR</a>.)</p>
<div id="using-geonames" class="section level4 hasAnchor" number="47.4.3.1">
<h4 class="hasAnchor"><span class="header-section-number">47.4.3.1</span> Using GeoNames<a href="#using-geonames" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What can we do? We can get access to lots of geographical information via the various <a href="http://www.geonames.org/export/ws-overview.html">GeoNames WebServices</a>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>countryInfo <span class="ot">&lt;-</span> <span class="fu">GNcountryInfo</span>()</span></code></pre></div>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(countryInfo)</span></code></pre></div>
<p>This <code>countryInfo</code> dataset is very helpful for accessing the rest of the data because it gives us the standardized codes for country and language.</p>
</div>
<div id="remixing-geonames-and-rebird" class="section level4 hasAnchor" number="47.4.3.2">
<h4 class="hasAnchor"><span class="header-section-number">47.4.3.2</span> Remixing geonames and rebird:<a href="#remixing-geonames-and-rebird" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What are the cities of France?</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>francedata <span class="ot">&lt;-</span> countryInfo <span class="sc">%&gt;%</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(countryName <span class="sc">==</span> <span class="st">&quot;France&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>frenchcities <span class="ot">&lt;-</span> <span class="fu">with</span>(francedata, <span class="fu">GNcities</span>(<span class="at">north =</span> north, <span class="at">east =</span> east,</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">south =</span> south, <span class="at">west =</span> west,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">maxRows =</span> <span class="dv">500</span>))</span></code></pre></div>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(frenchcities)</span></code></pre></div>
</div>
</div>
<div id="wikipedia-searching" class="section level3 hasAnchor" number="47.4.4">
<h3 class="hasAnchor"><span class="header-section-number">47.4.4</span> Wikipedia searching<a href="#wikipedia-searching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use geonames to search for georeferenced Wikipedia articles. Here are those within 20 km of Rio de Janerio, comparing results for English-language Wikipedia (<code>lang = "en"</code>) and Portuguese-language Wikipedia (<code>lang = "pt"</code>):</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>rio_english <span class="ot">&lt;-</span> <span class="fu">GNfindNearbyWikipedia</span>(<span class="at">lat =</span> <span class="sc">-</span><span class="fl">22.9083</span>, <span class="at">lng =</span> <span class="sc">-</span><span class="fl">43.1964</span>,</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">radius =</span> <span class="dv">20</span>, <span class="at">lang =</span> <span class="st">&quot;en&quot;</span>, <span class="at">maxRows =</span> <span class="dv">500</span>)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>rio_portuguese <span class="ot">&lt;-</span> <span class="fu">GNfindNearbyWikipedia</span>(<span class="at">lat =</span> <span class="sc">-</span><span class="fl">22.9083</span>, <span class="at">lng =</span> <span class="sc">-</span><span class="fl">43.1964</span>,</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">radius =</span> <span class="dv">20</span>, <span class="at">lang =</span> <span class="st">&quot;pt&quot;</span>, <span class="at">maxRows =</span> <span class="dv">500</span>)</span></code></pre></div>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(rio_english)</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(rio_portuguese)</span></code></pre></div>
</div>
<div id="plos-one" class="section level3 hasAnchor" number="47.4.5">
<h3 class="hasAnchor"><span class="header-section-number">47.4.5</span> Searching the Public Library of Science: rplos<a href="#plos-one" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://journals.plos.org/plosone/">PLOS ONE</a> is an open-access journal. They allow access to an impressive range of search tools, and allow you to obtain the full text of their articles. rOpenSci has a package called rplos that we can use to interact with the <a href="http://api.plos.org">PLOS API</a>. They have a nice tutorial on the rOpenSci website that you can see <a href="https://ropensci.org/tutorials/rplos_tutorial.html">here</a>. First, install/load the rplos package from CRAN.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;rplos&quot;)</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rplos)</span></code></pre></div>
<div id="searching-plos-one" class="section level4 hasAnchor" number="47.4.5.1">
<h4 class="hasAnchor"><span class="header-section-number">47.4.5.1</span> Searching PLOS ONE<a href="#searching-plos-one" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let‚Äôs follow along with the <a href="https://ropensci.org/tutorials/rplos_tutorial.html"><code>rOpenSci</code> tutorial</a> and do some searches:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">searchplos</span>(<span class="at">q=</span> <span class="st">&quot;Helianthus&quot;</span>, <span class="at">fl=</span> <span class="st">&quot;id&quot;</span>, <span class="at">limit =</span> <span class="dv">5</span>)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $meta</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 2</span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   numFound start</span></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      730     0</span></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $data</span></span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 1</span></span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   id                          </span></span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                       </span></span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 10.1371/journal.pone.0198869</span></span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 10.1371/journal.pone.0213065</span></span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 10.1371/journal.pone.0148280</span></span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 10.1371/journal.pone.0267383</span></span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 10.1371/journal.pone.0111982</span></span></code></pre></div>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">searchplos</span>(<span class="st">&quot;materials_and_methods:France&quot;</span>, <span class="at">fl =</span> <span class="st">&quot;title, materials_and_methods&quot;</span>)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $meta</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 2</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   numFound start</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    17436     0</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $data</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 √ó 2</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    title                                                                 mater‚Ä¶¬π</span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                                                                 &lt;chr&gt;  </span></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Borna Disease Virus Phosphoprotein Impairs the Developmental Program‚Ä¶ &quot;\nEth‚Ä¶</span></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Population Structure in Naegleria fowleri as Revealed by Microsatell‚Ä¶ &quot;\nSam‚Ä¶</span></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Genetic identification of bat species for pathogen surveillance acro‚Ä¶ &quot;\nBat‚Ä¶</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Prevalent hepatitis B surface antigen among first-time blood donors ‚Ä¶ &quot;\nStu‚Ä¶</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 The Plasminogen Activation System Modulates Differently Adipogenesis‚Ä¶ &quot;\n   ‚Ä¶</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Human Neural Cells Transiently Express Reelin during Olfactory Placo‚Ä¶ &quot;\nBio‚Ä¶</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Immunity Traits in Pigs: Substantial Genetic Variation and Limited C‚Ä¶ &quot;\n   ‚Ä¶</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Different Oxidative Stress Response in Keratinocytes and Fibroblasts‚Ä¶ &quot;\n   ‚Ä¶</span></span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Immunomodulation Stimulates the Innervation of Engineered Tooth Organ &quot;\nAni‚Ä¶</span></span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Genetics of wild and mass-reared populations of a generalist aphid p‚Ä¶ &quot;\nBio‚Ä¶</span></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with abbreviated variable name ¬π‚Äãmaterials_and_methods</span></span></code></pre></div>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">searchplos</span>(<span class="st">&quot;materials_and_methods:study site&quot;</span>, <span class="at">fl =</span> <span class="st">&quot;title, materials_and_methods&quot;</span>)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $meta</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 2</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   numFound start</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   125588     0</span></span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $data</span></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 √ó 2</span></span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    title                                                                 mater‚Ä¶¬π</span></span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                                                                 &lt;chr&gt;  </span></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Whi5 Regulation by Site Specific CDK-Phosphorylation in Saccharomyce‚Ä¶ &quot;\nYea‚Ä¶</span></span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Remote Source Document Verification in Two National Clinical Trials ‚Ä¶ &quot;Two N‚Ä¶</span></span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Variance Component Analysis of a Multi-Site Study for the Reproducib‚Ä¶ &quot;\n1) ‚Ä¶</span></span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Obtaining Valid Laboratory Data in Clinical Trials Conducted in Reso‚Ä¶ &quot;The s‚Ä¶</span></span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Transposable Prophage Mu Is Organized as a Stable Chromosomal Domain‚Ä¶ &quot;\nStr‚Ä¶</span></span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Effects of land-use change and related pressures on alien and native‚Ä¶ &quot;\nBio‚Ä¶</span></span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Structural and functional dissection reveals distinct roles of Ca2+-‚Ä¶ &quot;\nBac‚Ä¶</span></span>
<span id="cb261-19"><a href="#cb261-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Retention in Care and Outpatient Costs for Children Receiving Antire‚Ä¶ &quot;\nEth‚Ä¶</span></span>
<span id="cb261-20"><a href="#cb261-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Risk of Injection-Site Abscess among Infants Receiving a Preservativ‚Ä¶ &quot;\nStu‚Ä¶</span></span>
<span id="cb261-21"><a href="#cb261-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Global migration of clinical research during the era of trial regist‚Ä¶ &quot;\nPri‚Ä¶</span></span>
<span id="cb261-22"><a href="#cb261-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with abbreviated variable name ¬π‚Äãmaterials_and_methods</span></span></code></pre></div>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">searchplos</span>(<span class="st">&quot;*:*&quot;</span>, <span class="at">fl =</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $meta</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 2</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   numFound start</span></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2825218     0</span></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $data</span></span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 √ó 1</span></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    id                                                 </span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                                              </span></span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 10.1371/journal.pmed.0030495/title                 </span></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 10.1371/journal.pmed.0030495/abstract              </span></span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 10.1371/journal.pmed.0030495/references            </span></span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 10.1371/journal.pmed.0030495/body                  </span></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 10.1371/journal.pmed.0030495/introduction          </span></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 10.1371/journal.pmed.0030495/results_and_discussion</span></span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 10.1371/journal.pmed.0030495/materials_and_methods </span></span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 10.1371/journal.pmed.0030495/supporting_information</span></span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 10.1371/journal.pmed.0030496                       </span></span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 10.1371/journal.pmed.0030496/title</span></span></code></pre></div>
<p>Here is a list of <a href="http://api.plos.org/solr/search-fields/">options for the search</a> or you can run <code>data(plosfields)</code> followed by <code>plosfields</code> in the R Console.</p>
</div>
<div id="take-a-highbrow-look" class="section level4 hasAnchor" number="47.4.5.2">
<h4 class="hasAnchor"><span class="header-section-number">47.4.5.2</span> Take a highbrow look!<a href="#take-a-highbrow-look" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>highplos()</code> function does ‚Äúhighlighted searches on PLOS Journals full-text content‚Äù.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>highlighted <span class="ot">&lt;-</span> <span class="fu">highplos</span>(<span class="at">q=</span><span class="st">&#39;alcohol&#39;</span>, <span class="at">hl.fl =</span> <span class="st">&#39;abstract&#39;</span>, <span class="at">rows=</span><span class="dv">10</span>)</span></code></pre></div>
<p>We can then pass this output to <code>highbrow()</code>, which will open up our default browser where we can browse the highlighted fragments. When we run <code>highbrow(highlighted)</code> in our R Console this is what we see in our browser:</p>
<div class="figure">
<img src="img/rplos-highbrow.png" alt="Example rplos highlights" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-25)Example rplos highlights
</p>
</div>
</div>
<div id="plots-over-time" class="section level4 hasAnchor" number="47.4.5.3">
<h4 class="hasAnchor"><span class="header-section-number">47.4.5.3</span> Plots over time<a href="#plots-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can use the <code>plot_throughtime()</code> function to visualize the results of a search over time.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_throughtime</span>(<span class="at">terms =</span> <span class="st">&quot;phylogeny&quot;</span>, <span class="at">limit =</span> <span class="dv">200</span>)</span></code></pre></div>
<p><img src="0703_apiwrappers_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
</div>
<div id="is-it-a-boy-or-a-girl-gender-associated-names-throughout-us-history" class="section level3 hasAnchor" number="47.4.6">
<h3 class="hasAnchor"><span class="header-section-number">47.4.6</span> Is it a boy or a girl? gender-associated names throughout US history<a href="#is-it-a-boy-or-a-girl-gender-associated-names-throughout-us-history" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The gender package allows you access to data on the gender of names in the US. Because names change gender over the years, the probability of a name belonging to a man or a woman also depends on the <em>year</em>.</p>
<p>First, install/load the gender package from CRAN. You may be prompted to also install the companion package, genderdata. Go ahead and say yes. If you don‚Äôt see this message no need to worry, it is a one-time install.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;gender&quot;)</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gender)</span></code></pre></div>
<p>Let‚Äôs do some searches for the name Kelsey.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gender</span>(<span class="st">&quot;Kelsey&quot;</span>)</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The genderdata package needs to be installed.</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in install_genderdata_package(): Failed to install the genderdata package.</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Please try installing the package for yourself using the following command: </span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      remotes::install_github(&quot;lmullen/genderdata&quot;)</span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gender</span>(<span class="st">&quot;Kelsey&quot;</span>, <span class="at">years =</span> <span class="dv">1940</span>)</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The genderdata package needs to be installed.</span></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in install_genderdata_package(): Failed to install the genderdata package.</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Please try installing the package for yourself using the following command: </span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      remotes::install_github(&quot;lmullen/genderdata&quot;)</span></span></code></pre></div>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--HappyGitWithR Links-->
<!--Package Links-->
<!--Shiny links-->
<!--Publications-->
<!--R Documentation-->
<!--Wikipedia Links-->
<!--Misc. Links-->
<!--chapter:end:0703_apiwrappers.Rmd-->
</div>
</div>
</div>
<div id="diy-web-data" class="section level1 hasAnchor" number="48">
<h1 class="hasAnchor"><span class="header-section-number">48</span> DIY web data<a href="#diy-web-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These notes are adapted from Jenny Bryan‚Äôs stat545 and were originally written by Andrew MacDonald.</p>
<pre><code>No OMDb key available. Code chunks will not be evaluated.</code></pre>
<!--Original content: https://stat545.com/webdata03_activity.html-->
<!--Original author: Andrew MacDonald-->
<div id="interacting-with-an-api" class="section level2 hasAnchor" number="48.1">
<h2 class="hasAnchor"><span class="header-section-number">48.1</span> Interacting with an API<a href="#interacting-with-an-api" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter @ref(api-wrappers) we experimented with several packages that ‚Äúwrapped‚Äù APIs. That is, they handled the creation of the request and the formatting of the output. In this chapter we‚Äôre going to look at (part of) what these functions were doing.</p>
<div id="load-the-tidyverse-2" class="section level3 hasAnchor" number="48.1.1">
<h3 class="hasAnchor"><span class="header-section-number">48.1.1</span> Load the tidyverse<a href="#load-the-tidyverse-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will be using the functions from the <a href="https://www.tidyverse.org">tidyverse</a> throughout this chapter, so go ahead and load tidyverse package now.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="examine-the-structure-of-api-requests-using-the-open-movie-database" class="section level3 hasAnchor" number="48.1.2">
<h3 class="hasAnchor"><span class="header-section-number">48.1.2</span> Examine the structure of API requests using the Open Movie Database<a href="#examine-the-structure-of-api-requests-using-the-open-movie-database" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First we‚Äôre going to examine the structure of API requests via the <a href="http://www.omdbapi.com/">Open Movie Database</a> (OMDb). OMDb is very similar to IMDb, except it has a nice, simple API. We can go to the website, input some search parameters, and obtain both the XML query and the response from it.</p>
<!--TODO: Will frequently get an "Error: Daily request limit reached" message when using the demo. Seems to be an issue on their end: https://github.com/omdbapi/OMDb-API/issues/124 Maybe remove this exercise from the chapter to avoid problems?-->
<p><strong>Exercise:</strong> determine the shape of an API request. Scroll down to the <a href="http://www.omdbapi.com/#examples">‚ÄúExamples‚Äù section</a> on the OMDb site and play around with the parameters. Take a look at the resulting API call and the query you get back.</p>
<p>If we enter the following parameters:</p>
<ul>
<li><code>title = Interstellar</code>,</li>
<li><code>year = 2014</code>,</li>
<li><code>plot = full</code>,</li>
<li><code>response = JSON</code></li>
</ul>
<p>Here is what we see:</p>
<p>The request URL is:</p>
<pre class="http"><code>http://www.omdbapi.com/?t=Interstellar&amp;y=2014&amp;plot=full</code></pre>
<p>Notice the pattern in the request. Let‚Äôs try changing the response field from JSON to XML.</p>
<p>Now the request URL is:</p>
<pre class="http"><code>http://www.omdbapi.com/?t=Interstellar&amp;y=2014&amp;plot=full&amp;r=xml</code></pre>
<p>Try pasting these URLs into your browser. You should see this if you tried the first URL:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;Response&quot;</span><span class="fu">:</span><span class="st">&quot;False&quot;</span><span class="fu">,</span><span class="dt">&quot;Error&quot;</span><span class="fu">:</span><span class="st">&quot;No API key provided.&quot;</span><span class="fu">}</span></span></code></pre></div>
<p>‚Ä¶and this if you tried the second URL (where <code>r=xml</code>):</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">root</span><span class="ot"> response=</span><span class="st">&quot;False&quot;</span>&gt;</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">error</span>&gt;No API key provided.&lt;/<span class="kw">error</span>&gt;</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">root</span>&gt;</span></code></pre></div>
</div>
<div id="create-an-omdb-api-key" class="section level3 hasAnchor" number="48.1.3">
<h3 class="hasAnchor"><span class="header-section-number">48.1.3</span> Create an OMDb API Key<a href="#create-an-omdb-api-key" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This response tells us that we need an API key to access the OMDb API. We will store our key for the OMDb API in our <code>.Renviron</code> file using the helper function <code>edit_r_environ()</code> from the <a href="https://usethis.r-lib.org">usethis</a> package. Follow these steps:</p>
<ol style="list-style-type: decimal">
<li>Visit this URL and request your free API key: <a href="https://www.omdbapi.com/apikey.aspx" class="uri">https://www.omdbapi.com/apikey.aspx</a></li>
<li>Check your email and follow the instructions to activate your key.</li>
<li>Install/load the usethis package and run <code>edit_r_environ()</code> in the R Console:</li>
</ol>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># install.packages(&quot;usethis&quot;)</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(usethis)</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">edit_r_environ</span>()</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Add <code>OMDB_API_KEY=&lt;your-secret-key&gt;</code> on a new line, press enter to add a blank line at the end (important!), save the file, and close it.</p>
<ul>
<li>Note that we use <code>&lt;your-secret-key&gt;</code> as a placeholder here and throughout these instructions. Your actual API key will look something like: <code>p319s0aa</code> (no quotes or other characters like <code>&lt;</code> or <code>&gt;</code> should go on the right of the <code>=</code> sign).</li>
</ul></li>
<li><p>Restart R.</p></li>
<li><p>You can now access your OMDb API key from the R console and save it as an object:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;OMDB_API_KEY&quot;</span>)</span></code></pre></div></li>
<li><p>We can use this to easily add our API key to the request URL. Let‚Äôs make this API key an object we can refer to as <code>movie_key</code>:</p></li>
</ol>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># save it as an object</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>    movie_key <span class="ot">&lt;-</span> <span class="fu">Sys.getenv</span>(<span class="st">&quot;OMDB_API_KEY&quot;</span>)</span></code></pre></div>
<div id="alternative-strategy-for-keeping-keys-.rprofile" class="section level4 hasAnchor" number="48.1.3.1">
<h4 class="hasAnchor"><span class="header-section-number">48.1.3.1</span> Alternative strategy for keeping keys: <code>.Rprofile</code><a href="#alternative-strategy-for-keeping-keys-.rprofile" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Remember to protect your key! It is important for your privacy. You know, like a key.</strong></p>
<p>Now we follow the rOpenSci <a href="https://github.com/ropensci/rOpenSci/wiki/Installation-and-use-of-API-keys">tutorial on API keys</a>:</p>
<ul>
<li><strong><em>Add <code>.Rprofile</code> to your <code>.gitignore</code> !!</em></strong></li>
<li>Make a <code>.Rprofile</code> file (<a href="http://cran.r-project.org/bin/windows/rw-FAQ.html#What-are-HOME-and-working-directories_003f">windows tips</a>; <a href="http://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html#The-R-Console">mac tips</a>).</li>
<li>Write the following in it:</li>
</ul>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">OMBD_API_KEY =</span> <span class="st">&quot;YOUR_KEY&quot;</span>)</span></code></pre></div>
<ul>
<li>Restart R (i.e.¬†reopen your RStudio project).</li>
</ul>
<p>This code adds another element to the list of options, which you can see by calling <code>options()</code>. Part of the work done by <code>rplos::searchplos()</code> and friends is to go and obtain the value of this option with the function <code>getOption("OMBD_API_KEY")</code>. This indicates two things:</p>
<ol style="list-style-type: decimal">
<li>Spelling is important when you set the option in your <code>.Rprofile</code></li>
<li>You can do a similar process for an arbitrary package or key. For example:</li>
</ol>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="do">## in .Rprofile</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;this_is_my_key&quot;</span> <span class="ot">=</span> XXXX)</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="do">## later, in the R script:</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>key <span class="ot">&lt;-</span> <span class="fu">getOption</span>(<span class="st">&quot;this_is_my_key&quot;</span>)</span></code></pre></div>
<p>This is a simple means to keep your keys private, especially if you are sharing the same authentication across several projects.</p>
</div>
<div id="a-few-timely-reminders-about-your-.rprofile" class="section level4 hasAnchor" number="48.1.3.2">
<h4 class="hasAnchor"><span class="header-section-number">48.1.3.2</span> A few timely reminders about your <code>.Rprofile</code><a href="#a-few-timely-reminders-about-your-.rprofile" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;This is Andrew&#39;s Rprofile and you can&#39;t have it!&quot;</span>)</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">OMBD_API_KEY =</span> <span class="st">&quot;XXXXXXXXX&quot;</span>)</span></code></pre></div>
<ul>
<li>It must end with a blank line!</li>
<li>It lives in the project‚Äôs working directory, i.e.¬†the location of your <code>.Rproj</code>.</li>
<li>It must be gitignored.</li>
</ul>
<p>Remember that using <code>.Rprofile</code> makes your code un-reproducible. In this case, that is exactly what we want!</p>
</div>
</div>
<div id="recreate-the-request-url-in-r" class="section level3 hasAnchor" number="48.1.4">
<h3 class="hasAnchor"><span class="header-section-number">48.1.4</span> Recreate the request URL in R<a href="#recreate-the-request-url-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How can we recreate the same request URLs in R? We could use the <a href="https://glue.tidyverse.org/"><code>glue</code> package</a> to paste together the base URL, parameter labels, and parameter values:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>request <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;http://www.omdbapi.com/?t=Interstellar&amp;y=2014&amp;plot=short&amp;r=xml&amp;apikey={movie_key}&quot;</span>)</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>request</span></code></pre></div>
<p>This works, but it only works for movie titled <code>Interstellar</code> from 2014 where we want the short plot and the XML format. Let‚Äôs try to pull out more variables and paste them in with <code>glue</code>:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;http://www.omdbapi.com/?t={title}&amp;y={year}&amp;plot={plot}&amp;r={format}&amp;apikey={api_key}&quot;</span>,</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">&quot;Interstellar&quot;</span>,</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">year =</span> <span class="st">&quot;2014&quot;</span>,</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">plot =</span> <span class="st">&quot;short&quot;</span>,</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">format =</span> <span class="st">&quot;xml&quot;</span>,</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">api_key =</span> movie_key)</span></code></pre></div>
<p>We could go even further and make this into a function called <code>omdb()</code> that we can reuse more easily.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>omdb <span class="ot">&lt;-</span> <span class="cf">function</span>(title, year, plot, format, api_key) {</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>  glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;http://www.omdbapi.com/?t={title}&amp;y={year}&amp;plot={plot}&amp;r={format}&amp;apikey={api_key}&quot;</span>)</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="get-data-using-the-curl-package" class="section level3 hasAnchor" number="48.1.5">
<h3 class="hasAnchor"><span class="header-section-number">48.1.5</span> Get data using the curl package<a href="#get-data-using-the-curl-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we have a handy function that returns the API query. We can paste in the link, but we can also obtain data from within R using the <a href="https://CRAN.R-project.org/package=curl">curl</a> package. Install/load the curl package first.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;curl&quot;)</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(curl)</span></code></pre></div>
<p>Using curl to get the data in XML format:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>request_xml <span class="ot">&lt;-</span> <span class="fu">omdb</span>(<span class="at">title =</span> <span class="st">&quot;Interstellar&quot;</span>, <span class="at">year =</span> <span class="st">&quot;2014&quot;</span>, <span class="at">plot =</span> <span class="st">&quot;short&quot;</span>, </span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">format =</span> <span class="st">&quot;xml&quot;</span>, <span class="at">api_key =</span> movie_key)</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span>  <span class="fu">curl</span>(request_xml)</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>answer_xml <span class="ot">&lt;-</span> <span class="fu">readLines</span>(con, <span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(con)</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>answer_xml</span></code></pre></div>
<p>Using curl to get the data in JSON format:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>request_json <span class="ot">&lt;-</span> <span class="fu">omdb</span>(<span class="at">title =</span> <span class="st">&quot;Interstellar&quot;</span>, <span class="at">year =</span> <span class="st">&quot;2014&quot;</span>, <span class="at">plot =</span> <span class="st">&quot;short&quot;</span>, </span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">format =</span> <span class="st">&quot;json&quot;</span>, <span class="at">api_key =</span> movie_key)</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">curl</span>(request_json)</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>answer_json <span class="ot">&lt;-</span> <span class="fu">readLines</span>(con, <span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(con)</span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>answer_json  </span></code></pre></div>
<p>We have two forms of data that are obviously structured. What are they?</p>
</div>
</div>
<div id="intro-to-json-and-xml" class="section level2 hasAnchor" number="48.2">
<h2 class="hasAnchor"><span class="header-section-number">48.2</span> Intro to JSON and XML<a href="#intro-to-json-and-xml" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--TODO: Add more to this section?-->
<p>There are two common languages of web services:</p>
<ol style="list-style-type: decimal">
<li><strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otation (JSON)</li>
<li>e<strong>X</strong>tensible <strong>M</strong>arkup <strong>L</strong>anguage (XML)</li>
</ol>
<p>Here‚Äôs an example of JSON (from <a href="https://zapier.com/learn/apis/chapter-3-data-formats/">this wonderful site</a>):</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;crust&quot;</span><span class="op">:</span> <span class="st">&quot;original&quot;</span><span class="op">,</span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;toppings&quot;</span><span class="op">:</span> [<span class="st">&quot;cheese&quot;</span><span class="op">,</span> <span class="st">&quot;pepperoni&quot;</span><span class="op">,</span> <span class="st">&quot;garlic&quot;</span>]<span class="op">,</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;status&quot;</span><span class="op">:</span> <span class="st">&quot;cooking&quot;</span><span class="op">,</span></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;customer&quot;</span><span class="op">:</span> {</span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Brian&quot;</span><span class="op">,</span></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;phone&quot;</span><span class="op">:</span> <span class="st">&quot;573-111-1111&quot;</span></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is XML (also from <a href="https://zapier.com/learn/apis/chapter-3-data-formats/">this site</a>):</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">order</span>&gt;</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">crust</span>&gt;original&lt;/<span class="kw">crust</span>&gt;</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">toppings</span>&gt;</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">topping</span>&gt;cheese&lt;/<span class="kw">topping</span>&gt;</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">topping</span>&gt;pepperoni&lt;/<span class="kw">topping</span>&gt;</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">topping</span>&gt;garlic&lt;/<span class="kw">topping</span>&gt;</span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">toppings</span>&gt;</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">status</span>&gt;cooking&lt;/<span class="kw">status</span>&gt;</span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">order</span>&gt;</span></code></pre></div>
<p>You can see that both of these data structures are quite easy to read. They are ‚Äúself-describing‚Äù. In other words, they tell you how they are meant to be read. There are easy means of taking these data types and creating R objects.</p>
<div id="parsing-the-json-response-with-jsonlite" class="section level3 hasAnchor" number="48.2.1">
<h3 class="hasAnchor"><span class="header-section-number">48.2.1</span> Parsing the JSON response with jsonlite<a href="#parsing-the-json-response-with-jsonlite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our JSON response above can be parsed using <code>jsonlite::fromJSON()</code>. First install/load the jsonlite package.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;jsonlite&quot;)</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<p>Parsing our JSON response with <code>fromJSON()</code>:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>answer_json <span class="sc">%&gt;%</span> </span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fromJSON</span>()</span></code></pre></div>
<p>The output is a named list. A familiar and friendly R structure. Because data frames are lists and because this list has no nested lists-within-lists, we can coerce it very simply:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>answer_json <span class="sc">%&gt;%</span> </span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fromJSON</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
</div>
<div id="parsing-the-xml-response-using-xml2" class="section level3 hasAnchor" number="48.2.2">
<h3 class="hasAnchor"><span class="header-section-number">48.2.2</span> Parsing the XML response using xml2<a href="#parsing-the-xml-response-using-xml2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use the <a href="https://xml2.r-lib.org">xml2</a> package to wrangle our XML response.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;xml2&quot;)</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)</span></code></pre></div>
<p>Parsing our XML response with <code>read_xml()</code>:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>(xml_parsed <span class="ot">&lt;-</span> <span class="fu">read_xml</span>(answer_xml))</span></code></pre></div>
<p>Not exactly the result we were hoping for! However, this does tell us about the XML document‚Äôs structure:</p>
<ul>
<li>It has a <code>&lt;root&gt;</code> node, which has a single child node, <code>&lt;movie&gt;</code>.</li>
<li>The information we want is all stored as attributes (e.g.¬†title, year, etc.).</li>
</ul>
<p>The xml2 package has various functions to assist in navigating through XML. We can use the <code>xml_children()</code> function to extract all of the children nodes (i.e.¬†the single child, <code>&lt;movie&gt;</code>):</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>(contents <span class="ot">&lt;-</span> <span class="fu">xml_contents</span>(xml_parsed))</span></code></pre></div>
<p>The <code>xml_attrs()</code> function ‚Äúretrieves all attribute values as a named character vector‚Äù. Let‚Äôs use this to extract the information that we want from the <code>&lt;movie&gt;</code> node:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>(attrs <span class="ot">&lt;-</span> <span class="fu">xml_attrs</span>(contents)[[<span class="dv">1</span>]])</span></code></pre></div>
<p>We can transform this named character vector into a data frame with the help of <code>dplyr::bind_rows()</code>:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>attrs <span class="sc">%&gt;%</span> </span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
</div>
</div>
<div id="introducing-the-easy-way-httr" class="section level2 hasAnchor" number="48.3">
<h2 class="hasAnchor"><span class="header-section-number">48.3</span> Introducing the easy way: httr<a href="#introducing-the-easy-way-httr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://httr.r-lib.org">httr</a> is yet another star in the <a href="https://www.tidyverse.org">tidyverse</a>. It is a package designed to facilitate all things HTTP from within R. This includes the major HTTP verbs, which are:</p>
<!--TODO: Find source for these definitions-->
<ul>
<li><strong><code>GET()</code></strong> - Fetch an existing resource. The URL contains all the necessary information the server needs to locate and return the resource.</li>
<li><strong><code>POST()</code></strong> - Create a new resource. POST requests usually carry a payload that specifies the data for the new resource.</li>
<li><strong><code>PUT()</code></strong> - Update an existing resource. The payload may contain the updated data for the resource.</li>
<li><strong><code>DELETE()</code></strong> - Delete an existing resource.</li>
</ul>
<!--TODO: It's not clear in the original stat545 lesson what this is referring to. I checked the paragraphs above and below and wasn't able to find them at this site. Keeping the link here to revisit later.

(from [HTTP made really easy](http://www.jmarshall.com/easy/http/))
-->
<p>HTTP is the foundation for APIs; understanding how it works is the key to interacting with all the diverse APIs out there. An excellent beginning resource for APIs (including HTTP basics) is <a href="https://zapier.com/learn/apis/">An Introduction to APIs</a> by Brian Cooksey.</p>
<p>httr also facilitates a variety of <strong><em>authentication</em></strong> protocols.</p>
<p>httr contains one function for every HTTP verb. The functions have the same names as the verbs (e.g.¬†<code>GET()</code>, <code>POST()</code>). They have more informative outputs than simply using curl and come with nice convenience functions for working with the output:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;httr&quot;)</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span></code></pre></div>
<p>Using httr to get the data in JSON format:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>request_json <span class="ot">&lt;-</span> <span class="fu">omdb</span>(<span class="at">title =</span> <span class="st">&quot;Interstellar&quot;</span>, <span class="at">year =</span> <span class="st">&quot;2014&quot;</span>, <span class="at">plot =</span> <span class="st">&quot;short&quot;</span>, </span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">format =</span> <span class="st">&quot;json&quot;</span>, <span class="at">api_key =</span> movie_key)</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>response_json <span class="ot">&lt;-</span> <span class="fu">GET</span>(request_json)</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="fu">content</span>(response_json, <span class="at">as =</span> <span class="st">&quot;parsed&quot;</span>, <span class="at">type =</span> <span class="st">&quot;application/json&quot;</span>)</span></code></pre></div>
<p>Using httr to get the data in XML format:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>request_xml <span class="ot">&lt;-</span> <span class="fu">omdb</span>(<span class="at">title =</span> <span class="st">&quot;Interstellar&quot;</span>, <span class="at">year =</span> <span class="st">&quot;2014&quot;</span>, <span class="at">plot =</span> <span class="st">&quot;short&quot;</span>, </span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">format =</span> <span class="st">&quot;xml&quot;</span>, <span class="at">api_key =</span> movie_key)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>response_xml <span class="ot">&lt;-</span> <span class="fu">GET</span>(request_xml)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">content</span>(response_xml, <span class="at">as =</span> <span class="st">&quot;parsed&quot;</span>)</span></code></pre></div>
<p>httr also gives us access to lots of useful information about the quality of our response. For example, the header:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">headers</span>(response_xml)</span></code></pre></div>
<p>And also a handy means to extract specifically the HTTP status code:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">status_code</span>(response_xml)</span></code></pre></div>
<p>In fact, we didn‚Äôt need to create <code>omdb()</code> at all. httr provides a straightforward means of making an HTTP request with the <code>query</code> argument:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>the_martian <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">&quot;http://www.omdbapi.com/?&quot;</span>, </span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">query =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="st">&quot;The Martian&quot;</span>, <span class="at">y =</span> <span class="dv">2015</span>, <span class="at">plot =</span> <span class="st">&quot;short&quot;</span>, </span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">r =</span> <span class="st">&quot;json&quot;</span>, <span class="at">apikey =</span> movie_key))</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="fu">content</span>(the_martian)</span></code></pre></div>
<p>With httr, we are able to pass in the named arguments to the API call as a named list. We are also able to use spaces in movie names; httr encodes these in the URL before making the GET request.</p>
<p>It is very good to <a href="https://www.flickr.com/photos/girliemac/sets/72157628409467125">learn your HTTP status codes</a>.</p>
<p>The documentation for httr includes a vignette of <a href="https://httr.r-lib.org/articles/api-packages.html">‚ÄúBest practices for writing an API package‚Äù</a>, which is useful for when you want to bring your favorite web resource into the world of R.</p>
</div>
<div id="scraping" class="section level2 hasAnchor" number="48.4">
<h2 class="hasAnchor"><span class="header-section-number">48.4</span> Scraping<a href="#scraping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What if data is present on a website, but isn‚Äôt provided in an API at all? It is possible to grab that information too. How easy that is to do depends a lot on the quality of the website that we are using.</p>
<p>HTML is a structured way of displaying information. It is very similar in structure to XML (in fact many modern html sites are actually XHTML5, <a href="http://www.w3.org/TR/html5/the-xhtml-syntax.html">which is also valid XML</a>).</p>
<p>Two pieces of equipment:</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://rvest.tidyverse.org">rvest</a> package (<a href="https://CRAN.R-project.org/package=rvest">cran</a>; <a href="https://github.com/tidyverse/rvest">GitHub</a>). Install via <code>install.packages("rvest)"</code>.</li>
<li>SelectorGadget: point and click CSS selectors. <a href="http://selectorgadget.com/">Install in your browser</a>.</li>
</ol>
<p>Before we go any further, <a href="http://flukeout.github.io">let‚Äôs play a game together</a>!</p>
<div id="obtain-a-table" class="section level3 hasAnchor" number="48.4.1">
<h3 class="hasAnchor"><span class="header-section-number">48.4.1</span> Obtain a table<a href="#obtain-a-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let‚Äôs make a simple HTML table and then parse it.</p>
<ol style="list-style-type: decimal">
<li>Make a new, empty project</li>
<li>Make a totally empty <code>.Rmd</code> file and save it as <code>"GapminderHead.Rmd"</code></li>
<li>Copy this into the body:</li>
</ol>
<div class="sourceCode" id="cb301"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> html_document</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, results=&#39;asis&#39;}</span></span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(gapminder)</span></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(head(gapminder))</span></span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>Knit the document and click ‚ÄúView in Browser‚Äù. It should look like this:</p>
<p>We have created a simple HTML table with the head of <code>gapminder</code> in it! We can get our data back by parsing this table into a data frame again. Extracting data from HTML is called ‚Äúscraping‚Äù, and we can do it in R with the rvest package:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;rvest&quot;)</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(<span class="st">&quot;GapminderHead.html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>()</span></code></pre></div>
</div>
</div>
<div id="scraping-via-css-selectors" class="section level2 hasAnchor" number="48.5">
<h2 class="hasAnchor"><span class="header-section-number">48.5</span> Scraping via CSS selectors<a href="#scraping-via-css-selectors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs practice scraping websites using our newfound abilities. Here is a table of research <a href="https://www.scimagojr.com/countryrank.php">publications by country</a>.</p>
<p>We can try to get this data directly into R using <code>read_html()</code> and <code>html_table()</code>:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>research <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://www.scimagojr.com/countryrank.php&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>If you look at the structure of <code>research</code> (i.e.¬†via <code>str(research)</code>) you‚Äôll see that we‚Äôve obtained a list of data.frames. The top of the page contains another table element. This was also scraped!</p>
<p>Can we be more specific about what we obtain from this page? We can, by highlighting that table with CSS selectors:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>research <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;http://www.scimagojr.com/countryrank.php&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">&quot;.tabla_datos&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_table</span>()</span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(research)</span></code></pre></div>
</div>
<div id="random-observations-on-scraping" class="section level2 hasAnchor" number="48.6">
<h2 class="hasAnchor"><span class="header-section-number">48.6</span> Random observations on scraping<a href="#random-observations-on-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Make sure you‚Äôve obtained ONLY what you want! Scroll over the whole page to ensure that SelectorGadget hasn‚Äôt found too many things.</li>
<li>If you are having trouble parsing, try selecting a smaller subset of the thing you are seeking (e.g.¬†being more precise).</li>
</ul>
<p><strong>MOST IMPORTANTLY</strong> confirm that there is NO <a href="https://ropensci.org/packages/">rOpenSci package</a> and NO API before you <a href="https://rpubs.com/aammd/kivascrape">spend hours scraping</a> (the <a href="http://build.kiva.org/">API was right here</a>).</p>
</div>
<div id="extras" class="section level2 hasAnchor" number="48.7">
<h2 class="hasAnchor"><span class="header-section-number">48.7</span> Extras<a href="#extras" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="airports" class="section level3 hasAnchor" number="48.7.1">
<h3 class="hasAnchor"><span class="header-section-number">48.7.1</span> Airports<a href="#airports" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, go to this website about <a href="https://www.developer.aero/Airport-API">Airports</a>. Follow the link to get your API key (you will need to click a confirmation email).</p>
<p>List of all the airports on the planet:</p>
<pre class="url"><code>https://airport.api.aero/airport/?user_key={yourkey}</code></pre>
<p>List of all the airports matching Toronto:</p>
<pre><code>https://airport.api.aero/airport/match/toronto?user_key={yourkey}</code></pre>
<p>The distance between YVR and LAX:</p>
<pre><code>https://airport.api.aero/airport/distance/YVR/LAX?user_key={yourkey}</code></pre>
<p>Do you need just the US airports? <a href="https://github.com/Federal-Aviation-Administration/ASWS">This API does that</a> (also see <a href="https://www.fly.faa.gov/flyfaa/usmap.jsp">this</a>) and is free.</p>
<!--chapter:end:0704_diywebdata.Rmd-->
</div>
</div>
</div>
<div id="lab07" class="section level1 hasAnchor" number="49">
<h1 class="hasAnchor"><span class="header-section-number">49</span> Lab: Better Viz<a href="#lab07" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="conveying-the-right-message-through-visualization" class="section level2 hasAnchor" number="49.1">
<h2 class="hasAnchor"><span class="header-section-number">49.1</span> Conveying the right message through visualization<a href="#conveying-the-right-message-through-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this lab, our goal is to reconstruct and improve a data visualization on COVID and mask wearing.</p>
</div>
<div id="learning-goals-2" class="section level2 hasAnchor" number="49.2">
<h2 class="hasAnchor"><span class="header-section-number">49.2</span> Learning goals<a href="#learning-goals-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Critiquing visualizations that misrepresent data</li>
<li>Improving data visualizations to better convey the right message</li>
</ul>
</div>
<div id="getting-started-6" class="section level2 hasAnchor" number="49.3">
<h2 class="hasAnchor"><span class="header-section-number">49.3</span> Getting started<a href="#getting-started-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go to the course GitHub organization and locate the <a href="https://github.com/DataScience4Psych/lab_07_betterviz">template</a>. Clone it in RStudio and open the R Markdown document.
Knit the document to make sure it compiles without errors.</p>
<div id="warm-up-5" class="section level3 hasAnchor" number="49.3.1">
<h3 class="hasAnchor"><span class="header-section-number">49.3.1</span> Warm up<a href="#warm-up-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let‚Äôs warm up with some simple exercises.
Update the YAML of your R Markdown file with your information, knit, commit, and push your changes.
Make sure to commit with a meaningful commit message.
Then, go to your repo on GitHub and confirm that your changes are visible in your Rmd <strong>and</strong> md files.
If anything is missing, commit and push again.</p>
</div>
<div id="packages-7" class="section level3 hasAnchor" number="49.3.2">
<h3 class="hasAnchor"><span class="header-section-number">49.3.2</span> Packages<a href="#packages-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We‚Äôll use the <strong>tidyverse</strong> package for much of the data wrangling and visualization.
This package is already installed for you.
You can load it by running the following in your Console:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data-3" class="section level3 hasAnchor" number="49.3.3">
<h3 class="hasAnchor"><span class="header-section-number">49.3.3</span> Data<a href="#data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab, you‚Äôll construct the dataset!</p>
</div>
</div>
<div id="exercises-6" class="section level2 hasAnchor" number="49.4">
<h2 class="hasAnchor"><span class="header-section-number">49.4</span> Exercises<a href="#exercises-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following visualization was shared <a href="https://twitter.com/JonBoeckenstedt/status/1291602888376999936">on Twitter</a> as ‚Äúextraordinary misleading‚Äù.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Hey, <a href="https://twitter.com/maddow?ref_src=twsrc%5Etfw">@maddow</a> and <a href="https://twitter.com/MaddowBlog?ref_src=twsrc%5Etfw">@MaddowBlog</a> @SecNormanas as much as we&#39;d all hope everyone would wear masks, this chart is extraordinary misleading.  If you don&#39;t believe me, ask <a href="https://twitter.com/AlbertoCairo?ref_src=twsrc%5Etfw">@AlbertoCairo</a> who wrote the book on it. Check the scale on the two axes. <a href="https://t.co/JLxxgxzbua">pic.twitter.com/JLxxgxzbua</a></p>&mdash; Jon Boeckenstedt (@JonBoeckenstedt) <a href="https://twitter.com/JonBoeckenstedt/status/1291602888376999936?ref_src=twsrc%5Etfw">August 7, 2020</a></blockquote>

<p><img src="img/masks-v-nomasks.png" width="805" /></p>
<p>Before you dive in, think about what is misleading about this visualization and how you might go about fixing it.</p>
<ol style="list-style-type: decimal">
<li>Create a data frame that can be used to re-construct this visualization. You may need to guess some of the numbers, that‚Äôs ok. You should first think about how many rows and columns you‚Äôll need and what you want to call your variables. Then, you can use the <code>tribble()</code> function for this. For example, if you wanted to construct the following data frame</li>
</ol>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 √ó 2</span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   date     count</span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1/1/2020    15</span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 2/1/2020    20</span></span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 3/1/2020    22</span></span></code></pre></div>
<p>you can write</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>date, <span class="sc">~</span>count,</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1/1/2020&quot;</span>, <span class="dv">15</span>,</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2/1/2020&quot;</span>, <span class="dv">20</span>,</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3/1/2020&quot;</span>, <span class="dv">22</span>,</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Make a visualization that more accurately (and honestly) tells the story.</p></li>
<li><p>What message is more clear in your visualization than it was in the original visualization?</p></li>
<li><p>What, if any, useful information do these data and your visualization tell us about mask wearing and COVID?
It‚Äôll be difficult to set aside what you already know about mask wearing, but you should try to focus only on what this visualization tells.
Feel free to also comment on whether that lines up with what you know about mask wearing.</p></li>
</ol>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è Knit, <em>commit, and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards and review the md document on GitHub to make sure you‚Äôre happy with the final state of your work.</em></p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0705_lab_betterviz.Rmd-->
</div>
</div>
<div id="part-module-08" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 08<a href="#part-module-08" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-functions-and-automation" class="section level1 hasAnchor" number="50">
<h1 class="hasAnchor"><span class="header-section-number">50</span> Welcome to Functions and Automation<a href="#welcome-to-functions-and-automation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce functions. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYZgOzYB_dmauw55M7jXvsdo">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-7" class="section level2 hasAnchor" number="50.1">
<h2 class="hasAnchor"><span class="header-section-number">50.1</span> Module Materials<a href="#module-materials-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html">Functions and Automation</a></li>
</ul></li>
<li>Activities
<ul>
<li><a href="https://github.com/DataScience4Psych/ae-09-uoeart-functions">Functions and Art!</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module, including ‚ÄòNotes on Functions‚Äô</li>
<li><a href="https://r4ds.had.co.nz/">r4ds</a>
<ul>
<li>Sections on <a href="https://r4ds.had.co.nz/functions.html">functions</a>, and</li>
<li><a href="https://r4ds.had.co.nz/iteration.html">Iterations</a></li>
</ul></li>
</ul></li>
<li>Lab
<ul>
<li>[Conveying the right message through visualization][lab08]</li>
<li>[Optional Lab Money in Politics][lab08b]</li>
</ul></li>
</ul>
</div>
</div>
<div id="functions-1" class="section level1 hasAnchor" number="51">
<h1 class="hasAnchor"><span class="header-section-number">51</span> Functions!<a href="#functions-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Wow I‚Äôm so humbly grateful much love to y‚Äôallüíúüíúüíúüíú</p>&mdash; Missy Elliott (@MissyElliott) <a href="https://twitter.com/MissyElliott/status/1386707191617527812?ref_src=twsrc%5Etfw">April 26, 2021</a></blockquote>

<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/gfmVLvgztSw" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html" width="672" height="400px" data-external="1">
</iframe>
<div id="code-along-pt-1" class="section level2 hasAnchor" number="51.1">
<h2 class="hasAnchor"><span class="header-section-number">51.1</span> Code Along pt 1<a href="#code-along-pt-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe src="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html#7" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for this activity <a href="https://github.com/DataScience4Psych/ae-09-uoeart-functions">here</a>.</p>
</div>
<div id="functions-for-real" class="section level2 hasAnchor" number="51.2">
<h2 class="hasAnchor"><span class="header-section-number">51.2</span> Functions for real!<a href="#functions-for-real" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/w0YF_KZpBQM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html#14" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="code-along-pt-2" class="section level2 hasAnchor" number="51.3">
<h2 class="hasAnchor"><span class="header-section-number">51.3</span> Code Along pt 2<a href="#code-along-pt-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe src="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html#26" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for this activity <a href="https://github.com/DataScience4Psych/ae-09-uoeart-functions">here</a>.</p>
</div>
<div id="writing-functions" class="section level2 hasAnchor" number="51.4">
<h2 class="hasAnchor"><span class="header-section-number">51.4</span> Writing Functions<a href="#writing-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/dlmkgbB6Pjo" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html#32" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="automation" class="section level1 hasAnchor" number="52">
<h1 class="hasAnchor"><span class="header-section-number">52</span> Automation<a href="#automation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/BZrm_tlvCq4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html#42" width="672" height="400px" data-external="1">
</iframe>
<div id="code-along-pt-3" class="section level2 hasAnchor" number="52.1">
<h2 class="hasAnchor"><span class="header-section-number">52.1</span> Code Along pt 3<a href="#code-along-pt-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe src="https://datascience4psych.github.io/slides/d17_functions/d17_functions.html#54" width="672" height="400px" data-external="1">
</iframe>
<p>You can find the materials for this activity <a href="https://github.com/DataScience4Psych/ae-09-uoeart-functions">here</a>.</p>
</div>
<div id="math-to-coding" class="section level2 hasAnchor" number="52.2">
<h2 class="hasAnchor"><span class="header-section-number">52.2</span> Math to Coding<a href="#math-to-coding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">btw these large scary math symbols are just for-loops <a href="https://t.co/Kq6dcihPp4">pic.twitter.com/Kq6dcihPp4</a></p>&mdash; Freya Holm√©r (@FreyaHolmer) <a href="https://twitter.com/FreyaHolmer/status/1436696408506212353?ref_src=twsrc%5Etfw">September 11, 2021</a></blockquote>

<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0801_functions.Rmd-->
</div>
</div>
<div id="functions-part1" class="section level1 hasAnchor" number="53">
<h1 class="hasAnchor"><span class="header-section-number">53</span> Write your own R functions<a href="#functions-part1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These notes are adapted from Jenny Bryan‚Äôs stat545.</p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--Original content: https://stat545.com/block011_write-your-own-function-01.html-->
<div id="what-and-why" class="section level2 hasAnchor" number="53.1">
<h2 class="hasAnchor"><span class="header-section-number">53.1</span> What and why?<a href="#what-and-why" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>My goal here is to reveal the <strong>process</strong> a long-time useR employs for writing functions. I also want to illustrate why the process is the way it is. Merely looking at the finished product, e.g.¬†source code for R packages, can be extremely deceiving. Reality is generally much uglier ‚Ä¶ but more interesting!</p>
<p>Why are we covering this now, smack in the middle of data aggregation? Powerful machines like dplyr, purrr, and the built-in ‚Äúapply‚Äù family of functions, are ready and waiting to apply your purpose-built functions to various bits of your data. If you can express your analytical wishes in a function, these tools will give you great power.</p>
</div>
<div id="load-the-gapminder-data" class="section level2 hasAnchor" number="53.2">
<h2 class="hasAnchor"><span class="header-section-number">53.2</span> Load the Gapminder data<a href="#load-the-gapminder-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, load gapminder.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder)</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tibble [1,704 √ó 6] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ country  : Factor w/ 142 levels &quot;Afghanistan&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ continent: Factor w/ 5 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...</span></span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...</span></span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372..</span></span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</span></span></code></pre></div>
</div>
<div id="max---min" class="section level2 hasAnchor" number="53.3">
<h2 class="hasAnchor"><span class="header-section-number">53.3</span> Max - min<a href="#max---min" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Say you‚Äôve got a numeric vector, and you want to compute the difference between its max and min. <code>lifeExp</code> or <code>pop</code> or <code>gdpPercap</code> are great examples of a typical input. You can imagine wanting to get this statistic after we slice up the Gapminder data by year, country, continent, or combinations thereof.</p>
</div>
<div id="get-something-that-works" class="section level2 hasAnchor" number="53.4">
<h2 class="hasAnchor"><span class="header-section-number">53.4</span> Get something that works<a href="#get-something-that-works" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, develop some working code for interactive use, using a representative input. I‚Äôll use Gapminder‚Äôs life expectancy variable.</p>
<p>R functions that will be useful: <code>min()</code>, <code>max()</code>, <code>range()</code>. (<strong>Read their documentation:</strong> <a href="https://rdrr.io/r/base/Extremes.html">here</a> and <a href="https://rdrr.io/r/base/range.html">here</a>)</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="do">## get to know the functions mentioned above</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 23.6</span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 82.6</span></span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 23.6 82.6</span></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a><span class="do">## some natural solutions</span></span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(gapminder<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">min</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(gapminder, <span class="fu">max</span>(lifeExp) <span class="sc">-</span> <span class="fu">min</span>(lifeExp))</span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(gapminder<span class="sc">$</span>lifeExp)[<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">range</span>(gapminder<span class="sc">$</span>lifeExp)[<span class="dv">1</span>]</span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(gapminder, <span class="fu">range</span>(lifeExp)[<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">range</span>(lifeExp)[<span class="dv">1</span>])</span>
<span id="cb313-17"><a href="#cb313-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb313-18"><a href="#cb313-18" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">range</span>(gapminder<span class="sc">$</span>lifeExp))</span>
<span id="cb313-19"><a href="#cb313-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span></code></pre></div>
<p>Internalize this ‚Äúanswer‚Äù because our informal testing relies on you noticing departures from this.</p>
<div id="skateboard-perfectly-formed-rear-view-mirror" class="section level3 hasAnchor" number="53.4.1">
<h3 class="hasAnchor"><span class="header-section-number">53.4.1</span> Skateboard &gt;&gt; perfectly formed rear-view mirror<a href="#skateboard-perfectly-formed-rear-view-mirror" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This image <a href="https://blog.fastmonkeys.com/">widely attributed to the Spotify development team</a> conveys an important point.</p>
<div class="figure">
<img src="img/spotify-howtobuildmvp.jpg" alt="From [Your ultimate guide to Minimum Viable Product (+great examples)](https://blog.fastmonkeys.com/2014/06/18/minimum-viable-product-your-ultimate-guide-to-mvp-great-examples/)" width="60%" />
<p class="caption">
(#fig:spotify-howtobuildmvp)From <a href="https://blog.fastmonkeys.com/2014/06/18/minimum-viable-product-your-ultimate-guide-to-mvp-great-examples/">Your ultimate guide to Minimum Viable Product (+great examples)</a>
</p>
</div>
<p>Build that skateboard before you build the car or some fancy car part. A limited-but-functioning thing is very useful. It also keeps the spirits high.</p>
<p>This idea is related to the valuable <a href="http://c2.com/cgi/wiki?TelescopeRule">Telescope Rule</a>:</p>
<blockquote>
<p>It is faster to make a four-inch mirror then a six-inch mirror than to make a six-inch mirror.</p>
</blockquote>
</div>
</div>
<div id="turn-the-working-interactive-code-into-a-function" class="section level2 hasAnchor" number="53.5">
<h2 class="hasAnchor"><span class="header-section-number">53.5</span> Turn the working interactive code into a function<a href="#turn-the-working-interactive-code-into-a-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Add NO new functionality! Just write your very first R function.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>max_minus_min <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span></code></pre></div>
<p>Check that you‚Äôre getting the same answer as you did with your interactive code. Test it eyeball-o-metrically at this point.</p>
</div>
<div id="test-your-function" class="section level2 hasAnchor" number="53.6">
<h2 class="hasAnchor"><span class="header-section-number">53.6</span> Test your function<a href="#test-your-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="test-on-new-inputs" class="section level3 hasAnchor" number="53.6.1">
<h3 class="hasAnchor"><span class="header-section-number">53.6.1</span> Test on new inputs<a href="#test-on-new-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pick some new artificial inputs where you know (at least approximately) what your function should return.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(<span class="fu">runif</span>(<span class="dv">1000</span>))</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.996</span></span></code></pre></div>
<p>I know that 10 minus 1 is 9. I know that random uniform [0, 1] variates will be between 0 and 1. Therefore max - min should be less than 1. If I take LOTS of them, max - min should be pretty close to 1.</p>
<p>It is intentional that I tested on integer input as well as floating point. Likewise, I like to use valid-but-random data for this sort of check.</p>
</div>
<div id="test-on-real-data-but-different-real-data" class="section level3 hasAnchor" number="53.6.2">
<h3 class="hasAnchor"><span class="header-section-number">53.6.2</span> Test on real data but <em>different</em> real data<a href="#test-on-real-data-but-different-real-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Back to the real world now. Two other quantitative variables are lying around: <code>gdpPercap</code> and <code>pop</code>. Let‚Äôs have a go.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(gapminder<span class="sc">$</span>gdpPercap)</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 113282</span></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(gapminder<span class="sc">$</span>pop)</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1318623085</span></span></code></pre></div>
<p>Either check these results ‚Äúby hand‚Äù or apply the ‚Äúdoes that even make sense?‚Äù test.</p>
</div>
<div id="test-on-unexpected-stuff" class="section level3 hasAnchor" number="53.6.3">
<h3 class="hasAnchor"><span class="header-section-number">53.6.3</span> Test on unexpected stuff<a href="#test-on-unexpected-stuff" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we try to break our function. Don‚Äôt get truly diabolical (yet). Just make the kind of mistakes you can imagine making at 2am when, 3 years from now, you rediscover this useful function you wrote. Give your function inputs it‚Äôs not expecting.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(gapminder) <span class="do">## hey sometimes things &quot;just work&quot; on data.frames!</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in FUN(X[[i]], ...): only defined on a data frame with all numeric-alike variables</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(gapminder<span class="sc">$</span>country) <span class="do">## factors are kind of like integer vectors, no?</span></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in Summary.factor(structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, : &#39;max&#39; not meaningful for factors</span></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(<span class="st">&quot;eggplants are purple&quot;</span>) <span class="do">## i have no excuse for this one</span></span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in max(x) - min(x): non-numeric argument to binary operator</span></span></code></pre></div>
<p>How happy are you with those error messages? You must imagine that some entire <strong>script</strong> has failed and that you were hoping to just <code>source()</code> it without re-reading it. If a colleague or future you encountered these errors, do you run screaming from the room? How hard is it to pinpoint the usage problem?</p>
</div>
<div id="unbreakable" class="section level3 hasAnchor" number="53.6.4">
<h3 class="hasAnchor"><span class="header-section-number">53.6.4</span> Unbreakable<a href="#unbreakable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here are some great examples where the function <strong>should break but it does not.</strong></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(gapminder[<span class="fu">c</span>(<span class="st">&#39;lifeExp&#39;</span>, <span class="st">&#39;gdpPercap&#39;</span>, <span class="st">&#39;pop&#39;</span>)])</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.32e+09</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max_minus_min</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>In both cases, R‚Äôs eagerness to make sense of our requests is unfortunately successful. In the first case, a data.frame containing just the quantitative variables is eventually coerced into numeric vector. We can compute max minus min, even though it makes absolutely no sense at all. In the second case, a logical vector is converted to zeroes and ones, which might merit an error or at least a warning.</p>
</div>
</div>
<div id="check-the-validity-of-arguments" class="section level2 hasAnchor" number="53.7">
<h2 class="hasAnchor"><span class="header-section-number">53.7</span> Check the validity of arguments<a href="#check-the-validity-of-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For functions that will be used again ‚Äì which is not all of them! ‚Äì it is good to check the validity of arguments. This implements a rule from <a href="http://www.faqs.org/docs/artu/ch01s06.html">the Unix philosophy</a>:</p>
<blockquote>
<p>Rule of Repair: When you must fail, fail noisily and as soon as possible.</p>
</blockquote>
<div id="stop-if-not" class="section level3 hasAnchor" number="53.7.1">
<h3 class="hasAnchor"><span class="header-section-number">53.7.1</span> stop if not<a href="#stop-if-not" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>stopifnot()</code> is the entry level solution. I use it here to make sure the input <code>x</code> is a numeric vector.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>mmm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm</span>(gapminder)</span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mmm(gapminder): is.numeric(x) is not TRUE</span></span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm</span>(gapminder<span class="sc">$</span>country)</span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mmm(gapminder$country): is.numeric(x) is not TRUE</span></span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm</span>(<span class="st">&quot;eggplants are purple&quot;</span>)</span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mmm(&quot;eggplants are purple&quot;): is.numeric(x) is not TRUE</span></span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm</span>(gapminder[<span class="fu">c</span>(<span class="st">&#39;lifeExp&#39;</span>, <span class="st">&#39;gdpPercap&#39;</span>, <span class="st">&#39;pop&#39;</span>)])</span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mmm(gapminder[c(&quot;lifeExp&quot;, &quot;gdpPercap&quot;, &quot;pop&quot;)]): is.numeric(x) is not TRUE</span></span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb319-14"><a href="#cb319-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mmm(c(TRUE, TRUE, FALSE, TRUE, TRUE)): is.numeric(x) is not TRUE</span></span></code></pre></div>
<p>And we see that it catches all of the self-inflicted damage we would like to avoid.</p>
</div>
<div id="if-then-stop" class="section level3 hasAnchor" number="53.7.2">
<h3 class="hasAnchor"><span class="header-section-number">53.7.2</span> if then stop<a href="#if-then-stop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>stopifnot()</code> doesn‚Äôt provide a helpful error message. The next approach is widely used. Put your validity check inside an <code>if()</code> statement and call <code>stop()</code> yourself, with a custom error message, in the body.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>mmm2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(x)) {</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&#39;I am so sorry, but this function only works for numeric input!</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;You have provided an object of class: &#39;</span>, <span class="fu">class</span>(x)[<span class="dv">1</span>])</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)</span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm2</span>(gapminder)</span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in mmm2(gapminder): I am so sorry, but this function only works for numeric input!</span></span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; You have provided an object of class: tbl_df</span></span></code></pre></div>
<p>In addition to a gratuitous apology, the error raised also contains two more pieces of helpful info:</p>
<ul>
<li><em>Which</em> function threw the error.</li>
<li>Hints on how to fix things: expected class of input vs actual class.</li>
</ul>
<p>If it is easy to do so, I highly recommend this template: ‚Äúyou gave me THIS, but I need THAT‚Äù.</p>
<p>The tidyverse style guide has a very useful <a href="https://style.tidyverse.org/error-messages.html">chapter on how to construct error messages</a>.</p>
</div>
<div id="sidebar-non-programming-uses-for-assertions" class="section level3 hasAnchor" number="53.7.3">
<h3 class="hasAnchor"><span class="header-section-number">53.7.3</span> Sidebar: non-programming uses for assertions<a href="#sidebar-non-programming-uses-for-assertions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another good use of this pattern is to leave checks behind in data analytical scripts. Consider our repetitive use of Gapminder in this course. Every time we load it, we inspect it, hoping to see the usual stuff. If we were loading from file (vs.¬†a stable data package), we might want to formalize our expectations about the number of rows and columns, the names and flavors of the variables, etc. This would alert us if the data suddenly changed, which can be a useful wake-up call in scripts that you re-run <em>ad nauseam</em> on auto-pilot or non-interactively.</p>
</div>
</div>
<div id="wrap-up-and-whats-next" class="section level2 hasAnchor" number="53.8">
<h2 class="hasAnchor"><span class="header-section-number">53.8</span> Wrap-up and what‚Äôs next?<a href="#wrap-up-and-whats-next" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here‚Äôs the function we‚Äôve written so far:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>mmm2</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(x) {</span></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   if(!is.numeric(x)) {</span></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     stop(&#39;I am so sorry, but this function only works for numeric input!\n&#39;,</span></span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          &#39;You have provided an object of class: &#39;, class(x)[1])</span></span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max(x) - min(x)</span></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span></code></pre></div>
<p>What we‚Äôve accomplished:</p>
<ul>
<li>We‚Äôve written our first function.</li>
<li>We are checking the validity of its input, argument <code>x</code>.</li>
<li>We‚Äôve done a good amount of informal testing.</li>
</ul>
<p>Where to next? In <a href="#functions-part2">part 2</a> we generalize this function to take differences in other quantiles and learn how to set default values for arguments.</p>
</div>
<div id="where-were-we-where-are-we-going" class="section level2 hasAnchor" number="53.9">
<h2 class="hasAnchor"><span class="header-section-number">53.9</span> Where were we? Where are we going?<a href="#where-were-we-where-are-we-going" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In <a href="#functions-part1">part 1</a> we wrote our first R function to compute the difference between the max and min of a numeric vector. We checked the validity of the function‚Äôs only argument and, informally, we verified that it worked pretty well.</p>
<p>In this part, we generalize this function, learn more technical details about R functions, and set default values for some arguments.</p>
</div>
<div id="load-the-gapminder-data-1" class="section level2 hasAnchor" number="53.10">
<h2 class="hasAnchor"><span class="header-section-number">53.10</span> Load the Gapminder data<a href="#load-the-gapminder-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, load gapminder.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
</div>
<div id="restore-our-max-minus-min-function" class="section level2 hasAnchor" number="53.11">
<h2 class="hasAnchor"><span class="header-section-number">53.11</span> Restore our max minus min function<a href="#restore-our-max-minus-min-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs keep our previous function around as a baseline.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>mmm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="generalize-our-function-to-other-quantiles" class="section level2 hasAnchor" number="53.12">
<h2 class="hasAnchor"><span class="header-section-number">53.12</span> Generalize our function to other quantiles<a href="#generalize-our-function-to-other-quantiles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The max and the min are special cases of a <strong>quantile</strong>. Here are other special cases you may have heard of:</p>
<ul>
<li>median = 0.5 quantile</li>
<li>1st quartile = 0.25 quantile</li>
<li>3rd quartile = 0.75 quantile</li>
</ul>
<p>If you‚Äôre familiar with <a href="https://en.wikipedia.org/wiki/Box_plot">box plots</a>, the rectangle typically runs from the 1st quartile to the 3rd quartile, with a line at the median.</p>
<p>If <span class="math inline">\(q\)</span> is the <span class="math inline">\(p\)</span>-th quantile of a set of <span class="math inline">\(n\)</span> observations, what does that mean? Approximately <span class="math inline">\(pn\)</span> of the observations are less than <span class="math inline">\(q\)</span> and <span class="math inline">\((1 - p)n\)</span> are greater than <span class="math inline">\(q\)</span>. Yeah, you need to worry about rounding to an integer and less/greater than or equal to, but these details aren‚Äôt critical here.</p>
<p>Let‚Äôs generalize our function to take the difference between any two quantiles. We can still consider the max and min, if we like, but we‚Äôre not limited to that.</p>
</div>
<div id="get-something-that-works-again" class="section level2 hasAnchor" number="53.13">
<h2 class="hasAnchor"><span class="header-section-number">53.13</span> Get something that works, again<a href="#get-something-that-works-again" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The eventual inputs to our new function will be the data <code>x</code> and two probabilities.</p>
<p>First, play around with the <code>quantile()</code> function. Convince yourself you know how to use it, for example, by cross-checking your results with other built-in functions.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0%  25%  50%  75% 100% </span></span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23.6 48.2 60.7 70.8 82.6</span></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gapminder<span class="sc">$</span>lifeExp,</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">probs =</span> <span class="fl">0.5</span>)</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  50% </span></span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 60.7</span></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 60.7</span></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gapminder<span class="sc">$</span>lifeExp,</span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">robs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0%  25%  50%  75% 100% </span></span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23.6 48.2 60.7 70.8 82.6</span></span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gapminder<span class="sc">$</span>lifeExp, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>stats</span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb324-16"><a href="#cb324-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 23.6</span></span>
<span id="cb324-17"><a href="#cb324-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 48.2</span></span>
<span id="cb324-18"><a href="#cb324-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 60.7</span></span>
<span id="cb324-19"><a href="#cb324-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 70.8</span></span>
<span id="cb324-20"><a href="#cb324-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 82.6</span></span></code></pre></div>
<p>Now write a code snippet that takes the difference between two quantiles.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>the_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(gapminder<span class="sc">$</span>lifeExp, <span class="at">probs =</span> the_probs)</span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 22.6</span></span></code></pre></div>
</div>
<div id="turn-the-working-interactive-code-into-a-function-again" class="section level2 hasAnchor" number="53.14">
<h2 class="hasAnchor"><span class="header-section-number">53.14</span> Turn the working interactive code into a function, again<a href="#turn-the-working-interactive-code-into-a-function-again" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I‚Äôll use <code>qdiff</code> as the base of our function‚Äôs name. I copy the overall structure from our previous ‚Äúmax minus min‚Äù work but replace the guts of the function with the more general code we just developed.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>qdiff1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, probs) {</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="at">x =</span> x, <span class="at">probs =</span> probs)</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff1</span>(gapminder<span class="sc">$</span>lifeExp, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 22.6</span></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(gapminder<span class="sc">$</span>lifeExp) <span class="co"># hey, we&#39;ve reinvented IQR</span></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 22.6</span></span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff1</span>(gapminder<span class="sc">$</span>lifeExp, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span></code></pre></div>
<p>Again we do some informal tests against familiar results and external implementations.</p>
</div>
<div id="argument-names-freedom-and-conventions" class="section level2 hasAnchor" number="53.15">
<h2 class="hasAnchor"><span class="header-section-number">53.15</span> Argument names: freedom and conventions<a href="#argument-names-freedom-and-conventions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I want you to understand the importance of argument names.</p>
<p>I can name my arguments almost anything I like. Proof:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>qdiff2 <span class="ot">&lt;-</span> <span class="cf">function</span>(zeus, hera) {</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(zeus))</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="at">x =</span> zeus, <span class="at">probs =</span> hera)</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff2</span>(<span class="at">zeus =</span> gapminder<span class="sc">$</span>lifeExp, <span class="at">hera =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span></code></pre></div>
<p>While I can name my arguments after Greek gods, it‚Äôs usually a bad idea. Take all opportunities to make things more self-explanatory via meaningful names. Future you will thank you.</p>
<p>If you are going to pass the arguments of your function as arguments of a built-in function, consider copying the argument names. Unless you have a good reason to do your own thing (some argument names are bad!), be consistent with the existing function. Again, the reason is to reduce your cognitive load. This is what I‚Äôve been doing all along and now you know why:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>qdiff1</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(x, probs) {</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   stopifnot(is.numeric(x))</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   the_quantiles &lt;- quantile(x = x, probs = probs)</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max(the_quantiles) - min(the_quantiles)</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;bytecode: 0x000001396a400118&gt;</span></span></code></pre></div>
<p>We took this detour so you could see there is no <em>structural</em> relationship between my arguments (<code>x</code> and <code>probs</code>) and those of <code>quantile()</code> (also <code>x</code> and <code>probs</code>). The similarity or equivalence of the names <strong>accomplishes nothing</strong> as far as R is concerned; it is solely for the benefit of humans reading, writing, and using the code. Which is very important!</p>
</div>
<div id="what-a-function-returns" class="section level2 hasAnchor" number="53.16">
<h2 class="hasAnchor"><span class="header-section-number">53.16</span> What a function returns<a href="#what-a-function-returns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By this point, I expect someone will have asked about the last line in my function‚Äôs body. Look above for a reminder of the function‚Äôs definition.</p>
<p>By default, a function returns the result of the last line of the body. I am just letting that happen with the line <code>max(the_quantiles) - min(the_quantiles)</code>. However, there is an explicit function for this: <code>return()</code>. I could just as easily make this the last line of my function‚Äôs body:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles))</span></code></pre></div>
<p>You absolutely must use <code>return()</code> if you want to return early based on some condition, i.e.¬†before execution gets to the last line of the body. Otherwise, you can decide your own conventions about when you use <code>return()</code> and when you don‚Äôt.</p>
</div>
<div id="default-values-freedom-to-not-specify-the-arguments" class="section level2 hasAnchor" number="53.17">
<h2 class="hasAnchor"><span class="header-section-number">53.17</span> Default values: freedom to NOT specify the arguments<a href="#default-values-freedom-to-not-specify-the-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What happens if we call our function but neglect to specify the probabilities?</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff1</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in quantile(x = x, probs = probs): argument &quot;probs&quot; is missing, with no default</span></span></code></pre></div>
<p>Oops! At the moment, this causes a fatal error. It can be nice to provide some reasonable default values for certain arguments. In our case, it would not be a good idea to specify a default value for the primary input <code>x</code>, but it would be a good idea to specify a default for <code>probs</code>.</p>
<p>We started by focusing on the max and the min, so I think those make reasonable defaults. Here‚Äôs how to specify that in a function definition.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>qdiff3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) {</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, probs)</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Again we check how the function works, in old examples and new, specifying the <code>probs</code> argument and not.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff3</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mmm</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff3</span>(gapminder<span class="sc">$</span>lifeExp, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 33.6</span></span></code></pre></div>
</div>
<div id="check-the-validity-of-arguments-again" class="section level2 hasAnchor" number="53.18">
<h2 class="hasAnchor"><span class="header-section-number">53.18</span> Check the validity of arguments, again<a href="#check-the-validity-of-arguments-again" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Exercise:</strong> upgrade our argument validity checks in light of the new argument <code>probs</code>.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="do">## problems identified during class</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="do">## we&#39;re not checking that probs is numeric</span></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="do">## we&#39;re not checking that probs is length 2</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="do">## we&#39;re not checking that probs are in [0,1]</span></span></code></pre></div>
</div>
<div id="wrap-up-and-whats-next-1" class="section level2 hasAnchor" number="53.19">
<h2 class="hasAnchor"><span class="header-section-number">53.19</span> Wrap-up and what‚Äôs next?<a href="#wrap-up-and-whats-next-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here‚Äôs the function we‚Äôve written so far:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>qdiff3</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function(x, probs = c(0, 1)) {</span></span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   stopifnot(is.numeric(x))</span></span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   the_quantiles &lt;- quantile(x, probs)</span></span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   max(the_quantiles) - min(the_quantiles)</span></span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;bytecode: 0x000001396d8e8fc0&gt;</span></span></code></pre></div>
<p>What we‚Äôve accomplished:</p>
<ul>
<li>We‚Äôve generalized our first function to take a difference between arbitrary quantiles.</li>
<li>We‚Äôve specified default values for the probabilities that set the quantiles.</li>
</ul>
<p>Where to next? Next, we tackle <code>NA</code>s, the special <code>...</code> argument, and formal unit testing.</p>
</div>
<div id="where-were-we-where-are-we-going-1" class="section level2 hasAnchor" number="53.20">
<h2 class="hasAnchor"><span class="header-section-number">53.20</span> Where were we? Where are we going?<a href="#where-were-we-where-are-we-going-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Previously, we generalized our first R function so it could take the difference between any two quantiles of a numeric vector. We also set default values for the underlying probabilities, so that, by default, we compute the max minus the min.</p>
<p>In this part, we tackle <code>NA</code>s, the special argument <code>...</code> and formal testing.</p>
</div>
<div id="load-the-gapminder-data-2" class="section level2 hasAnchor" number="53.21">
<h2 class="hasAnchor"><span class="header-section-number">53.21</span> Load the Gapminder data<a href="#load-the-gapminder-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, load gapminder.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
</div>
<div id="restore-our-max-minus-min-function-1" class="section level2 hasAnchor" number="53.22">
<h2 class="hasAnchor"><span class="header-section-number">53.22</span> Restore our max minus min function<a href="#restore-our-max-minus-min-function-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs keep our previous function around as a baseline.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>qdiff3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) {</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, probs)</span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="be-proactive-about-nas" class="section level2 hasAnchor" number="53.23">
<h2 class="hasAnchor"><span class="header-section-number">53.23</span> Be proactive about <code>NA</code>s<a href="#be-proactive-about-nas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I am being gentle by letting you practice with the Gapminder data. In real life, missing data will make your life a living hell. If you are lucky, it will be properly indicated by the special value <code>NA</code>, but don‚Äôt hold your breath. Many built-in R functions have an <code>na.rm =</code> argument through which you can specify how you want to handle <code>NA</code>s. Typically the default value is <code>na.rm = FALSE</code> and typical default behavior is to either let <code>NA</code>s propagate or to raise an error. Let‚Äôs see how <code>quantile()</code> handles <code>NA</code>s:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> gapminder<span class="sc">$</span>lifeExp</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>z[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0%  25%  50%  75% 100% </span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23.6 48.2 60.7 70.8 82.6</span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(z)</span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in quantile.default(z): missing values and NaN&#39;s not allowed if &#39;na.rm&#39; is FALSE</span></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(z, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0%  25%  50%  75% 100% </span></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23.6 48.2 60.8 70.8 82.6</span></span></code></pre></div>
<p>So <code>quantile()</code> simply will not operate in the presence of <code>NA</code>s unless <code>na.rm = TRUE</code>. How shall we modify our function?</p>
<p>If we wanted to hardwire <code>na.rm = TRUE</code>, we could. Focus on our call to <code>quantile()</code> inside our function definition.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>qdiff4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) {</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, probs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff4</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff4</span>(z)</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span></code></pre></div>
<p>This works but it is dangerous to invert the default behavior of a well-known built-in function and to provide the user with no way to override this.</p>
<p>We could add an <code>na.rm =</code> argument to our own function. We might even enforce our preferred default ‚Äì but at least we‚Äôre giving the user a way to control the behavior around <code>NA</code>s.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>qdiff5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">na.rm =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, probs, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff5</span>(gapminder<span class="sc">$</span>lifeExp)</span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff5</span>(z)</span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 59</span></span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff5</span>(z, <span class="at">na.rm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in quantile.default(x, probs, na.rm = na.rm): missing values and NaN&#39;s not allowed if &#39;na.rm&#39; is FALSE</span></span></code></pre></div>
</div>
<div id="the-useful-but-mysterious-...-argument" class="section level2 hasAnchor" number="53.24">
<h2 class="hasAnchor"><span class="header-section-number">53.24</span> The useful but mysterious <code>...</code> argument<a href="#the-useful-but-mysterious-...-argument" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You probably could have lived a long and happy life without knowing there are at least 9 different algorithms for computing quantiles. <a href="https://rdrr.io/r/stats/quantile.html">Go read about the <code>type</code> argument</a> of <code>quantile()</code>. TLDR: If a quantile is not unambiguously equal to an observed data point, you must somehow average two data points. You can weight this average different ways, depending on the rest of the data, and <code>type =</code> controls this.</p>
<p>Let‚Äôs say we want to give the user of our function the ability to specify how the quantiles are computed, but we want to accomplish with as little fuss as possible. In fact, we don‚Äôt even want to clutter our function‚Äôs interface with this! This calls for the very special <code>...</code> argument. In English, this set of three dots is frequently called an ‚Äúellipsis‚Äù.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>qdiff6 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, ...) {</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="at">x =</span> x, <span class="at">probs =</span> probs, <span class="at">na.rm =</span> na.rm, ...)</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The practical significance of the <code>type =</code> argument is virtually nonexistent, so we can‚Äôt demo with the Gapminder data. Thanks to <a href="https://twitter.com/wrathematics">@wrathematics</a>, here‚Äôs a small example where we can (barely) detect a difference due to <code>type</code>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(z, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     0%    25%    50%    75%   100% </span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.346 -0.890 -0.564  0.429  1.084</span></span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(z, <span class="at">type =</span> <span class="dv">4</span>)</span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     0%    25%    50%    75%   100% </span></span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.346 -1.049 -0.564  0.353  1.084</span></span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">quantile</span>(z, <span class="at">type =</span> <span class="dv">1</span>), <span class="fu">quantile</span>(z, <span class="at">type =</span> <span class="dv">4</span>))</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Mean relative difference: 0.178&quot;</span></span></code></pre></div>
<p>Now we can call our function, requesting that quantiles be computed in different ways.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff6</span>(z, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.32</span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qdiff6</span>(z, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">type =</span> <span class="dv">4</span>)</span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.4</span></span></code></pre></div>
<p>While the difference may be subtle, <strong>it‚Äôs there</strong>. Marvel at the fact that we have passed <code>type = 1</code> through to <code>quantile()</code> <em>even though it was not a formal argument of our own function</em>.</p>
<p>The special argument <code>...</code> is very useful when you want the ability to pass arbitrary arguments down to another function, but without constantly expanding the formal arguments to your function. This leaves you with a less cluttered function definition and gives you future flexibility to specify these arguments only when you need to.</p>
<p>You will also encounter the <code>...</code> argument in many built-in functions ‚Äì read up on <a href="https://rdrr.io/r/base/c.html"><code>c()</code></a> or <a href="https://rdrr.io/r/base/list.html"><code>list()</code></a> ‚Äì and now you have a better sense of what it means. It is not a breezy ‚Äúand so on and so forth.‚Äù</p>
<p>There are also downsides to <code>...</code>, so use it with intention. In a package, you will have to work harder to create truly informative documentation for your user. Also, the quiet, absorbent properties of <code>...</code> mean it can sometimes silently swallow other named arguments, when the user has a typo in the name. Depending on whether or how this fails, it can be a little tricky to find out what went wrong.</p>
<p>The <a href="https://ellipsis.r-lib.org">ellipsis package</a> provides tools that help package developers use <code>...</code> more safely. The in-progress tidyverse principles guide provides further guidance on the design of functions that take <code>...</code> in <a href="https://principles.tidyverse.org/dots-position.html">Data, dots, details</a>.</p>
</div>
<div id="use-testthat-for-formal-unit-tests" class="section level2 hasAnchor" number="53.25">
<h2 class="hasAnchor"><span class="header-section-number">53.25</span> Use testthat for formal unit tests<a href="#use-testthat-for-formal-unit-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Until now, we‚Äôve relied on informal tests of our evolving function. If you are going to use a function a lot, especially if it is part of a package, it is wise to use formal unit tests.</p>
<p>The <a href="https://testthat.r-lib.org">testthat</a> package (<a href="https://CRAN.R-project.org/package=testthat">cran</a>; <a href="https://github.com/r-lib/testthat">GitHub</a>) provides excellent facilities for this, with a distinct emphasis on automated unit testing of entire packages. However, we can take it out for a test drive even with our one measly function.</p>
<p>We will construct a test with <code>test_that()</code> and, within it, we put one or more <em>expectations</em> that check actual against expected results. You simply harden your informal, interactive tests into formal unit tests. Here are some examples of tests and indicative expectations.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&#39;invalid args are detected&#39;</span>, {</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_error</span>(<span class="fu">qdiff6</span>(<span class="st">&quot;eggplants are purple&quot;</span>))</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_error</span>(<span class="fu">qdiff6</span>(iris))</span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&#39;NA handling works&#39;</span>, {</span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_error</span>(<span class="fu">qdiff6</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="cn">NA</span>), <span class="at">na.rm =</span> <span class="cn">FALSE</span>))</span>
<span id="cb343-10"><a href="#cb343-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(<span class="fu">qdiff6</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="cn">NA</span>)), <span class="dv">4</span>)</span>
<span id="cb343-11"><a href="#cb343-11" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>No news is good news! Let‚Äôs see what test failure would look like. Let‚Äôs revert to a version of our function that does no <code>NA</code> handling, then test for proper <code>NA</code> handling. We can watch it fail.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>qdiff_no_NA <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) {</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>  the_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="at">x =</span> x, <span class="at">probs =</span> probs)</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(the_quantiles) <span class="sc">-</span> <span class="fu">min</span>(the_quantiles)</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&#39;NA handling works&#39;</span>, {</span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_that</span>(<span class="fu">qdiff_no_NA</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="cn">NA</span>)), <span class="fu">equals</span>(<span class="dv">4</span>))</span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Similar to the advice to use assertions in data analytical scripts, I recommend you use unit tests to monitor the behavior of functions you (or others) will use often. If your tests cover the function‚Äôs important behavior, then you can edit the internals freely. You‚Äôll rest easy in the knowledge that, if you broke anything important, the tests will fail and alert you to the problem. A function that is important enough for unit tests probably also belongs in a package, where there are obvious mechanisms for running the tests as part of overall package checks.</p>
</div>
</div>
<div id="functions-practicum" class="section level1 hasAnchor" number="54">
<h1 class="hasAnchor"><span class="header-section-number">54</span> Function-writing practicum<a href="#functions-practicum" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--Original content: https://stat545.com/block012_function-regress-lifeexp-on-year.html-->
<div id="overview" class="section level2 hasAnchor" number="54.1">
<h2 class="hasAnchor"><span class="header-section-number">54.1</span> Overview<a href="#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We recently learned how to write our own R functions (<a href="#functions-part1">part 1</a>, <a href="#functions-part2">part 2</a>, <a href="#functions-part3">part 3</a>).</p>
<p>Now we use that knowledge to write another useful function, within the context of the Gapminder data:</p>
<ul>
<li>Input: a data.frame that contains (at least) a life expectancy variable <code>lifeExp</code> and a variable for year <code>year</code></li>
<li>Output: a vector of estimated intercept and slope, from a linear regression of <code>lifeExp</code> on <code>year</code></li>
</ul>
<p>The ultimate goal is to apply this function to the Gapminder data for a specific country. We will eventually scale up to <em>all</em> countries using external machinery, e.g., the <code>dplyr::group_by()</code> + <code>dplyr::do()</code>.</p>
</div>
<div id="load-the-gapminder-data-3" class="section level2 hasAnchor" number="54.2">
<h2 class="hasAnchor"><span class="header-section-number">54.2</span> Load the Gapminder data<a href="#load-the-gapminder-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, load gapminder. Load ggplot2 because we‚Äôll make some plots and load dplyr too.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
</div>
<div id="get-data-to-practice-with" class="section level2 hasAnchor" number="54.3">
<h2 class="hasAnchor"><span class="header-section-number">54.3</span> Get data to practice with<a href="#get-data-to-practice-with" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I extract the data for one country in order to develop some working code interactively.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>j_country <span class="ot">&lt;-</span> <span class="st">&quot;France&quot;</span> <span class="co"># pick, but do not hard wire, an example</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>(j_dat <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> j_country))</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 6</span></span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 France  Europe     1952    67.4 42459667     7030.</span></span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 France  Europe     1957    68.9 44310863     8663.</span></span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 France  Europe     1962    70.5 47124000    10560.</span></span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 France  Europe     1967    71.6 49569000    13000.</span></span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 France  Europe     1972    72.4 51732000    16107.</span></span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 France  Europe     1977    73.8 53165019    18293.</span></span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 France  Europe     1982    74.9 54433565    20294.</span></span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 France  Europe     1987    76.3 55630100    22066.</span></span>
<span id="cb346-15"><a href="#cb346-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 France  Europe     1992    77.5 57374179    24704.</span></span>
<span id="cb346-16"><a href="#cb346-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 France  Europe     1997    78.6 58623428    25890.</span></span>
<span id="cb346-17"><a href="#cb346-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 France  Europe     2002    79.6 59925035    28926.</span></span>
<span id="cb346-18"><a href="#cb346-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 France  Europe     2007    80.7 61083916    30470.</span></span></code></pre></div>
<p>Always always always plot the data. Yes, even now.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(j_dat, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp))</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="0802_functionnotes_files/figure-html/first-example-scatterplot-1.png" width="672" /></p>
</div>
<div id="get-some-code-that-works" class="section level2 hasAnchor" number="54.4">
<h2 class="hasAnchor"><span class="header-section-number">54.4</span> Get some code that works<a href="#get-some-code-that-works" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fit the regression:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>j_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year, j_dat)</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(j_fit)</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        year </span></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    -397.765       0.239</span></span></code></pre></div>
<p>Whoa, check out that wild intercept! Apparently the life expectancy in France around year 0 A.D. was minus 400 years! Never forget to sanity check a model. In this case, a reparametrization is in order. I think it makes more sense for the intercept to correspond to life expectancy in 1952, the earliest date in our dataset. Estimate the intercept eye-ball-o-metrically from the plot and confirm that we‚Äôve got something sane and interpretable now.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>j_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">I</span>(year <span class="sc">-</span> <span class="dv">1952</span>), j_dat)</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(j_fit)</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    (Intercept) I(year - 1952) </span></span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         67.790          0.239</span></span></code></pre></div>
<div id="sidebar-regression-stuff" class="section level3 hasAnchor" number="54.4.1">
<h3 class="hasAnchor"><span class="header-section-number">54.4.1</span> Sidebar: regression stuff<a href="#sidebar-regression-stuff" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two things above that might prompt questions.</p>
<p>First, how did I know to get the estimated coefficients from a fitted model via <code>coef()</code>? Years of experience. But how might a novice learn such things? Read <a href="https://rdrr.io/r/stats/lm.html">the documentation for <code>lm()</code></a>, in this case. The ‚ÄúSee also‚Äù section advises us about many functions that can operate on fitted linear model objects, including, but by no means limited to, <code>coef()</code>. Read <a href="https://rdrr.io/r/stats/coef.html">the documentation on <code>coef()</code></a> too.</p>
<p>Second, what am I doing here: <code>lm(lifeExp ~ I(year - 1952))</code>? I want the intercept to correspond to 1952 and an easy way to accomplish that is to create a new predictor on the fly: year minus 1952. The way I achieve that in the model formula, <code>I(year - 1952)</code>, uses the <code>I()</code> function which ‚Äúinhibits interpretation/conversion of objects‚Äù. By protecting the expression <code>year - 1952</code>, I ensure it is interpreted in the obvious arithmetical way.</p>
</div>
</div>
<div id="turn-working-code-into-a-function" class="section level2 hasAnchor" number="54.5">
<h2 class="hasAnchor"><span class="header-section-number">54.5</span> Turn working code into a function<a href="#turn-working-code-into-a-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Create the basic definition of a function and drop your working code inside. Add arguments and edit the inner code to match. Apply it to the practice data. Do you get the same result as before?</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>le_lin_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">offset =</span> <span class="dv">1952</span>) {</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>  the_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">I</span>(year <span class="sc">-</span> offset), dat)</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(the_fit)</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="fu">le_lin_fit</span>(j_dat)</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      (Intercept) I(year - offset) </span></span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           67.790            0.239</span></span></code></pre></div>
<p>I had to decide how to handle the offset. Given that I will scale this code up to many countries, which, in theory, might have data for different dates, I chose to set a default of 1952. Strategies that compute the offset from data, either the main Gapminder dataset or the excerpt passed to this function, are also reasonable to consider.</p>
<p>I loathe the names on this return value. This is not my first rodeo and I know that, downstream, these will contaminate variable names and factor levels and show up in public places like plots and tables. Fix names early!</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>le_lin_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">offset =</span> <span class="dv">1952</span>) {</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>  the_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">I</span>(year <span class="sc">-</span> offset), dat)</span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">coef</span>(the_fit), <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;slope&quot;</span>))</span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="fu">le_lin_fit</span>(j_dat)</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; intercept     slope </span></span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    67.790     0.239</span></span></code></pre></div>
<p>Much better!</p>
</div>
<div id="test-on-other-data-and-in-a-clean-workspace" class="section level2 hasAnchor" number="54.6">
<h2 class="hasAnchor"><span class="header-section-number">54.6</span> Test on other data and in a clean workspace<a href="#test-on-other-data-and-in-a-clean-workspace" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It‚Äôs always good to rotate through examples during development. The most common error this will help you catch is when you accidentally hard-wire your example into your function. If you‚Äôre paying attention to your informal tests, you will find it creepy that your function returns <strong>exactly the same results</strong> regardless which input data you give it. This actually happened to me while I was writing this document, I kid you not! I had left <code>j_fit</code> inside the call to <code>coef()</code>, instead of switching it to <code>the_fit</code>. How did I catch that error? I saw the fitted line below, which clearly did not have an intercept in the late 60s and a positive slope, as my first example did. Figures are a mighty weapon in the fight against nonsense. I don‚Äôt trust analyses that have few/no figures.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>j_country <span class="ot">&lt;-</span> <span class="st">&quot;Zimbabwe&quot;</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>(j_dat <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> j_country))</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 √ó 6</span></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    country  continent  year lifeExp      pop gdpPercap</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 Zimbabwe Africa     1952    48.5  3080907      407.</span></span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 Zimbabwe Africa     1957    50.5  3646340      519.</span></span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 Zimbabwe Africa     1962    52.4  4277736      527.</span></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 Zimbabwe Africa     1967    54.0  4995432      570.</span></span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 Zimbabwe Africa     1972    55.6  5861135      799.</span></span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 Zimbabwe Africa     1977    57.7  6642107      686.</span></span>
<span id="cb352-12"><a href="#cb352-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 Zimbabwe Africa     1982    60.4  7636524      789.</span></span>
<span id="cb352-13"><a href="#cb352-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 Zimbabwe Africa     1987    62.4  9216418      706.</span></span>
<span id="cb352-14"><a href="#cb352-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 Zimbabwe Africa     1992    60.4 10704340      693.</span></span>
<span id="cb352-15"><a href="#cb352-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 Zimbabwe Africa     1997    46.8 11404948      792.</span></span>
<span id="cb352-16"><a href="#cb352-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 Zimbabwe Africa     2002    40.0 11926563      672.</span></span>
<span id="cb352-17"><a href="#cb352-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 Zimbabwe Africa     2007    43.5 12311143      470.</span></span>
<span id="cb352-18"><a href="#cb352-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(j_dat, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp))</span>
<span id="cb352-19"><a href="#cb352-19" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb352-20"><a href="#cb352-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="0802_functionnotes_files/figure-html/second-example-scatterplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">le_lin_fit</span>(j_dat)</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; intercept     slope </span></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    55.221    -0.093</span></span></code></pre></div>
<p>The linear fit is comically bad, but yes I believe the visual line and the regression results match up.</p>
<p>It‚Äôs also a good idea to clean out the workspace, rerun the minimum amount of code, and retest your function. This will help you catch another common mistake: accidentally relying on objects that were lying around in the workspace during development but that are not actually defined in your function nor passed as formal arguments.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>le_lin_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">offset =</span> <span class="dv">1952</span>) {</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>  the_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> <span class="fu">I</span>(year <span class="sc">-</span> offset), dat)</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">coef</span>(the_fit), <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;slope&quot;</span>))</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a><span class="fu">le_lin_fit</span>(gapminder <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Zimbabwe&quot;</span>))</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; intercept     slope </span></span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    55.221    -0.093</span></span></code></pre></div>
</div>
<div id="are-we-there-yet" class="section level2 hasAnchor" number="54.7">
<h2 class="hasAnchor"><span class="header-section-number">54.7</span> Are we there yet?<a href="#are-we-there-yet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Yes.</p>
<p>Given how I plan to use this function, I don‚Äôt feel the need to put it under formal unit tests or put in argument validity checks.</p>
</div>
<div id="resources-3" class="section level2 hasAnchor" number="54.8">
<h2 class="hasAnchor"><span class="header-section-number">54.8</span> Resources<a href="#resources-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Packages for runtime assertions (the last 3 seem to be under more active development than <code>assertthat</code>):</p>
<ul>
<li><p>assertthat on <a href="https://CRAN.R-project.org/package=assertthat">cran</a> and <a href="https://github.com/hadley/assertthat">GitHub</a> - <em>the Hadleyverse option</em></p></li>
<li><p>ensurer on <a href="https://CRAN.R-project.org/package=ensurer">cran</a> and <a href="https://github.com/smbache/ensurer">GitHub</a> - <em>general purpose, pipe-friendly</em></p></li>
<li><p>assertr on <a href="https://CRAN.R-project.org/package=assertr">cran</a> and <a href="https://github.com/ropensci/assertr">GitHub</a> - <em>explicitly data pipeline oriented</em></p></li>
<li><p>assertive on <a href="https://CRAN.R-project.org/package=assertive">cran</a> and <a href="https://bitbucket.org/richierocks/assertive/src/master/">Bitbucket</a> - <em>rich set of built-in functions</em></p></li>
<li><p>Hadley Wickham‚Äôs book <a href="http://adv-r.had.co.nz">Advanced R</a> <span class="citation">(<a href="#ref-wickham2015a" role="doc-biblioref">2015</a>)</span>:</p>
<ul>
<li>Section on <a href="http://adv-r.had.co.nz/Exceptions-Debugging.html#defensive-programming">defensive programming</a></li>
<li>Section on <a href="http://adv-r.had.co.nz/Functions.html#function-arguments">function arguments</a></li>
<li>Section on <a href="http://adv-r.had.co.nz/Functions.html#return-values">return values</a></li>
</ul></li>
<li><p>Unit testing with testthat</p>
<ul>
<li>On <a href="https://CRAN.R-project.org/package=testthat">cran</a>, development on <a href="https://github.com/r-lib/testthat">GitHub</a>, main <a href="https://testthat.r-lib.org">webpage</a></li>
</ul></li>
<li><p>Wickham and Bryan‚Äôs <a href="https://r-pkgs.org/index.html">R Packages</a> book <span class="citation">(<a href="#ref-wickham-unpub" role="doc-biblioref">in progress</a>)</span></p>
<ul>
<li><a href="https://r-pkgs.org/tests.html">Testing chapter</a></li>
</ul></li>
<li><p>Wickham‚Äôs <a href="https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf">testthat: Get Started with Testing</a> article in The R Journal <span class="citation">(<a href="#ref-wickham2011b" role="doc-biblioref">2011a</a>)</span>. Maybe this is completely superseded by the newer chapter above? Be aware that parts could be out of date, but I recall it was a helpful read.</p></li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0802_functionnotes.Rmd-->
</div>
</div>
<div id="lab08" class="section level1 hasAnchor" number="55">
<h1 class="hasAnchor"><span class="header-section-number">55</span> Lab: University of Edinburgh Art Collection<a href="#lab08" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The University of Edinburgh Art Collection <em>‚Äúsupports the world-leading research and teaching that happens within the University. Comprised of an astonishing range of objects and ideas spanning two millennia and a multitude of artistic forms, the collection reflects not only the long and rich trajectory of the University, but also major national and international shifts in art history.‚Äù</em><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<blockquote>
<p>Note: See the sidebar <a href="https://collections.ed.ac.uk/art">here</a> and note that there are 3017 pieces in the art collection we‚Äôre collecting data on.</p>
</blockquote>
<p>In this lab, we‚Äôll scrape data on all art pieces in the <a href="https://collections.ed.ac.uk/art/search/*:*/Collection:%22edinburgh+college+of+art%7C%7C%7CEdinburgh+College+of+Art%22">Edinburgh College of Art collection</a>.</p>
<p>The learning goals of this lab are:</p>
<ul>
<li>Web scraping from a single page</li>
<li>Writing functions</li>
<li>Iteration</li>
<li>Writing data</li>
</ul>
<p>Before getting started, let‚Äôs check that a bot has permissions to access pages on this domain.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paths_allowed</span>(<span class="st">&quot;https://collections.ed.ac.uk/art)&quot;</span>)</span></code></pre></div>
<pre><code>## 
 collections.ed.ac.uk</code></pre>
<pre><code>## [1] TRUE</code></pre>
<div id="getting-started-7" class="section level2 hasAnchor" number="55.1">
<h2 class="hasAnchor"><span class="header-section-number">55.1</span> Getting started<a href="#getting-started-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Go to the course GitHub organization and locate your lab repo, which should be named <code>lab-07-uoe-art</code>. Grab the URL of the repo, and fork your own copy.</p>
<p>Run the following (but update it for your name and email!) in the Console to configure Git:</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis)</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">use_git_config</span>(<span class="at">user.name =</span> <span class="st">&quot;Your Name&quot;</span>, </span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">user.email =</span> <span class="st">&quot;your.email@address.com&quot;</span>)</span></code></pre></div>
</div>
<div id="r-scripts-vs.-r-markdown-documents" class="section level2 hasAnchor" number="55.2">
<h2 class="hasAnchor"><span class="header-section-number">55.2</span> R scripts vs.¬†R Markdown documents<a href="#r-scripts-vs.-r-markdown-documents" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Today we will be using both R scripts and R Markdown documents:</p>
<ul>
<li><code>.R</code>: R scripts are plain text files containing <strong>only</strong> code and brief comments,
<ul>
<li>We‚Äôll use R scripts in the web scraping stage and ultimately save the scraped
data as a csv.</li>
</ul></li>
<li><code>.Rmd</code>: R Markdown documents are plain text files containing.
<ul>
<li>We‚Äôll use an R Markdown document in the web analysis stage, where we start
off by reading in the csv file we wrote out in the scraping stage.</li>
</ul></li>
</ul>
<p>Here is the organization of your repo, and the corresponding section in the
lab that each file will be used for:</p>
<pre><code>|-data
|  |- README.md
|-lab-07-uoe-art.Rmd              # analysis
|-lab-07-uoe-art.Rproj            # project management
|-README.md
|-scripts                         # webscraping
|  |- 01-scrape-page-one.R        # scraping a single page
|  |- 02-scrape-page-function.R   # functions
|  |- 03-scrape-page-many.R       # iteration</code></pre>
</div>
<div id="selectorgadget" class="section level2 hasAnchor" number="55.3">
<h2 class="hasAnchor"><span class="header-section-number">55.3</span> SelectorGadget<a href="#selectorgadget" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this lab, I recommend using Google Chrome as your web browser. In case you haven‚Äôt installed the SelectorGadget extension‚Ä¶ go to the <a href="https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb?hl=en">SelectorGadget extension page</a> on the Chrome Web Store and click on ‚ÄúAdd to Chrome‚Äù (big blue button). A pop up window will ask <em>Add ‚ÄúSelectorGadget‚Äù?</em>, click ‚ÄúAdd extension‚Äù.</p>
<p>Another pop up window will ask whether you want to get your extensions on all your computer. If you want this, you can turn on sync, but you don‚Äôt need to for the purpose of this lab.</p>
<p><img src="img/selectorgadget.png" width="89" /></p>
<p>You should now be able to access SelectorGadget by clicking on the icon next to the search bar in the Chrome browser.</p>
<div id="scraping-a-single-page" class="section level3 hasAnchor" number="55.3.1">
<h3 class="hasAnchor"><span class="header-section-number">55.3.1</span> Scraping a single page<a href="#scraping-a-single-page" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p><strong>Tip:</strong> To run the code you can highlight or put your cursor next to the lines of code you want to run and hit Command+Enter.</p>
</blockquote>
<div class="box">
<p>Work in <code>scripts/01-scrape-page-one.R</code>.</p>
</div>
<p>We will start off by scraping data on the first 10 pieces in the collection from
<a href="https://collections.ed.ac.uk/art/search/*:*/Collection:%22edinburgh+college+of+art%7C%7C%7CEdinburgh+College+of+Art%22?offset=0">here</a>.</p>
<p>First, we define a new object called <code>first_url</code>, which is the link above. Then, we read the page at this url with the <code>read_html()</code> function from the <strong>rvest</strong> package. The code for this is already provided in <code>01-scrape-page-one.R</code>.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set url</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>first_url <span class="ot">&lt;-</span> <span class="st">&quot;https://collections.ed.ac.uk/art/search/*:*/Collection:%22edinburgh+college+of+art%7C%7C%7CEdinburgh+College+of+Art%22?offset=0&quot;</span></span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a><span class="co"># read html page</span></span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a>page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(first_url)</span></code></pre></div>
<p>For the ten pieces on this page, we will extract <code>title</code>, <code>artist</code>, and <code>link</code>
information, and put these three variables in a data frame.</p>
</div>
<div id="titles" class="section level3 hasAnchor" number="55.3.2">
<h3 class="hasAnchor"><span class="header-section-number">55.3.2</span> Titles<a href="#titles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let‚Äôs start with titles. We make use of the SelectorGadget to identify the tags for the relevant nodes:</p>
<p><img src="img/iteminfo-h3a.gif" /><!-- --></p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>page <span class="sc">%&gt;%</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;.iteminfo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">&quot;h3 a&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (10)}
##  [1] &lt;a href=&quot;./record/99495?highlight=*:*&quot;&gt;Untitled                          ...
##  [2] &lt;a href=&quot;./record/50464?highlight=*:*&quot;&gt;Unknown                           ...
##  [3] &lt;a href=&quot;./record/99473?highlight=*:*&quot;&gt;Untitled - Portrait of a Woman in ...
##  [4] &lt;a href=&quot;./record/21078?highlight=*:*&quot;&gt;Four Female Heads                 ...
##  [5] &lt;a href=&quot;./record/20807?highlight=*:*&quot;&gt;Seated Male Nude                  ...
##  [6] &lt;a href=&quot;./record/21349?highlight=*:*&quot;&gt;Seascape from a Boat              ...
##  [7] &lt;a href=&quot;./record/99926?highlight=*:*&quot;&gt;Untitled                          ...
##  [8] &lt;a href=&quot;./record/20830?highlight=*:*&quot;&gt;Seated Male Nude                  ...
##  [9] &lt;a href=&quot;./record/21538?highlight=*:*&quot;&gt;Untitled                          ...
## [10] &lt;a href=&quot;./record/99207?highlight=*:*&quot;&gt;No 98                             ...</code></pre>
<p>Then we extract the text with <code>html_text()</code>:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>page <span class="sc">%&gt;%</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;.iteminfo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">&quot;h3 a&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;Untitled                                                                            (1962)&quot;                               
##  [2] &quot;Unknown                                                                            (Circa 1890)&quot;                          
##  [3] &quot;Untitled - Portrait of a Woman in a Hat                                                                            (1974)&quot;
##  [4] &quot;Four Female Heads                                                                            (1959)&quot;                      
##  [5] &quot;Seated Male Nude                                                                            (1960)&quot;                       
##  [6] &quot;Seascape from a Boat                                                                            (1952)&quot;                   
##  [7] &quot;Untitled                                                                            (2002)&quot;                               
##  [8] &quot;Seated Male Nude                                                                            (1957)&quot;                       
##  [9] &quot;Untitled                                                                            (1960)&quot;                               
## [10] &quot;No 98                                                                            (1960)&quot;</code></pre>
<p>And get rid of all the spurious whitespace in the text with <code>str_squish()</code>:</p>
<pre class="marginfigure"><code>Take a look at the help docs for `str_squish()` (with `?str_squish`) to </code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>page <span class="sc">%&gt;%</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;.iteminfo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">&quot;h3 a&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_squish</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;Untitled (1962)&quot;                               
##  [2] &quot;Unknown (Circa 1890)&quot;                          
##  [3] &quot;Untitled - Portrait of a Woman in a Hat (1974)&quot;
##  [4] &quot;Four Female Heads (1959)&quot;                      
##  [5] &quot;Seated Male Nude (1960)&quot;                       
##  [6] &quot;Seascape from a Boat (1952)&quot;                   
##  [7] &quot;Untitled (2002)&quot;                               
##  [8] &quot;Seated Male Nude (1957)&quot;                       
##  [9] &quot;Untitled (1960)&quot;                               
## [10] &quot;No 98 (1960)&quot;</code></pre>
<p>And finally save the resulting data as a vector of length 10:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>titles <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;.iteminfo&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">&quot;h3 a&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_squish</span>()</span></code></pre></div>
</div>
<div id="links" class="section level3 hasAnchor" number="55.3.3">
<h3 class="hasAnchor"><span class="header-section-number">55.3.3</span> Links<a href="#links" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The same nodes that contain the text for the titles also contains information on the links to individual art piece pages for each title. We can extract this information using a new function from the rvest package, <code>html_attr()</code>, which
extracts attributes.</p>
<p>A mini HTML lesson! The following is how we define hyperlinked text in HTML:</p>
<pre><code>&lt;a href=&quot;https://www.google.com&quot;&gt;Seach on Google&lt;/a&gt;</code></pre>
<p>And this is how the text would look like on a webpage: <a href="https://www.google.com">Seach on Google</a>.</p>
<p>Here the text is <code>Seach on Google</code> and the <code>href</code> attribute contains the url
of the website you‚Äôd go to if you click on the hyperlinked text: <code>https://www.google.com</code>.</p>
<p>The moral of the story is: the link is stored in the <code>href</code> attribute.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>page <span class="sc">%&gt;%</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;.iteminfo&quot;</span>) <span class="sc">%&gt;%</span>   <span class="co"># same nodes</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">&quot;h3 a&quot;</span>) <span class="sc">%&gt;%</span>         <span class="co"># as before</span></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)             <span class="co"># but get href attribute instead of text</span></span></code></pre></div>
<pre><code>##  [1] &quot;./record/99495?highlight=*:*&quot; &quot;./record/50464?highlight=*:*&quot;
##  [3] &quot;./record/99473?highlight=*:*&quot; &quot;./record/21078?highlight=*:*&quot;
##  [5] &quot;./record/20807?highlight=*:*&quot; &quot;./record/21349?highlight=*:*&quot;
##  [7] &quot;./record/99926?highlight=*:*&quot; &quot;./record/20830?highlight=*:*&quot;
##  [9] &quot;./record/21538?highlight=*:*&quot; &quot;./record/99207?highlight=*:*&quot;</code></pre>
<p>These don‚Äôt really look like urls as we know them though. They‚Äôre relative
links.</p>
<blockquote>
<p>Note: See the help for <code>str_replace()</code> to find out how it works. Remember that the first argument is passed in from the pipeline, so you just need to define the <code>pattern</code> and <code>replacement</code> arguments.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Click on one of art piece titles in your browser and take note of the url
of the webpage it takes you to. How does that url compare to what we scraped
above? How is it different? Using <code>str_replace()</code>, fix the URLs.</li>
</ol>
</div>
<div id="artists" class="section level3 hasAnchor" number="55.3.4">
<h3 class="hasAnchor"><span class="header-section-number">55.3.4</span> Artists<a href="#artists" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="2" style="list-style-type: decimal">
<li>Fill in the blanks to scrape artist names.</li>
</ol>
</div>
<div id="put-it-altogether" class="section level3 hasAnchor" number="55.3.5">
<h3 class="hasAnchor"><span class="header-section-number">55.3.5</span> Put it altogether<a href="#put-it-altogether" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="3" style="list-style-type: decimal">
<li>Fill in the blanks to organize everything in a tibble.</li>
</ol>
</div>
<div id="scrape-the-next-page" class="section level3 hasAnchor" number="55.3.6">
<h3 class="hasAnchor"><span class="header-section-number">55.3.6</span> Scrape the next page<a href="#scrape-the-next-page" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="4" style="list-style-type: decimal">
<li>Click on the next page, and grab its url. Fill in the blank in
to define a new object: <code>second_url</code>. Copy-paste code from top of the R script
to scrape the new set of art pieces, and save the resulting data frame as
<code>second_ten</code>.</li>
</ol>
</div>
</div>
<div id="functions-2" class="section level2 hasAnchor" number="55.4">
<h2 class="hasAnchor"><span class="header-section-number">55.4</span> Functions<a href="#functions-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p><strong>Mason Comment:</strong> I know that I haven‚Äôt taught you explicitly how to write functions yet. But, you have learned enough from me (and wise Prof.¬†Google) to teach yourself how to do it. Don‚Äôt worry ‚Äì I‚Äôll be covering how to write functions explicitly in the next module. (Try it on your own first, and then take a sneek peak ahead if you want some reassurance that you‚Äôre doing it ‚Äúright‚Äù. I believe in you!</p>
</blockquote>
<div class="box">
<p>Work in <code>scripts/02-scrape-page-function.R</code>.</p>
</div>
<p>You‚Äôve been using R functions, now it‚Äôs time to write your own!</p>
<p>Let‚Äôs start simple. Here is a function that takes in an argument <code>x</code>, and adds 2 to it.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>add_two <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let‚Äôs test it:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add_two</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add_two</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<p>The skeleton for defining functions in R is as follows:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(input){</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># do something with the input(s)</span></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return something</span></span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then, a function for scraping a page should look something like:</p>
<blockquote>
<p><strong>Tip:</strong> Function names should be short but evocative verbs.</p>
</blockquote>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(url){</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># read page at url</span></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract title, link, artist info for n pieces on page</span></span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return a n x 3 tibble</span></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><p>Fill in the blanks using code you already developed in the previous exercises. Name the function <code>scrape_page</code>.</p></li>
<li><p>Test out your new function by running the following in the console. Does the output look right?</p></li>
</ol>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scrape_page</span>(first_url)</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scrape_page</span>(second_url)</span></code></pre></div>
</div>
<div id="iteration" class="section level2 hasAnchor" number="55.5">
<h2 class="hasAnchor"><span class="header-section-number">55.5</span> Iteration<a href="#iteration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="box">
<p>Work in <code>scripts/03-scrape-page-many.R</code>.</p>
</div>
<p>We went from manually scraping individual pages to writing a function to do
the same. Next, we will work on making our workflow a little more efficient
by using R to iterate over all pages that contain information on the art collection.</p>
<blockquote>
<p><strong>Reminder:</strong> The collection has 3017 pieces in total, as of the last time this page was compiled.</p>
</blockquote>
<p>That means we develop a list of URLs (of pages that each have 10 art pieces), and write some code that applies the <code>scrape_page()</code> function to each page, and combines the resulting data frames from each page into a single data frame with 3017 rows and 3 columns.</p>
<div id="list-of-urls" class="section level3 hasAnchor" number="55.5.1">
<h3 class="hasAnchor"><span class="header-section-number">55.5.1</span> List of URLs<a href="#list-of-urls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Click through the first few of the pages in the art collection and observe their URLs to confirm the following pattern:</p>
<pre><code>[sometext]offset=0     # Pieces 1-10
[sometext]offset=10    # Pieces 11-20
[sometext]offset=20    # Pieces 21-30
[sometext]offset=30    # Pieces 31-40
...
[sometext]offset=2900  # Pieces 2900-2909</code></pre>
<p>We can construct these URLs in R by pasting together two pieces: (1) a common
(<code>root</code>) text for the beginning of the URL, and (2) numbers starting at 0, increasing by 10, all the way up to 2900. Two new functions are helpful for accomplishing this: <code>paste0()</code> for pasting two pieces of text and <code>seq()</code> for generating a sequence of numbers.</p>
<ol start="7" style="list-style-type: decimal">
<li>Fill in the blanks to construct the list of URLs.</li>
</ol>
</div>
<div id="mapping" class="section level3 hasAnchor" number="55.5.2">
<h3 class="hasAnchor"><span class="header-section-number">55.5.2</span> Mapping<a href="#mapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we‚Äôre ready to iterate over the list of URLs we constructed. We will do this by <strong>map</strong>ping the function we developed over the list of URLs. There are a series of mapping functions in R (more details on that soon!), and they each take the following form:</p>
<pre><code>map([x], [function to apply to each element of x])</code></pre>
<p>In our case, <code>x</code> is the list of URLs we constructed and the function to apply to each element of <code>x</code> is the function we developed earlier, <code>scrape_page</code>. Now, we want a data frame, so we use <code>map_dfr</code> function:</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dfr</span>(urls, scrape_page)</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Fill in the blanks to scrape all pages, and to create a new data frame called <code>uoe_art</code>.</li>
</ol>
</div>
<div id="write-out-data" class="section level3 hasAnchor" number="55.5.3">
<h3 class="hasAnchor"><span class="header-section-number">55.5.3</span> Write out data<a href="#write-out-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="9" style="list-style-type: decimal">
<li>Finally write out the data frame you constructed into the <code>data</code> folder so that you can use it in the analysis section.</li>
</ol>
</div>
</div>
<div id="analysis" class="section level2 hasAnchor" number="55.6">
<h2 class="hasAnchor"><span class="header-section-number">55.6</span> Analysis<a href="#analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="box">
<p>Work in <code>lab-07-uoe-art.Rmd</code> for the rest of the lab.</p>
</div>
<p>Now that we have a tidy dataset that we can analyze, let‚Äôs do that!</p>
<p>We‚Äôll start with some data cleaning, to clean up the dates that appear at the end of some title text in parentheses. Some of these are years, others are more specific dates, some art pieces have no date information whatsoever, and others have some non-date information in parentheses. This should be interesting to clean up!</p>
<p>First thing we‚Äôll try is to separate the <code>title</code> column into two: one for the
actual <code>title</code> and the other for the <code>date</code> if it exists. In human speak, we
need to</p>
<blockquote>
<p>‚Äúseparate the <code>title</code> column at the first occurence of <code>(</code> and put the contents on one side of the <code>(</code> into a column called <code>title</code> and the contents on the other side into a column called <code>date</code>‚Äù</p>
</blockquote>
<p>Luckily, there‚Äôs a function that does just this: <code>separate()</code>!</p>
<p>Once we have completed separating the single <code>title</code> column into <code>title</code> and <code>date</code>, we need to do further cleanup in the <code>date</code> column to get rid of extraneous <code>)</code>s with <code>str_remove()</code>, capture year information, and save the data as a numeric variable.</p>
<blockquote>
<p><strong>Hint:</strong> Remember escaping special characters from that video? Which video‚Ä¶ oh you know the one. You‚Äôll need to use that trick again.</p>
</blockquote>
<ol start="10" style="list-style-type: decimal">
<li><p>Fill in the blanks in to implement the data wrangling we described above. Note that this approach will result in some warnings when you run the code, and that‚Äôs OK!
Read the warnings, and explain what they mean, and why we are ok with leaving them in given that our objective is to just capture <code>year</code> where it‚Äôs convenient to do so.</p></li>
<li><p>Print out a summary of the dataframe using the <code>skim()</code> function. How many pieces have artist info missing? How many have year info missing?</p></li>
<li><p>Make a histogram of years. Use a reasonable binwidth. Do you see anything out of the ordinary?</p></li>
</ol>
<blockquote>
<p><strong>Hint:</strong> You‚Äôll want to use <code>mutate()</code> and <code>if_else()</code> or <code>case_when()</code> to
implement the correction.</p>
</blockquote>
<ol start="13" style="list-style-type: decimal">
<li><p>Find which piece has the out of the ordinary year and go to its page on the art collection website to find the correct year for it. Can you tell why our code didn‚Äôt capture the correct year information? Correct the error in the data frame and visualize the data again.</p></li>
<li><p>Who is the most commonly featured artist in the collection? Do you know them? Any guess as to why the university has so many pieces from them?</p></li>
</ol>
<blockquote>
<p><strong>Hint:</strong> You‚Äôll want to use a combination of <code>filter()</code> and <code>str_detect()</code>. You will want to read the help for <code>str_detect()</code> at a minimum, and consider how you might capture titles where the word appears as ‚Äúchild‚Äù and ‚ÄúChild‚Äù.</p>
</blockquote>
<ol start="15" style="list-style-type: decimal">
<li>Final question! How many art pieces have the word ‚Äúchild‚Äù in their title? See if you can figure it out, and ask for help if not.</li>
</ol>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0806_lab_art.Rmd-->
</div>
</div>
<div id="part-module-09" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 09<a href="#part-module-09" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-data-and-ethics" class="section level1 hasAnchor" number="56">
<h1 class="hasAnchor"><span class="header-section-number">56</span> Welcome to Data and Ethics<a href="#welcome-to-data-and-ethics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is a bit different than the typical module. We‚Äôll be introducing ideas related to privacy and ethics in the context of data science. There is only one video this week. This week is dedicated to your mid-semester check-in with Mason. I encourage you to watch the video and work your way through the notes. You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYbaiTmldRY2ddsLrHp3z6yO">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-8" class="section level2 hasAnchor" number="56.1">
<h2 class="hasAnchor"><span class="header-section-number">56.1</span> Module Materials<a href="#module-materials-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d18_ethics/d18_ethics.html">Ethics</a></li>
<li><a href="https://datascience4psych.github.io/slides/d19_bias/d19_bias.html">Algorithmic bias</a></li>
</ul></li>
<li>Readings
<ul>
<li><a href="https://blog.conceptnet.io/posts/2017/how-to-make-a-racist-ai-without-really-trying/">How to make a racist AI without really trying</a></li>
<li><a href="https://notstatschat.rbind.io/2018/09/27/how-to-write-a-racist-ai-in-r-without-really-trying/">How to write a racist AI in R without really trying</a></li>
<li>Check out the annotated bibliography.</li>
</ul></li>
<li>Activities
<ul>
<li>Annotated Bibliography</li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab09">Lab</a></li>
</ul></li>
</ul>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Me hearing my students make nuanced and important points during a class discussion of Data Science Ethics: <a href="https://t.co/7TUupLb9MH">pic.twitter.com/7TUupLb9MH</a></p>&mdash; Chelsea Parlett-Pelleriti (@ChelseaParlett) <a href="https://twitter.com/ChelseaParlett/status/1377361474952200194?ref_src=twsrc%5Etfw">March 31, 2021</a></blockquote>

</div>
</div>
<div id="data-science-and-ethics" class="section level1 hasAnchor" number="57">
<h1 class="hasAnchor"><span class="header-section-number">57</span> Data Science and Ethics<a href="#data-science-and-ethics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="module-commentary" class="section level2 hasAnchor" number="57.1">
<h2 class="hasAnchor"><span class="header-section-number">57.1</span> Module Commentary<a href="#module-commentary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/ViXI50uaPOM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="misrepresenting-data" class="section level2 hasAnchor" number="57.2">
<h2 class="hasAnchor"><span class="header-section-number">57.2</span> Misrepresenting Data<a href="#misrepresenting-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/31puixbm9n0" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d18_ethics/d18_ethics.html" width="672" height="400px" data-external="1">
</iframe>
<div id="graph-detective" class="section level3 hasAnchor" number="57.2.1">
<h3 class="hasAnchor"><span class="header-section-number">57.2.1</span> Graph Detective<a href="#graph-detective" class="anchor-section" aria-label="Anchor link to header"></a></h3>
Source: Lucy D‚ÄôAgostino McGowan. <a href="https://livefreeordichotomize.com/2020/05/17/graph-detective/">Graph detective</a>. Live Free or Dichotomize. 17 May 2020.
<center>
<iframe width="900" height="1000" src="https://livefreeordichotomize.com/2020/05/17/graph-detective/" frameborder="0">
</iframe>
</center>
</div>
</div>
<div id="maps" class="section level2 hasAnchor" number="57.3">
<h2 class="hasAnchor"><span class="header-section-number">57.3</span> Maps<a href="#maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe src="https://datascience4psych.github.io/slides/d18_ethics/d18_ethics.html#14" width="672" height="400px" data-external="1">
</iframe>
<!--chapter:end:0901_ethics.Rmd-->
</div>
</div>
<div id="bias" class="section level1 hasAnchor" number="58">
<h1 class="hasAnchor"><span class="header-section-number">58</span> Bias<a href="#bias" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d19_bias/d19_bias.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d19_bias/d19_bias.html" width="672" height="400px" data-external="1">
</iframe>
<div id="curated-videography" class="section level2 hasAnchor" number="58.1">
<h2 class="hasAnchor"><span class="header-section-number">58.1</span> Curated Videography<a href="#curated-videography" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Random commenter: Why does CS need an ethics focus?<br>Me: Because technology hurts people and maybe if doesn‚Äôt have to. <br>Them: Technology is just a tool. <br>Me: That. That is why CS people need more ethics focused training. <br><br>I swear this is 100% real.</p>&mdash; Casey Fiesler is at cfiesler@hci.social (@cfiesler) <a href="https://twitter.com/cfiesler/status/1485423667588780033?ref_src=twsrc%5Etfw">January 24, 2022</a></blockquote>

<div id="data-science-ethics-in-6-minutes" class="section level3 hasAnchor" number="58.1.1">
<h3 class="hasAnchor"><span class="header-section-number">58.1.1</span> Data Science Ethics in 6 Minutes<a href="#data-science-ethics-in-6-minutes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/mA4gypAiRYU" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="ai-for-good-in-the-r-and-python-ecosystems" class="section level3 hasAnchor" number="58.1.2">
<h3 class="hasAnchor"><span class="header-section-number">58.1.2</span> AI for Good in the R and Python ecosystems<a href="#ai-for-good-in-the-r-and-python-ecosystems" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/fgf2VjnhpCs?start=1162" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="are-we-automating-racism" class="section level3 hasAnchor" number="58.1.3">
<h3 class="hasAnchor"><span class="header-section-number">58.1.3</span> Are We Automating Racism?<a href="#are-we-automating-racism" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Ok5sKLXqynQ" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="big-techs-b.s.-about-ai-ethics" class="section level3 hasAnchor" number="58.1.4">
<h3 class="hasAnchor"><span class="header-section-number">58.1.4</span> Big Tech‚Äôs B.S. about AI ethics<a href="#big-techs-b.s.-about-ai-ethics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">After spending a few years cutting through Big Tech&#39;s B.S. about AI ethics, I&#39;ve created a glossary to help you decode what all of their favorite terms actually mean.<br><br>I had way too much fun working on this! Threading some of my favorites below. <a href="https://t.co/h0TGqoFpHA">https://t.co/h0TGqoFpHA</a></p>&mdash; Karen Hao ÈÉùÁèÇÁÅµ @karenhao@mas.to (@_KarenHao) <a href="https://twitter.com/_KarenHao/status/1381981018295578629?ref_src=twsrc%5Etfw">April 13, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Wow, who could have predicted that Google&#39;s mistreatment of <a href="https://twitter.com/timnitGebru?ref_src=twsrc%5Etfw">@timnitGebru</a> and <a href="https://twitter.com/mmitchell_ai?ref_src=twsrc%5Etfw">@mmitchell_ai</a> would have consequences?<br><br>Google still has taken no responsibility for what it did. <a href="https://t.co/FGKc5NSiKR">https://t.co/FGKc5NSiKR</a></p>&mdash; Jonathan Aldrich @ SPLASH (@JAldrichPL) <a href="https://twitter.com/JAldrichPL/status/1451524487275552775?ref_src=twsrc%5Etfw">October 22, 2021</a></blockquote>

</div>
</div>
<div id="annotated-bibliography-instructions" class="section level2 hasAnchor" number="58.2">
<h2 class="hasAnchor"><span class="header-section-number">58.2</span> Annotated Bibliography Instructions<a href="#annotated-bibliography-instructions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An annotated bibliography is a list of citations but with commentary! Ok, more like just an enhanced list where you summarize the source and explain why it is important to include.</p>
<p>Your mission is to add either a citation or an annotation (or both) to this list of Data Science and Ethics Readings.</p>
<ol style="list-style-type: decimal">
<li>Carole Cadwalladr and Emma Graham-Harrison. <a href="https://www.theguardian.com/technology/2018/mar/17/facebook-cambridge-analytica-kogan-data-algorithm">How Cambridge Analytica turned Facebook ‚Äòlikes‚Äô into a lucrative political tool</a>. The Guardian. 17 March 2018.</li>
<li>Chen Wenhong and Anabel Quan-Haase. <a href="https://journals.sagepub.com/doi/full/10.1177/0894439318810734">Big Data Ethics and Politics: Toward New Understandings</a>. Social Science Computer Review. 14 November 2018.</li>
<li>Nitasha Tiku. [Google hired Timnit Gebru to be an outspoken critic of unethical AI. Then she was fired for it.]. (<a href="https://www.washingtonpost.com/technology/2020/12/23/google-timnit-gebru-ai-ethics/" class="uri">https://www.washingtonpost.com/technology/2020/12/23/google-timnit-gebru-ai-ethics/</a>). The Washington Post. 23 December 2020.</li>
<li>Dan Swinhoe. <a href="https://www.csoonline.com/article/3410278/the-biggest-data-breach-fines-penalties-and-settlements-so-far.html">The biggest data breach fines, penalties, and settlements so far</a>. CSO. 5 March 2021.</li>
<li>Sara Morrison.<a href="https://www.vox.com/recode/22250897/facebook-data-privacy-collection-algorithms-extremism">Why you should care about data privacy even if you have ‚Äúnothing to hide‚Äù</a>. Vox. Jan 28 2021.</li>
<li>Richard Van Noorden. <a href="https://www.nature.com/articles/d41586-020-03187-3">The ethical questions that haunt facial-recognition research</a>. Nature. 18 November 2020.</li>
<li>Karen Hao. <a href="https://www.technologyreview.com/2021/04/13/1022568/big-tech-ai-ethics-guide/">Big Tech‚Äôs guide to talking about AI ethics</a>. MIT Technology Review. April 13 2021</li>
<li>Catherine D‚ÄôIgnazio and Lauren F. Klein. <a href="https://mitpressonpubpub.mitpress.mit.edu/data-feminism">Data feminism</a>. Mit Press, 2020.</li>
<li>Inclusive Communication Principles in <a href="https://www.cdc.gov/healthcommunication/Preferred_Terms.html">Health Equity Guiding Principles for Inclusive Communication</a>. CDC, 2022</li>
</ol>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0902_bias.Rmd-->
</div>
</div>
<div id="lab09" class="section level1 hasAnchor" number="59">
<h1 class="hasAnchor"><span class="header-section-number">59</span> Lab: Modeling professor attractiveness and course evaluations<a href="#lab09" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="getting-started-8" class="section level2 hasAnchor" number="59.1">
<h2 class="hasAnchor"><span class="header-section-number">59.1</span> Getting started<a href="#getting-started-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many college courses conclude by giving students the opportunity to evaluate the course and the instructor anonymously. However, the use of these student evaluations as an indicator of course quality and teaching effectiveness is often criticized because these measures may reflect the influence of non-teaching related characteristics, such as the physical appearance of the instructor. The article titled, ‚ÄúBeauty in the classroom: instructors‚Äô pulchritude and putative pedagogical productivity‚Äù (Hamermesh and Parker, 2005) found that instructors who are viewed to be better looking receive higher instructional ratings. (Daniel S. Hamermesh, Amy Parker, Beauty in the classroom: instructors pulchritude and putative pedagogical productivity, Economics of Education Review, Volume 24, Issue 4, August 2005, Pages 369-376, ISSN 0272-7757, 10.1016/j.econedurev.2004.07.013. <a href="http://www.sciencedirect.com/science/article/pii/S0272775704001165" class="uri">http://www.sciencedirect.com/science/article/pii/S0272775704001165</a>.)</p>
<p>For this assignment, you will analyze the data from this study in order to learn what goes into a positive professor evaluation.</p>
<p>The data were gathered from end of semester student evaluations for a large sample of professors from the University of Texas at Austin. In addition, six students rated the professors‚Äô physical appearance. (This is a slightly modified version of the original data set that was released as part of the replication data for Data Analysis Using Regression and Multilevel/Hierarchical Models (Gelman and Hill, 2007).) The result is a data frame where each row contains a different course and columns represent variables about the courses and professors.</p>
<div id="packages-8" class="section level3 hasAnchor" number="59.1.1">
<h3 class="hasAnchor"><span class="header-section-number">59.1.1</span> Packages<a href="#packages-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab, we will work with the <strong>tidyverse</strong>, <strong>openintro</strong>, and <strong>broom</strong> packages.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span></code></pre></div>
</div>
<div id="housekeeping-2" class="section level3 hasAnchor" number="59.1.2">
<h3 class="hasAnchor"><span class="header-section-number">59.1.2</span> Housekeeping<a href="#housekeeping-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="git-configuration-password-caching" class="section level4 hasAnchor" number="59.1.2.1">
<h4 class="hasAnchor"><span class="header-section-number">59.1.2.1</span> Git configuration / password caching<a href="#git-configuration-password-caching" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Configure your Git user name and email. If you cannot remember the instructions, refer to an earlier lab. Also remember that you can cache your password for a limited amount of time.</p>
</div>
<div id="project-name-2" class="section level4 hasAnchor" number="59.1.2.2">
<h4 class="hasAnchor"><span class="header-section-number">59.1.2.2</span> Project name<a href="#project-name-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Update the name of your project to match the lab‚Äôs title.</p>
</div>
</div>
</div>
<div id="warm-up-6" class="section level2 hasAnchor" number="59.2">
<h2 class="hasAnchor"><span class="header-section-number">59.2</span> Warm up<a href="#warm-up-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we introduce the data, let‚Äôs warm up with some simple exercises.</p>
<div id="yaml-3" class="section level3 hasAnchor" number="59.2.1">
<h3 class="hasAnchor"><span class="header-section-number">59.2.1</span> YAML<a href="#yaml-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Open the R Markdown (Rmd) file in your project and knit the document.</p>
</div>
<div id="committing-and-pushing-changes" class="section level3 hasAnchor" number="59.2.2">
<h3 class="hasAnchor"><span class="header-section-number">59.2.2</span> Committing and pushing changes<a href="#committing-and-pushing-changes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Go to the <strong>Git</strong> pane in your RStudio.</li>
<li>View the <strong>Diff</strong> and confirm that you are happy with the changes.</li>
<li>Add a commit message like ‚ÄúUpdate name‚Äù in the <strong>Commit message</strong> box and hit <strong>Commit</strong>.</li>
<li>Click on <strong>Push</strong>. This will prompt a dialog box where you first need to enter your user name, and then your password.</li>
</ul>
</div>
</div>
<div id="the-data-3" class="section level2 hasAnchor" number="59.3">
<h2 class="hasAnchor"><span class="header-section-number">59.3</span> The data<a href="#the-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The dataset we‚Äôll be using is called <code>evals</code> from the <strong>openintro</strong> package. Take a peek at the codebook with <code>?evals</code>.</p>
</div>
<div id="exercises-7" class="section level2 hasAnchor" number="59.4">
<h2 class="hasAnchor"><span class="header-section-number">59.4</span> Exercises<a href="#exercises-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="part-1-exploratory-data-analysis" class="section level3 hasAnchor" number="59.4.1">
<h3 class="hasAnchor"><span class="header-section-number">59.4.1</span> Part 1: Exploratory Data Analysis<a href="#part-1-exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Visualize the distribution of <code>score</code>. Is the distribution skewed? What does that tell you about how students rate courses? Is this what you expected to see? Why, or why not? Include any summary statistics and visualizations you use in your response.</p></li>
<li><p>Visualize and describe the relationship between <code>score</code> and the variable <code>bty_avg</code>, a professor‚Äôs average beauty rating.</p></li>
</ol>
<blockquote>
<p><strong>Hint:</strong> See the help page for the function at <a href="http://ggplot2.tidyverse.org/reference/index.html" class="uri">http://ggplot2.tidyverse.org/reference/index.html</a>.</p>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>Replot the scatterplot from Exercise 3, but this time use <code>geom_jitter()</code>? What does ‚Äújitter‚Äù mean? What was misleading about the initial scatterplot?</li>
</ol>
</div>
<div id="part-2-linear-regression-with-a-numerical-predictor" class="section level3 hasAnchor" number="59.4.2">
<h3 class="hasAnchor"><span class="header-section-number">59.4.2</span> Part 2: Linear regression with a numerical predictor<a href="#part-2-linear-regression-with-a-numerical-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p><strong>Recall:</strong> Linear model is in the form <span class="math inline">\(\hat{y} = b_0 + b_1 x\)</span>.</p>
</blockquote>
<ol start="4" style="list-style-type: decimal">
<li><p>Let‚Äôs see if the apparent trend in the plot is something more than natural variation. Fit a linear model called <code>m_bty</code> to predict average professor evaluation <code>score</code> by average beauty rating (<code>bty_avg</code>). Based on the regression output, write the linear model.</p></li>
<li><p>Replot your visualization from Exercise 3, and add the regression line to this plot in orange color. Turn off the shading for the uncertainty of the line.</p></li>
<li><p>Interpret the slope of the linear model in context of the data.</p></li>
<li><p>Interpret the intercept of the linear model in context of the data. Comment on whether or not the intercept makes sense in this context.</p></li>
<li><p>Determine the <span class="math inline">\(R^2\)</span> of the model and interpret it in context of the data.</p></li>
</ol>
</div>
<div id="part-3-linear-regression-with-a-categorical-predictor" class="section level3 hasAnchor" number="59.4.3">
<h3 class="hasAnchor"><span class="header-section-number">59.4.3</span> Part 3: Linear regression with a categorical predictor<a href="#part-3-linear-regression-with-a-categorical-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="9" style="list-style-type: decimal">
<li><p>Fit a new linear model called <code>m_gen</code> to predict average professor evaluation <code>score</code> based on <code>gender</code> of the professor. Based on the regression output, write the linear model and interpret the slope and intercept in context of the data.</p></li>
<li><p>What is the equation of the line corresponding to male professors? What is it for female professors?</p></li>
<li><p>Fit a new linear model called <code>m_rank</code> to predict average professor evaluation <code>score</code> based on <code>rank</code> of the professor. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data.</p></li>
<li><p>Create a new variable called <code>rank_relevel</code> where <code>"tenure track"</code> is the baseline level.</p></li>
<li><p>Fit a new linear model called <code>m_rank_relevel</code> to predict average professor evaluation <code>score</code> based on <code>rank_relevel</code> of the professor. This is the new (releveled) variable you created in Exercise 13. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data. Also determine and interpret the <span class="math inline">\(R^2\)</span> of the model.</p></li>
<li><p>Create another new variable called <code>tenure_eligible</code> that labels <code>"teaching"</code> faculty as
<code>"no"</code> and labels <code>"tenure track"</code> and <code>"tenured"</code> faculty as <code>"yes"</code>.</p></li>
<li><p>Fit a new linear model called <code>m_tenure_eligible</code> to predict average professor evaluation <code>score</code> based on <code>tenure_eligible</code>ness of the professor. This is the new (regrouped) variable you created in Exercise 15. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data. Also determine and interpret the <span class="math inline">\(R^2\)</span> of the model.</p></li>
</ol>
<!--chapter:end:0903_lab_attractive_evals.Rmd-->
</div>
</div>
</div>
<div id="part-module-10" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 10<a href="#part-module-10" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-modeling-the-tidy-way" class="section level1 hasAnchor" number="60">
<h1 class="hasAnchor"><span class="header-section-number">60</span> Welcome to modeling the tidy way!<a href="#welcome-to-modeling-the-tidy-way" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module introduces you to the ideas behind fitting and interpreting models within the framework of tidymodels. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYbPw5iYzYEzoOKa7mJKNIhq">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>. In the spirit of transparency, I have strong [non-positive][tidymodelthoughts] thoughts on tidymodels, but I also think that it is useful for you to learn them. I have similar feelings about the necessary evil that is ANOVA or SPSS.</p>
<div id="module-materials-9" class="section level2 hasAnchor" number="60.1">
<h2 class="hasAnchor"><span class="header-section-number">60.1</span> Module Materials<a href="#module-materials-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Videos
<ul>
<li>Located in the subchapters of this module</li>
</ul></li>
<li>Slidedecks
<ul>
<li><a href="https://datascience4psych.github.io/slides/d20_language/d20_language.html">Language of Models</a></li>
<li><a href="https://datascience4psych.github.io/slides/d21_fitting/d21_fitting.html">Fitting and interpreting models</a></li>
<li><a href="https://datascience4psych.github.io/slides/d22_nonlinear/d22_nonlinear.html">Modeling non-linear relationships</a></li>
<li><a href="https://datascience4psych.github.io/slides/d23_multiple/d23_multiple.html">Models with multiple predictors</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module</li>
<li>Articles
<ul>
<li><a href="https://core.ac.uk/reader/191832935">Rodgers, J. L. (2010). The epistemology of mathematical and statistical modeling: A quiet methodological revolution. American Psychologist, 65, 1-12.</a></li>
</ul></li>
<li>R4DS
<ul>
<li><a href="https://r4ds.had.co.nz/model-intro.html">Model Section</a>, including
<ul>
<li><a href="https://r4ds.had.co.nz/model-basics.html">Model Basics</a></li>
<li><a href="https://r4ds.had.co.nz/model-building.html">Model Building</a></li>
</ul></li>
</ul></li>
</ul></li>
<li>Lab
<ul>
<li>Lab 10</li>
</ul></li>
</ul>
</div>
</div>
<div id="language-of-models" class="section level1 hasAnchor" number="61">
<h1 class="hasAnchor"><span class="header-section-number">61</span> Language of Models!<a href="#language-of-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d20_language/d20_language.html">here</a> if they do not appear below.</p>
<div id="what-is-a-model" class="section level2 hasAnchor" number="61.1">
<h2 class="hasAnchor"><span class="header-section-number">61.1</span> What is a model?<a href="#what-is-a-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/XbyXxGDFmFQ" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d20_language/d20_language.html#1" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="modeling-the-relationship-between-variables" class="section level2 hasAnchor" number="61.2">
<h2 class="hasAnchor"><span class="header-section-number">61.2</span> Modeling the relationship between variables<a href="#modeling-the-relationship-between-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Y0ehX5VI_Wo" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d20_language/d20_language.html#16" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="fitting-and-interpreting-models" class="section level1 hasAnchor" number="62">
<h1 class="hasAnchor"><span class="header-section-number">62</span> Fitting and interpreting models<a href="#fitting-and-interpreting-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d21_fitting/d21_fitting.html">here</a> if they do not appear below.</p>
<div id="models-with-numerical-explanatory-variables" class="section level2 hasAnchor" number="62.1">
<h2 class="hasAnchor"><span class="header-section-number">62.1</span> Models with numerical explanatory variables<a href="#models-with-numerical-explanatory-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/BVtVIO08KKE" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d21_fitting/d21_fitting.html#1" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="a-more-technical-worked-example" class="section level2 hasAnchor" number="62.2">
<h2 class="hasAnchor"><span class="header-section-number">62.2</span> A More Technical Worked Example<a href="#a-more-technical-worked-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs load our standard libraries:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2 ‚îÄ‚îÄ</span></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tibble  3.1.8      ‚úî dplyr   1.0.10</span></span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî tidyr   1.2.1      ‚úî stringr 1.5.0 </span></span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî readr   2.1.3      ‚úî forcats 0.5.2 </span></span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úî purrr   1.0.0      </span></span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ</span></span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::filter() masks stats::filter()</span></span>
<span id="cb384-11"><a href="#cb384-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ‚úñ dplyr::lag()    masks stats::lag()</span></span></code></pre></div>
<ul>
<li><p>If you‚Äôve taken a regression course, you might recognize this model as a special case of a linear model.</p></li>
<li><p>If you haven‚Äôt, well, it doesn‚Äôt really matter much except‚Ä¶ we can use the <code>lm()</code> function to fit the model.</p></li>
</ul>
<p>The advantage is that <code>lm()</code> easily splits the data into <strong>fitted values</strong> and <strong>residuals</strong>:</p>
<p>Observed value = Fitted value + residual</p>
<p>Let‚Äôs get the fitted values and residuals for each voice part:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>lm_singer <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> voice.part,</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> singer</span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>We can extract the fitted values using <code>fitted.values(lm_singer)</code> and the residuals with <code>residuals(lm_singer)</code> or <code>lm_singer$residuals</code>.</p>
<p>For convenience, we create a data frame with two columns: the voice parts and the residuals.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>res_singer <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">voice_part =</span> singer<span class="sc">$</span>voice.part,</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">residual =</span> <span class="fu">residuals</span>(lm_singer))</span></code></pre></div>
<p>We can also do this with <code>group_by</code> and <code>mutate</code>:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> singer <span class="sc">%&gt;%</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(voice.part) <span class="sc">%&gt;%</span></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> <span class="fu">mean</span>(height),</span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> height <span class="sc">-</span> <span class="fu">mean</span>(height)</span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div id="does-the-linear-model-fit" class="section level3 hasAnchor" number="62.2.1">
<h3 class="hasAnchor"><span class="header-section-number">62.2.1</span> Does the linear model fit?<a href="#does-the-linear-model-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To assess whether the linear model is a good fit to the data, we need to know whether the errors look like they come from normal distributions with the same variance.</p>
<p>The residuals are our estimates of the errors, and so we need to check both normality and homoscedasticity.</p>
</div>
<div id="homoscedasticity" class="section level3 hasAnchor" number="62.2.2">
<h3 class="hasAnchor"><span class="header-section-number">62.2.2</span> Homoscedasticity<a href="#homoscedasticity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a few ways we can look at the residuals. Side-by-side boxplots give a broad overview:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_singer, <span class="fu">aes</span>(<span class="at">x =</span> voice_part, <span class="at">y =</span> residual)) <span class="sc">+</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We can also look at the ecdfs of the residuals for each voice part.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_singer, <span class="fu">aes</span>(<span class="at">x =</span> residual, <span class="at">color =</span> voice_part)) <span class="sc">+</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()</span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>From these plots, it seems like the residuals in each group have approximately the same variance.</p>
</div>
<div id="normality" class="section level3 hasAnchor" number="62.2.3">
<h3 class="hasAnchor"><span class="header-section-number">62.2.3</span> Normality<a href="#normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We also want to examine normality of the residuals, broken up by voice part. We can do this by faceting:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_singer, <span class="fu">aes</span>(<span class="at">sample =</span> residual)) <span class="sc">+</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>voice_part, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-14-1.png" width="576" /></p>
<p>Not only do the lines look reasonably straight, the scales look similar for all eight voice parts. This suggests a model where all of the errors are normal with the <em>same</em> standard deviation. This is convenient because it is the form of a standard linear model:</p>
<p>Singer height = Average height for their voice part + Normal(<span class="math inline">\(0, \sigma^2\)</span>) error.</p>
</div>
<div id="normality-of-pooled-residuals" class="section level3 hasAnchor" number="62.2.4">
<h3 class="hasAnchor"><span class="header-section-number">62.2.4</span> Normality of pooled residuals<a href="#normality-of-pooled-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If the linear model holds, then all the residuals come from the same normal distribution.</p>
<p>We‚Äôve already checked for normality of the residuals within each voice part, but to get a little more power to see divergence from normality, we can pool the residuals and make a normal QQ plot of all the residuals together.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_singer, <span class="fu">aes</span>(<span class="at">sample =</span> residual)) <span class="sc">+</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>()</span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>It‚Äôs easier to check normality if we plot the line that the points should fall on: if we think the points come from a <span class="math inline">\(N(\mu, \sigma^2)\)</span> distribution, they should lie on a line with intercept <span class="math inline">\(\mu\)</span> and slope <span class="math inline">\(\sigma\)</span> (the standard deviation).</p>
<p>In the linear model, we assume that the mean of the error terms is zero. We don‚Äôt know what their variance should be, but we can estimate it using the variance of the residuals.</p>
<p>Therefore, we add a line with the mean of the residuals (which should be zero) as the intercept, and the SD of the residuals as the slope. This is:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_singer, <span class="fu">aes</span>(<span class="at">sample =</span> residual)) <span class="sc">+</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="fu">sd</span>(res_singer<span class="sc">$</span>residual)))</span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="the-actually-correct-way" class="section level3 hasAnchor" number="62.2.5">
<h3 class="hasAnchor"><span class="header-section-number">62.2.5</span> The actually correct way<a href="#the-actually-correct-way" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pedantic note: We should use an <span class="math inline">\(n-8\)</span> denominator instead of <span class="math inline">\(n-1\)</span> in the SD calculation for degrees of freedom reasons. The <span class="math inline">\(n-8\)</span> part is necessary because there are 7 different variables associated with the model we fitted with lm_singer. We can get the SD directly from the linear model:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(res_singer<span class="sc">$</span>residual)</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.47</span></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(lm_singer)<span class="sc">$</span>sigma, <span class="dv">3</span>)</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.5</span></span></code></pre></div>
<p>However, the difference between this and the SD above is negligible.</p>
<p>Add the line:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_singer, <span class="fu">aes</span>(<span class="at">sample =</span> residual)) <span class="sc">+</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">mean</span>(res_singer<span class="sc">$</span>residual), <span class="at">slope =</span> <span class="fu">summary</span>(lm_singer)<span class="sc">$</span>sigma)</span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>The straight line isn‚Äôt absolutely perfect, but it‚Äôs doing a pretty good job.</p>
</div>
<div id="our-final-model" class="section level3 hasAnchor" number="62.2.6">
<h3 class="hasAnchor"><span class="header-section-number">62.2.6</span> Our final model<a href="#our-final-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since the errors seem to be pretty normal, our final model is:</p>
<p>Singer height = Average height for their voice part + Normal(<span class="math inline">\(0, 2.5^2\)</span>) error.</p>
<p>Note: Although normality (or lack thereof) can be important for probabilistic prediction or (sometimes) for inferential data analysis, it‚Äôs relatively unimportant for EDA. If your residuals are about normal that‚Äôs nice, but as long as they‚Äôre not horribly skewed they‚Äôre probably not a problem.</p>
</div>
<div id="what-have-we-learned" class="section level3 hasAnchor" number="62.2.7">
<h3 class="hasAnchor"><span class="header-section-number">62.2.7</span> What have we learned?<a href="#what-have-we-learned" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>About singers:</p>
<ul>
<li><p>We‚Äôve seen that average height increases as the voice part range decreases.</p></li>
<li><p>Within each voice part, the residuals look like they come from a normal distribution with the same variance for each voice part. This suggests that there‚Äôs nothing further we need to do to explain singer heights: we have an average for each voice part, and there is no suggestion of systematic differences beyond that due to voice part.</p></li>
</ul>
<p>About data analysis:</p>
<ul>
<li><p>We can use some of our univariate visualization tools, particularly boxplots and ecdfs, to look for evidence of heteroscedasticity.</p></li>
<li><p>We can use normal QQ plots on both pooled and un-pooled residuals to look for evidence of non-normality.</p></li>
<li><p>If we wanted to do formal tests or parameter estimation for singer heights, we would feel pretty secure using results based on normal theory.</p></li>
</ul>
</div>
<div id="commentary-on-model-performance" class="section level3 hasAnchor" number="62.2.8">
<h3 class="hasAnchor"><span class="header-section-number">62.2.8</span> Commentary on Model Performance<a href="#commentary-on-model-performance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>#&gt; Error in tweet_blockquote(tweet_url = tweet_url, maxwidth = maxwidth,  : 
#&gt;   Not Found (HTTP 404).</code></pre>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">I FUCKING TOLD HIM</p>&mdash; Kevin M. King (@KMKing_Psych) <a href="https://twitter.com/KMKing_Psych/status/1516598327478865923?ref_src=twsrc%5Etfw">April 20, 2022</a></blockquote>

<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm_singer)</span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model_performance(lm_singer)</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ-plot</span></span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_normality</span>(lm_singer), <span class="at">type =</span> <span class="st">&quot;qq&quot;</span>)</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; For confidence bands, please install `qqplotr`.</span></span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="co"># PP-plot</span></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_normality</span>(lm_singer), <span class="at">type =</span> <span class="st">&quot;pp&quot;</span>)</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; For confidence bands, please install `qqplotr`.</span></span></code></pre></div>
<p><img src="1001_fitting_files/figure-html/unnamed-chunk-20-3.png" width="672" /></p>
</div>
</div>
<div id="models-with-categorical-explanatory-variables" class="section level2 hasAnchor" number="62.3">
<h2 class="hasAnchor"><span class="header-section-number">62.3</span> Models with categorical explanatory variables<a href="#models-with-categorical-explanatory-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/7056Lt3yUY4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d21_fitting/d21_fitting.html#29" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="modeling-non-linear-relationships" class="section level1 hasAnchor" number="63">
<h1 class="hasAnchor"><span class="header-section-number">63</span> Modeling non-linear relationships<a href="#modeling-non-linear-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d22_nonlinear/d22_nonlinear.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/tSzwRyO7cNw" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d22_nonlinear/d22_nonlinear.html#1" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="modeling-with-multiple-predictors" class="section level1 hasAnchor" number="64">
<h1 class="hasAnchor"><span class="header-section-number">64</span> Modeling with multiple predictors<a href="#modeling-with-multiple-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d23_multiple/d23_multiple.html">here</a> if they do not appear below.</p>
<div id="the-linear-model-with-multiple-predictors" class="section level2 hasAnchor" number="64.1">
<h2 class="hasAnchor"><span class="header-section-number">64.1</span> The linear model with multiple predictors<a href="#the-linear-model-with-multiple-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/xTv1wqNKbHI" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d23_multiple/d23_multiple.html#2" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="two-numerical-predictors" class="section level2 hasAnchor" number="64.2">
<h2 class="hasAnchor"><span class="header-section-number">64.2</span> Two numerical predictors<a href="#two-numerical-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/SVoazCcAZ-s" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d23_multiple/d23_multiple.html#24" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="my-thoughts-on-tidy-modeling-tidymodelthoughts" class="section level2 hasAnchor" number="64.3">
<h2 class="hasAnchor"><span class="header-section-number">64.3</span> My Thoughts on Tidy Modeling {tidymodelthoughts}<a href="#my-thoughts-on-tidy-modeling-tidymodelthoughts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">That&#39;s a good distinction -- I think tidyverse is good for data cleaning and onboarding undergrads (my lab is very undergrad heavy); but that tidymodels can die in a fire because they don&#39;t report f-tests!!!!</p>&mdash; Prof. Mason Garrison üåàüí´‚ú® (@SMasonGarrison) <a href="https://twitter.com/SMasonGarrison/status/1387230798332506114?ref_src=twsrc%5Etfw">April 28, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Underfitting vs Overfitting in Machine Learning.<a href="https://twitter.com/hashtag/datascience?src=hash&amp;ref_src=twsrc%5Etfw">#datascience</a> <a href="https://twitter.com/hashtag/machinelearning?src=hash&amp;ref_src=twsrc%5Etfw">#machinelearning</a> <a href="https://twitter.com/hashtag/coding?src=hash&amp;ref_src=twsrc%5Etfw">#coding</a> <a href="https://twitter.com/hashtag/programming?src=hash&amp;ref_src=twsrc%5Etfw">#programming</a> <a href="https://twitter.com/hashtag/python?src=hash&amp;ref_src=twsrc%5Etfw">#python</a> <a href="https://twitter.com/hashtag/data?src=hash&amp;ref_src=twsrc%5Etfw">#data</a> <a href="https://twitter.com/hashtag/deeplearning?src=hash&amp;ref_src=twsrc%5Etfw">#deeplearning</a> <a href="https://twitter.com/hashtag/technology?src=hash&amp;ref_src=twsrc%5Etfw">#technology</a> <a href="https://twitter.com/hashtag/dataanalytics?src=hash&amp;ref_src=twsrc%5Etfw">#dataanalytics</a> <a href="https://twitter.com/hashtag/datascientist?src=hash&amp;ref_src=twsrc%5Etfw">#datascientist</a> <a href="https://twitter.com/hashtag/ai?src=hash&amp;ref_src=twsrc%5Etfw">#ai</a> <a href="https://twitter.com/hashtag/computerscience?src=hash&amp;ref_src=twsrc%5Etfw">#computerscience</a> <a href="https://twitter.com/hashtag/tech?src=hash&amp;ref_src=twsrc%5Etfw">#tech</a> <a href="https://twitter.com/hashtag/developer?src=hash&amp;ref_src=twsrc%5Etfw">#developer</a> <a href="https://twitter.com/hashtag/analytics?src=hash&amp;ref_src=twsrc%5Etfw">#analytics</a>  <a href="https://twitter.com/hashtag/iot?src=hash&amp;ref_src=twsrc%5Etfw">#iot</a> <a href="https://twitter.com/hashtag/coder?src=hash&amp;ref_src=twsrc%5Etfw">#coder</a> <a href="https://twitter.com/hashtag/programmerlife?src=hash&amp;ref_src=twsrc%5Etfw">#programmerlife</a> <a href="https://twitter.com/hashtag/100DaysOfCode?src=hash&amp;ref_src=twsrc%5Etfw">#100DaysOfCode</a> <a href="https://twitter.com/hashtag/DeepLearning?src=hash&amp;ref_src=twsrc%5Etfw">#DeepLearning</a> <a href="https://t.co/QRZqeHMsCg">pic.twitter.com/QRZqeHMsCg</a></p>&mdash; Tilok Saha (@tilok_saha) <a href="https://twitter.com/tilok_saha/status/1466017023561912328?ref_src=twsrc%5Etfw">December 1, 2021</a></blockquote>

<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1001_fitting.Rmd-->
</div>
</div>
<div id="notes-on-logistic-regression" class="section level1 hasAnchor" number="65">
<h1 class="hasAnchor"><span class="header-section-number">65</span> Notes on Logistic Regression<a href="#notes-on-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="predicting-categorical-data" class="section level2 hasAnchor" number="65.1">
<h2 class="hasAnchor"><span class="header-section-number">65.1</span> Predicting categorical data<a href="#predicting-categorical-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="spam-filters" class="section level4 hasAnchor" number="65.1.0.1">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.1</span> Spam filters<a href="#spam-filters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Data from 3921 emails and 21 variables on them</li>
<li>Outcome: whether the email is spam or not</li>
<li>Predictors: number of characters, whether the email had ‚ÄúRe:‚Äù in the subject, time at which email was sent, number of times the word ‚Äúinherit‚Äù shows up in the email, etc.</li>
</ul>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(email)</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(email)</span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 3,921</span></span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 21</span></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ spam         &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶</span></span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ to_multiple  &lt;fct&gt; 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶</span></span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ from         &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ‚Ä¶</span></span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ cc           &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 2, 1, 0, 2, 0, ‚Ä¶</span></span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ sent_email   &lt;fct&gt; 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, ‚Ä¶</span></span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ time         &lt;dttm&gt; 2012-01-01 01:16:41, 2012-01-01 02:03:59, 2012-01-01 11:‚Ä¶</span></span>
<span id="cb399-12"><a href="#cb399-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ image        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶</span></span>
<span id="cb399-13"><a href="#cb399-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ attach       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶</span></span>
<span id="cb399-14"><a href="#cb399-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ dollar       &lt;dbl&gt; 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 5, 0, 0, ‚Ä¶</span></span>
<span id="cb399-15"><a href="#cb399-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ winner       &lt;fct&gt; no, no, no, no, no, no, no, no, no, no, no, no, no, no, n‚Ä¶</span></span>
<span id="cb399-16"><a href="#cb399-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ inherit      &lt;dbl&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶</span></span>
<span id="cb399-17"><a href="#cb399-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ viagra       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶</span></span>
<span id="cb399-18"><a href="#cb399-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ password     &lt;dbl&gt; 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, ‚Ä¶</span></span>
<span id="cb399-19"><a href="#cb399-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ num_char     &lt;dbl&gt; 11.370, 10.504, 7.773, 13.256, 1.231, 1.091, 4.837, 7.421‚Ä¶</span></span>
<span id="cb399-20"><a href="#cb399-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ line_breaks  &lt;int&gt; 202, 202, 192, 255, 29, 25, 193, 237, 69, 68, 25, 79, 191‚Ä¶</span></span>
<span id="cb399-21"><a href="#cb399-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ format       &lt;fct&gt; 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, ‚Ä¶</span></span>
<span id="cb399-22"><a href="#cb399-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ re_subj      &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, ‚Ä¶</span></span>
<span id="cb399-23"><a href="#cb399-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ exclaim_subj &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, ‚Ä¶</span></span>
<span id="cb399-24"><a href="#cb399-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ urgent_subj  &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶</span></span>
<span id="cb399-25"><a href="#cb399-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ exclaim_mess &lt;dbl&gt; 0, 1, 6, 48, 1, 1, 1, 18, 1, 0, 2, 1, 0, 10, 4, 10, 20, 0‚Ä¶</span></span>
<span id="cb399-26"><a href="#cb399-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ number       &lt;fct&gt; big, small, small, small, none, none, big, small, small, ‚Ä¶</span></span></code></pre></div>
<blockquote>
<p>Question: Would you expect longer or shorter emails to be spam?</p>
</blockquote>
<pre><code>#&gt; Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use &quot;none&quot; instead as
#&gt; of ggplot2 3.3.4.
#&gt; Picking joint bandwidth of 1.18</code></pre>
<p><img src="1002_logistic_notes_files/figure-html/unnamed-chunk-3-1.png" width="100%" /></p>
<pre><code>#&gt; # A tibble: 2 √ó 2
#&gt;   spam  mean_num_char
#&gt;   &lt;fct&gt;         &lt;dbl&gt;
#&gt; 1 0             11.3 
#&gt; 2 1              5.44</code></pre>
<blockquote>
<p>Question: Would you expect emails that have subjects starting with ‚ÄúRe:‚Äù, ‚ÄúRE:‚Äù, ‚Äúre:‚Äù, or ‚ÄúrE:‚Äù to be spam or not?</p>
</blockquote>
<p><img src="1002_logistic_notes_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="modeling-spam" class="section level4 hasAnchor" number="65.1.0.2">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.2</span> Modeling spam<a href="#modeling-spam" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Both number of characters and whether the message has ‚Äúre:‚Äù in the subject might be related to whether the email is spam. How do we come up with a model that will let us explore this relationship?</p></li>
<li><p>For simplicity, we‚Äôll focus on the number of characters (<code>num_char</code>) as predictor, but the model we describe can be expanded to take multiple predictors as well.</p></li>
</ul>
<p>This isn‚Äôt something we can reasonably fit a linear model to ‚Äì we need something different!</p>
<pre><code>#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
#&gt; ‚Ñπ Please use `linewidth` instead.</code></pre>
<p><img src="1002_logistic_notes_files/figure-html/unnamed-chunk-6-1.png" width="70%" /></p>
</div>
<div id="framing-the-problem" class="section level4 hasAnchor" number="65.1.0.3">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.3</span> Framing the problem<a href="#framing-the-problem" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>We can treat each outcome (spam and not) as successes and failures arising from separate Bernoulli trials
<ul>
<li>Bernoulli trial: a random experiment with exactly two possible outcomes, ‚Äúsuccess‚Äù and ‚Äúfailure‚Äù, in which the probability of success is the same every time the experiment is conducted</li>
</ul></li>
<li>Each Bernoulli trial can have a separate probability of success</li>
</ul>
<p><span class="math display">\[ y_i ‚àº Bern(p) \]</span></p>
<ul>
<li><p>We can then use the predictor variables to model that probability of success, <span class="math inline">\(p_i\)</span></p></li>
<li><p>We can‚Äôt just use a linear model for <span class="math inline">\(p_i\)</span> (since <span class="math inline">\(p_i\)</span> must be between 0 and 1) but we can transform the linear model to have the appropriate range</p></li>
</ul>
</div>
<div id="generalized-linear-models" class="section level4 hasAnchor" number="65.1.0.4">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.4</span> Generalized linear models<a href="#generalized-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>This is a very general way of addressing many problems in regression and the resulting models are called <strong>generalized linear models (GLMs)</strong></p></li>
<li><p>Logistic regression is just one example</p></li>
</ul>
</div>
<div id="three-characteristics-of-glms" class="section level4 hasAnchor" number="65.1.0.5">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.5</span> Three characteristics of GLMs<a href="#three-characteristics-of-glms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All GLMs have the following three characteristics:</p>
<ol style="list-style-type: decimal">
<li><p>A probability distribution describing a generative model for the outcome variable</p></li>
<li><p>A linear model:
<span class="math display">\[\eta = \beta_0 + \beta_1 X_1 + \cdots + \beta_k X_k\]</span></p></li>
<li><p>A link function that relates the linear model to the parameter of the outcome distribution</p></li>
</ol>
</div>
<div id="logistic-regression" class="section level4 hasAnchor" number="65.1.0.6">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.6</span> Logistic regression<a href="#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Logistic regression is a GLM used to model a binary categorical outcome using numerical and categorical predictors</p></li>
<li><p>To finish specifying the Logistic model we just need to define a reasonable link function that connects <span class="math inline">\(\eta_i\)</span> to <span class="math inline">\(p_i\)</span>: logit function</p></li>
<li><p><strong>Logit function:</strong> For <span class="math inline">\(0\le p \le 1\)</span></p></li>
</ul>
<p><span class="math display">\[logit(p) = \log\left(\frac{p}{1-p}\right)\]</span></p>
</div>
<div id="logit-function-visualized" class="section level4 hasAnchor" number="65.1.0.7">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.7</span> Logit function, visualized<a href="#logit-function-visualized" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p =</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.999</span>,</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logit_p =</span> <span class="fu">log</span>(p <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p)))</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> logit_p)) <span class="sc">+</span></span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;logit(p)&quot;</span>) <span class="sc">+</span></span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;logit(p) vs. p&quot;</span>)</span></code></pre></div>
<p><img src="1002_logistic_notes_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="properties-of-the-logit" class="section level4 hasAnchor" number="65.1.0.8">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.8</span> Properties of the logit<a href="#properties-of-the-logit" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>The logit function takes a value between 0 and 1 and maps it to a value between <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(\infty\)</span></p></li>
<li><p>Inverse logit (logistic) function:
<span class="math display">\[g^{-1}(x) = \frac{\exp(x)}{1+\exp(x)} = \frac{1}{1+\exp(-x)}\]</span></p></li>
<li><p>The inverse logit function takes a value between <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(\infty\)</span> and maps it to a value between 0 and 1</p></li>
<li><p>This formulation is also useful for interpreting the model, since the logit can be interpreted as the log odds of a success ‚Äì more on this later</p></li>
</ul>
</div>
<div id="the-logistic-regression-model" class="section level4 hasAnchor" number="65.1.0.9">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.9</span> The logistic regression model<a href="#the-logistic-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Based on the three GLM criteria, we have
<ul>
<li><span class="math inline">\(y_i \sim \text{Bern}(p_i)\)</span></li>
<li><span class="math inline">\(\eta_i = \beta_0+\beta_1 x_{1,i} + \cdots + \beta_n x_{n,i}\)</span></li>
<li><span class="math inline">\(\text{logit}(p_i) = \eta_i\)</span></li>
</ul></li>
<li>From which we get</li>
</ul>
<p><span class="math display">\[p_i = \frac{\exp(\beta_0+\beta_1 x_{1,i} + \cdots + \beta_k x_{k,i})}{1+\exp(\beta_0+\beta_1 x_{1,i} + \cdots + \beta_k x_{k,i})}\]</span></p>
</div>
<div id="modeling-spam-1" class="section level4 hasAnchor" number="65.1.0.10">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.10</span> Modeling spam<a href="#modeling-spam-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In R, we fit a GLM in the same way as a linear model except we</p>
<ul>
<li>specify the model with <code>logistic_reg()</code></li>
<li>use <code>"glm"</code> instead of <code>"lm"</code> as the engine</li>
<li>define <code>family = "binomial"</code> for the link function to be used in the model</li>
</ul>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>spam_fit <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(spam <span class="sc">~</span> num_char,</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> email,</span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a><span class="co">#tidy(spam_fit)</span></span></code></pre></div>
</div>
<div id="spam-model" class="section level4 hasAnchor" number="65.1.0.11">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.11</span> Spam model<a href="#spam-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(spam_fit)</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 √ó 5</span></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   term        estimate std.error statistic   p.value</span></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 (Intercept)  -1.80     0.0716     -25.1  2.04e-139</span></span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 num_char     -0.0621   0.00801     -7.75 9.50e- 15</span></span></code></pre></div>
<p>Model:
<span class="math display">\[\log\left(\frac{p}{1-p}\right) = -1.80-0.0621\times \text{num_char}\]</span></p>
</div>
<div id="pspam-for-an-email-with-2000-characters" class="section level4 hasAnchor" number="65.1.0.12">
<h4 class="hasAnchor"><span class="header-section-number">65.1.0.12</span> P(spam) for an email with 2000 characters<a href="#pspam-for-an-email-with-2000-characters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[\log\left(\frac{p}{1-p}\right) = -1.80-0.0621\times 2\]</span></p>
<p><span class="math display">\[\frac{p}{1-p} = \exp(-1.9242) = 0.15 \rightarrow p = 0.15 \times (1 - p)\]</span></p>
<p><span class="math display">\[p = 0.15 - 0.15p \rightarrow 1.15p = 0.15\]</span></p>
<p><span class="math display">\[p = 0.15 / 1.15 = 0.13\]</span></p>
<blockquote>
<p>Question: What is the probability that an email with 15000 characters is spam? What about an email with 40000 characters?</p>
</blockquote>
<p><img src="1002_logistic_notes_files/figure-html/spam-predict-viz-1.png" width="100%" /></p>
<ul>
<li>2K chars: P(spam) = 0.13</li>
<li>15K chars, P(spam) = 0.06</li>
<li>40K chars, P(spam) = 0.01</li>
</ul>
<blockquote>
<p>Question: Would you prefer an email with 2000 characters to be labeled as spam or not? How about 40,000 characters?</p>
</blockquote>
<p><img src="1002_logistic_notes_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="sensitivity-and-specificity" class="section level2 hasAnchor" number="65.2">
<h2 class="hasAnchor"><span class="header-section-number">65.2</span> Sensitivity and specificity<a href="#sensitivity-and-specificity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="false-positive-and-negative" class="section level4 hasAnchor" number="65.2.0.1">
<h4 class="hasAnchor"><span class="header-section-number">65.2.0.1</span> False positive and negative<a href="#false-positive-and-negative" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<colgroup>
<col width="28%" />
<col width="35%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Email is spam</th>
<th>Email is not spam</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Email labeled spam</td>
<td>True positive</td>
<td>False positive (Type 1 error)</td>
</tr>
<tr class="even">
<td>Email labeled not spam</td>
<td>False negative (Type 2 error)</td>
<td>True negative</td>
</tr>
</tbody>
</table>
<ul>
<li><p>False negative rate = P(Labeled not spam | Email spam) = FN / (TP + FN)</p></li>
<li><p>False positive rate = P(Labeled spam | Email not spam) = FP / (FP + TN)</p></li>
</ul>
</div>
<div id="sensitivity-and-specificity-1" class="section level4 hasAnchor" number="65.2.0.2">
<h4 class="hasAnchor"><span class="header-section-number">65.2.0.2</span> Sensitivity and specificity<a href="#sensitivity-and-specificity-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<colgroup>
<col width="28%" />
<col width="35%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Email is spam</th>
<th>Email is not spam</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Email labeled spam</td>
<td>True positive</td>
<td>False positive (Type 1 error)</td>
</tr>
<tr class="even">
<td>Email labeled not spam</td>
<td>False negative (Type 2 error)</td>
<td>True negative</td>
</tr>
</tbody>
</table>
<ul>
<li>Sensitivity = P(Labeled spam | Email spam) = TP / (TP + FN)
<ul>
<li>Sensitivity = 1 ‚àí False negative rate</li>
</ul></li>
<li>Specificity = P(Labeled not spam | Email not spam) = TN / (FP + TN)
<ul>
<li>Specificity = 1 ‚àí False positive rate</li>
</ul></li>
</ul>
<blockquote>
<p>Question: If you were designing a spam filter, would you want sensitivity and specificity to be high or low? What are the trade-offs associated with each decision?</p>
</blockquote>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1002_logistic_notes.Rmd-->
</div>
</div>
</div>
<div id="lab10" class="section level1 hasAnchor" number="66">
<h1 class="hasAnchor"><span class="header-section-number">66</span> Lab: Modeling with multiple predictors<a href="#lab10" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="professor-attractiveness-and-course-evaluations-pt.-2" class="section level2 hasAnchor" number="66.1">
<h2 class="hasAnchor"><span class="header-section-number">66.1</span> Professor attractiveness and course evaluations, Pt. 2<a href="#professor-attractiveness-and-course-evaluations-pt.-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this lab, we revisit the professor evaluations data we modeled in the previous lab. In the last lab, we modeled evaluation scores using a single predictor at a time. However, this time we use multiple predictors to model evaluation scores.</p>
<p>If you don‚Äôt remember the data, review the previous lab‚Äôs introduction before continuing to the exercises.</p>
</div>
<div id="getting-started-9" class="section level2 hasAnchor" number="66.2">
<h2 class="hasAnchor"><span class="header-section-number">66.2</span> Getting started<a href="#getting-started-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="packages-9" class="section level3 hasAnchor" number="66.2.1">
<h3 class="hasAnchor"><span class="header-section-number">66.2.1</span> Packages<a href="#packages-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab we will work with the <strong>tidyverse</strong>, <strong>openintro</strong>, and <strong>broom</strong> packages.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span></code></pre></div>
<!-- 
### Housekeeping

#### Git configuration / password caching

Configure your Git user name and email. If you cannot remember the instructions, refer to an earlier lab. Also remember that you can cache your password for a limited amount of time.

#### Project name

Update the name of your project to match the lab's title.

-->
</div>
</div>
<div id="warm-up-7" class="section level2 hasAnchor" number="66.3">
<h2 class="hasAnchor"><span class="header-section-number">66.3</span> Warm up<a href="#warm-up-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we introduce the data, let‚Äôs warm up with some simple exercises.</p>
<div id="yaml-4" class="section level3 hasAnchor" number="66.3.1">
<h3 class="hasAnchor"><span class="header-section-number">66.3.1</span> YAML<a href="#yaml-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Open the R Markdown (Rmd) file in your project, change the author name to your name, and knit the document.</p>
</div>
<div id="commiting-and-pushing-changes-2" class="section level3 hasAnchor" number="66.3.2">
<h3 class="hasAnchor"><span class="header-section-number">66.3.2</span> Commiting and pushing changes<a href="#commiting-and-pushing-changes-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Go to the <strong>Git</strong> pane in your RStudio.</li>
<li>View the <strong>Diff</strong> and confirm that you are happy with the changes.</li>
<li>Add a commit message like ‚ÄúUpdate team name‚Äù in the <strong>Commit message</strong> box and hit <strong>Commit</strong>.</li>
<li>Click on <strong>Push</strong>. This will prompt a dialogue box where you first need to enter your user name, and then your password.</li>
</ul>
</div>
</div>
<div id="the-data-4" class="section level2 hasAnchor" number="66.4">
<h2 class="hasAnchor"><span class="header-section-number">66.4</span> The data<a href="#the-data-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The dataset we‚Äôll be using is called <code>evals</code> from the <strong>openintro</strong> package. Take a peek at the codebook with <code>?evals</code>.</p>
</div>
<div id="exercises-8" class="section level2 hasAnchor" number="66.5">
<h2 class="hasAnchor"><span class="header-section-number">66.5</span> Exercises<a href="#exercises-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="part-1-simple-linear-regression" class="section level3 hasAnchor" number="66.5.1">
<h3 class="hasAnchor"><span class="header-section-number">66.5.1</span> Part 1: Simple linear regression<a href="#part-1-simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Fit a linear model (one you have fit before): <code>m_bty</code>, predicting average
professor evaluation <code>score</code> based on average beauty rating (<code>bty_avg</code>) only. Write the
linear model, and note the <span class="math inline">\(R^2\)</span> and the adjusted <span class="math inline">\(R^2\)</span>.</li>
</ol>
</div>
<div id="part-2-multiple-linear-regression" class="section level3 hasAnchor" number="66.5.2">
<h3 class="hasAnchor"><span class="header-section-number">66.5.2</span> Part 2: Multiple linear regression<a href="#part-2-multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="2" style="list-style-type: decimal">
<li><p>Fit a linear model (one you have fit before): <code>m_bty_gen</code>, predicting average
professor evaluation <code>score</code> based on average beauty rating (<code>bty_avg</code>) and <code>gender</code>.
Write the linear model, and note the <span class="math inline">\(R^2\)</span> and the adjusted <span class="math inline">\(R^2\)</span>.</p></li>
<li><p>Interpret the slope and intercept of <code>m_bty_gen</code> in context of the data.</p></li>
<li><p>What percent of the variability in <code>score</code> is explained by the model <code>m_bty_gen</code>.</p></li>
<li><p>What is the equation of the line corresponding to <em>just</em> male professors?</p></li>
<li><p>For two professors who received the same beauty rating, which gender tends to have the higher course evaluation score?</p></li>
<li><p>How does the relationship between beauty and evaluation score vary between male and female professors?</p></li>
<li><p>How do the adjusted <span class="math inline">\(R^2\)</span> values of <code>m_bty_gen</code> and <code>m_bty</code> compare? What does this tell us about how useful <code>gender</code> is in explaining the variability in evaluation scores when we already have information on the beauty score of the professor.</p></li>
<li><p>Compare the slopes of <code>bty_avg</code> under the two models (<code>m_bty</code> and <code>m_bty_gen</code>). Has the addition of <code>gender</code> to the model changed the parameter estimate (slope) for <code>bty_avg</code>?</p></li>
<li><p>Create a new model called <code>m_bty_rank</code> with <code>gender</code> removed and <code>rank</code> added in. Write the equation of the linear model and interpret the slopes and intercept in context of the data.</p></li>
</ol>
</div>
<div id="part-3-the-search-for-the-best-model" class="section level3 hasAnchor" number="66.5.3">
<h3 class="hasAnchor"><span class="header-section-number">66.5.3</span> Part 3: The search for the best model<a href="#part-3-the-search-for-the-best-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Going forward, only consider the following variables as potential predictors: <code>rank</code>, <code>ethnicity</code>, <code>gender</code>, <code>language</code>, <code>age</code>, <code>cls_perc_eval</code>, <code>cls_did_eval</code>, <code>cls_students</code>, <code>cls_level</code>, <code>cls_profs</code>, <code>cls_credits</code>, <code>bty_avg</code>.</p>
<ol start="11" style="list-style-type: decimal">
<li><p>Which variable, on its own, would you expect to be the worst predictor of evaluation scores? Why? <em>Hint:</em> Think about which variable would you expect to not have any association with the professor‚Äôs score.</p></li>
<li><p>Check your suspicions from the previous exercise. Include the model output for that variable in your response.</p></li>
<li><p>Suppose you wanted to fit a full model with the variables listed above. If you are already going to include <code>cls_perc_eval</code> and <code>cls_students</code>, which variable should you not include as an additional predictor? Why?</p></li>
<li><p>Fit a full model with all predictors listed above (except for the one you decided to exclude) in the previous question.</p></li>
<li><p>Using backward-selection with adjusted R-squared as the selection criterion, determine the <em>best</em> model. You do not need to show all steps in your answer, just the output for the final model. Also, write out the linear model for predicting score based on the final model you settle on.</p></li>
<li><p>Interpret the slopes of one numerical and one categorical predictor based on your final model.</p></li>
<li><p>Based on your final model, describe the characteristics of a professor and course at University of Texas at Austin that would be associated with a high evaluation score.</p></li>
<li><p>Would you be comfortable generalizing your conclusions to apply to professors generally (at any university)? Why or why not?</p></li>
</ol>
<!--chapter:end:1003_mlr_course_evals.Rmd-->
</div>
</div>
</div>
<div id="part-module-11" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 11<a href="#part-module-11" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-overfitting-and-cross-validation" class="section level1 hasAnchor" number="67">
<h1 class="hasAnchor"><span class="header-section-number">67</span> Welcome to Overfitting and Cross-Validation<a href="#welcome-to-overfitting-and-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce you to cross-validation and overfitting. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYZ-u6LzBbanrNFoeLHKaLL6">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-10" class="section level2 hasAnchor" number="67.1">
<h2 class="hasAnchor"><span class="header-section-number">67.1</span> Module Materials<a href="#module-materials-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Videos and Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d24_overfitting/d24_overfitting.html">Overfitting</a></li>
<li><a href="https://datascience4psych.github.io/slides/d25_crossvalidation/d25_crossvalidation.html">Cross-validation</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module</li>
<li>Articles
<ul>
<li><a href="https://journals.sagepub.com/doi/full/10.1177/2515245919898466">de Rooij, M., &amp; Weeda, W. (2020). Cross-validation: A method every psychologist should know. Advances in Methods and Practices in Psychological Science, 3(2), 248-263.</a></li>
<li><a href="http://www.quantpsy.org/pubs/maccallum_zhang_preacher_rucker_2002.pdf">MacCallum, R. C., Zhang, S., Preacher, K. J., &amp; Rucker, D. D. (2002). On the practice of dichotomization of quantitative variables. Psychological Methods, 7, 19-40.</a></li>
</ul></li>
<li>R4DS
<ul>
<li><a href="https://r4ds.had.co.nz/many-models.html">Many Models</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="overfitting" class="section level1 hasAnchor" number="68">
<h1 class="hasAnchor"><span class="header-section-number">68</span> Overfitting!<a href="#overfitting" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d24_overfitting/d24_overfitting.html">here</a> if they do not appear below. The embedded code for feature enginering can be found <a href="#featurenotes">here</a></p>
<iframe src="https://datascience4psych.github.io/slides/d24_overfitting/d24_overfitting.html#1" width="672" height="400px" data-external="1">
</iframe>
<div id="prediction" class="section level2 hasAnchor" number="68.1">
<h2 class="hasAnchor"><span class="header-section-number">68.1</span> Prediction<a href="#prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/U70OmbO-DP4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d24_overfitting/d24_overfitting.html#2" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="workflow" class="section level2 hasAnchor" number="68.2">
<h2 class="hasAnchor"><span class="header-section-number">68.2</span> Workflow<a href="#workflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/R4h9u-sQHwI" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d24_overfitting/d24_overfitting.html#17" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="cross-validation" class="section level1 hasAnchor" number="69">
<h1 class="hasAnchor"><span class="header-section-number">69</span> Cross-Validation<a href="#cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d25_crossvalidation/d25_crossvalidation.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/KQ9f8s7RB5g" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d25_crossvalidation/d25_crossvalidation.html" width="672" height="400px" data-external="1">
</iframe>
<div id="v-fold" class="section level2 hasAnchor" number="69.1">
<h2 class="hasAnchor"><span class="header-section-number">69.1</span> V-Fold<a href="#v-fold" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/quEVKV-Tk0Y" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d25_crossvalidation/d25_crossvalidation.html#35" width="672" height="400px" data-external="1">
</iframe>
</div>
</div>
<div id="featurenotes" class="section level1 hasAnchor" number="70">
<h1 class="hasAnchor"><span class="header-section-number">70</span> Notes on Feature Engineering<a href="#featurenotes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="feature-engineering" class="section level2 hasAnchor" number="70.1">
<h2 class="hasAnchor"><span class="header-section-number">70.1</span> Feature engineering<a href="#feature-engineering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>We prefer simple models when possible, but <strong>parsimony</strong> does not mean sacrificing accuracy (or predictive performance) in the interest of simplicity</p></li>
<li><p>Variables that go into the model and how they are represented are just as critical to success of the model</p></li>
<li><p><strong>Feature engineering</strong> allows us to get creative with our predictors in an effort to make them more useful for our model (to increase its predictive performance)</p></li>
</ul>
<div id="same-training-and-testing-sets-as-before" class="section level3 hasAnchor" number="70.1.1">
<h3 class="hasAnchor"><span class="header-section-number">70.1.1</span> Same training and testing sets as before<a href="#same-training-and-testing-sets-as-before" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix random numbers by setting the seed </span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Enables analysis to be reproducible when random numbers are used </span></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1066</span>)</span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Put 80% of the data into the training set </span></span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a>email_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(email, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frames for the two sets:</span></span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">training</span>(email_split)</span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a>test_data  <span class="ot">&lt;-</span> <span class="fu">testing</span>(email_split)</span></code></pre></div>
</div>
<div id="a-simple-approach-mutate" class="section level3 hasAnchor" number="70.1.2">
<h3 class="hasAnchor"><span class="header-section-number">70.1.2</span> A simple approach: <code>mutate()</code><a href="#a-simple-approach-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="sc">%&gt;%</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">date</span>(time),</span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dow  =</span> <span class="fu">wday</span>(time),</span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(time)</span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, date, dow, month) <span class="sc">%&gt;%</span></span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="co"># shuffle to show a variety</span></span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 √ó 4</span></span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   time                date         dow month</span></span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dttm&gt;              &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 2012-02-07 14:17:38 2012-02-07     3     2</span></span>
<span id="cb408-13"><a href="#cb408-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 2012-02-28 19:24:15 2012-02-28     3     2</span></span>
<span id="cb408-14"><a href="#cb408-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 2012-03-12 08:07:31 2012-03-12     2     3</span></span>
<span id="cb408-15"><a href="#cb408-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 2012-01-26 13:58:18 2012-01-26     5     1</span></span>
<span id="cb408-16"><a href="#cb408-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 2012-02-21 08:50:29 2012-02-21     3     2</span></span></code></pre></div>
</div>
</div>
<div id="modeling-workflow-revisited" class="section level2 hasAnchor" number="70.2">
<h2 class="hasAnchor"><span class="header-section-number">70.2</span> Modeling workflow, revisited<a href="#modeling-workflow-revisited" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Create a <strong>recipe</strong> for feature engineering steps to be applied to the training data</p></li>
<li><p>Fit the model to the training data after these steps have been applied</p></li>
<li><p>Using the model estimates from the training data, predict outcomes for the test data</p></li>
<li><p>Evaluate the performance of the model on the test data</p></li>
</ul>
</div>
<div id="building-recipes" class="section level2 hasAnchor" number="70.3">
<h2 class="hasAnchor"><span class="header-section-number">70.3</span> Building recipes<a href="#building-recipes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="initiate-a-recipe" class="section level3 hasAnchor" number="70.3.1">
<h3 class="hasAnchor"><span class="header-section-number">70.3.1</span> Initiate a recipe<a href="#initiate-a-recipe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>email_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>  spam <span class="sc">~</span> .,          <span class="co"># formula</span></span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data  <span class="co"># data to use for cataloguing names and types of variables</span></span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(email_rec)</span></code></pre></div>
<pre><code>#&gt; # A tibble: 21 √ó 4
#&gt;    variable     type      role      source  
#&gt;    &lt;chr&gt;        &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
#&gt;  1 to_multiple  &lt;chr [3]&gt; predictor original
#&gt;  2 from         &lt;chr [3]&gt; predictor original
#&gt;  3 cc           &lt;chr [2]&gt; predictor original
#&gt;  4 sent_email   &lt;chr [3]&gt; predictor original
#&gt;  5 time         &lt;chr [1]&gt; predictor original
#&gt;  6 image        &lt;chr [2]&gt; predictor original
#&gt;  7 attach       &lt;chr [2]&gt; predictor original
#&gt;  8 dollar       &lt;chr [2]&gt; predictor original
#&gt;  9 winner       &lt;chr [3]&gt; predictor original
#&gt; 10 inherit      &lt;chr [2]&gt; predictor original
#&gt; 11 viagra       &lt;chr [2]&gt; predictor original
#&gt; 12 password     &lt;chr [2]&gt; predictor original
#&gt; 13 num_char     &lt;chr [2]&gt; predictor original
#&gt; 14 line_breaks  &lt;chr [2]&gt; predictor original
#&gt; 15 format       &lt;chr [3]&gt; predictor original
#&gt; 16 re_subj      &lt;chr [3]&gt; predictor original
#&gt; 17 exclaim_subj &lt;chr [2]&gt; predictor original
#&gt; 18 urgent_subj  &lt;chr [3]&gt; predictor original
#&gt; 19 exclaim_mess &lt;chr [2]&gt; predictor original
#&gt; 20 number       &lt;chr [3]&gt; predictor original
#&gt; 21 spam         &lt;chr [3]&gt; outcome   original</code></pre>
</div>
<div id="remove-certain-variables" class="section level3 hasAnchor" number="70.3.2">
<h3 class="hasAnchor"><span class="header-section-number">70.3.2</span> Remove certain variables<a href="#remove-certain-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>email_rec <span class="ot">&lt;-</span> email_rec <span class="sc">%&gt;%</span></span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(from, sent_email)</span></code></pre></div>
<pre><code>#&gt; Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;       role #variables
#&gt;    outcome          1
#&gt;  predictor         20
#&gt; 
#&gt; Operations:
#&gt; 
#&gt; Variables removed from, sent_email</code></pre>
</div>
<div id="feature-engineer-date" class="section level3 hasAnchor" number="70.3.3">
<h3 class="hasAnchor"><span class="header-section-number">70.3.3</span> Feature engineer date<a href="#feature-engineer-date" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>email_rec <span class="ot">&lt;-</span> email_rec <span class="sc">%&gt;%</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(time, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;dow&quot;</span>, <span class="st">&quot;month&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(time)</span></code></pre></div>
<pre><code>#&gt; Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;       role #variables
#&gt;    outcome          1
#&gt;  predictor         20
#&gt; 
#&gt; Operations:
#&gt; 
#&gt; Variables removed from, sent_email
#&gt; Date features from time
#&gt; Variables removed time</code></pre>
</div>
<div id="discretize-numeric-variables" class="section level3 hasAnchor" number="70.3.4">
<h3 class="hasAnchor"><span class="header-section-number">70.3.4</span> Discretize numeric variables<a href="#discretize-numeric-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Proceed with major caution! And please be sure to read <a href="http://www.quantpsy.org/pubs/maccallum_zhang_preacher_rucker_2002.pdf">MacCallum, R. C., Zhang, S., Preacher, K. J., &amp; Rucker, D. D. (2002). On the practice of dichotomization of quantitative variables. Psychological Methods, 7, 19-40.</a> and play around with the demo data from Kris‚Äôs website: <a href="http://www.quantpsy.org/mzpr.htm" class="uri">http://www.quantpsy.org/mzpr.htm</a></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>email_rec <span class="ot">&lt;-</span> email_rec <span class="sc">%&gt;%</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_cut</span>(cc, attach, dollar, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_cut</span>(inherit, password, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>))</span></code></pre></div>
<pre><code>#&gt; Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;       role #variables
#&gt;    outcome          1
#&gt;  predictor         20
#&gt; 
#&gt; Operations:
#&gt; 
#&gt; Variables removed from, sent_email
#&gt; Date features from time
#&gt; Variables removed time
#&gt; Cut numeric for cc, attach, dollar
#&gt; Cut numeric for inherit, password</code></pre>
</div>
<div id="create-dummy-variables" class="section level3 hasAnchor" number="70.3.5">
<h3 class="hasAnchor"><span class="header-section-number">70.3.5</span> Create dummy variables<a href="#create-dummy-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>email_rec <span class="ot">&lt;-</span> email_rec <span class="sc">%&gt;%</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>())</span></code></pre></div>
<pre><code>#&gt; Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;       role #variables
#&gt;    outcome          1
#&gt;  predictor         20
#&gt; 
#&gt; Operations:
#&gt; 
#&gt; Variables removed from, sent_email
#&gt; Date features from time
#&gt; Variables removed time
#&gt; Cut numeric for cc, attach, dollar
#&gt; Cut numeric for inherit, password
#&gt; Dummy variables from all_nominal(), -all_outcomes()</code></pre>
</div>
<div id="remove-zero-variance-variables" class="section level3 hasAnchor" number="70.3.6">
<h3 class="hasAnchor"><span class="header-section-number">70.3.6</span> Remove zero variance variables<a href="#remove-zero-variance-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Variables that contain only a single value</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>email_rec <span class="ot">&lt;-</span> email_rec <span class="sc">%&gt;%</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>())</span></code></pre></div>
<pre><code>#&gt; Recipe
#&gt; 
#&gt; Inputs:
#&gt; 
#&gt;       role #variables
#&gt;    outcome          1
#&gt;  predictor         20
#&gt; 
#&gt; Operations:
#&gt; 
#&gt; Variables removed from, sent_email
#&gt; Date features from time
#&gt; Variables removed time
#&gt; Cut numeric for cc, attach, dollar
#&gt; Cut numeric for inherit, password
#&gt; Dummy variables from all_nominal(), -all_outcomes()
#&gt; Zero variance filter on all_predictors()</code></pre>
</div>
<div id="all-in-one-place" class="section level3 hasAnchor" number="70.3.7">
<h3 class="hasAnchor"><span class="header-section-number">70.3.7</span> All in one place<a href="#all-in-one-place" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>email_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(spam <span class="sc">~</span> ., <span class="at">data =</span> email) <span class="sc">%&gt;%</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(from, sent_email) <span class="sc">%&gt;%</span></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_date</span>(time, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;dow&quot;</span>, <span class="st">&quot;month&quot;</span>)) <span class="sc">%&gt;%</span>               </span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_cut</span>(cc, attach, dollar, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_cut</span>(inherit, password, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>())</span></code></pre></div>
</div>
</div>
<div id="building-workflows" class="section level2 hasAnchor" number="70.4">
<h2 class="hasAnchor"><span class="header-section-number">70.4</span> Building workflows<a href="#building-workflows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="define-model" class="section level3 hasAnchor" number="70.4.1">
<h3 class="hasAnchor"><span class="header-section-number">70.4.1</span> Define model<a href="#define-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>email_mod <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>)</span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>email_mod</span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Logistic Regression Model Specification (classification)</span></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Computational engine: glm</span></span></code></pre></div>
</div>
<div id="define-workflow" class="section level3 hasAnchor" number="70.4.2">
<h3 class="hasAnchor"><span class="header-section-number">70.4.2</span> Define workflow<a href="#define-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Workflows</strong> bring together models and recipes so that they can be easily applied to both the training and test data.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>email_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(email_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(email_rec)</span></code></pre></div>
<pre><code>#&gt; ‚ïê‚ïê Workflow ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
#&gt; Preprocessor: Recipe
#&gt; Model: logistic_reg()
#&gt; 
#&gt; ‚îÄ‚îÄ Preprocessor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
#&gt; 7 Recipe Steps
#&gt; 
#&gt; ‚Ä¢ step_rm()
#&gt; ‚Ä¢ step_date()
#&gt; ‚Ä¢ step_rm()
#&gt; ‚Ä¢ step_cut()
#&gt; ‚Ä¢ step_cut()
#&gt; ‚Ä¢ step_dummy()
#&gt; ‚Ä¢ step_zv()
#&gt; 
#&gt; ‚îÄ‚îÄ Model ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
#&gt; Logistic Regression Model Specification (classification)
#&gt; 
#&gt; Computational engine: glm</code></pre>
</div>
<div id="fit-model-to-training-data" class="section level3 hasAnchor" number="70.4.3">
<h3 class="hasAnchor"><span class="header-section-number">70.4.3</span> Fit model to training data<a href="#fit-model-to-training-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>email_fit <span class="ot">&lt;-</span> email_wflow <span class="sc">%&gt;%</span> </span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_data)</span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span></code></pre></div>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(email_fit) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">31</span>)</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 31 √ó 5</span></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    term                estimate std.error statistic  p.value</span></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 (Intercept)        -1.11       0.264    -4.19    2.75e- 5</span></span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 image              -1.72       0.956    -1.80    7.23e- 2</span></span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 viagra              2.30     182.        0.0126  9.90e- 1</span></span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 num_char            0.0469     0.0271    1.73    8.41e- 2</span></span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 line_breaks        -0.00563    0.00151  -3.74    1.87e- 4</span></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 exclaim_subj       -0.0721     0.271    -0.266   7.90e- 1</span></span>
<span id="cb426-11"><a href="#cb426-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 exclaim_mess        0.0101     0.00214   4.72    2.36e- 6</span></span>
<span id="cb426-12"><a href="#cb426-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 to_multiple_X1     -2.83       0.377    -7.49    6.71e-14</span></span>
<span id="cb426-13"><a href="#cb426-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 cc_X.1.68.         -0.178      0.468    -0.382   7.03e- 1</span></span>
<span id="cb426-14"><a href="#cb426-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 attach_X.1.21.      2.39       0.381     6.27    3.61e-10</span></span>
<span id="cb426-15"><a href="#cb426-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 dollar_X.1.64.      0.0544     0.222     0.246   8.06e- 1</span></span>
<span id="cb426-16"><a href="#cb426-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 winner_yes          2.20       0.415     5.31    1.11e- 7</span></span>
<span id="cb426-17"><a href="#cb426-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13 inherit_X.1.5.     -9.14     756.       -0.0121  9.90e- 1</span></span>
<span id="cb426-18"><a href="#cb426-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 inherit_X.5.10.     1.95       1.27      1.54    1.23e- 1</span></span>
<span id="cb426-19"><a href="#cb426-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 password_X.1.5.    -1.71       0.759    -2.25    2.43e- 2</span></span>
<span id="cb426-20"><a href="#cb426-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16 password_X.5.10.  -12.4      420.       -0.0296  9.76e- 1</span></span>
<span id="cb426-21"><a href="#cb426-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 password_X.10.20. -13.8      812.       -0.0170  9.86e- 1</span></span>
<span id="cb426-22"><a href="#cb426-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18 password_X.20.28. -13.8      814.       -0.0170  9.86e- 1</span></span>
<span id="cb426-23"><a href="#cb426-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19 format_X1          -0.802      0.161    -4.99    6.17e- 7</span></span>
<span id="cb426-24"><a href="#cb426-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20 re_subj_X1         -2.78       0.400    -6.97    3.25e-12</span></span>
<span id="cb426-25"><a href="#cb426-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21 urgent_subj_X1      2.57       1.13      2.27    2.31e- 2</span></span>
<span id="cb426-26"><a href="#cb426-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22 number_small       -0.659      0.170    -3.87    1.10e- 4</span></span>
<span id="cb426-27"><a href="#cb426-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23 number_big          0.199      0.246     0.807   4.20e- 1</span></span>
<span id="cb426-28"><a href="#cb426-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24 time_dow_Mon       -0.0207     0.300    -0.0690  9.45e- 1</span></span>
<span id="cb426-29"><a href="#cb426-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25 time_dow_Tue        0.306      0.273     1.12    2.63e- 1</span></span>
<span id="cb426-30"><a href="#cb426-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26 time_dow_Wed       -0.204      0.279    -0.731   4.65e- 1</span></span>
<span id="cb426-31"><a href="#cb426-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27 time_dow_Thu       -0.237      0.297    -0.799   4.24e- 1</span></span>
<span id="cb426-32"><a href="#cb426-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28 time_dow_Fri        0.000702   0.284     0.00247 9.98e- 1</span></span>
<span id="cb426-33"><a href="#cb426-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29 time_dow_Sat        0.261      0.307     0.851   3.95e- 1</span></span>
<span id="cb426-34"><a href="#cb426-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30 time_month_Feb      0.912      0.183     4.97    6.68e- 7</span></span>
<span id="cb426-35"><a href="#cb426-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31 time_month_Mar      0.638      0.187     3.41    6.52e- 4</span></span></code></pre></div>
</div>
<div id="make-predictions-for-test-data" class="section level3 hasAnchor" number="70.4.4">
<h3 class="hasAnchor"><span class="header-section-number">70.4.4</span> Make predictions for test data<a href="#make-predictions-for-test-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>email_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(email_fit, test_data, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(test_data) </span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-4"><a href="#cb427-4" aria-hidden="true" tabindex="-1"></a>email_pred</span>
<span id="cb427-5"><a href="#cb427-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 785 √ó 23</span></span>
<span id="cb427-6"><a href="#cb427-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    .pred_0  .pred_1 spam  to_mu‚Ä¶¬π from     cc sent_‚Ä¶¬≤ time                image attach dollar winner</span></span>
<span id="cb427-7"><a href="#cb427-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt; &lt;int&gt; &lt;fct&gt;   &lt;dttm&gt;              &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt; </span></span>
<span id="cb427-8"><a href="#cb427-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1   0.948 0.0522   0     0       1         0 0       2012-01-01 04:09:49     0      0      0 no    </span></span>
<span id="cb427-9"><a href="#cb427-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2   0.909 0.0914   0     0       1         0 0       2012-01-01 22:00:18     0      0      0 no    </span></span>
<span id="cb427-10"><a href="#cb427-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3   0.971 0.0292   0     0       1         0 0       2012-01-02 00:42:16     0      0      5 no    </span></span>
<span id="cb427-11"><a href="#cb427-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4   0.887 0.113    0     0       1         0 0       2012-01-01 20:58:14     0      0      0 no    </span></span>
<span id="cb427-12"><a href="#cb427-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5   0.992 0.00755  0     0       1         0 0       2012-01-02 02:07:22     0      0     21 no    </span></span>
<span id="cb427-13"><a href="#cb427-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6   1.00  0.000432 0     1       1         2 0       2012-01-02 13:09:45     0      0      0 no    </span></span>
<span id="cb427-14"><a href="#cb427-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7   0.999 0.000691 0     0       1         1 0       2012-01-02 10:12:51     0      0      0 no    </span></span>
<span id="cb427-15"><a href="#cb427-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8   1.00  0.000280 0     1       1         2 0       2012-01-02 16:24:21     0      0      0 no    </span></span>
<span id="cb427-16"><a href="#cb427-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9   0.971 0.0292   0     0       1         0 0       2012-01-03 04:34:50     0      0     11 no    </span></span>
<span id="cb427-17"><a href="#cb427-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10   0.978 0.0224   0     0       1         0 0       2012-01-03 08:33:28     0      0     18 no    </span></span>
<span id="cb427-18"><a href="#cb427-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ‚Ä¶ with 775 more rows, 11 more variables: inherit &lt;dbl&gt;, viagra &lt;dbl&gt;, password &lt;dbl&gt;,</span></span>
<span id="cb427-19"><a href="#cb427-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   num_char &lt;dbl&gt;, line_breaks &lt;int&gt;, format &lt;fct&gt;, re_subj &lt;fct&gt;, exclaim_subj &lt;dbl&gt;,</span></span>
<span id="cb427-20"><a href="#cb427-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   urgent_subj &lt;fct&gt;, exclaim_mess &lt;dbl&gt;, number &lt;fct&gt;, and abbreviated variable names</span></span>
<span id="cb427-21"><a href="#cb427-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   ¬π‚Äãto_multiple, ¬≤‚Äãsent_email</span></span></code></pre></div>
</div>
<div id="evaluate-the-performance" class="section level3 hasAnchor" number="70.4.5">
<h3 class="hasAnchor"><span class="header-section-number">70.4.5</span> Evaluate the performance<a href="#evaluate-the-performance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>email_pred <span class="sc">%&gt;%</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_curve</span>(</span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">truth =</span> spam,</span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a>    .pred_1,</span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span></span>
<span id="cb428-6"><a href="#cb428-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb428-7"><a href="#cb428-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="1101_cv_files/figure-html/roc-1.png" width="672" /></p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>email_pred <span class="sc">%&gt;%</span></span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_auc</span>(</span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">truth =</span> spam,</span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a>    .pred_1,</span>
<span id="cb429-5"><a href="#cb429-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span></span>
<span id="cb429-6"><a href="#cb429-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb429-7"><a href="#cb429-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 3</span></span>
<span id="cb429-8"><a href="#cb429-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .metric .estimator .estimate</span></span>
<span id="cb429-9"><a href="#cb429-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span id="cb429-10"><a href="#cb429-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 roc_auc binary         0.864</span></span></code></pre></div>
</div>
</div>
<div id="making-decisions" class="section level2 hasAnchor" number="70.5">
<h2 class="hasAnchor"><span class="header-section-number">70.5</span> Making decisions<a href="#making-decisions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cutoff-probability-0.5" class="section level3 hasAnchor" number="70.5.1">
<h3 class="hasAnchor"><span class="header-section-number">70.5.1</span> Cutoff probability: 0.5<a href="#cutoff-probability-0.5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we decide to label an email as spam if the model predicts the probability of spam to be <strong>more than 0.5</strong>.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>cutoff_prob <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>email_pred <span class="sc">%&gt;%</span></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spam      =</span> <span class="fu">if_else</span>(spam <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Email is spam&quot;</span>, <span class="st">&quot;Email is not spam&quot;</span>),</span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spam_pred =</span> <span class="fu">if_else</span>(.pred_1 <span class="sc">&gt;</span> cutoff_prob, <span class="st">&quot;Email labelled spam&quot;</span>, <span class="st">&quot;Email labelled not spam&quot;</span>)</span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(spam_pred, spam) <span class="sc">%&gt;%</span></span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> spam, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Email is not spam&quot;</span>, <span class="st">&quot;Email is spam&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Email is not spam</th>
<th align="right">Email is spam</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Email labelled not spam</td>
<td align="right">700</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="left">Email labelled spam</td>
<td align="right">7</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
</div>
<div id="cutoff-probability-0.25" class="section level3 hasAnchor" number="70.5.2">
<h3 class="hasAnchor"><span class="header-section-number">70.5.2</span> Cutoff probability: 0.25<a href="#cutoff-probability-0.25" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we decide to label an email as spam if the model predicts the probability of spam to be <strong>more than 0.25</strong>.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>cutoff_prob <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>email_pred <span class="sc">%&gt;%</span></span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spam      =</span> <span class="fu">if_else</span>(spam <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Email is spam&quot;</span>, <span class="st">&quot;Email is not spam&quot;</span>),</span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spam_pred =</span> <span class="fu">if_else</span>(.pred_1 <span class="sc">&gt;</span> cutoff_prob, <span class="st">&quot;Email labelled spam&quot;</span>, <span class="st">&quot;Email labelled not spam&quot;</span>)</span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb431-7"><a href="#cb431-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(spam_pred, spam) <span class="sc">%&gt;%</span></span>
<span id="cb431-8"><a href="#cb431-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> spam, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb431-9"><a href="#cb431-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Email is not spam&quot;</span>, <span class="st">&quot;Email is spam&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Email is not spam</th>
<th align="right">Email is spam</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Email labelled not spam</td>
<td align="right">673</td>
<td align="right">42</td>
</tr>
<tr class="even">
<td align="left">Email labelled spam</td>
<td align="right">34</td>
<td align="right">36</td>
</tr>
</tbody>
</table>
</div>
<div id="cutoff-probability-0.75" class="section level3 hasAnchor" number="70.5.3">
<h3 class="hasAnchor"><span class="header-section-number">70.5.3</span> Cutoff probability: 0.75<a href="#cutoff-probability-0.75" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we decide to label an email as spam if the model predicts the probability of spam to be <strong>more than 0.75</strong>.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>cutoff_prob <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>email_pred <span class="sc">%&gt;%</span></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spam      =</span> <span class="fu">if_else</span>(spam <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Email is spam&quot;</span>, <span class="st">&quot;Email is not spam&quot;</span>),</span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spam_pred =</span> <span class="fu">if_else</span>(.pred_1 <span class="sc">&gt;</span> cutoff_prob, <span class="st">&quot;Email labelled spam&quot;</span>, <span class="st">&quot;Email labelled not spam&quot;</span>)</span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(spam_pred, spam) <span class="sc">%&gt;%</span></span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> spam, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Email is not spam&quot;</span>, <span class="st">&quot;Email is spam&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Email is not spam</th>
<th align="right">Email is spam</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Email labelled not spam</td>
<td align="right">703</td>
<td align="right">73</td>
</tr>
<tr class="even">
<td align="left">Email labelled spam</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1101_cv.Rmd-->
</div>
</div>
</div>
<div id="odd-notes-on-cross-validation" class="section level1 hasAnchor" number="71">
<h1 class="hasAnchor"><span class="header-section-number">71</span> ODD: Notes on Cross validation<a href="#odd-notes-on-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A too technical and optional deep dive set of notes on cross-validation.</p>
<p>We have:</p>
<ul>
<li><p>Data <span class="math inline">\(X_1, \ldots, X_n\)</span>.</p></li>
<li><p>A tuning parameter <span class="math inline">\(\theta\)</span>. Each value of <span class="math inline">\(\theta\)</span> corresponds to a different set of models.</p></li>
<li><p>A function <span class="math inline">\(L\)</span> that takes a fitted model and a data point and returns a measure of model quality.</p></li>
</ul>
<p>We would like to choose one model from the set of candidate models indexed by <span class="math inline">\(\theta\)</span>.</p>
<div id="example-regression" class="section level2 hasAnchor" number="71.1">
<h2 class="hasAnchor"><span class="header-section-number">71.1</span> Example: Regression<a href="#example-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Data: Pairs of predictors and response variables, <span class="math inline">\((y_i, X_i)\)</span>, <span class="math inline">\(i = 1,\ldots, n\)</span>, <span class="math inline">\(y_i \in \mathbb R\)</span>, <span class="math inline">\(X_i \in \mathbb R^p\)</span></p></li>
<li><p>Models: <span class="math inline">\(y_i = X \beta + \epsilon\)</span>, <span class="math inline">\(\beta_j = 0, j \in S_\theta\)</span>, where <span class="math inline">\(S_\theta \subseteq \{1,\ldots, p\}\)</span>.</p></li>
<li><p>Model quality: Squared-error loss. If <span class="math inline">\(\hat \beta_\theta\)</span> are our estimates of the regression coefficients in model <span class="math inline">\(\theta\)</span>, model quality is measured by
<span class="math display">\[
L(\hat \beta_\theta, (y_i, X_i)) = (y_i - X_i^T \hat \beta_\theta)^2
\]</span></p></li>
</ul>
<p>We want to choose a subset of the predictors that do the best job of explaining the response.</p>
<p>Naive solution: Find the model that has the lowest value for the squared-error loss.</p>
<p>Why doesn‚Äôt this work?</p>
</div>
<div id="example-mixture-models" class="section level2 hasAnchor" number="71.2">
<h2 class="hasAnchor"><span class="header-section-number">71.2</span> Example: Mixture models<a href="#example-mixture-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Data: <span class="math inline">\(x_1,\ldots, x_n\)</span>, <span class="math inline">\(x_i \in \mathbb R\)</span></p></li>
<li><p>Models: Gaussian mixture models with <span class="math inline">\(\theta\)</span> mixture components.</p></li>
<li><p>Model quality: Negative log likelihood of the data. If <span class="math inline">\(\hat p_\theta\)</span> is the density of the fitted model with <span class="math inline">\(\theta\)</span> components, model quality is measured by <span class="math inline">\(L(\hat p_\theta, x_i) = -\log \hat p_\theta(x_i)\)</span>.</p></li>
</ul>
<p>We want to choose the number of mixture components that best explains the data.</p>
<p>Naive solution: Choose the number of mixture components that minimizes the negative log likelihood of the data.</p>
</div>
<div id="better-solution-cross-validation" class="section level2 hasAnchor" number="71.3">
<h2 class="hasAnchor"><span class="header-section-number">71.3</span> Better Solution: Cross validation<a href="#better-solution-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Idea: Instead of measuring model quality on the same data we used to fit the model, we estimate model quality on new data.</p>
<p>If we knew the true distribution of the data, we could simulate new data and use a Monte Carlo estimate based on the simulations.</p>
<p>We can‚Äôt actually get new data, and so we hold some back when we fit the model and then pretend that the held back data is new data.</p>
<p>Procedure:</p>
<ul>
<li><p>Divide the data into <span class="math inline">\(K\)</span> folds</p></li>
<li><p>Let <span class="math inline">\(X^{(k)}\)</span> denote the data in fold <span class="math inline">\(k\)</span>, and let <span class="math inline">\(X^{(-k)}\)</span> denote the data in all the folds except for <span class="math inline">\(k\)</span>.</p></li>
<li><p>For each fold and each value of the tuning parameter <span class="math inline">\(\theta\)</span>, fit the model on <span class="math inline">\(X^{(-k)}\)</span> to get <span class="math inline">\(\hat f_\theta^{(k)}\)</span></p></li>
<li><p>Compute
<span class="math display">\[
\text{CV}(\theta) = \frac{1}{n} \sum_{k=1}^K \sum_{x \in X^{(k)}} L(\hat f_\theta^{(k)}, x)
\]</span></p></li>
<li><p>Choose <span class="math inline">\(\hat \theta = \text{argmin}_{\theta} \text{CV}(\theta)\)</span></p></li>
</ul>
</div>
<div id="example" class="section level2 hasAnchor" number="71.4">
<h2 class="hasAnchor"><span class="header-section-number">71.4</span> Example<a href="#example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), <span class="at">nrow =</span> n)</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true" tabindex="-1"></a>get_rss_submodels <span class="ot">&lt;-</span> <span class="cf">function</span>(n_predictors, y, X) {</span>
<span id="cb433-6"><a href="#cb433-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n_predictors <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb433-7"><a href="#cb433-7" aria-hidden="true" tabindex="-1"></a>        lm_submodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">0</span>)</span>
<span id="cb433-8"><a href="#cb433-8" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb433-9"><a href="#cb433-9" aria-hidden="true" tabindex="-1"></a>        lm_submodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> X[,<span class="dv">1</span><span class="sc">:</span>n_predictors, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb433-10"><a href="#cb433-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb433-11"><a href="#cb433-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(<span class="fu">residuals</span>(lm_submodel)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb433-12"><a href="#cb433-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb433-13"><a href="#cb433-13" aria-hidden="true" tabindex="-1"></a>p_vec <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>p</span>
<span id="cb433-14"><a href="#cb433-14" aria-hidden="true" tabindex="-1"></a>rss <span class="ot">&lt;-</span> <span class="fu">sapply</span>(p_vec, get_rss_submodels, y, X)</span>
<span id="cb433-15"><a href="#cb433-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rss <span class="sc">~</span> p_vec)</span></code></pre></div>
<p><img src="1102_cvnotes_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>get_cv_error <span class="ot">&lt;-</span> <span class="cf">function</span>(n_predictors,</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>                         y,</span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a>                         X,</span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a>                         folds) </span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true" tabindex="-1"></a>    cv_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="fu">unique</span>(folds)))</span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(f <span class="cf">in</span> <span class="fu">unique</span>(folds)) {</span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true" tabindex="-1"></a>        cv_vec[f] <span class="ot">&lt;-</span> <span class="fu">rss_on_held_out</span>(</span>
<span id="cb434-9"><a href="#cb434-9" aria-hidden="true" tabindex="-1"></a>                  n_predictors,</span>
<span id="cb434-10"><a href="#cb434-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y_train =</span> y[folds <span class="sc">!=</span> f],</span>
<span id="cb434-11"><a href="#cb434-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">X_train =</span> X[folds <span class="sc">!=</span> f,],</span>
<span id="cb434-12"><a href="#cb434-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y_test =</span> y[folds <span class="sc">==</span> f],</span>
<span id="cb434-13"><a href="#cb434-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">X_test =</span> X[folds <span class="sc">==</span> f,])</span>
<span id="cb434-14"><a href="#cb434-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb434-15"><a href="#cb434-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(cv_vec))</span>
<span id="cb434-16"><a href="#cb434-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb434-17"><a href="#cb434-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-18"><a href="#cb434-18" aria-hidden="true" tabindex="-1"></a>rss_on_held_out <span class="ot">&lt;-</span> <span class="cf">function</span>(n_predictors,</span>
<span id="cb434-19"><a href="#cb434-19" aria-hidden="true" tabindex="-1"></a>                            y_train,</span>
<span id="cb434-20"><a href="#cb434-20" aria-hidden="true" tabindex="-1"></a>                            X_train,</span>
<span id="cb434-21"><a href="#cb434-21" aria-hidden="true" tabindex="-1"></a>                            y_test,</span>
<span id="cb434-22"><a href="#cb434-22" aria-hidden="true" tabindex="-1"></a>                            X_test) {</span>
<span id="cb434-23"><a href="#cb434-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(n_predictors <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb434-24"><a href="#cb434-24" aria-hidden="true" tabindex="-1"></a>        lm_submodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> <span class="dv">0</span>)</span>
<span id="cb434-25"><a href="#cb434-25" aria-hidden="true" tabindex="-1"></a>        preds_on_test <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(y_test))</span>
<span id="cb434-26"><a href="#cb434-26" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb434-27"><a href="#cb434-27" aria-hidden="true" tabindex="-1"></a>        lm_submodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> X_train[,<span class="dv">1</span><span class="sc">:</span>n_predictors, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb434-28"><a href="#cb434-28" aria-hidden="true" tabindex="-1"></a>        preds_on_test <span class="ot">&lt;-</span> X_test[,<span class="dv">1</span><span class="sc">:</span>n_predictors, drop<span class="ot">=</span> <span class="cn">FALSE</span>] <span class="sc">%*%</span> <span class="fu">coef</span>(lm_submodel)</span>
<span id="cb434-29"><a href="#cb434-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb434-30"><a href="#cb434-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-31"><a href="#cb434-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y_test <span class="sc">-</span> preds_on_test)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb434-32"><a href="#cb434-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb434-33"><a href="#cb434-33" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb434-34"><a href="#cb434-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-35"><a href="#cb434-35" aria-hidden="true" tabindex="-1"></a><span class="do">## normally you would do this at random</span></span>
<span id="cb434-36"><a href="#cb434-36" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="at">each =</span> n <span class="sc">/</span> K)</span>
<span id="cb434-37"><a href="#cb434-37" aria-hidden="true" tabindex="-1"></a>p_vec <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>p</span>
<span id="cb434-38"><a href="#cb434-38" aria-hidden="true" tabindex="-1"></a>cv_errors <span class="ot">&lt;-</span> <span class="fu">sapply</span>(p_vec, get_cv_error, y, X, folds)</span>
<span id="cb434-39"><a href="#cb434-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv_errors <span class="sc">~</span> p_vec)</span></code></pre></div>
<p><img src="1102_cvnotes_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="choice-of-k" class="section level2 hasAnchor" number="71.5">
<h2 class="hasAnchor"><span class="header-section-number">71.5</span> Choice of <span class="math inline">\(K\)</span><a href="#choice-of-k" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Considerations:</p>
<ul>
<li><p>Larger <span class="math inline">\(K\)</span> means more computation (although sometimes there is a shortcut for leave-one-out cross validation)</p></li>
<li><p>Larger <span class="math inline">\(K\)</span> means less bias in the estimate of model accuracy</p></li>
<li><p>Larger <span class="math inline">\(K\)</span> also means more variance in the estimate, so we don‚Äôt necessarily want <span class="math inline">\(K = n\)</span></p></li>
<li><p>Usually choose <span class="math inline">\(K = 5\)</span> or <span class="math inline">\(K = 10\)</span></p></li>
<li><p>If your problem is structured (e.g.¬†time series, spatial), you should choose the folds to respect the structure.</p></li>
</ul>
</div>
<div id="summing-up" class="section level2 hasAnchor" number="71.6">
<h2 class="hasAnchor"><span class="header-section-number">71.6</span> Summing up<a href="#summing-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>We can use simulations to estimate arbitrary functions of our random variables.</p></li>
<li><p>If we know the underlying distribution, we can simply simulate from it (Monte Carlo integration).</p></li>
<li><p>If we don‚Äôt know the underlying distribution, we can ‚Äúsimulate‚Äù from the data by resampling from the data (cross validation; ish). Resampling methods will do well to the extent that the observed data reflect the true data-generating distribution.</p></li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1102_cvnotes.Rmd-->
</div>
</div>
<div id="lab08b" class="section level1 hasAnchor" number="72">
<h1 class="hasAnchor"><span class="header-section-number">72</span> Optional Lab 08b<a href="#lab08b" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This lab is optional. You are welcome to try it and can count it either as a lab or as a portfolio piece.</p>
<p><strong>Disclaimer</strong> It is a more extensive lab that I‚Äôm not quite happy with. Specifically, I think it is a bit too time consuming and I‚Äôve not been able to calibrate the difficulty.</p>
<!--
In this assignment you will work on data scraping.
Having worked through the interactive tutorial titled [Money in politics](https://minecr.shinyapps.io/dsbox-05-moneyinpolitics/) will be a good preparation for this homework assignment as you'll be working with the same website.
-->
<details>
  <summary>Tired of typing your password?</summary>

<p>Chances are your browser has already saved your password, but if not, you can ask Git to save (cache) your password for a period of time, where you indicate the period of time in seconds. For example, if you want it to cache your password for 1 hour, that would be 3,600 seconds. To do so, run the following <b>in the console</b>, <code>usethis::use_git_config(credential.helper = "cache --timeout=3600")</code>. If you want to cache it for a longer amount of time, you can adjust the number in the code.</p>
  
</details>
<div id="packages-10" class="section level2 hasAnchor" number="72.1">
<h2 class="hasAnchor"><span class="header-section-number">72.1</span> Packages<a href="#packages-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this assignment we will use the following packages:</p>
<ul>
<li><strong>tidyverse</strong>: a collection of packages for doing data analysis in a ‚Äútidy‚Äù way</li>
<li><strong>robotstxt</strong>: provides functions to download and parse <code>robots.txt</code> files, making it easy to check if bots (spiders, crawler, scrapers, ‚Ä¶) are allowed to access specific resources on a domain</li>
<li><strong>rvest</strong>: helps you scrape information from web pages</li>
<li><strong>scales</strong>: provides the internal scaling infrastructure used by ggplot2 and gives you tools to override the default breaks, labels, transformations and palettes</li>
</ul>
</div>
<div id="data-collection-via-web-scraping" class="section level2 hasAnchor" number="72.2">
<h2 class="hasAnchor"><span class="header-section-number">72.2</span> Data collection via web scraping<a href="#data-collection-via-web-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="img/opensecrets.png" width="100%" /></p>
<p>The data come from <a href="https://www.opensecrets.org">OpenSecrets.org</a>, a <em>‚Äúwebsite tracking the influence of money on U.S. politics, and how that money affects policy and citizens‚Äô lives‚Äù</em>.
This website is hosted by The Center for Responsive Politics, which is a nonpartisan, independent nonprofit that <em>‚Äútracks money in U.S. politics and its effect on elections and public policy.‚Äù</em><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p>Before getting started, let‚Äôs check that a bot has permissions to access pages on this domain.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robotstxt)</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paths_allowed</span>(<span class="st">&quot;https://www.opensecrets.org&quot;</span>)</span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Our goal is to scrape data for contributions in all election years Open Secrets has data for.
Since that means repeating a task many times, let‚Äôs first write a function that works on the first page.
Confirm it works on a few others.
Then iterate it over pages for all years.</p>
<div class="box">
<p>Complete the following set of steps in the <code>scrape-pac.R</code> file in the <code>scripts</code> folder of your repository.
This file already contains some starter code to help you out.</p>
</div>
<ul>
<li><p>Write a function called <code>scrape_pac()</code> that scrapes information from the Open Secrets webpage for foreign-contected PAC contributions in a given year.
This function should</p>
<ul>
<li>have one input: the URL of the webpage and should return a data frame.</li>
<li>rename variables scraped, using <code>snake_case</code> naming.</li>
<li>clean up the <code>Country of Origin/Parent Company</code> variable with <code>str_squish()</code>.</li>
<li>add a new column to the data frame for <code>year</code>. We will want this information when we ultimately have data from all years, so this is a good time to keep track of it. Our function doesn‚Äôt take a year argument, but the year is embedded in the URL, so we can extract it out of there, and add it as a new column. Use the <code>str_sub()</code> function to extract the last 4 characters from the URL. You will probably want to look at the help for this function to figure out how to specify ‚Äúlast 4 characters‚Äù.</li>
</ul></li>
<li><p>Define the URLs for 2020, 2018, and 1998 contributions.
Then, test your function using these URLs as inputs.
Does the function seem to do what you expected it to do?</p></li>
<li><p>Construct a vector called <code>urls</code> that contains the URLs for each webpage that contains information on foreign-connected PAC contributions for a given year.</p></li>
<li><p>Map the <code>scrape_pac()</code> function over <code>urls</code> in a way that will result in a data frame called <code>pac_all</code>.</p></li>
<li><p>Write the data frame to a csv file called <code>pac-all.csv</code> in the <code>data</code> folder.</p></li>
</ul>
<p><em>‚úÖ‚¨ÜÔ∏è If you haven‚Äôt yet done so, now is definitely a good time to commit and push your changes to GitHub with an appropriate commit message (e.g.¬†‚ÄúData scraping complete‚Äù). Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<ol style="list-style-type: decimal">
<li>In your R Markdown file, load <code>pac-all.csv</code> and report its number of observations and variables using inline code.</li>
</ol>
</div>
<div id="data-cleaning" class="section level2 hasAnchor" number="72.3">
<h2 class="hasAnchor"><span class="header-section-number">72.3</span> Data cleaning<a href="#data-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we clean the <code>pac_all</code> data frame to prepare it for analysis and visualization.
We have two goals in data cleaning:</p>
<ul>
<li><p>Separate the <code>country_parent</code> into two such that country and parent company appear in different columns for country-level analysis.</p></li>
<li><p>Convert contribution amounts in <code>total</code>, <code>dems</code>, and <code>repubs</code> from character strings to numeric values.</p></li>
</ul>
<p>The following exercises walk you through how to make these fixes to the data.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Use the <code>separate()</code> function to separate <code>country_parent</code> into <code>country</code> and <code>parent</code> columns.
Note that country and parent company names are separated by <code>\</code> (which will need to be specified in your function) and also note that there are some entries where the <code>\</code> sign appears twice and in these cases we want to only split the value at the first occurrence of <code>\</code>.
This can be accomplished by setting the <code>extra</code> argument in to <code>"merge"</code> so that the cell is split into only 2 segments, e.g.¬†we want <code>"Denmark/Novo Nordisk A/S"</code> to be split into <code>"Denmark"</code> and <code>"Novo Nordisk A/S"</code>.
(See help for <code>separate()</code> for more on this.) End your code chunk by printing out the top 10 rows of your data frame (if you just type the data frame name it should automatically do this for you).</p></li>
<li><p>Remove the character strings including <code>$</code> and <code>,</code> signs in the <code>total</code>, <code>dems</code>,and <code>repubs</code> columns and convert these columns to numeric.
End your code chunk by printing out the top 10 rows of your data frame (if you just type the data frame name it should automatically do this for you).
A couple hints to help you out:</p>
<ul>
<li><p>The <code>$</code> character is a special character so it will need to be escaped.</p></li>
<li><p>Some contribution amounts are in the millions (e.g.¬†Anheuser-Busch contributed a total of $1,510,897 in 2008).
In this case we need to remove all occurrences of <code>,</code>, which we can do by using <code>str_remove_all()</code> instead of <code>str_remove()</code>.</p></li>
</ul></li>
</ol>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>Now is a good time to knit your document, and commit and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
</div>
<div id="data-visualization-and-interpretation" class="section level2 hasAnchor" number="72.4">
<h2 class="hasAnchor"><span class="header-section-number">72.4</span> Data visualization and interpretation<a href="#data-visualization-and-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol start="4" style="list-style-type: decimal">
<li><p>Create a line plot of total contributions from all foreign-connected PACs in the Canada and Mexico over the years.
Once you have made the plot, write a brief interpretation of what the graph reveals.
Few hints to help you out:</p>
<ul>
<li>Filter for only <code>Canada</code> and <code>Mexico</code>.</li>
<li>Calculate sum of total contributions from PACs for each year for each country by using a sequence of <code>group_by()</code> then <code>summarize()</code>.</li>
<li>Make a plot of total contributions (y-axis) by year (x-axis) where two lines identified by different colors represent each of Canada and Mexico.</li>
</ul></li>
</ol>
<!-- -->
<ol start="5" style="list-style-type: decimal">
<li>Recreate the following visualization. Once you have made the plot, write a brief interpretation of what the graph reveals. Note that these are only UK contributions. You will need to make use of functions from the <strong>scales</strong> package for axis labels as well as from <strong>ggplot2</strong>. Remember, if you can‚Äôt figure out certain bits, you can always ask on the class github!</li>
</ol>
<p><img src="img/plot-to-recreate.png" width="100%" /></p>
<p>üß∂ ‚úÖ ‚¨ÜÔ∏è <em>Knit your document, and commit and push your changes to GitHub with an appropriate commit message. Make sure to commit and push all changed files so that your Git pane is cleared up afterwards.</em></p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1104_labmoney.Rmd-->
</div>
</div>
<div id="part-module-12" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 12<a href="#part-module-12" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-quantifying-uncertainty" class="section level1 hasAnchor" number="73">
<h1 class="hasAnchor"><span class="header-section-number">73</span> Welcome to Quantifying Uncertainty<a href="#welcome-to-quantifying-uncertainty" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce ideas related to representing uncertainty. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYbWGmSnbLIYwdLOnGm6une6">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-11" class="section level2 hasAnchor" number="73.1">
<h2 class="hasAnchor"><span class="header-section-number">73.1</span> Module Materials<a href="#module-materials-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures
<ul>
<li><a href="https://datascience4psych.github.io/slides/d26_quantify/d26_quantify.html">Quantifying Uncertainty</a></li>
<li><a href="https://datascience4psych.github.io/slides/d27_bootstrap/d27_bootstrap.html">Bootstrapping</a></li>
</ul></li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module</li>
<li>About the Needle
* <a href="https://www.theverge.com/2016/11/8/13571216/new-york-times-election-forecast-jitter-needle">The NYT‚Äôs election forecast needle is stressing people out with fake jitter</a>
<ul>
<li><a href="https://qz.com/1924611/its-okay-to-look-at-the-new-york-times-election-needle/">Kopf, D. (2020, November 3). Why it‚Äôs okay to look at the New York Times ‚Äúelection needle‚Äù. Quartz</a></li>
</ul></li>
</ul></li>
<li>Lab
<ul>
<li><a href="#lab12">Lab</a></li>
</ul></li>
</ul>
</div>
</div>
<div id="quantifying-uncertainty" class="section level1 hasAnchor" number="74">
<h1 class="hasAnchor"><span class="header-section-number">74</span> Quantifying Uncertainty!<a href="#quantifying-uncertainty" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d26_quantify/d26_quantify.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/rQp3knI6Pdk" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d26_quantify/d26_quantify.html" width="672" height="400px" data-external="1">
</iframe>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Introduce them to insight::format_p() !</p>&mdash; Brenton Wiernik üè≥Ô∏è‚Äçüåà (@bmwiernik) <a href="https://twitter.com/bmwiernik/status/1451894527187431429?ref_src=twsrc%5Etfw">October 23, 2021</a></blockquote>

</div>
<div id="bootstrapping" class="section level1 hasAnchor" number="75">
<h1 class="hasAnchor"><span class="header-section-number">75</span> Bootstrapping<a href="#bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d27_bootstrap/d27_bootstrap.html">here</a> if they do not appear below.</p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/j0cfD9290-s" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<iframe src="https://datascience4psych.github.io/slides/d27_bootstrap/d27_bootstrap.html" width="672" height="400px" data-external="1">
</iframe>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1201_uncertainty.Rmd-->
</div>
<div id="notes-on-hypothesis-testing" class="section level1 hasAnchor" number="76">
<h1 class="hasAnchor"><span class="header-section-number">76</span> Notes on Hypothesis Testing<a href="#notes-on-hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="hypothesis-testing-for-a-single-proportion" class="section level2 hasAnchor" number="76.1">
<h2 class="hasAnchor"><span class="header-section-number">76.1</span> Hypothesis testing for a single proportion<a href="#hypothesis-testing-for-a-single-proportion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Packages</span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code></pre></div>
<div id="organ-donors" class="section level3 hasAnchor" number="76.1.1">
<h3 class="hasAnchor"><span class="header-section-number">76.1.1</span> Organ donors<a href="#organ-donors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>People providing an organ for donation sometimes seek the help of a special ‚Äúmedical consultant‚Äù. These consultants assist the patient in all aspects of the surgery, with the goal of reducing the possibility of complications during the medical procedure and recovery. Patients might choose a consultant based in part on the historical complication rate of the consultant‚Äôs clients.</p>
<p>One consultant tried to attract patients by noting that the average complication rate for liver donor surgeries in the US is about 10%, but her clients have only had 3 complications in the 62 liver donor surgeries she has facilitated. She claims this is strong evidence that her work meaningfully contributes to reducing complications (and therefore she should be hired!).</p>
</div>
<div id="data-4" class="section level3 hasAnchor" number="76.1.2">
<h3 class="hasAnchor"><span class="header-section-number">76.1.2</span> Data<a href="#data-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>organ_donor <span class="sc">%&gt;%</span></span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(outcome)</span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 √ó 2</span></span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   outcome             n</span></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt;</span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 complication        3</span></span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 no complication    59</span></span></code></pre></div>
</div>
<div id="parameter-vs.-statistic" class="section level3 hasAnchor" number="76.1.3">
<h3 class="hasAnchor"><span class="header-section-number">76.1.3</span> Parameter vs.¬†statistic<a href="#parameter-vs.-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>parameter</strong> for a hypothesis test is the ‚Äútrue‚Äù value of interest. We typically estimate the parameter using a <strong>sample statistic</strong> as a <strong>point estimate</strong>.</p>
<p><span class="math inline">\(p~\)</span>: true rate of complication</p>
<p><span class="math inline">\(\hat{p}~\)</span>: rate of complication in the sample = <span class="math inline">\(\frac{3}{62}\)</span> =
0.048</p>
</div>
<div id="correlation-vs.-causation" class="section level3 hasAnchor" number="76.1.4">
<h3 class="hasAnchor"><span class="header-section-number">76.1.4</span> Correlation vs.¬†causation<a href="#correlation-vs.-causation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Is it possible to assess the consultant‚Äôs claim using the data?</p>
</blockquote>
<p>No.¬†The claim is that there is a causal connection, but the data are observational. For example, maybe patients who can afford a medical consultant can afford better medical care, which can also lead to a lower complication rate. Although it is not possible to assess the causal claim, it is still possible to test for an association using these data. For this question we ask, could the low complication rate of <span class="math inline">\(\hat{p}\)</span> = 0.048 be due to chance?</p>
</div>
<div id="two-claims" class="section level3 hasAnchor" number="76.1.5">
<h3 class="hasAnchor"><span class="header-section-number">76.1.5</span> Two claims<a href="#two-claims" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Null hypothesis:</strong> ‚ÄúThere is nothing going on‚Äù</li>
</ul>
<p>Complication rate for this consultant is no different than the US average of 10%</p>
<ul>
<li><strong>Alternative hypothesis:</strong> ‚ÄúThere is something going on‚Äù</li>
</ul>
<p>Complication rate for this consultant is <strong>lower</strong> than the US average of 10%</p>
</div>
<div id="hypothesis-testing-as-a-court-trial" class="section level3 hasAnchor" number="76.1.6">
<h3 class="hasAnchor"><span class="header-section-number">76.1.6</span> Hypothesis testing as a court trial<a href="#hypothesis-testing-as-a-court-trial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Null hypothesis</strong>, <span class="math inline">\(H_0\)</span>: Defendant is innocent</p></li>
<li><p><strong>Alternative hypothesis</strong>, <span class="math inline">\(H_A\)</span>: Defendant is guilty</p></li>
<li><p><strong>Present the evidence:</strong> Collect data</p></li>
<li><p><strong>Judge the evidence:</strong> ‚ÄúCould these data plausibly have happened by chance if the null hypothesis were true?‚Äù</p>
<ul>
<li>Yes: Fail to reject <span class="math inline">\(H_0\)</span></li>
<li>No: Reject <span class="math inline">\(H_0\)</span></li>
</ul></li>
</ul>
</div>
<div id="hypothesis-testing-framework" class="section level3 hasAnchor" number="76.1.7">
<h3 class="hasAnchor"><span class="header-section-number">76.1.7</span> Hypothesis testing framework<a href="#hypothesis-testing-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Start with a null hypothesis, <span class="math inline">\(H_0\)</span>, that represents the status quo</p></li>
<li><p>Set an alternative hypothesis, <span class="math inline">\(H_A\)</span>, that represents the research question, i.e.¬†what we‚Äôre testing for</p></li>
<li><p>Conduct a hypothesis test under the assumption that the null hypothesis is true and calculate a <strong>p-value</strong> (probability of observed or more extreme outcome given that the null hypothesis is true)</p>
<ul>
<li>if the test results suggest that the data do not provide convincing evidence for the alternative hypothesis, stick with the null hypothesis</li>
<li>if they do, then reject the null hypothesis in favor of the alternative</li>
</ul></li>
</ul>
</div>
<div id="setting-the-hypotheses" class="section level3 hasAnchor" number="76.1.8">
<h3 class="hasAnchor"><span class="header-section-number">76.1.8</span> Setting the hypotheses<a href="#setting-the-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Which of the following is the correct set of hypotheses?</p>
</blockquote>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(H_0: p = 0.10\)</span>; <span class="math inline">\(H_A: p \ne 0.10\)</span> <br></p></li>
<li><p><span class="math inline">\(H_0: p = 0.10\)</span>; <span class="math inline">\(H_A: p &gt; 0.10\)</span> <br></p></li>
<li><p><span class="math inline">\(H_0: p = 0.10\)</span>; <span class="math inline">\(H_A: p &lt; 0.10\)</span> <br></p></li>
<li><p><span class="math inline">\(H_0: \hat{p} = 0.10\)</span>; <span class="math inline">\(H_A: \hat{p} \ne 0.10\)</span> <br></p></li>
<li><p><span class="math inline">\(H_0: \hat{p} = 0.10\)</span>; <span class="math inline">\(H_A: \hat{p} &gt; 0.10\)</span> <br></p></li>
<li><p><span class="math inline">\(H_0: \hat{p} = 0.10\)</span>; <span class="math inline">\(H_A: \hat{p} &lt; 0.10\)</span> <br></p></li>
</ol>
</div>
<div id="simulating-the-null-distribution" class="section level3 hasAnchor" number="76.1.9">
<h3 class="hasAnchor"><span class="header-section-number">76.1.9</span> Simulating the null distribution<a href="#simulating-the-null-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since <span class="math inline">\(H_0: p = 0.10\)</span>, we need to simulate a null distribution where the probability of success (complication) for each trial (patient) is 0.10.</p>
<blockquote>
<p>Describe how you would simulate the null distribution for this study using a bag of chips. How many chips? What colors? What do the colors indicate? How many draws? <b>With replacement</b> or <b>without replacement</b>?</p>
</blockquote>
</div>
<div id="what-do-we-expect" class="section level3 hasAnchor" number="76.1.10">
<h3 class="hasAnchor"><span class="header-section-number">76.1.10</span> What do we expect?<a href="#what-do-we-expect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>When sampling from the null distribution, what is the expected proportion of success (complications)?</p>
</blockquote>
</div>
<div id="simulation" class="section level3 hasAnchor" number="76.1.11">
<h3 class="hasAnchor"><span class="header-section-number">76.1.11</span> Simulation<a href="#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here are some simulations‚Ä¶.</p>
<pre><code>#&gt; sim1
#&gt;    complication no complication 
#&gt;               3              59
#&gt; [1] 0.0484</code></pre>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-5-1.png" width="50%" /></p>
<pre><code>#&gt; sim2
#&gt;    complication no complication 
#&gt;               9              53
#&gt; [1] 0.145</code></pre>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-6-1.png" width="50%" /></p>
<pre><code>#&gt; sim3
#&gt;    complication no complication 
#&gt;               8              54
#&gt; [1] 0.129</code></pre>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>This is getting boring‚Ä¶ We need a way to automate this process!</p>
</div>
<div id="using-tidymodels-to-generate-the-null-distribution" class="section level3 hasAnchor" number="76.1.12">
<h3 class="hasAnchor"><span class="header-section-number">76.1.12</span> Using tidymodels to generate the null distribution<a href="#using-tidymodels-to-generate-the-null-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> organ_donor <span class="sc">%&gt;%</span></span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> outcome,</span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;complication&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">p =</span> <span class="fu">c</span>(<span class="st">&quot;complication&quot;</span> <span class="ot">=</span> <span class="fl">0.10</span>,</span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;no complication&quot;</span> <span class="ot">=</span> <span class="fl">0.90</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb441-7"><a href="#cb441-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">100</span>,</span>
<span id="cb441-8"><a href="#cb441-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;simulate&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb441-9"><a href="#cb441-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;prop&quot;</span>)</span>
<span id="cb441-10"><a href="#cb441-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The `&quot;simulate&quot;` generation type has been renamed to `&quot;draw&quot;`. Use `type = &quot;draw&quot;` instead to quiet this message.</span></span></code></pre></div>
<pre><code>#&gt; Response: outcome (factor)
#&gt; Null Hypothesis: point
#&gt; # A tibble: 100 √ó 2
#&gt;    replicate  stat
#&gt;        &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1         1 0.161
#&gt;  2         2 0.081
#&gt;  3         3 0.161
#&gt;  4         4 0.145
#&gt;  5         5 0.097
#&gt;  6         6 0.145
#&gt;  7         7 0.081
#&gt;  8         8 0.097
#&gt;  9         9 0.161
#&gt; 10        10 0.048
#&gt; # ‚Ä¶ with 90 more rows</code></pre>
</div>
<div id="visualizing-the-null-distribution" class="section level3 hasAnchor" number="76.1.13">
<h3 class="hasAnchor"><span class="header-section-number">76.1.13</span> Visualizing the null distribution<a href="#visualizing-the-null-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>What would you expect the center of the null distribution to be?</p>
</blockquote>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> null_dist, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Null distribution&quot;</span>)</span></code></pre></div>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-10-1.png" width="40%" /></p>
</div>
<div id="calculating-the-p-value-visually" class="section level3 hasAnchor" number="76.1.14">
<h3 class="hasAnchor"><span class="header-section-number">76.1.14</span> Calculating the p-value, visually<a href="#calculating-the-p-value-visually" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>What is the p-value, i.e.¬†in what % of the simulations was the simulated sample proportion at least as extreme as the observed sample proportion?</p>
</blockquote>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-11-1.png" width="50%" /></p>
</div>
<div id="calculating-the-p-value-directly" class="section level3 hasAnchor" number="76.1.15">
<h3 class="hasAnchor"><span class="header-section-number">76.1.15</span> Calculating the p-value, directly<a href="#calculating-the-p-value-directly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>null_dist <span class="sc">%&gt;%</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stat <span class="sc">&lt;=</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">62</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p_value =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(null_dist))</span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 1</span></span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   p_value</span></span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt;</span></span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    0.12</span></span></code></pre></div>
</div>
<div id="significance-level" class="section level3 hasAnchor" number="76.1.16">
<h3 class="hasAnchor"><span class="header-section-number">76.1.16</span> Significance level<a href="#significance-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We often use 5% as the cutoff for whether the p-value is low enough that the data are unlikely to have come from the null model. This cutoff value is called the <strong>significance level</strong>, <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li><p>If p-value &lt; <span class="math inline">\(\alpha\)</span>, reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span>: The data provide convincing evidence for the alternative hypothesis.</p></li>
<li><p>If p-value &gt; <span class="math inline">\(\alpha\)</span>, fail to reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span>: The data do not provide convincing evidence for the alternative hypothesis.</p></li>
</ul>
</div>
<div id="conclusion" class="section level3 hasAnchor" number="76.1.17">
<h3 class="hasAnchor"><span class="header-section-number">76.1.17</span> Conclusion<a href="#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>What is the conclusion of the hypothesis test?</p>
</blockquote>
<p>Since the p-value is greater than the significance level, we fail to reject the null hypothesis.
These data do not provide convincing evidence that this consultant incurs a lower complication rate than 10% (overall US complication rate).</p>
</div>
<div id="lets-get-real" class="section level3 hasAnchor" number="76.1.18">
<h3 class="hasAnchor"><span class="header-section-number">76.1.18</span> Let‚Äôs get real<a href="#lets-get-real" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>100 simulations is not sufficient</p></li>
<li><p>We usually simulate around 15,000 times to get an accurate distribution, but we‚Äôll do 1,000 here for efficiency.</p></li>
</ul>
</div>
<div id="run-the-test" class="section level3 hasAnchor" number="76.1.19">
<h3 class="hasAnchor"><span class="header-section-number">76.1.19</span> Run the test<a href="#run-the-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> organ_donor <span class="sc">%&gt;%</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> outcome,</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;complication&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">p =</span> <span class="fu">c</span>(<span class="st">&quot;complication&quot;</span> <span class="ot">=</span> <span class="fl">0.10</span>,</span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;no complication&quot;</span> <span class="ot">=</span> <span class="fl">0.90</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>,</span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;simulate&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;prop&quot;</span>)</span>
<span id="cb445-10"><a href="#cb445-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The `&quot;simulate&quot;` generation type has been renamed to `&quot;draw&quot;`. Use `type = &quot;draw&quot;` instead to quiet this message.</span></span></code></pre></div>
</div>
<div id="visualize-and-calculate" class="section level3 hasAnchor" number="76.1.20">
<h3 class="hasAnchor"><span class="header-section-number">76.1.20</span> Visualize and calculate<a href="#visualize-and-calculate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> null_dist, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">62</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a>null_dist <span class="sc">%&gt;%</span></span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stat <span class="sc">&lt;=</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">62</span>) <span class="sc">%&gt;%</span></span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p_value =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(null_dist))</span>
<span id="cb447-5"><a href="#cb447-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span id="cb447-6"><a href="#cb447-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   p_value</span></span>
<span id="cb447-7"><a href="#cb447-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt;</span></span>
<span id="cb447-8"><a href="#cb447-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   0.124</span></span></code></pre></div>
</div>
</div>
<div id="one-vs.-two-sided-hypothesis-tests" class="section level2 hasAnchor" number="76.2">
<h2 class="hasAnchor"><span class="header-section-number">76.2</span> One vs.¬†two sided hypothesis tests<a href="#one-vs.-two-sided-hypothesis-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="types-of-alternative-hypotheses" class="section level3 hasAnchor" number="76.2.1">
<h3 class="hasAnchor"><span class="header-section-number">76.2.1</span> Types of alternative hypotheses<a href="#types-of-alternative-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>One sided (one tailed) alternatives: The parameter is hypothesized to be less than or greater than the null value, &lt; or &gt;</p></li>
<li><p>Two sided (two tailed) alternatives: The parameter is hypothesized to be not equal to the null value, <span class="math inline">\(\ne\)</span></p>
<ul>
<li>Calculated as two times the tail area beyond the observed sample statistic</li>
<li>More objective, and hence more widely preferred</li>
</ul></li>
</ul>
<blockquote>
<p>Average systolic blood pressure of people with Stage 1 Hypertension is 150 mm Hg.</p>
</blockquote>
<blockquote>
<p>Suppose we want to use a hypothesis test to evaluate whether a new blood pressure medication has <b>an effect</b> on the average blood pressure of heart patients. What are the hypotheses?</p>
</blockquote>
</div>
</div>
<div id="testing-for-independence" class="section level2 hasAnchor" number="76.3">
<h2 class="hasAnchor"><span class="header-section-number">76.3</span> Testing for independence<a href="#testing-for-independence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="is-yawning-contagious" class="section level3 hasAnchor" number="76.3.1">
<h3 class="hasAnchor"><span class="header-section-number">76.3.1</span> Is yawning contagious?<a href="#is-yawning-contagious" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Do you think yawning is contagious?</p>
</blockquote>
<p><img src="img/yawn1.png" /></p>
<p><img src="img/yawn2.png" /></p>
<p>An experiment conducted by the MythBusters tested if a person can be subconsciously influenced into yawning if another person near them yawns. (<a href="https://www.discovery.com/tv-shows/mythbusters/videos/is-yawning-contagious-2">Video</a>)</p>
</div>
<div id="study-description" class="section level3 hasAnchor" number="76.3.2">
<h3 class="hasAnchor"><span class="header-section-number">76.3.2</span> Study description<a href="#study-description" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this study, 50 people were randomly assigned to two groups: 34 to a group where a person near them yawned (treatment) and 16 to a control group where they didn‚Äôt see someone yawn (control).</p>
<p>The data are in the <strong>openintro</strong> package: <code>yawn</code></p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>yawn <span class="sc">%&gt;%</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(group, result)</span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 √ó 3</span></span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group result       n</span></span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt; &lt;fct&gt;    &lt;int&gt;</span></span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 ctrl  not yawn    12</span></span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 ctrl  yawn         4</span></span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 trmt  not yawn    24</span></span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 trmt  yawn        10</span></span></code></pre></div>
</div>
<div id="proportion-of-yawners" class="section level3 hasAnchor" number="76.3.3">
<h3 class="hasAnchor"><span class="header-section-number">76.3.3</span> Proportion of yawners<a href="#proportion-of-yawners" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>yawn <span class="sc">%&gt;%</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(group, result) <span class="sc">%&gt;%</span></span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_hat =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 √ó 4</span></span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   group [2]</span></span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group result       n p_hat</span></span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt; &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 ctrl  not yawn    12 0.75 </span></span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 ctrl  yawn         4 0.25 </span></span>
<span id="cb449-11"><a href="#cb449-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 trmt  not yawn    24 0.706</span></span>
<span id="cb449-12"><a href="#cb449-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 trmt  yawn        10 0.294</span></span></code></pre></div>
<ul>
<li>Proportion of yawners in the treatment group: <span class="math inline">\(\frac{10}{34} = 0.2941\)</span></li>
<li>Proportion of yawners in the control group: <span class="math inline">\(\frac{4}{16} = 0.25\)</span></li>
<li>Difference: <span class="math inline">\(0.2941 - 0.25 = 0.0441\)</span></li>
<li>Our results match the ones calculated on the MythBusters episode.</li>
</ul>
</div>
<div id="independence" class="section level3 hasAnchor" number="76.3.4">
<h3 class="hasAnchor"><span class="header-section-number">76.3.4</span> Independence?<a href="#independence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Based on the proportions we calculated, do you think yawning is really contagious, i.e.¬†are seeing someone yawn and yawning dependent?</p>
</blockquote>
<pre><code>#&gt; # A tibble: 4 √ó 4
#&gt; # Groups:   group [2]
#&gt;   group result       n p_hat
#&gt;   &lt;fct&gt; &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;
#&gt; 1 ctrl  not yawn    12 0.75 
#&gt; 2 ctrl  yawn         4 0.25 
#&gt; 3 trmt  not yawn    24 0.706
#&gt; 4 trmt  yawn        10 0.294</code></pre>
</div>
<div id="dependence-or-another-possible-explanation" class="section level3 hasAnchor" number="76.3.5">
<h3 class="hasAnchor"><span class="header-section-number">76.3.5</span> Dependence, or another possible explanation?<a href="#dependence-or-another-possible-explanation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>The observed differences might suggest that yawning is contagious, i.e.¬†seeing someone yawn and yawning are dependent.</p></li>
<li><p>But the differences are small enough that we might wonder if they might simple be <strong>due to chance</strong>.</p></li>
<li><p>Perhaps if we were to repeat the experiment, we would see slightly different results.</p></li>
<li><p>So we will do just that - well, somewhat - and see what happens.</p></li>
<li><p>Instead of actually conducting the experiment many times, we will <strong>simulate</strong> our results.</p></li>
</ul>
</div>
<div id="two-competing-claims" class="section level3 hasAnchor" number="76.3.6">
<h3 class="hasAnchor"><span class="header-section-number">76.3.6</span> Two competing claims<a href="#two-competing-claims" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>‚ÄúThere is nothing going on.‚Äù
Yawning and seeing someone yawn are <strong>independent</strong>, yawning is not contagious, observed difference in proportions is simply due to chance. <span class="math inline">\(\rightarrow\)</span> Null hypothesis</p></li>
<li><p>‚ÄúThere is something going on.‚Äù
Yawning and seeing someone yawn are <strong>dependent</strong>, yawning is contagious, observed difference in proportions is not due to chance. <span class="math inline">\(\rightarrow\)</span> Alternative hypothesis</p></li>
</ul>
</div>
<div id="simulation-setup" class="section level3 hasAnchor" number="76.3.7">
<h3 class="hasAnchor"><span class="header-section-number">76.3.7</span> Simulation setup<a href="#simulation-setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>A regular deck of cards is comprised of 52 cards: 4 aces, 4 of numbers 2-10, 4 jacks, 4 queens, and 4 kings.</p></li>
<li><p>Take out two aces from the deck of cards and set them aside.</p></li>
<li><p>The remaining 50 playing cards to represent each participant in the study:</p>
<ul>
<li>14 face cards (including the 2 aces) represent the people who yawn.</li>
<li>36 non-face cards represent the people who don‚Äôt yawn.</li>
</ul></li>
</ol>
</div>
<div id="running-the-simulation" class="section level3 hasAnchor" number="76.3.8">
<h3 class="hasAnchor"><span class="header-section-number">76.3.8</span> Running the simulation<a href="#running-the-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Shuffle the 50 cards at least 7 times<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> to ensure that the cards counted out are from a random process.</p></li>
<li><p>Count out the top 16 cards and set them aside. These cards represent the people in the control group.</p></li>
<li><p>Out of the remaining 34 cards (treatment group) count the (the number of people who yawned in the treatment group).</p></li>
<li><p>Calculate the difference in proportions of yawners (treatment - control), and plot it
on the board.</p></li>
<li><p>Mark the difference you find on the dot plot on the board.</p></li>
</ol>
</div>
<div id="simulation-by-hand" class="section level3 hasAnchor" number="76.3.9">
<h3 class="hasAnchor"><span class="header-section-number">76.3.9</span> Simulation by hand<a href="#simulation-by-hand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Do the simulation results suggest that yawning is contagious, i.e.¬†does seeing someone yawn and yawning appear to be dependent?</p>
</blockquote>
<div class="figure">
<img src="img/yawn-sim-results.png" alt="" />
<p class="caption">yawn-sim-results</p>
</div>
</div>
<div id="simulation-by-computation" class="section level3 hasAnchor" number="76.3.10">
<h3 class="hasAnchor"><span class="header-section-number">76.3.10</span> Simulation by computation<a href="#simulation-by-computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> yawn <span class="sc">%&gt;%</span></span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> result,</span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">explanatory =</span> group, </span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;yawn&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in props&quot;</span>, </span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;trmt&quot;</span>, <span class="st">&quot;ctrl&quot;</span>))</span></code></pre></div>
<ul>
<li>Start with the data frame</li>
<li><strong>Specify the variables</strong>
<ul>
<li><strong>Since the response variable is categorical, specify the level which should be considered as ‚Äúsuccess‚Äù</strong></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>yawn <span class="sc">%&gt;%</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a>{{  <span class="fu">specify</span>(<span class="at">response =</span> result, <span class="at">explanatory =</span> group, </span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;yawn&quot;</span>) }}</span></code></pre></div>
<ul>
<li><strong>State the null hypothesis (yawning and whether or not you see someone yawn are independent)</strong></li>
</ul>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>yawn <span class="sc">%&gt;%</span></span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> result, <span class="at">explanatory =</span> group, </span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;yawn&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>{{ <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) }}</span></code></pre></div>
<ul>
<li><strong>Generate simulated differences via permutation</strong></li>
</ul>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>yawn <span class="sc">%&gt;%</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> result, <span class="at">explanatory =</span> group, </span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;yawn&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>{{ <span class="fu">generate</span>(<span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) }}</span></code></pre></div>
<ul>
<li><strong>Calculate the sample statistic of interest (difference in proportions)</strong>
<ul>
<li><strong>Since the explanatory variable is categorical, specify the order in which the subtraction should occur for the calculation of the sample statistic, <span class="math inline">\((\hat{p}_{treatment} - \hat{p}_{control})\)</span>.</strong></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>yawn <span class="sc">%&gt;%</span></span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> result, <span class="at">explanatory =</span> group, </span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;yawn&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a>{{ <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in props&quot;</span>, </span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;trmt&quot;</span>, <span class="st">&quot;ctrl&quot;</span>)) }}</span></code></pre></div>
</div>
<div id="recap-2" class="section level3 hasAnchor" number="76.3.11">
<h3 class="hasAnchor"><span class="header-section-number">76.3.11</span> Recap<a href="#recap-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Save the result</strong></li>
<li>Start with the data frame</li>
<li>Specify the variables
<ul>
<li>Since the response variable is categorical, specify the level which should be considered as ‚Äúsuccess‚Äù</li>
</ul></li>
<li>State the null hypothesis (yawning and whether or not you see someone yawn are independent)</li>
<li>Generate simulated differences via permutation</li>
<li>Calculate the sample statistic of interest (difference in proportions)
<ul>
<li>Since the explanatory variable is categorical, specify the order in which the subtraction should occur for the calculation of the sample statistic, <span class="math inline">\((\hat{p}_{treatment} - \hat{p}_{control})\)</span>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a>{{null_dist <span class="ot">&lt;-</span> yawn <span class="sc">%&gt;%</span> }}</span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> outcome, <span class="at">explanatory =</span> group, </span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">success =</span> <span class="st">&quot;yawn&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in props&quot;</span>, </span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;treatment&quot;</span>, <span class="st">&quot;control&quot;</span>))</span></code></pre></div>
</div>
<div id="visualizing-the-null-distribution-1" class="section level3 hasAnchor" number="76.3.12">
<h3 class="hasAnchor"><span class="header-section-number">76.3.12</span> Visualizing the null distribution<a href="#visualizing-the-null-distribution-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>What would you expect the center of the null distribution to be?</p>
</blockquote>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> null_dist, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Null distribution&quot;</span>)</span></code></pre></div>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-24-1.png" width="70%" /></p>
</div>
<div id="calculating-the-p-value-visually-1" class="section level3 hasAnchor" number="76.3.13">
<h3 class="hasAnchor"><span class="header-section-number">76.3.13</span> Calculating the p-value, visually<a href="#calculating-the-p-value-visually-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>What is the p-value, i.e.¬†in what % of the simulations was the simulated difference in sample proportion at least as extreme as the observed difference in sample proportions?</p>
</blockquote>
<p><img src="1202_hypothesis_files/figure-html/unnamed-chunk-25-1.png" width="80%" /></p>
</div>
<div id="calculating-the-p-value-directly-1" class="section level3 hasAnchor" number="76.3.14">
<h3 class="hasAnchor"><span class="header-section-number">76.3.14</span> Calculating the p-value, directly<a href="#calculating-the-p-value-directly-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>null_dist <span class="sc">%&gt;%</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stat <span class="sc">&gt;=</span> <span class="fl">0.0441</span>) <span class="sc">%&gt;%</span></span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p_value =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(null_dist))</span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 √ó 1</span></span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   p_value</span></span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt;</span></span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    0.53</span></span></code></pre></div>
</div>
<div id="conclusion-1" class="section level3 hasAnchor" number="76.3.15">
<h3 class="hasAnchor"><span class="header-section-number">76.3.15</span> Conclusion<a href="#conclusion-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>What is the conclusion of the hypothesis test?</p>
</blockquote>
<blockquote>
<p>Do you ‚Äúbuy‚Äù this conclusion?</p>
</blockquote>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1202_hypothesis.Rmd-->
</div>
</div>
</div>
<div id="lab11" class="section level1 hasAnchor" number="77">
<h1 class="hasAnchor"><span class="header-section-number">77</span> Lab: So what if you smoke when pregnant?<a href="#lab11" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="simulation-based-inference" class="section level2 hasAnchor" number="77.1">
<h2 class="hasAnchor"><span class="header-section-number">77.1</span> Simulation based inference<a href="#simulation-based-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In 2004, the state of North Carolina released a large data set containing information on births recorded in this state. This data set is useful to researchers studying the relation between habits and practices of expectant mothers and the birth of their children. We will work with a random sample of observations from this data set.</p>
</div>
<div id="getting-started-10" class="section level2 hasAnchor" number="77.2">
<h2 class="hasAnchor"><span class="header-section-number">77.2</span> Getting started<a href="#getting-started-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="packages-11" class="section level3 hasAnchor" number="77.2.1">
<h3 class="hasAnchor"><span class="header-section-number">77.2.1</span> Packages<a href="#packages-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lab we will work with the <strong>tidyverse</strong>, <strong>infer</strong>, and <strong>openintro</strong> packages. We can install and load them with the following:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span></code></pre></div>
</div>
</div>
<div id="housekeeping-3" class="section level2 hasAnchor" number="77.3">
<h2 class="hasAnchor"><span class="header-section-number">77.3</span> Housekeeping<a href="#housekeeping-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="git-configuration-password-caching-1" class="section level3 hasAnchor" number="77.3.1">
<h3 class="hasAnchor"><span class="header-section-number">77.3.1</span> Git configuration / password caching<a href="#git-configuration-password-caching-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Configure your Git user name and email. If you cannot remember the instructions, refer to an earlier lab. Also remember that you can cache your password for a limited amount of time.</p>
</div>
<div id="project-name-3" class="section level3 hasAnchor" number="77.3.2">
<h3 class="hasAnchor"><span class="header-section-number">77.3.2</span> Project name<a href="#project-name-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Update the name of your project to match the lab‚Äôs title.</p>
</div>
</div>
<div id="warm-up-8" class="section level2 hasAnchor" number="77.4">
<h2 class="hasAnchor"><span class="header-section-number">77.4</span> Warm up<a href="#warm-up-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we introduce the data, let‚Äôs warm up with some simple exercises.</p>
<div id="yaml-5" class="section level3 hasAnchor" number="77.4.1">
<h3 class="hasAnchor"><span class="header-section-number">77.4.1</span> YAML<a href="#yaml-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Open the R Markdown (Rmd) file in your project, change the author name to your name, and knit the document.</p>
</div>
<div id="commiting-and-pushing-changes-3" class="section level3 hasAnchor" number="77.4.2">
<h3 class="hasAnchor"><span class="header-section-number">77.4.2</span> Commiting and pushing changes<a href="#commiting-and-pushing-changes-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Go to the <strong>Git</strong> pane in your RStudio.</li>
<li>View the <strong>Diff</strong> and confirm that you are happy with the changes.</li>
<li>Add a commit message like ‚ÄúUpdate team name‚Äù in the <strong>Commit message</strong> box and hit <strong>Commit</strong>.</li>
<li>Click on <strong>Push</strong>. This will prompt a dialogue box where you first need to enter your user name, and then your password.</li>
</ul>
</div>
</div>
<div id="set-a-seed" class="section level2 hasAnchor" number="77.5">
<h2 class="hasAnchor"><span class="header-section-number">77.5</span> Set a seed!<a href="#set-a-seed" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this lab, we‚Äôll be generating random samples. The last thing you want is those samples to change every time you knit your document. So, you should set a seed. There‚Äôs an R chunk in your R Markdown file set aside for this. Locate it and add a seed.</p>
</div>
<div id="the-data-5" class="section level2 hasAnchor" number="77.6">
<h2 class="hasAnchor"><span class="header-section-number">77.6</span> The data<a href="#the-data-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load the <code>ncbirths</code> data from the <code>openintro</code> package:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ncbirths)</span></code></pre></div>
<p>We have observations on 13 different variables, some categorical and some
numerical. The meaning of each variable is as follows.</p>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th>variable</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fage</code></td>
<td>father‚Äôs age in years.</td>
</tr>
<tr class="even">
<td><code>mage</code></td>
<td>mother‚Äôs age in years.</td>
</tr>
<tr class="odd">
<td><code>mature</code></td>
<td>maturity status of mother.</td>
</tr>
<tr class="even">
<td><code>weeks</code></td>
<td>length of pregnancy in weeks.</td>
</tr>
<tr class="odd">
<td><code>premie</code></td>
<td>whether the birth was classified as premature (premie) or full-term.</td>
</tr>
<tr class="even">
<td><code>visits</code></td>
<td>number of hospital visits during pregnancy.</td>
</tr>
<tr class="odd">
<td><code>marital</code></td>
<td>whether mother is <code>married</code> or <code>not married</code> at birth.</td>
</tr>
<tr class="even">
<td><code>gained</code></td>
<td>weight gained by mother during pregnancy in pounds.</td>
</tr>
<tr class="odd">
<td><code>weight</code></td>
<td>weight of the baby at birth in pounds.</td>
</tr>
<tr class="even">
<td><code>lowbirthweight</code></td>
<td>whether baby was classified as low birthweight (<code>low</code>) or not (<code>not low</code>).</td>
</tr>
<tr class="odd">
<td><code>gender</code></td>
<td>gender of the baby, <code>female</code> or <code>male</code>.</td>
</tr>
<tr class="even">
<td><code>habit</code></td>
<td>status of the mother as a <code>nonsmoker</code> or a <code>smoker</code>.</td>
</tr>
<tr class="odd">
<td><code>whitemom</code></td>
<td>whether mom is <code>white</code> or <code>not white</code>.</td>
</tr>
</tbody>
</table>
</div>
<div id="exercises-9" class="section level2 hasAnchor" number="77.7">
<h2 class="hasAnchor"><span class="header-section-number">77.7</span> Exercises<a href="#exercises-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>What are the cases in this data set? How many cases are there in our sample?</li>
</ol>
<p>The first step in the analysis of a new dataset is getting acquainted with the data. Make summaries of the variables in your dataset, determine which variables are categorical and which are numerical. For numerical variables, are there outliers? If you aren‚Äôt sure or want to take a closer look at the data, make a graph.</p>
<div id="baby-weights" class="section level3 hasAnchor" number="77.7.1">
<h3 class="hasAnchor"><span class="header-section-number">77.7.1</span> Baby weights<a href="#baby-weights" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Wen, Shi Wu, Michael S. Kramer, and Robert H. Usher. ‚ÄúComparison of birth weight distributions between Chinese and Caucasian infants.‚Äù American Journal of Epidemiology 141.12 (1995): 1177-1187.</p>
</blockquote>
<p>A 1995 study suggests that average weight of Caucasian babies born in the US is 3,369 grams (7.43 pounds). In this dataset, we only have information on mother‚Äôs race, so we will make the simplifying assumption that babies of Caucasian mothers are also Caucasian, i.e.¬†<code>whitemom = "white"</code>. (Yes, I know that this assumption is a gross oversimplification).</p>
<p>We want to evaluate whether the average weight of Caucasian babies has changed since 1995.</p>
<p>Our null hypothesis should state ‚Äúthere is nothing going on‚Äù, i.e.¬†no change since 1995: <span class="math inline">\(H_0: \mu = 7.43~pounds\)</span>.</p>
<p>Our alternative hypothesis should reflect the research question, i.e.¬†some change since 1995. Since the research question doesn‚Äôt state a direction for the change, we use a two sided alternative hypothesis: <span class="math inline">\(H_A: \mu \ne 7.43~pounds\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Create a filtered data frame called <code>ncbirths_white</code> that contain data only from white mothers. Then, calculate the mean of the weights of their babies.</p></li>
<li><p>Are the conditions necessary for conducting simulation based inference satisfied? Explain your reasoning.</p></li>
</ol>
<p>Let‚Äôs discuss how this test would work. Our goal is to simulate a null distribution of sample means that is centered at the null value of 7.43 pounds. In order to do so, we</p>
<ul>
<li>take a bootstrap sample of from the original sample,</li>
<li>calculate this bootstrap sample‚Äôs mean,</li>
<li>repeat these two steps a large number of times to create a bootstrap distribution of means centered at the observed sample mean,</li>
<li>shift this distribution to be centered at the null value by subtracting / adding X to all boostrap mean (X = difference between mean of bootstrap distribution and null value), and</li>
<li>calculate the p-value as the proportion of bootstrap samples that yielded a sample mean at least as extreme as the observed sample mean.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Run the appropriate hypothesis test, visualize the null distribution, calculate the p-value, and interpret the results in context of the data and the hypothesis test.</li>
</ol>
</div>
<div id="baby-weight-vs.-smoking" class="section level3 hasAnchor" number="77.7.2">
<h3 class="hasAnchor"><span class="header-section-number">77.7.2</span> Baby weight vs.¬†smoking<a href="#baby-weight-vs.-smoking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the possible relationship between a mother‚Äôs smoking habit and the weight of her baby. Plotting the data is a useful first step because it helps us quickly visualize trends, identify strong associations, and develop research questions.</p>
<ol start="6" style="list-style-type: decimal">
<li><p>Make side-by-side boxplots displaying the relationship between <code>habit</code> and <code>weight</code>. What does the plot highlight about the relationship between these two variables?</p></li>
<li><p>Before moving forward, save a version of the dataset omitting observations where there are NAs for <code>habit</code>. You can call this version <code>ncbirths_habitgiven</code>.</p></li>
</ol>
<p>The box plots show how the medians of the two distributions compare, but we can also compare the means of the distributions using the following to first group the data by the <code>habit</code> variable, and then calculate the mean<code>weight</code> in these groups using.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>ncbirths_habitgiven <span class="sc">%&gt;%</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(habit) <span class="sc">%&gt;%</span></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight))</span></code></pre></div>
<p>There is an observed difference, but is this difference statistically significant? In order to answer this question, we will conduct a hypothesis test.</p>
<ol start="8" style="list-style-type: decimal">
<li><p>Write the hypotheses for testing if the average weights of babies born to smoking and non-smoking mothers are different.</p></li>
<li><p>Are the conditions necessary for conducting simulation based inference satisfied? Explain your reasoning.</p></li>
<li><p>Run the appropriate hypothesis test, calculate the p-value, and interpret the results in context of the data and the hypothesis test.</p></li>
<li><p>Construct a 95% confidence interval for the difference between the average weights of babies born to smoking and non-smoking mothers.</p></li>
</ol>
</div>
<div id="baby-weight-vs.-mothers-age" class="section level3 hasAnchor" number="77.7.3">
<h3 class="hasAnchor"><span class="header-section-number">77.7.3</span> Baby weight vs.¬†mother‚Äôs age<a href="#baby-weight-vs.-mothers-age" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this portion of the analysis, we focus on two variables. The first one is <code>maturemom</code>.</p>
<ol start="12" style="list-style-type: decimal">
<li>First, a non-inference task: Determine the age cutoff for younger and mature mothers. Use a method of your choice, and explain how your method works.</li>
</ol>
<p>The other variable of interest is <code>lowbirthweight</code>.</p>
<ol start="13" style="list-style-type: decimal">
<li>Conduct a hypothesis test evaluating whether the proportion of low birth weight babies is higher for mature mothers. State the hypotheses, verify the conditions, run the test and calculate the p-value, and state your conclusion in context of the research question. Use <span class="math inline">\(\alpha = 0.05\)</span>. If you find a significant difference, construct a confidence interval, at the equivalent level to the hypothesis test, for the difference between the proportions of low birth weight babies between mature and younger moms, and interpret this interval in context of the data.</li>
</ol>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1204_lab_smoking.Rmd-->
</div>
</div>
</div>
<div id="part-module-13" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 13<a href="#part-module-13" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="welcome-to-simulating-data" class="section level1 hasAnchor" number="78">
<h1 class="hasAnchor"><span class="header-section-number">78</span> Welcome to Simulating Data<a href="#welcome-to-simulating-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module is designed to introduce you to the key ideas behind simulating data. In essence, we are making our own data instead of using someone else‚Äôs. Eventually, there will be video lectures. Once those videos exist, please watch the videos and work your way through the notes. <strong>The videos will eventually start on the next page.</strong> You will eventually be able to find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYbWGmSnbLIYwdLOnGm6une6">here</a>. The slides used to make the videos in this module will be able to be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<div id="module-materials-12" class="section level2 hasAnchor" number="78.1">
<h2 class="hasAnchor"><span class="header-section-number">78.1</span> Module Materials<a href="#module-materials-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides from Lectures</li>
<li>Suggested Readings
<ul>
<li>All subchapters of this module, including
<ul>
<li>‚Ä¶</li>
</ul></li>
<li>R4DS
<ul>
<li><a href="https://r4ds.had.co.nz/">TBD</a>, including
<ul>
<li>[TBD]</li>
<li>[TBD]</li>
</ul></li>
</ul></li>
</ul></li>
<li>Activities
<ul>
<li>[TBD]</li>
</ul></li>
<li>Lab
<ul>
<li><a href="#labTBD">TBD</a></li>
</ul></li>
</ul>
</div>
<div id="estimated-video-length-6" class="section level2 hasAnchor" number="78.2">
<h2 class="hasAnchor"><span class="header-section-number">78.2</span> Estimated Video Length<a href="#estimated-video-length-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--https://ytplaylist-len.herokuapp.com/ -->
<p>No of videos : TBD</p>
<p>Average length of video : TBD</p>
<p>Total length of playlist : TBD</p>
</div>
</div>
<div id="getting-started-with-simulating-data-in-r" class="section level1 hasAnchor" number="79">
<h1 class="hasAnchor"><span class="header-section-number">79</span> Getting started with simulating data in R<a href="#getting-started-with-simulating-data-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>I adapted <a href="https://github.com/aosmith16/simulation-helper-functions">this tutorial</a> from <a href="https://github.com/aosmith16">Ariel Muldoon</a></p>
</blockquote>
<p>There are many reasons we might want to simulate data in R, and I find being able to simulate data to be incredibly useful in my day-to-day work. But how does someone get started simulating data?</p>
<p>Today I‚Äôm going to take a closer look at some of the R functions that are useful to get to know when simulating data. These functions are all from base R packages, not in add-on packages, so some of them may already familiar to you.</p>
<p>Here‚Äôs what we‚Äôll do today:</p>
<ol style="list-style-type: decimal">
<li>Simulate quantitative variables via random number generation with <code>rnorm()</code>, <code>runif()</code> and <code>rpois()</code>.</li>
<li>Generate character variables that represent groups via <code>rep()</code>. We‚Äôll explore how to create character vectors with different repeating patterns.</li>
<li>Create data with both quantitative and categorical variables, making use of functions from the first two steps above.</li>
<li>Learn to use <code>replicate()</code> to repeat the data simulation process many times.</li>
</ol>
<div id="generating-random-numbers" class="section level2 hasAnchor" number="79.1">
<h2 class="hasAnchor"><span class="header-section-number">79.1</span> Generating random numbers<a href="#generating-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One way to generate numeric data is to pull random numbers from some distribution. This can be done via the functions for generating random deviates. These functions always start with <code>r</code> (for ‚Äúrandom‚Äù).</p>
<p>The basic distributions that I use the most for generating random numbers are the normal (<code>rnorm()</code>) and uniform (<code>runif()</code>) distributions. We‚Äôll look at those today, plus the Poisson (<code>rpois()</code>) distribution for generating discrete counts.</p>
<p>There are many other distributions available as part of the <strong>stats</strong> package (e.g., binomial, F, log normal, beta, exponential, Gamma) and, as you can imagine, even more available in add-on packages. I recently needed to generate data from the Tweedie distribution to test a modeling tool, which I could do via package <strong>tweedie</strong>.</p>
<p>The <code>r</code> functions for a chosen distribution all work basically the same way. We define how many random numbers we want to generate in the first argument (<code>n</code>) and then define the parameters for the distribution we want to draw from. This is easier to see with practice, so let‚Äôs get started.</p>
</div>
<div id="rnorm-to-generate-random-numbers-from-the-normal-distribution" class="section level2 hasAnchor" number="79.2">
<h2 class="hasAnchor"><span class="header-section-number">79.2</span> <code>rnorm()</code> to generate random numbers from the normal distribution<a href="#rnorm-to-generate-random-numbers-from-the-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I use <code>rnorm()</code> a lot, sometimes with good reason and other times when I need some numbers and I really don‚Äôt care too much about what they are.</p>
<p>There are three arguments to <code>rnorm()</code>. From the <code>Usage</code> section of the documentation:</p>
<blockquote>
<p>rnorm(n, mean = 0, sd = 1)
The <code>n</code> argument is the number of observations we want to generate. The <code>mean</code> and <code>sd</code> arguments show what the default values are (note that <code>sd</code> is the <em>standard deviation</em>, not the variance). Not all <code>r</code> functions have defaults to the arguments like this.</p>
</blockquote>
<p>To get 5 random numbers from a <span class="math inline">\(Normal(0, 1)\)</span> (aka the <em>standard</em> normal) distribution we can write code like:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.9293 -2.7158 -0.2679 -0.3469  0.0876</span></span></code></pre></div>
<p>There are a couple things about this code and the output to discuss.</p>
<p>First, the code got me 5 numbers, which is what I wanted. (Yay!) However, the code itself isn‚Äôt particularly clear. What I might refer to as lazy coding on my part can look pretty mysterious to someone reading my code (or to my future self reading my code). Since I used the default values for <code>mean</code> and <code>sd</code>, it‚Äôs not clear exactly what distribution I drew the numbers from.</p>
<div id="writing-out-arguments-for-clearer-code" class="section level3 hasAnchor" number="79.2.1">
<h3 class="hasAnchor"><span class="header-section-number">79.2.1</span> Writing out arguments for clearer code<a href="#writing-out-arguments-for-clearer-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here‚Äôs more readable code to do the same thing, where I write out the mean and standard deviation arguments explicitly even though I‚Äôm using the default values. It is certainly not necessary to always be this careful, but I don‚Äôt think I‚Äôve run into a time when it was bad to have clear code.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="dv">0</span>, </span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -1.4419 -1.3634  0.0907 -0.5217  0.4292</span></span></code></pre></div>
</div>
<div id="setting-the-random-seed-for-reproducible-random-numbers" class="section level3 hasAnchor" number="79.2.2">
<h3 class="hasAnchor"><span class="header-section-number">79.2.2</span> Setting the random seed for reproducible random numbers<a href="#setting-the-random-seed-for-reproducible-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Second, if we run this code again we‚Äôll get different numbers. To get reproducible random numbers we need to <em>set the seed</em> via <code>set.seed()</code>.</p>
<p>Making sure someone else will be able to exactly reproduce your results when running the same code can be desirable in teaching. It is also is useful when making an example dataset to demonstrate a coding issue, like if you were asking a code question on Stack Overflow.</p>
<p>I also will set the seed when I‚Äôm making a function for simulations and I want to make sure it works correctly. Otherwise in most simulations we don‚Äôt actually want or need to set the seed.</p>
<p>If we set the seed prior to running <code>rnorm()</code>, we can reproduce the values we generate.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="dv">0</span>, </span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.476 -0.125  1.096 -1.444  1.148</span></span></code></pre></div>
<p>If we set the seed back to the same number and run the code again, we get the same values.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="dv">0</span>, </span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb465-5"><a href="#cb465-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.476 -0.125  1.096 -1.444  1.148</span></span></code></pre></div>
</div>
<div id="change-parameters-in-rnorm" class="section level3 hasAnchor" number="79.2.3">
<h3 class="hasAnchor"><span class="header-section-number">79.2.3</span> Change parameters in <code>rnorm()</code><a href="#change-parameters-in-rnorm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For getting a quick set of numbers it‚Äôs easy to use the default parameter values in <code>rnorm()</code> but we can certainly change the values to something else. For example, when I‚Äôm exploring long-run behavior of variance estimated from linear models I will want to vary the standard deviation values.</p>
<p>The <code>sd</code> argument shows the <em>standard deviation</em> of the normal distribution. So drawing from a <span class="math inline">\(Normal(0, 4)\)</span> can be done by setting <code>sd</code> to 2.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="dv">0</span>, </span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.937 -2.012  0.127  2.050  1.146</span></span></code></pre></div>
<p>I‚Äôve seen others change the mean and standard deviation to create a variable that is within some specific range, as well. For example, if the mean is large and the standard deviation small in relation to the mean we can generate strictly positive numbers. (I usually use <code>runif()</code> for this, which we‚Äôll see below.)</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="dv">50</span>, </span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 86.9 52.2 35.1 83.2 64.4</span></span></code></pre></div>
</div>
<div id="using-vectors-of-values-for-the-parameter-arguments" class="section level3 hasAnchor" number="79.2.4">
<h3 class="hasAnchor"><span class="header-section-number">79.2.4</span> Using vectors of values for the parameter arguments<a href="#using-vectors-of-values-for-the-parameter-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also use vectors for arguments! We can pull random numbers from a normal distribution with distinct parameters if we use a vector for the parameter arguments. For example, this could be useful for simulating data with different group means but the same variance. We might want to use something like this if we were making data that we would analyze using an ANOVA.</p>
<p>I‚Äôll keep the standard deviation at 1 but will draw data from three distribution centered at three different locations: one at 0, one at 5, and one at 20. I request 10 total draws by changing <code>n</code> to 10.</p>
<p>Note the repeating pattern: the function iteratively draws one value from each distribution until the total number requested is reached. This can lead to imbalance in the sample size per distribution.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, </span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">20</span>), </span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] -1.663  5.576 20.473 -0.543  6.128 18.352 -0.314  4.817 21.470 -0.866</span></span></code></pre></div>
<p>A vector can also be passed to <code>sd</code>. Here both the means and standard deviations vary among the three distributions used to generate values.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, </span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">20</span>), </span>
<span id="cb469-3"><a href="#cb469-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">20</span>) )</span>
<span id="cb469-4"><a href="#cb469-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1]  1.527 10.271 40.601  0.840  6.085  6.549  0.133  4.645  1.146 -1.022</span></span></code></pre></div>
<p>Things are different for the <code>n</code> argument. If a vector is passed to <code>n</code>, the <em>length</em> of that vector is taken to be the number required (see <code>Arguments</code> section of documentation for details).</p>
<p>Here‚Äôs an example. Since the vector for <code>n</code> is length 3, we only get 3 values.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">20</span>), </span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">20</span>) )</span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.281  7.724 22.617</span></span></code></pre></div>
</div>
</div>
<div id="example-of-using-the-simulated-numbers-from-rnorm" class="section level2 hasAnchor" number="79.3">
<h2 class="hasAnchor"><span class="header-section-number">79.3</span> Example of using the simulated numbers from <code>rnorm()</code><a href="#example-of-using-the-simulated-numbers-from-rnorm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Up to this point we‚Äôve printed the results of each simulation. In reality we‚Äôd want to save our vectors as objects in R to use them for some further task.</p>
<p>For example, maybe we want to simulate two unrelated variables and then look to see how correlated they appear to be. This can be a fun exercise to demonstrate how variables can appear to be related by chance even when we know they are not, especially at small sample sizes.</p>
<p>Let‚Äôs generate two quantitative vectors of length 10, which I‚Äôll name <code>x</code> and <code>y</code>, and plot the results. I‚Äôm using the defaults for <code>mean</code> and <code>sd</code>.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, </span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="dv">0</span>, </span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, </span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="dv">0</span>, </span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-8"><a href="#cb471-8" aria-hidden="true" tabindex="-1"></a>df_demo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var1=</span>x, <span class="at">var2=</span>y)</span>
<span id="cb471-9"><a href="#cb471-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-10"><a href="#cb471-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x)</span></code></pre></div>
<p><img src="1300_simulations_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><img src="1300_simulations_files/figure-html/unnamed-chunk-12-1.png" width="672" />
## <code>runif()</code> pulls from the uniform distribution</p>
<p>Pulling random numbers from other distributions is extremely similar to using <code>rnorm()</code>, so we‚Äôll go through them more quickly.</p>
<p>I‚Äôve started using <code>runif()</code> pretty regularly, especially when I want to easily generate numbers that are strictly positive but continuous. The uniform distribution is a continuous distribution, with numbers uniformly distributed between some minimum and maximum.</p>
<p>From <code>Usage</code> we can see that by default we pull random numbers between 0 and 1. The first argument, as with all of these <code>r</code> functions, is the number of deviates we want to randomly generate:</p>
<blockquote>
<p>runif(n, min = 0, max = 1)
Let‚Äôs generate 5 numbers between 0 and 1.</p>
</blockquote>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">min =</span> <span class="dv">0</span>,</span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.999 0.943 0.250 0.648 0.113</span></span></code></pre></div>
<p>What if we want to generate 5 numbers between 50 and 100? We can change the parameter values.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">min =</span> <span class="dv">50</span>, <span class="at">max =</span> <span class="dv">100</span>)</span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 81.6 66.9 82.7 64.3 54.2</span></span></code></pre></div>
</div>
<div id="example-of-using-the-simulated-numbers-from-runif" class="section level2 hasAnchor" number="79.4">
<h2 class="hasAnchor"><span class="header-section-number">79.4</span> Example of using the simulated numbers from <code>runif()</code><a href="#example-of-using-the-simulated-numbers-from-runif" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One situation where I‚Äôve found <code>runif()</code> handy is when I wanted to demonstrate the effect of the relative size of the variable values on the size of the estimated coefficient in a regression. For example, the size of the coefficient measured in kilometers is smaller than if that variable was converted into meters.</p>
<p>Let‚Äôs generate some data with the response variable (<code>y</code>) pulled from a standard normal distribution and then an explanatory variable with values between 1 and 2. The two variables are unrelated.</p>
<p>You see I‚Äôm still writing out my argument names for clarity, but you may get a sense how easy it would be to start cutting corners to avoid the extra typing.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x1)</span>
<span id="cb474-5"><a href="#cb474-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.96 1.08 1.71 1.33 2.00 1.45</span></span></code></pre></div>
<p>Now simulate a second explanatory variable with values between 200 and 300. This variable is also unrelated to the other two.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">min =</span> <span class="dv">200</span>, <span class="at">max =</span> <span class="dv">300</span>)</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x2)</span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 220 263 210 245 265 257</span></span></code></pre></div>
<p>We can fit a multiple regression linear model via <code>lm()</code>. The coefficient for the second variable, with a larger relative size, is generally going to be smaller than the first since the change in <code>y</code> for a ‚Äú1-unit increase‚Äù in <code>x</code> depends on the units of <code>x</code>.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x1 + x2)</span></span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)           x1           x2  </span></span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     0.38089      0.10494     -0.00191</span></span></code></pre></div>
</div>
<div id="discrete-counts-with-rpois" class="section level2 hasAnchor" number="79.5">
<h2 class="hasAnchor"><span class="header-section-number">79.5</span> Discrete counts with <code>rpois()</code><a href="#discrete-counts-with-rpois" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs look at one last function for generating random numbers, this time for generating discrete integers (including 0) from a Poisson distribution with <code>rpois()</code>.</p>
<p>I use <code>rpois()</code> for generating counts for exploring generalized linear models. I‚Äôve also found this function useful in gaining a better understanding of the shape of Poisson distributions with different means.</p>
<p>The Poisson distribution is a single parameter distribution. The function looks like:</p>
<blockquote>
<p>rpois(n, lambda)
The single parameter, <code>lambda</code>, is the mean. It has no default setting so must always be defined by the user.</p>
</blockquote>
<p>Let‚Äôs generate five values from a Poisson distribution with a mean of 2.5. Note that <em>mean</em> of the Poisson distribution can be any non-negative value (i.e., it doesn‚Äôt have to be an integer) even though the observed values will be discrete integers.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">lambda =</span> <span class="fl">2.5</span>)</span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2 1 4 1 2</span></span></code></pre></div>
</div>
<div id="example-of-using-the-simulated-numbers-from-rpois" class="section level2 hasAnchor" number="79.6">
<h2 class="hasAnchor"><span class="header-section-number">79.6</span> Example of using the simulated numbers from <code>rpois()</code><a href="#example-of-using-the-simulated-numbers-from-rpois" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs explore the Poisson distribution a little more, seeing how the distribution looks when changing the mean. Being able to look at how the Poisson distribution changes with the mean via simulation helped me understand the distribution better, including why it so often does a poor job modeling ecological count data.</p>
<p>We‚Äôll draw 100 values from a Poisson distribution with a mean of 5. We‚Äôll name this vector <code>y</code> and take a look at a summary of those values.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">100</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>The vector of values we simulated fall between 1 and 14.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(y)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1.00    3.00    5.00    4.83    6.00   11.00</span></span></code></pre></div>
<p>There is mild right-skew when we draw a histogram of the values.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="1300_simulations_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Let‚Äôs do the same thing for a Poisson distribution with a mean of 100. The range of values is pretty narrow; there are no values even remotely close to 0.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">100</span>, <span class="at">lambda =</span> <span class="dv">100</span>)</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(y)</span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    76.0    94.8   102.0   101.3   108.0   124.0</span></span></code></pre></div>
<p>And the distribution is pretty symmetric compared to the distribution with the smaller mean.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="1300_simulations_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>An alternative to the Poisson distribution for discrete integers is the negative binomial distribution. Packages <strong>MASS</strong> has a function called <code>rnegbin()</code> for random number generation from the negative binomial distribution.</p>
</div>
</div>
<div id="generate-character-vectors-with-rep" class="section level1 hasAnchor" number="80">
<h1 class="hasAnchor"><span class="header-section-number">80</span> Generate character vectors with <code>rep()</code><a href="#generate-character-vectors-with-rep" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Quantitative variables are great, but in simulations we‚Äôre often going to need categorical variables, as well.</p>
<p>In my own work these are usually sort of ‚Äúgrouping‚Äù or ‚Äútreatment‚Äù variable. This means I need to have repeated observations of each character value. The <code>rep()</code> function is one way to avoid having to write out an entire vector manually. It‚Äôs for <em>replicating elements of vectors and lists</em>.</p>
<div id="using-letters-and-letters" class="section level2 hasAnchor" number="80.1">
<h2 class="hasAnchor"><span class="header-section-number">80.1</span> Using <code>letters</code> and <code>LETTERS</code><a href="#using-letters-and-letters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first argument of <code>rep()</code> is the vector to be repeated. One option is to write out the character vector you want to repeat. You can also get a simple character vector through the use of <code>letters</code> or <code>LETTERS</code>. These are <em>built in constants</em> in R. <code>letters</code> is the 26 lowercase letters of the Roman alphabet and <code>LETTERS</code> is the 26 uppercase letters.</p>
<p>Letters can be pulled out via the extract brackets (<code>[</code>). I use these built-in constants for pure convenience when I need to make a basic categorical vector and it doesn‚Äôt matter what form those categories take. I find it more straightforward to type out the word and brackets than a vector of characters (complete with all those pesky quotes and such).</p>
<p>Here are the first two <code>letters</code>.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot;</span></span></code></pre></div>
<p>And the last 17 <code>LETTERS</code>.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>LETTERS[<span class="dv">10</span><span class="sc">:</span><span class="dv">26</span>]</span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;J&quot; &quot;K&quot; &quot;L&quot; &quot;M&quot; &quot;N&quot; &quot;O&quot; &quot;P&quot; &quot;Q&quot; &quot;R&quot; &quot;S&quot; &quot;T&quot; &quot;U&quot; &quot;V&quot; &quot;W&quot; &quot;X&quot; &quot;Y&quot; &quot;Z&quot;</span></span></code></pre></div>
</div>
<div id="repeat-each-element-of-a-vector-with-each" class="section level2 hasAnchor" number="80.2">
<h2 class="hasAnchor"><span class="header-section-number">80.2</span> Repeat each element of a vector with <code>each</code><a href="#repeat-each-element-of-a-vector-with-each" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are three arguments that help us repeat the values in the vector in <code>rep()</code> with different patterns: <code>each</code>, <code>times</code>, and <code>length.out</code>. These can be used individually or in combination.</p>
<p>With <code>each</code> we repeat each unique character in the vector the defined number of times. The replication is done ‚Äúelementwise‚Äù, so the repeats of each unique character are all in a row.</p>
<p>Let‚Äôs repeat two characters three times each. The resulting vector is 6 observations long.</p>
<p>This is an example of how I might make a grouping variable for simulating data to be used in a two-sample analysis.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot;</span></span></code></pre></div>
</div>
<div id="repeat-a-whole-vector-with-the-times-argument" class="section level2 hasAnchor" number="80.3">
<h2 class="hasAnchor"><span class="header-section-number">80.3</span> Repeat a whole vector with the <code>times</code> argument<a href="#repeat-a-whole-vector-with-the-times-argument" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>times</code> argument can be used when we want to repeat the whole vector rather than repeating it elementwise.</p>
<p>We‚Äôll make a two-group variable again, but this time we‚Äôll change the repeating pattern of the values in the variable.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;b&quot;</span></span></code></pre></div>
</div>
<div id="set-the-output-vector-length-with-the-length.out-argument" class="section level2 hasAnchor" number="80.4">
<h2 class="hasAnchor"><span class="header-section-number">80.4</span> Set the output vector length with the <code>length.out</code> argument<a href="#set-the-output-vector-length-with-the-length.out-argument" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>length.out</code> argument has <code>rep()</code> repeat the whole vector. However, it repeats the vector only until the defined length is reached. Using <code>length.out</code> is another way to get unbalanced groups.</p>
<p>Rather than defining the number of repeats like we did with <code>each</code> and <code>times</code> we define the length of the output vector.</p>
<p>Here we‚Äôll make a two-group variable of length 5. This means the second group will have one less value than the first.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot;</span></span></code></pre></div>
</div>
<div id="repeat-each-element-a-different-number-of-times" class="section level2 hasAnchor" number="80.5">
<h2 class="hasAnchor"><span class="header-section-number">80.5</span> Repeat each element a different number of <code>times</code><a href="#repeat-each-element-a-different-number-of-times" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unlike <code>each</code> and <code>length.out</code>, we can use <code>times</code> with a vector of values. This allows us to repeat each element of the character vector a different number of times. This is one way to simulate unbalanced groups. Using <code>times</code> with a vector repeats each element like <code>each</code> does, which can make it harder to remember which argument does what.</p>
<p>Let‚Äôs repeat the first element twice and the second four times.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>) )</span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot;</span></span></code></pre></div>
</div>
<div id="combining-each-with-times" class="section level2 hasAnchor" number="80.6">
<h2 class="hasAnchor"><span class="header-section-number">80.6</span> Combining <code>each</code> with <code>times</code><a href="#combining-each-with-times" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As your simulation situation get more complicated, you may need more complicated patterns for your categorical variable. The <code>each</code> argument can be combined with <code>times</code> to first repeat each value elementwise (via <code>each</code>) and then repeat that whole pattern (via <code>times</code>).</p>
<p>When using <code>times</code> this way it will only take a single value and not a vector.</p>
<p>Let‚Äôs repeat each value twice, 3 times.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">2</span>, <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot;</span></span></code></pre></div>
</div>
<div id="combining-each-with-length.out" class="section level2 hasAnchor" number="80.7">
<h2 class="hasAnchor"><span class="header-section-number">80.7</span> Combining <code>each</code> with <code>length.out</code><a href="#combining-each-with-length.out" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Similarly we can use <code>each</code> with <code>length.out</code>. This can lead to some imbalance.</p>
<p>Here we‚Äôll repeat the two values twice each but with a total final vector length of 7.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">7</span>)</span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot;</span></span></code></pre></div>
<p>Note you can‚Äôt use <code>length.out</code> and <code>times</code> together (if you try, <code>length.out</code> will be given priority and <code>times</code> ignored).</p>
</div>
</div>
<div id="creating-datasets-with-quantiative-and-categorical-variables" class="section level1 hasAnchor" number="81">
<h1 class="hasAnchor"><span class="header-section-number">81</span> Creating datasets with quantiative and categorical variables<a href="#creating-datasets-with-quantiative-and-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We now have some tools for creating quantitative data as well as categorical. Which means it‚Äôs time to make some datasets! We‚Äôll create several simple ones to get the general idea.</p>
<div id="simulate-data-with-no-differences-among-two-groups" class="section level2 hasAnchor" number="81.1">
<h2 class="hasAnchor"><span class="header-section-number">81.1</span> Simulate data with no differences among two groups<a href="#simulate-data-with-no-differences-among-two-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs start by simulating data that we would use in a simple two-sample analysis with no difference between groups. We‚Äôll make a total of 6 observations, three in each group.</p>
<p>We‚Äôll be using the tools we reviewed above but will now name the output and combine them into a data.frame. This last step isn‚Äôt always necessary, but does help keep things organized in certain types of simulations.</p>
<p>First we‚Äôll make separate vectors for the continuous and categorical data and then bind them together via <code>data.frame()</code>.</p>
<p>Notice there is no need to use <code>cbind()</code> here, which is commonly done by R beginners (I know I did!). Instead we can use <code>data.frame()</code> directly.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(group,</span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a>           response)</span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group response</span></span>
<span id="cb491-6"><a href="#cb491-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     a    0.493</span></span>
<span id="cb491-7"><a href="#cb491-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     a    0.523</span></span>
<span id="cb491-8"><a href="#cb491-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     a    1.237</span></span>
<span id="cb491-9"><a href="#cb491-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     b    0.356</span></span>
<span id="cb491-10"><a href="#cb491-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     b    0.575</span></span>
<span id="cb491-11"><a href="#cb491-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     b   -0.422</span></span></code></pre></div>
<p>When I make a data.frame like this I prefer to make my vectors and the data.frame simultaneously to avoid having a lot of variables cluttering up my R Environment.</p>
<p>I often teach/blog with all the steps clearly delineated as I think it‚Äôs easier when you are starting out, so (as always) use the method that works for you.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">response =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) )</span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group response</span></span>
<span id="cb492-4"><a href="#cb492-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     a    0.402</span></span>
<span id="cb492-5"><a href="#cb492-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     a    0.959</span></span>
<span id="cb492-6"><a href="#cb492-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     a   -1.876</span></span>
<span id="cb492-7"><a href="#cb492-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     b   -0.212</span></span>
<span id="cb492-8"><a href="#cb492-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     b    1.437</span></span>
<span id="cb492-9"><a href="#cb492-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     b    0.386</span></span></code></pre></div>
<p>Now let‚Äôs add another categorical variable to this dataset.</p>
<p>Say we are in a situation involving two factors, not one. We have a single observations for every combination of the two factors (i.e., the two factors are <em>crossed</em>).</p>
<p>The second factor, which we‚Äôll call <code>factor</code>, will take on the values ‚ÄúC‚Äù, ‚ÄúD‚Äù, and ‚ÄúE‚Äù.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a>LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;C&quot; &quot;D&quot; &quot;E&quot;</span></span></code></pre></div>
<p>We need to repeat the values in a way that every combination of <code>group</code> and <code>factor</code> is present in the dataset at one time.</p>
<p>Remember the <code>group</code> factor is repeated elementwise.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot;</span></span></code></pre></div>
<p>We need to repeat the three values twice. But what argument do we use in <code>rep()</code> to do so?</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>], ?)</span></code></pre></div>
<p>Does <code>each</code> work?</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;C&quot; &quot;C&quot; &quot;D&quot; &quot;D&quot; &quot;E&quot; &quot;E&quot;</span></span></code></pre></div>
<p>No, if we use <code>each</code> then each element is repeated twice and some of the combinations of <code>group</code> and <code>factor</code> are missing.</p>
<p>This is a job for the <code>times</code> or <code>length.out</code> arguments, so the whole vector is repeated. We can repeat the whole vector twice using <code>times</code>, or use <code>length.out = 6</code>. I do the former.</p>
<p>In the result below we can see every combination of the two factors is present once.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">factor =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">response =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) )</span>
<span id="cb497-4"><a href="#cb497-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group factor response</span></span>
<span id="cb497-5"><a href="#cb497-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     a      C    0.426</span></span>
<span id="cb497-6"><a href="#cb497-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     a      D    0.290</span></span>
<span id="cb497-7"><a href="#cb497-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     a      E   -0.364</span></span>
<span id="cb497-8"><a href="#cb497-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     b      C    1.978</span></span>
<span id="cb497-9"><a href="#cb497-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     b      D    1.087</span></span>
<span id="cb497-10"><a href="#cb497-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     b      E   -0.587</span></span></code></pre></div>
</div>
<div id="simulate-data-with-a-difference-among-groups" class="section level2 hasAnchor" number="81.2">
<h2 class="hasAnchor"><span class="header-section-number">81.2</span> Simulate data with a difference among groups<a href="#simulate-data-with-a-difference-among-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The dataset above is one with ‚Äúno difference‚Äù among groups. What if the means were different between groups? Let‚Äôs make two groups of three observations where the mean of one group is 5 and the other is 10. The two groups have a shared variance (and so standard deviation) of 1.</p>
<p>Remembering how <code>rnorm()</code> works with a vector of means is key here. The function draws iteratively from each distribution.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a>response</span>
<span id="cb498-3"><a href="#cb498-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  4.41 12.48  4.74 10.27  5.37 10.02</span></span></code></pre></div>
<p>How do we get the <code>group</code> pattern correct?</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ?)</span></code></pre></div>
<p>We need to repeat the whole vector three times instead of elementwise.</p>
<p>To get the groups in the correct order we need to use <code>times</code> or <code>length.out</code> in <code>rep()</code>. With <code>length.out</code> we define the output length of the vector, which is 6. Alternatively we could use <code>times = 3</code> to repeat the whole vector 3 times.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">6</span>)</span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a>group</span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;b&quot;</span></span></code></pre></div>
<p>These can then be combined into a data.frame. Working out this process is another reason why sometimes we build each vector separately prior to combining together.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(group,</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a>            response)</span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group response</span></span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     a     4.41</span></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     b    12.48</span></span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     a     4.74</span></span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     b    10.27</span></span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     a     5.37</span></span>
<span id="cb501-9"><a href="#cb501-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     b    10.02</span></span></code></pre></div>
</div>
<div id="multiple-quantitative-variables-with-groups" class="section level2 hasAnchor" number="81.3">
<h2 class="hasAnchor"><span class="header-section-number">81.3</span> Multiple quantitative variables with groups<a href="#multiple-quantitative-variables-with-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For our last dataset we‚Äôll have two groups, with 10 observations per group.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">10</span>)</span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;D&quot; &quot;D&quot; &quot;D&quot; &quot;D&quot; &quot;D&quot; &quot;D&quot; &quot;D&quot; &quot;D&quot; &quot;D&quot;</span></span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20] &quot;D&quot;</span></span></code></pre></div>
<p>Let‚Äôs make a dataset that has two quantitative variables, unrelated to both each other and the groups. One variable ranges from 10 and 15 and one from 100 and 150.</p>
<p>How many observations should we draw from each uniform distribution?</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> ?, <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">15</span>)</span></code></pre></div>
<p>We had 2 groups with 10 observations each and 2*10 = 20. So we need to use <code>n = 20</code> in <code>runif()</code>.</p>
<p>Here is the dataset made in a single step.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">15</span>),</span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">150</span>))</span>
<span id="cb504-4"><a href="#cb504-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    group    x   y</span></span>
<span id="cb504-5"><a href="#cb504-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      C 13.2 127</span></span>
<span id="cb504-6"><a href="#cb504-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      C 13.9 137</span></span>
<span id="cb504-7"><a href="#cb504-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      C 12.7 135</span></span>
<span id="cb504-8"><a href="#cb504-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      C 14.3 123</span></span>
<span id="cb504-9"><a href="#cb504-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      C 11.7 118</span></span>
<span id="cb504-10"><a href="#cb504-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      C 14.6 108</span></span>
<span id="cb504-11"><a href="#cb504-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7      C 12.8 142</span></span>
<span id="cb504-12"><a href="#cb504-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8      C 13.5 104</span></span>
<span id="cb504-13"><a href="#cb504-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9      C 13.9 107</span></span>
<span id="cb504-14"><a href="#cb504-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10     C 12.2 145</span></span>
<span id="cb504-15"><a href="#cb504-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11     D 12.0 117</span></span>
<span id="cb504-16"><a href="#cb504-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12     D 13.7 121</span></span>
<span id="cb504-17"><a href="#cb504-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13     D 14.8 145</span></span>
<span id="cb504-18"><a href="#cb504-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14     D 11.7 120</span></span>
<span id="cb504-19"><a href="#cb504-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15     D 13.3 140</span></span>
<span id="cb504-20"><a href="#cb504-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16     D 10.8 107</span></span>
<span id="cb504-21"><a href="#cb504-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17     D 14.0 148</span></span>
<span id="cb504-22"><a href="#cb504-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18     D 14.9 113</span></span>
<span id="cb504-23"><a href="#cb504-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19     D 13.5 105</span></span>
<span id="cb504-24"><a href="#cb504-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20     D 14.4 120</span></span></code></pre></div>
<p>What happens if we get this wrong? If we‚Äôre lucky we get an error.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">15</span>),</span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">150</span>))</span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in data.frame(group = rep(LETTERS[3:4], each = 10), x = runif(n = 15, : arguments imply differing number of rows: 20, 15</span></span></code></pre></div>
<p>But if we get things wrong and the number we use goes into the number we need evenly, R will <em>recycle</em> the vector to the end of the <code>data.frame()</code>.</p>
<p>This is a hard mistake to catch. If you look carefully through the output below you can see that the continuous variables start to repeat on line 10.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">15</span>),</span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">min =</span> <span class="dv">100</span>, <span class="at">max =</span> <span class="dv">150</span>))</span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    group    x   y</span></span>
<span id="cb506-5"><a href="#cb506-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      C 12.3 108</span></span>
<span id="cb506-6"><a href="#cb506-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      C 13.8 115</span></span>
<span id="cb506-7"><a href="#cb506-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      C 12.4 105</span></span>
<span id="cb506-8"><a href="#cb506-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      C 10.1 125</span></span>
<span id="cb506-9"><a href="#cb506-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      C 10.8 130</span></span>
<span id="cb506-10"><a href="#cb506-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      C 11.0 129</span></span>
<span id="cb506-11"><a href="#cb506-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7      C 11.5 149</span></span>
<span id="cb506-12"><a href="#cb506-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8      C 13.5 139</span></span>
<span id="cb506-13"><a href="#cb506-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9      C 11.6 120</span></span>
<span id="cb506-14"><a href="#cb506-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10     C 12.9 120</span></span>
<span id="cb506-15"><a href="#cb506-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11     D 12.3 108</span></span>
<span id="cb506-16"><a href="#cb506-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12     D 13.8 115</span></span>
<span id="cb506-17"><a href="#cb506-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13     D 12.4 105</span></span>
<span id="cb506-18"><a href="#cb506-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14     D 10.1 125</span></span>
<span id="cb506-19"><a href="#cb506-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15     D 10.8 130</span></span>
<span id="cb506-20"><a href="#cb506-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16     D 11.0 129</span></span>
<span id="cb506-21"><a href="#cb506-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17     D 11.5 149</span></span>
<span id="cb506-22"><a href="#cb506-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18     D 13.5 139</span></span>
<span id="cb506-23"><a href="#cb506-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19     D 11.6 120</span></span>
<span id="cb506-24"><a href="#cb506-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20     D 12.9 120</span></span></code></pre></div>
</div>
</div>
<div id="repeatedly-simulate-data-with-replicate" class="section level1 hasAnchor" number="82">
<h1 class="hasAnchor"><span class="header-section-number">82</span> Repeatedly simulate data with <code>replicate()</code><a href="#repeatedly-simulate-data-with-replicate" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The <code>replicate()</code> function is a real workhorse when making repeated simulations. It is a member of the <em>apply</em> family in R, and is specifically made (per the documentation) for the <em>repeated evaluation of an expression (which will usually involve random number generation)</em>.</p>
<p>We want to repeatedly simulate data that involves random number generation, so that sounds like a useful tool.</p>
<p>The <code>replicate()</code> function takes three arguments:</p>
<ul>
<li><code>n</code>, which is the number of replications to perform. This is to set the number of repeated runs we want.<br />
</li>
<li><code>expr</code>, the expression that should be run repeatedly. This is often a function.<br />
</li>
<li><code>simplify</code>, which controls the type of output the results of <code>expr</code> are saved into. Use <code>simplify = FALSE</code> to get output saved into a list instead of in an array.</li>
</ul>
<div id="simple-example-of-replicate" class="section level2 hasAnchor" number="82.1">
<h2 class="hasAnchor"><span class="header-section-number">82.1</span> Simple example of <code>replicate()</code><a href="#simple-example-of-replicate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs say we want to simulate some values from a normal distribution, which we can do using the <code>rnorm()</code> function as above. But now instead of drawing some number of values from a distribution one time we want to do it many times. This could be something we‚Äôd do when demonstrating the central limit theorem, for example.</p>
<p>Doing the random number generation many times is where <code>replicate()</code> comes in. It allows us to run the function in <code>expr</code> exactly <code>n</code> times.</p>
<p>Here I‚Äôll generate 5 values from a standard normal distribution three times. Notice the addition of <code>simplify = FALSE</code> to get a list as output.</p>
<p>The output below is a list of three vectors. Each vector is from a unique run of the function, so contains five random numbers drawn from the normal distribution with a mean of 0 and standard deviation of 1.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">simplify =</span> <span class="cn">FALSE</span> )</span>
<span id="cb507-5"><a href="#cb507-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb507-6"><a href="#cb507-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.476 -0.125  1.096 -1.444  1.148</span></span>
<span id="cb507-7"><a href="#cb507-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb507-8"><a href="#cb507-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb507-9"><a href="#cb507-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.4684 -1.0060  0.0636  1.0250  0.5731</span></span>
<span id="cb507-10"><a href="#cb507-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb507-11"><a href="#cb507-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb507-12"><a href="#cb507-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  1.847  0.112 -0.746  1.658  0.722</span></span></code></pre></div>
<p>Note if I don‚Äôt use <code>simplify = FALSE</code> I will get a matrix of values instead of a list. Each column in the matrix is the output from one run of the function.</p>
<p>In this case there will be three columns in the output, one for each run, and 5 rows. This can be a useful output type for some simulations. I focus on list output throughout the rest of this post only because that‚Äôs what I have been using recently for simulations.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) )</span>
<span id="cb508-4"><a href="#cb508-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        [,1]    [,2]   [,3]</span></span>
<span id="cb508-5"><a href="#cb508-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]  0.476 -0.4684  1.847</span></span>
<span id="cb508-6"><a href="#cb508-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] -0.125 -1.0060  0.112</span></span>
<span id="cb508-7"><a href="#cb508-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,]  1.096  0.0636 -0.746</span></span>
<span id="cb508-8"><a href="#cb508-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] -1.444  1.0250  1.658</span></span>
<span id="cb508-9"><a href="#cb508-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,]  1.148  0.5731  0.722</span></span></code></pre></div>
</div>
<div id="an-equivalent-for-loop-example" class="section level2 hasAnchor" number="82.2">
<h2 class="hasAnchor"><span class="header-section-number">82.2</span> An equivalent <code>for()</code> loop example<a href="#an-equivalent-for-loop-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <code>for()</code> loop can be used in place of <code>replicate()</code> for simulations. With time and practice I‚Äôve found <code>replicate()</code> to be much more convenient in terms of writing the code. However, in my experience some folks find <code>for()</code> loops intuitive when they are starting out in R. I think it‚Äôs because <code>for()</code> loops are more explicit on the looping process: the user can see the values that <code>i</code> takes and the output for each <code>i</code> iteration is saved into the output object because the code is written out explicitly.</p>
<p>In my example I‚Äôll save the output of each iteration of the loop into a list called <code>list1</code>. I initialize this as an empty list prior to starting the loop. To match what I did with <code>replicate()</code> I do three iterations of the loop (<code>i in 1:3</code>), drawing 5 values via <code>rnorm()</code> each time.</p>
<p>The result is identical to my <code>replicate()</code> code above. It took a little more code to do it but the process is very clear since it is explicitly written out.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a>list1 <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># Make an empty list to save output in</span></span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) { <span class="co"># Indicate number of iterations with &quot;i&quot;</span></span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a>    list1[[i]] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># Save output in list for each iteration</span></span>
<span id="cb509-5"><a href="#cb509-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb509-6"><a href="#cb509-6" aria-hidden="true" tabindex="-1"></a>list1</span>
<span id="cb509-7"><a href="#cb509-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb509-8"><a href="#cb509-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.476 -0.125  1.096 -1.444  1.148</span></span>
<span id="cb509-9"><a href="#cb509-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb509-10"><a href="#cb509-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb509-11"><a href="#cb509-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.4684 -1.0060  0.0636  1.0250  0.5731</span></span>
<span id="cb509-12"><a href="#cb509-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb509-13"><a href="#cb509-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb509-14"><a href="#cb509-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  1.847  0.112 -0.746  1.658  0.722</span></span></code></pre></div>
</div>
<div id="using-replicate-to-repeatedly-make-a-dataset" class="section level2 hasAnchor" number="82.3">
<h2 class="hasAnchor"><span class="header-section-number">82.3</span> Using <code>replicate()</code> to repeatedly make a dataset<a href="#using-replicate-to-repeatedly-make-a-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Earlier we were making datasets with random numbers and some grouping variables. Our code looked like</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">response =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) )</span>
<span id="cb510-3"><a href="#cb510-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group response</span></span>
<span id="cb510-4"><a href="#cb510-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     a   -1.663</span></span>
<span id="cb510-5"><a href="#cb510-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     a    0.576</span></span>
<span id="cb510-6"><a href="#cb510-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     a    0.473</span></span>
<span id="cb510-7"><a href="#cb510-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     b   -0.543</span></span>
<span id="cb510-8"><a href="#cb510-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     b    1.128</span></span>
<span id="cb510-9"><a href="#cb510-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     b   -1.648</span></span></code></pre></div>
<p>We could put this process as the <code>expr</code> argument in <code>replicate()</code> to get many simulated datasets. I would do something like this if I wanted to compare the long-run performance of two different statistical tools using the exact same random datasets.</p>
<p>I‚Äôll replicate things 3 times again to easily see the output. I still use <code>simplify = FALSE</code> to get things into a list.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a>simlist <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, </span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">expr =</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">response =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) ),</span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>We can see this result is a list of three data.frames.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(simlist)</span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ :&#39;data.frame&#39;:    6 obs. of  2 variables:</span></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ group   : chr [1:6] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; ...</span></span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ response: num [1:6] -0.314 -0.183 1.47 -0.866 1.527 ...</span></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ :&#39;data.frame&#39;:    6 obs. of  2 variables:</span></span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ group   : chr [1:6] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; ...</span></span>
<span id="cb512-8"><a href="#cb512-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ response: num [1:6] 1.03 0.84 0.217 -0.673 0.133 ...</span></span>
<span id="cb512-9"><a href="#cb512-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ :&#39;data.frame&#39;:    6 obs. of  2 variables:</span></span>
<span id="cb512-10"><a href="#cb512-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ group   : chr [1:6] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; ...</span></span>
<span id="cb512-11"><a href="#cb512-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ response: num [1:6] -0.943 -1.022 0.281 0.545 0.131 ...</span></span></code></pre></div>
<p>Here is the first one.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a>simlist[[<span class="dv">1</span>]]</span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   group response</span></span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     a   -0.314</span></span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     a   -0.183</span></span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     a    1.470</span></span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     b   -0.866</span></span>
<span id="cb513-7"><a href="#cb513-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     b    1.527</span></span>
<span id="cb513-8"><a href="#cb513-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     b    1.054</span></span></code></pre></div>
</div>
</div>
<div id="whats-the-next-step" class="section level1 hasAnchor" number="83">
<h1 class="hasAnchor"><span class="header-section-number">83</span> What‚Äôs the next step?<a href="#whats-the-next-step" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>I‚Äôm ending here, but there‚Äôs still more to learn about simulations. For a simulation to explore long-run behavior, some process is going to be repeated many times. We did this via <code>replicate()</code>. The next step would be to extract whatever results are of interest. This latter process is often going to involve some sort of looping.</p>
<p>By saving our generated variables or data.frames into a list we‚Äôve made it so we can loop via list looping functions like <code>lapply()</code> or <code>purrr::map()</code>. The family of <em>map</em> functions are newer and have a lot of convenient output types that make them pretty useful. If you want to see how that might look for a simulations, you can see a few examples in my blog post <a href="https://aosmith.rbind.io/2018/06/05/a-closer-look-at-replicate-and-purrr/">A closer look at replicate() and purrr::map() for simulations</a>.</p>
<p>Happy simulating!</p>
<!--chapter:end:1300_simulations.Rmd-->
</div>
<div id="part-module-14" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 14<a href="#part-module-14" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="rshiny" class="section level1 hasAnchor" number="84">
<h1 class="hasAnchor"><span class="header-section-number">84</span> Welcome to interactive web apps<a href="#rshiny" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module will introduce you to interactive web apps. We‚Äôll focus on rshiny. Please watch the videos and work your way through the notes. <strong>The videos start on the next page.</strong> You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYbWGmSnbLIYwdLOnGm6une6">here</a>. Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<pre><code>#&gt; Error in tweet_blockquote(tweet_url = tweet_url, maxwidth = maxwidth,  : 
#&gt;   Not Found (HTTP 404).</code></pre>
<div id="module-materials-13" class="section level2 hasAnchor" number="84.1">
<h2 class="hasAnchor"><span class="header-section-number">84.1</span> Module Materials<a href="#module-materials-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Slides
<ul>
<li><a href="https://datascience4psych.github.io/slides/d28_interactive/d28_interactive.html">Interactive web apps</a></li>
</ul></li>
<li>Videos
<ul>
<li>Curated Videos</li>
</ul></li>
<li>Readings
<ul>
<li><a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/">Rstudio tutorial</a></li>
<li>Written Lecture Notes</li>
</ul></li>
<li>Lab
<ul>
<li>No Lab!</li>
</ul></li>
</ul>
</div>
</div>
<div id="rshiny-overview" class="section level1 hasAnchor" number="85">
<h1 class="hasAnchor"><span class="header-section-number">85</span> RShiny Overview<a href="#rshiny-overview" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>You can follow along with the slides <a href="https://datascience4psych.github.io/slides/d28_interactive/d28_interactive.html">here</a> if they do not appear below.</p>
<iframe src="https://datascience4psych.github.io/slides/d28_interactive/d28_interactive.html" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="practical-advice-from-the-data-professor" class="section level1 hasAnchor" number="86">
<h1 class="hasAnchor"><span class="header-section-number">86</span> Practical Advice from the Data Professor<a href="#practical-advice-from-the-data-professor" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>I‚Äôve outsourced the practical videos because, frankly, I‚Äôm a novice when it comes to rshiny. I know enough to be dangerous, but not enough to wield that power for teaching. However, my good twitter friend, <a href="https://twitter.com/thedataprof">the Data Professor</a> has that power. You should check out his <a href="https://www.youtube.com/channel/UCV8e2g4IWQqK71bbzGDEI4Q">youtube channel</a></p>
<div id="web-apps-in-r-building-your-first-web-application-in-r" class="section level2 hasAnchor" number="86.1">
<h2 class="hasAnchor"><span class="header-section-number">86.1</span> Web Apps in R: Building your First Web Application in R<a href="#web-apps-in-r-building-your-first-web-application-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/tfN10IUX9Lo" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="web-apps-in-r-build-interactive-histogram-web-application-in-r" class="section level2 hasAnchor" number="86.2">
<h2 class="hasAnchor"><span class="header-section-number">86.2</span> Web Apps in R: Build Interactive Histogram Web Application in R<a href="#web-apps-in-r-build-interactive-histogram-web-application-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/lC1Dk6gUbe0" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="web-apps-in-r-building-data-driven-web-application-in-r" class="section level2 hasAnchor" number="86.3">
<h2 class="hasAnchor"><span class="header-section-number">86.3</span> Web Apps in R: Building Data-Driven Web Application in R<a href="#web-apps-in-r-building-data-driven-web-application-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/CYXvVuklWRM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="web-apps-in-r-building-the-machine-learning-web-application-in-r" class="section level2 hasAnchor" number="86.4">
<h2 class="hasAnchor"><span class="header-section-number">86.4</span> Web Apps in R: Building the Machine Learning Web Application in R<a href="#web-apps-in-r-building-the-machine-learning-web-application-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/ceg7MMQNln8" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="web-apps-in-r-build-bmi-calculator-web-application-in-r-for-health-monitoring" class="section level2 hasAnchor" number="86.5">
<h2 class="hasAnchor"><span class="header-section-number">86.5</span> Web Apps in R: Build BMI Calculator web application in R for health monitoring<a href="#web-apps-in-r-build-bmi-calculator-web-application-in-r-for-health-monitoring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/9EQ6cwBQpvo" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--HappyGitWithR Links-->
<!--Package Links-->
<!--Shiny links-->
<!--Publications-->
<!--R Documentation-->
<!--Wikipedia Links-->
<!--Misc. Links-->
<!--chapter:end:1401_rshiny.Rmd-->
</div>
</div>
<div id="shiny-overview" class="section level1 hasAnchor" number="87">
<h1 class="hasAnchor"><span class="header-section-number">87</span> All the Shiny things<a href="#shiny-overview" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These notes are adapted from Jenny Bryan and Dean Attali.</p>
<!--Original content: https://stat545.com/shiny00_index.html

* Chapter \@ref(shiny-slides) - Slides to accompany Chapter \@ref(shiny-tutorial).
* Chapter \@ref(shiny-tutorial) - Shiny tutorial with hands-on activity to build [this app](https://daattali.com/shiny/bcl/) using the BC Liquor Store dataset.
-->
<div id="shiny-slides" class="section level2 hasAnchor" number="87.1">
<h2 class="hasAnchor"><span class="header-section-number">87.1</span> Building Slides<a href="#shiny-slides" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>See <a href="https://docs.google.com/presentation/d/1dXhqqsD7dPOOdcC5Y7RW--dEU7UfU52qlb0YD3kKeLw/edit#slide=id.p">‚ÄúBuilding Shiny Apps‚Äù slides</a> by Dean Attali.</p>
</div>
<div id="shiny-tutorial" class="section level2 hasAnchor" number="87.2">
<h2 class="hasAnchor"><span class="header-section-number">87.2</span> Building Shiny apps<a href="#shiny-tutorial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--Original content: https://stat545.com/shiny01_activity.html-->
<!--Original Author: Dean Attali-->
<p><a href="https://shiny.rstudio.com">Shiny</a> is a package from RStudio that can be used to build interactive web pages with R. While that may sound scary because of the words ‚Äúweb pages‚Äù, Shiny is geared to R users who have zero experience with web development, and you do not need to know any HTML/CSS/JavaScript.</p>
<p>You can do quite a lot with Shiny: think of it as an easy way to make an interactive web page, and that web page can seamlessly interact with R and display R objects (plots, tables, of anything else you do in R). To get a sense of the wide range of things you can do with Shiny, you can visit my Shiny server (<a href="https://daattali.com/shiny/" class="uri">https://daattali.com/shiny/</a>), which hosts some of my own Shiny apps.</p>
<p>This tutorial is a hands-on activity complement to a set of <a href="#shiny-slides">presentation slides</a> for learning how to build Shiny apps. In this activity, we‚Äôll walk through all the steps of building a Shiny app using a dataset that lets you explore the products available at the BC Liquor Store. The final version of the app, including a few extra features that are left as exercises for the reader, can be seen here: <a href="https://daattali.com/shiny/bcl/" class="uri">https://daattali.com/shiny/bcl/</a>. Any activity deemed as an exercise throughout this tutorial is not mandatory for building our app, but they are good for getting more practice with Shiny.</p>
<p>This tutorial should take approximately an hour to complete. If you want even more practice, another great tutorial is the <a href="https://shiny.rstudio.com/tutorial/">official Shiny tutorial</a>. RStudio also provides a <a href="https://shiny.rstudio.com/images/shiny-cheatsheet.pdf">handy cheatsheet</a> to remember all the little details after you already learned the basics.</p>
<div id="shiny-tutorial-1" class="section level3 hasAnchor" number="87.2.1">
<h3 class="hasAnchor"><span class="header-section-number">87.2.1</span> Before we begin<a href="#shiny-tutorial-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You‚Äôll need to have the shiny package, so install it.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;shiny&quot;</span>)</span></code></pre></div>
<p>To ensure you successfully installed Shiny, try running one of the demo apps.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="fu">runExample</span>(<span class="st">&quot;01_hello&quot;</span>)</span></code></pre></div>
<p>If the example app is running, press <em>Escape</em> to close the app, and you are ready to build your first Shiny app!</p>
<p><strong>Exercise:</strong> Visit <a href="https://www.showmeshiny.com/" class="uri">https://www.showmeshiny.com/</a>, which is a gallery of user-submitted Shiny apps, and click through some of the showcased apps. Get a feel for the wide range of things you can do with Shiny.</p>
</div>
<div id="shiny-tutorial-2" class="section level3 hasAnchor" number="87.2.2">
<h3 class="hasAnchor"><span class="header-section-number">87.2.2</span> Shiny app basics<a href="#shiny-tutorial-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Every Shiny app is composed of a two parts: a web page that shows the app to the user, and a computer that powers the app. The computer that runs the app can either be your own laptop (such as when you‚Äôre running an app from RStudio) or a server somewhere else. You, as the Shiny app developer, need to write these two parts (you‚Äôre not going to write a computer, but rather the code that powers the app). In Shiny terminology, they are called <em>UI</em> (user interface) and <em>server</em>.</p>
<p>UI is just a web document that the user gets to see, it‚Äôs HTML that you write using Shiny‚Äôs functions. The UI is responsible for creating the layout of the app and telling Shiny exactly where things go. The server is responsible for the logic of the app; it‚Äôs the set of instructions that tell the web page what to show when the user interacts with the page.</p>
<p>If you look at the app we will be building (<a href="http://daattali.com/shiny/bcl/" class="uri">http://daattali.com/shiny/bcl/</a>), the page that you see is built with the UI code. You‚Äôll notice there are some controls that you, as the user, can manipulate. If you adjust the price or choose a country, you‚Äôll notice that the plot and the table get updated. The UI is responsible for creating these controls and telling Shiny <em>where</em> to place the controls and where to place the plot and table, while the server is responsible for creating the actual plot or the data in the table.</p>
</div>
<div id="shiny-tutorial-3" class="section level3 hasAnchor" number="87.2.3">
<h3 class="hasAnchor"><span class="header-section-number">87.2.3</span> Create an empty Shiny app<a href="#shiny-tutorial-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All Shiny apps follow the same template:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>()</span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {}</span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>This template is by itself a working minimal Shiny app that doesn‚Äôt do much. It initializes an empty UI and an empty server, and runs an app using these empty parts. Copy this template into a new file named <code>app.R</code> in a new folder. It is <strong>very important</strong> that the name of the file is <code>app.R</code>, otherwise it would not be recognized as a Shiny app. It is also <strong>very important</strong> that you place this app in its own folder, and not in a folder that already has other R scripts or files, unless those other files are used by your app.</p>
<p>After saving the file, RStudio should recognize that this is a Shiny app, and you should see the usual <em>Run</em> button at the top change to <em>Run App</em>.</p>
<div class="figure">
<img src="img/shiny-runapp.png" alt="Shiny run app button" width="93%" />
<p class="caption">
(#fig:unnamed-chunk-3)Shiny run app button
</p>
</div>
<p>If you don‚Äôt see the <em>Run App</em> button, it means you either have a very old version of RStudio, don‚Äôt have Shiny installed, or didn‚Äôt follow the file naming conventions.</p>
<p>Click the <em>Run App</em> button, and now your app should run. You won‚Äôt see much because it‚Äôs an empty app, but you should see that the R Console has some text printed in the form of <code>Listening on http://127.0.0.1:5274</code> and that a little stop sign appeared at the top of the R Console You‚Äôll also notice that you can‚Äôt run any commands in the R Console This is because R is busy - your R session is currently powering a Shiny app and listening for user interaction (which won‚Äôt happen because the app has nothing in it yet).</p>
<p>Click the stop button to stop the app, or press the <em>Escape</em> key.</p>
<div class="figure">
<img src="img/shiny-stopapp.png" alt="Shiny stop app button" width="93%" />
<p class="caption">
(#fig:unnamed-chunk-4)Shiny stop app button
</p>
</div>
<p>You may have noticed that when you click the <em>Run App</em> button, all it‚Äôs doing is just running the function <code>shiny::runApp()</code> in the R Console You can run that command instead of clicking the button if you prefer.</p>
<p><strong>Exercise:</strong> Try running the empty app using the <code>runApp()</code> function instead of using the <em>Run App</em> button.</p>
<div id="alternate-way-to-create-a-shiny-app-separate-ui-and-server-files" class="section level4 hasAnchor" number="87.2.3.1">
<h4 class="hasAnchor"><span class="header-section-number">87.2.3.1</span> Alternate way to create a Shiny app: separate UI and server files<a href="#alternate-way-to-create-a-shiny-app-separate-ui-and-server-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another way to define a Shiny app is by separating the UI and server code into two files: <code>ui.R</code> and <code>server.R</code>. This is the preferable way to write Shiny apps when the app is complex and involves more code, but in this tutorial we‚Äôll stick to the simple single file. If you want to break up your app into these two files, you simply put all code that is assigned to the <code>ui</code> variable in <code>ui.R</code> and all the code assigned to the <code>server</code> function in <code>server.R</code>. When RStudio sees these two files in the same folder, it will know you‚Äôre writing a Shiny app.</p>
<p><strong>Exercise:</strong> Try making a new Shiny app by creating the two files <code>ui.R</code> and <code>server.R</code>. Remember that they have to be in the same folder. Also remember to put them in a <em>new, isolated</em> folder (not where your <code>app.R</code> already exists).</p>
</div>
<div id="let-rstudio-fill-out-a-shiny-app-template-for-you" class="section level4 hasAnchor" number="87.2.3.2">
<h4 class="hasAnchor"><span class="header-section-number">87.2.3.2</span> Let RStudio fill out a Shiny app template for you<a href="#let-rstudio-fill-out-a-shiny-app-template-for-you" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can also create a new Shiny app using RStudio‚Äôs menu by selecting <em>File &gt; New File &gt; Shiny Web App‚Ä¶</em>. If you do this, RStudio will let you choose if you want a single-file app (<code>app.R</code>) or a two-file app (<code>ui.R</code>+<code>server.R</code>). RStudio will initialize a simple functional Shiny app with some code in it. I personally don‚Äôt use this feature because I find it easier to simply type the few lines of a Shiny app and save the files.</p>
</div>
</div>
<div id="shiny-tutorial-4" class="section level3 hasAnchor" number="87.2.4">
<h3 class="hasAnchor"><span class="header-section-number">87.2.4</span> Load the dataset<a href="#shiny-tutorial-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--TODO:
Link to the original dataset no longer works. The closest thing I could find is [this](https://catalogue.data.gov.bc.ca/dataset/bc-liquor-store-product-price-list-historical-prices) but it was just modified in 2019. The csv at deanattali.com is still live so will just refer to that for now. 
-->
<p>The dataset we‚Äôll be using contains information about all the products sold by BC Liquor Store and is provided by <a href="https://www.opendatabc.ca/dataset/bc-liquor-store-product-price-list-current-prices">OpenDataBC</a>. They provide a direct link to download a CSV version of the data, and this data has the rare quality that it is immediately clean and useful. You can view the <a href="http://pub.data.gov.bc.ca/datasets/176284/BC_Liquor_Store_Product_Price_List.csv">raw data</a> they provide, but I have taken a few steps to simplify the dataset to make it more useful for our app. I removed some columns, renamed other columns, and dropped a few rare factor levels.</p>
<p>The processed dataset we‚Äôll be using in this app is available <a href="https://deanattali.com/files/bcl-data.csv">here</a>. Download it now and place this file in the same folder as your Shiny app. Make sure the file is named <code>bcl-data.csv</code>.</p>
<p>Add a line in your app to load the data into a variable called <code>bcl</code>. It should look something like this</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>bcl <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bcl-data.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Place this line in your app as the second line, just after <code>library(shiny)</code>. Make sure the file path and file name are correct, otherwise your app won‚Äôt run. Try to run the app to make sure the file can be loaded without errors.</p>
<p>If you want to verify that the app can successfully read the data, you can add a <code>print()</code> statement after reading the data. This won‚Äôt make anything happen in your Shiny app, but you will see a summary of the dataset printed in the R Console, which should let you know that the dataset was indeed loaded correctly. You can place the following line after reading the data:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(bcl))</span></code></pre></div>
<p>Once you get confirmation that the data is properly loaded, you can remove that line.</p>
<blockquote>
<p>In case you‚Äôre curious, the code Jenny and Dean used to process the raw data into the data we‚Äôll be using is available <a href="https://gist.github.com/daattali/56b9fa8f3e99174fba63">as a gist</a>.</p>
</blockquote>
<p><strong>Exercise:</strong> Load the data file into R and get a feel for what‚Äôs in it. How big is it, what variables are there, what are the normal price ranges, etc.</p>
</div>
</div>
<div id="shiny-tutorial-5" class="section level2 hasAnchor" number="87.3">
<h2 class="hasAnchor"><span class="header-section-number">87.3</span> Build the basic UI<a href="#shiny-tutorial-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let‚Äôs start populating our app with some elements visually. This is usually the first thing you do when writing a Shiny app - add elements to the UI.</p>
<div id="add-plain-text-to-the-ui" class="section level3 hasAnchor" number="87.3.1">
<h3 class="hasAnchor"><span class="header-section-number">87.3.1</span> Add plain text to the UI<a href="#add-plain-text-to-the-ui" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can place R strings inside <code>fluidPage()</code> to render text.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(<span class="st">&quot;BC Liquor Store&quot;</span>, <span class="st">&quot;prices&quot;</span>)</span></code></pre></div>
<p>Replace the line in your app that assigns an empty <code>fluidPage()</code> into <code>ui</code> with the one above, and run the app.</p>
<p>The entire UI will be built by passing comma-separated arguments into the <code>fluidPage()</code> function. By passing regular text, the web page will just render boring unformatted text.</p>
<p><strong>Exercise:</strong> Add several more strings to <code>fluidPage()</code> and run the app. Nothing too exciting is happening yet, but you should just see all the text appear in one contiguous block.</p>
<div id="add-formatted-text-and-other-html-elements" class="section level4 hasAnchor" number="87.3.1.1">
<h4 class="hasAnchor"><span class="header-section-number">87.3.1.1</span> Add formatted text and other HTML elements<a href="#add-formatted-text-and-other-html-elements" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we want our text to be formatted nicer, Shiny has many functions that are wrappers around HTML tags that format text. We can use the‚Ä¶</p>
<ul>
<li><code>h1()</code> function for a top-level header (<code>&lt;h1&gt;</code> in HTML)</li>
<li><code>h2()</code> for a secondary header (<code>&lt;h2&gt;</code> in HTML)</li>
<li><code>strong()</code> to make text bold (<code>&lt;strong&gt;</code> in HTML)</li>
<li><code>em()</code> to make text italicized (<code>&lt;em&gt;</code> in HTML)</li>
<li>‚Ä¶and many more.</li>
</ul>
<p>There are also functions that are wrappers to other HTML tags, such as <code>br()</code> for a line break, <code>img()</code> for an image, <code>a()</code> for a hyperlink, and others.</p>
<p>All of these functions are actually just wrappers to HTML tags with the equivalent name. You can add any arbitrary HTML tag using the <code>tags</code> object, which you can learn more about by reading the help file via <code>?tags</code>.</p>
<p>Just as a demonstration, try replacing the <code>fluidPage()</code> function in your UI with the following:</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">h1</span>(<span class="st">&quot;My app&quot;</span>),</span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;BC&quot;</span>,</span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Liquor&quot;</span>,</span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">br</span>(),</span>
<span id="cb521-6"><a href="#cb521-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Store&quot;</span>,</span>
<span id="cb521-7"><a href="#cb521-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">strong</span>(<span class="st">&quot;prices&quot;</span>)</span>
<span id="cb521-8"><a href="#cb521-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Run the app with this code as the UI. Notice the formatting of the text and understand why it is rendered that way.</p>
<blockquote>
<p>For people who know basic HTML: any named argument you pass to an HTML function becomes an attribute of the HTML element, and any unnamed argument will be a child of the element. That means that you can, for example, create blue text with <code>div("this is blue", style = "color: blue;")</code>.</p>
</blockquote>
<p><strong>Exercise:</strong> Experiment with different HTML-wrapper functions inside <code>fluidPage()</code>. Run the <code>fluidPage(...)</code> function in the R Console and see the HTML that it creates.</p>
</div>
<div id="add-a-title" class="section level4 hasAnchor" number="87.3.1.2">
<h4 class="hasAnchor"><span class="header-section-number">87.3.1.2</span> Add a title<a href="#add-a-title" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We could add a title to the app with <code>h1()</code>, but Shiny also has a special function <code>titlePanel()</code>. Using <code>titlePanel()</code> not only adds a visible big title-like text to the top of the page, but it also sets the ‚Äúofficial‚Äù title of the web page. This means that when you look at the name of the tab in the browser, you‚Äôll see this title.</p>
<p>Overwrite the <code>fluidPage()</code> that you experimented with so far, and replace it with the simple one below, that simply has a title and nothing else.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;BC Liquor Store prices&quot;</span>)</span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Exercise:</strong> Look at the documentation for the <code>titlePanel()</code> function and notice it has another argument. Use that argument and see if you can see what it does.</p>
</div>
<div id="add-a-layout" class="section level4 hasAnchor" number="87.3.1.3">
<h4 class="hasAnchor"><span class="header-section-number">87.3.1.3</span> Add a layout<a href="#add-a-layout" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You may have noticed that so far, by just adding text and HTML tags, everything is unstructured and the elements simply stack up one below the other in one column. We‚Äôll use <code>sidebarLayout()</code> to add a simple structure. It provides a simple two-column layout with a smaller sidebar and a larger main panel. We‚Äôll build our app such that all the inputs that the user can manipulate will be in the sidebar, and the results will be shown in the main panel on the right.</p>
<p>Add the following code after the <code>titlePanel()</code></p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sidebarLayout</span>(</span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarPanel</span>(<span class="st">&quot;our inputs will go here&quot;</span>),</span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mainPanel</span>(<span class="st">&quot;the results will go here&quot;</span>)</span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Remember that all the arguments inside <code>fluidPage()</code> need to be separated by commas.</p>
<p>So far our complete app looks like this (hopefully this isn‚Äôt a surprise to you):</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true" tabindex="-1"></a>bcl <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bcl-data.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-4"><a href="#cb524-4" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb524-5"><a href="#cb524-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;BC Liquor Store prices&quot;</span>),</span>
<span id="cb524-6"><a href="#cb524-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb524-7"><a href="#cb524-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(<span class="st">&quot;our inputs will go here&quot;</span>),</span>
<span id="cb524-8"><a href="#cb524-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(<span class="st">&quot;the results will go here&quot;</span>)</span>
<span id="cb524-9"><a href="#cb524-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb524-10"><a href="#cb524-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb524-11"><a href="#cb524-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-12"><a href="#cb524-12" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {}</span>
<span id="cb524-13"><a href="#cb524-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-14"><a href="#cb524-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<div class="figure">
<img src="img/shiny-layout.png" alt="Our Shiny app so far" width="93%" />
<p class="caption">
(#fig:unnamed-chunk-5)Our Shiny app so far
</p>
</div>
<blockquote>
<p>If you want to be a lot more flexible with the design, you can have much more fine control over where things go by using a grid layout. We won‚Äôt cover that here, but if you‚Äôre interested, look at the documentation for <code>?column</code> and <code>?fluidRow</code>.</p>
</blockquote>
<p><strong>Exercise:</strong> Add some UI into each of the two panels (sidebar panel and main panel) and see how your app now has two columns.</p>
</div>
<div id="all-ui-functions-are-simply-html-wrappers" class="section level4 hasAnchor" number="87.3.1.4">
<h4 class="hasAnchor"><span class="header-section-number">87.3.1.4</span> All UI functions are simply HTML wrappers<a href="#all-ui-functions-are-simply-html-wrappers" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It‚Äôs important to remember: the entire UI is just HTML, and Shiny simply gives you easy tools to write it without having to know HTML. To convince yourself of this reality, look at the output when printing the contents of the <code>ui</code> variable.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ui)</span></code></pre></div>
<div class="sourceCode" id="cb526"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## &lt;div class=&quot;container-fluid&quot;&gt;</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a><span class="fu">##   &lt;h2&gt;BC Liquor Store prices&lt;/h2&gt;</span></span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a><span class="fu">##   &lt;div class=&quot;row&quot;&gt;</span></span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a><span class="fu">##     &lt;div class=&quot;col-sm-4&quot;&gt;</span></span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a><span class="fu">##       &lt;form class=&quot;well&quot;&gt;our inputs will go here&lt;/form&gt;</span></span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a><span class="fu">##     &lt;/div&gt;</span></span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true" tabindex="-1"></a><span class="fu">##     &lt;div class=&quot;col-sm-8&quot;&gt;the results will go here&lt;/div&gt;</span></span>
<span id="cb526-8"><a href="#cb526-8" aria-hidden="true" tabindex="-1"></a><span class="fu">##   &lt;/div&gt;</span></span>
<span id="cb526-9"><a href="#cb526-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## &lt;/div&gt;</span></span></code></pre></div>
<p>This output should make you appreciate Shiny for not making you write horrendous HTML by hand.</p>
</div>
</div>
<div id="shiny-tutorial-6" class="section level3 hasAnchor" number="87.3.2">
<h3 class="hasAnchor"><span class="header-section-number">87.3.2</span> Add inputs to the UI<a href="#shiny-tutorial-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inputs are what gives users a way to interact with a Shiny app. Shiny provides many input functions to support many kinds of interactions that the user could have with an app. For example, <code>textInput()</code> is used to let the user enter text, <code>numericInput()</code> lets the user select a number, <code>dateInput()</code> is for selecting a date, and <code>selectInput()</code> is for creating a select box (a.k.a. a dropdown menu).</p>
<div class="figure">
<img src="img/shiny-inputs.png" alt="Shiny inputs" width="93%" />
<p class="caption">
(#fig:unnamed-chunk-6)Shiny inputs
</p>
</div>
<p>All input functions have the same first two arguments: <code>inputId</code> and <code>label</code>. The <code>inputId</code> will be the name that Shiny will use to refer to this input when you want to retrieve its current value. It is important to note that every input must have a unique <code>inputId</code>. If you give more than one input the same <code>inputId</code>, Shiny will unfortunately not give you an explicit error, but your app won‚Äôt work correctly. The <code>label</code> argument specifies the text in the display label that goes along with the input widget. Every input can also have multiple other arguments specific to that input type. The only way to find out what arguments you can use with a specific input function is to look at its help file.</p>
<p><strong>Exercise:</strong> Read the documentation of <code>numericInput</code> (via <code>?numericInput</code>) and try adding a numeric input to the UI. Experiment with the different arguments. Run the app and see how you can interact with this input. Then try different inputs types.</p>
<div id="input-for-price" class="section level4 hasAnchor" number="87.3.2.1">
<h4 class="hasAnchor"><span class="header-section-number">87.3.2.1</span> Input for price<a href="#input-for-price" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first input we want to have is for specifying a price range (minimum and maximum price). The most sensible types of input for this are either <code>numericInput()</code> or <code>sliderInput()</code> since they are both used for selecting numbers. If we use <code>numericInput()</code>, we‚Äôd have to use two inputs, one for the minimum value and one for the maximum. Looking at the documentation for <code>sliderInput()</code>, you‚Äôll see that by supplying a vector of length two as the <code>value</code> argument, it can be used to specify a range rather than a single number. This sounds like what we want in this case, so we‚Äôll use <code>sliderInput()</code>.</p>
<p>To create a slider input, a maximum value needs to be provided. We could use the maximum price in the dataset, which is $30,250, but I doubt I‚Äôd ever buy something that expensive. I think $100 is a more reasonable max price for me, and about 85% of the products in this dataset are below $100, so let‚Äôs use that as our max.</p>
<p>By looking at the documentation for the slider input function, the following piece of code can be constructed.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sliderInput</span>(<span class="st">&quot;priceInput&quot;</span>, <span class="st">&quot;Price&quot;</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>,</span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">40</span>), <span class="at">pre =</span> <span class="st">&quot;$&quot;</span>)</span></code></pre></div>
<p>Place the code for the slider input inside <code>sidebarPanel()</code> (replace the text we wrote earlier with this input).</p>
<p><strong>Exercise:</strong> Run the code of the <code>sliderInput()</code> in the R Console and see what it returns. Change some of the parameters of <code>sliderInput()</code>, and see how that changes the result. It‚Äôs important to truly understand that all these functions in the UI are simply a convenient way to write HTML, as is apparent whenever you run these functions on their own.</p>
</div>
<div id="input-for-product-type" class="section level4 hasAnchor" number="87.3.2.2">
<h4 class="hasAnchor"><span class="header-section-number">87.3.2.2</span> Input for product type<a href="#input-for-product-type" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Usually when going to the liquor store you know whether you‚Äôre looking for beer or wine, and you don‚Äôt want to waste your time in the wrong section. The same is true in our app, we should be able to choose what type of product we want.</p>
<p>For this we want some kind of a text input. But allowing the user to enter text freely isn‚Äôt the right solution because we want to restrict the user to only a few choices. We could either use radio buttons or a select box for our purpose. Let‚Äôs use radio buttons for now since there are only a few options, so take a look at the documentation for <code>radioButtons()</code> and come up with a reasonable input function code. It should look like this:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">radioButtons</span>(<span class="st">&quot;typeInput&quot;</span>, <span class="st">&quot;Product type&quot;</span>,</span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;BEER&quot;</span>, <span class="st">&quot;REFRESHMENT&quot;</span>, <span class="st">&quot;SPIRITS&quot;</span>, <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">selected =</span> <span class="st">&quot;WINE&quot;</span>)</span></code></pre></div>
<p>Add this input code inside <code>sidebarPanel()</code>, after the previous input (separate them with a comma).</p>
<blockquote>
<p>If you look at that input function and think ‚Äúwhat if there were 100 types, listing them by hand would not be fun, there‚Äôs got to be a better way!‚Äù, then you‚Äôre right. This is where <a href="#shiny-tutorial-11"><code>uiOutput()</code></a> comes in handy, but we‚Äôll talk about that later.</p>
</blockquote>
</div>
<div id="input-for-country" class="section level4 hasAnchor" number="87.3.2.3">
<h4 class="hasAnchor"><span class="header-section-number">87.3.2.3</span> Input for country<a href="#input-for-country" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sometimes Dean and Jenny like to feel fancy and only look for wines imported from France. We should add one last input, to select a <code>Country</code>. The most appropriate input type in this case is probably the select box. Look at the documentation for <code>selectInput()</code> and create an input function. For now let‚Äôs only have <code>"CANADA"</code>, <code>"FRANCE"</code>, <code>"ITALY"</code> as options, and later we‚Äôll see how to include all countries.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">selectInput</span>(<span class="st">&quot;countryInput&quot;</span>, <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;CANADA&quot;</span>, <span class="st">&quot;FRANCE&quot;</span>, <span class="st">&quot;ITALY&quot;</span>))</span></code></pre></div>
<p>Add this function as well to your app. If you followed along, your entire app should have this code:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a>bcl <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bcl-data.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-4"><a href="#cb530-4" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb530-5"><a href="#cb530-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;BC Liquor Store prices&quot;</span>),</span>
<span id="cb530-6"><a href="#cb530-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb530-7"><a href="#cb530-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb530-8"><a href="#cb530-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;priceInput&quot;</span>, <span class="st">&quot;Price&quot;</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">40</span>), <span class="at">pre =</span> <span class="st">&quot;$&quot;</span>),</span>
<span id="cb530-9"><a href="#cb530-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">radioButtons</span>(<span class="st">&quot;typeInput&quot;</span>, <span class="st">&quot;Product type&quot;</span>,</span>
<span id="cb530-10"><a href="#cb530-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;BEER&quot;</span>, <span class="st">&quot;REFRESHMENT&quot;</span>, <span class="st">&quot;SPIRITS&quot;</span>, <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb530-11"><a href="#cb530-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb530-12"><a href="#cb530-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">&quot;countryInput&quot;</span>, <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb530-13"><a href="#cb530-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;CANADA&quot;</span>, <span class="st">&quot;FRANCE&quot;</span>, <span class="st">&quot;ITALY&quot;</span>))</span>
<span id="cb530-14"><a href="#cb530-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb530-15"><a href="#cb530-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(<span class="st">&quot;the results will go here&quot;</span>)</span>
<span id="cb530-16"><a href="#cb530-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb530-17"><a href="#cb530-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb530-18"><a href="#cb530-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-19"><a href="#cb530-19" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {}</span>
<span id="cb530-20"><a href="#cb530-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb530-21"><a href="#cb530-21" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<div class="figure">
<img src="img/shiny-addinputs.png" alt="Adding inputs to our Shiny app" width="93%" />
<p class="caption">
(#fig:unnamed-chunk-7)Adding inputs to our Shiny app
</p>
</div>
</div>
</div>
<div id="shiny-tutorial-7" class="section level3 hasAnchor" number="87.3.3">
<h3 class="hasAnchor"><span class="header-section-number">87.3.3</span> Add placeholders for outputs<a href="#shiny-tutorial-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After creating all the inputs, we should add elements to the UI to display the outputs. Outputs can be any object that R creates and that we want to display in our app - such as a plot, a table, or text. We‚Äôre still only building the UI, so at this point we can only add <em>placeholders</em> for the outputs that will determine where an output will be and what its ID is, but it won‚Äôt actually show anything. Each output needs to be constructed in the server code later.</p>
<p>Shiny provides several output functions, one for each type of output. Similarly to the input functions, all the output functions have a <code>outputId</code> argument that is used to identify each output, and this argument must be unique for each output.</p>
<div id="output-for-a-plot-of-the-results" class="section level4 hasAnchor" number="87.3.3.1">
<h4 class="hasAnchor"><span class="header-section-number">87.3.3.1</span> Output for a plot of the results<a href="#output-for-a-plot-of-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>At the top of the main panel we‚Äôll have a plot showing some visualization of the results. Since we want a plot, the function we use is <code>plotOutput()</code>.</p>
<p>Add the following code into the <code>mainPanel()</code> (replace the existing text):</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotOutput</span>(<span class="st">&quot;coolplot&quot;</span>)</span></code></pre></div>
<p>This will add a placeholder in the UI for a plot named <em>coolplot</em>.</p>
<p><strong>Exercise:</strong> To remind yourself that we are still merely constructing HTML and not creating actual plots yet, run the above <code>plotOutput()</code> function in the R Console to see that all it does is create some HTML.</p>
</div>
</div>
<div id="output-for-a-table-summary-of-the-results" class="section level3 hasAnchor" number="87.3.4">
<h3 class="hasAnchor"><span class="header-section-number">87.3.4</span> Output for a table summary of the results<a href="#output-for-a-table-summary-of-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below the plot, we will have a table that shows all the results. To get a table, we use the <code>tableOutput()</code> function.</p>
<p>Here is a simple way to create a UI element that will hold a table output:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tableOutput</span>(<span class="st">&quot;results&quot;</span>)</span></code></pre></div>
<p>Add this output to the <code>mainPanel()</code> as well. Maybe add a couple <code>br()</code> in between the two outputs, just as a space buffer so that they aren‚Äôt too close to each other.</p>
</div>
</div>
<div id="shiny-tutorial-8" class="section level2 hasAnchor" number="87.4">
<h2 class="hasAnchor"><span class="header-section-number">87.4</span> Checkpoint: what our app looks like after implementing the UI<a href="#shiny-tutorial-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you‚Äôve followed along, your app should now have this code:</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a>bcl <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bcl-data.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-4"><a href="#cb533-4" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb533-5"><a href="#cb533-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;BC Liquor Store prices&quot;</span>),</span>
<span id="cb533-6"><a href="#cb533-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb533-7"><a href="#cb533-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb533-8"><a href="#cb533-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;priceInput&quot;</span>, <span class="st">&quot;Price&quot;</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">40</span>), <span class="at">pre =</span> <span class="st">&quot;$&quot;</span>),</span>
<span id="cb533-9"><a href="#cb533-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">radioButtons</span>(<span class="st">&quot;typeInput&quot;</span>, <span class="st">&quot;Product type&quot;</span>,</span>
<span id="cb533-10"><a href="#cb533-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;BEER&quot;</span>, <span class="st">&quot;REFRESHMENT&quot;</span>, <span class="st">&quot;SPIRITS&quot;</span>, <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb533-11"><a href="#cb533-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb533-12"><a href="#cb533-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">&quot;countryInput&quot;</span>, <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb533-13"><a href="#cb533-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;CANADA&quot;</span>, <span class="st">&quot;FRANCE&quot;</span>, <span class="st">&quot;ITALY&quot;</span>))</span>
<span id="cb533-14"><a href="#cb533-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb533-15"><a href="#cb533-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb533-16"><a href="#cb533-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;coolplot&quot;</span>),</span>
<span id="cb533-17"><a href="#cb533-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">br</span>(), <span class="fu">br</span>(),</span>
<span id="cb533-18"><a href="#cb533-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tableOutput</span>(<span class="st">&quot;results&quot;</span>)</span>
<span id="cb533-19"><a href="#cb533-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb533-20"><a href="#cb533-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb533-21"><a href="#cb533-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb533-22"><a href="#cb533-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-23"><a href="#cb533-23" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {}</span>
<span id="cb533-24"><a href="#cb533-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb533-25"><a href="#cb533-25" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<div id="shiny-tutorial-9" class="section level3 hasAnchor" number="87.4.1">
<h3 class="hasAnchor"><span class="header-section-number">87.4.1</span> Implement server logic to create outputs<a href="#shiny-tutorial-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far we only wrote code inside that was assigned to the <code>ui</code> variable (or code that was written in <code>ui.R</code>). That‚Äôs usually the easier part of a Shiny app. Now we have to write the <code>server</code> function, which will be responsible for listening to changes to the inputs and creating outputs to show in the app.</p>
<p>If you look at the server function, you‚Äôll notice that it is always defined with two arguments: <code>input</code> and <code>output</code>. You <em>must</em> define these two arguments! Both <code>input</code> and <code>output</code> are list-like objects. As the names suggest, <code>input</code> is a list you will read values <em>from</em> and <code>output</code> is a list you will write values <em>to</em>. <code>input</code> will contain the values of all the different inputs at any given time, and <code>output</code> is where you will save output objects (such as tables and plots) to display in your app.</p>
<div id="building-an-output" class="section level4 hasAnchor" number="87.4.1.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.1.1</span> Building an output<a href="#building-an-output" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall that we created two output placeholders: <em>coolplot</em> (a plot) and <em>results</em> (a table). We need to write code in R that will tell Shiny what kind of plot or table to display. There are three rules to build an output in Shiny:</p>
<ol style="list-style-type: decimal">
<li>Save the output object into the <code>output</code> list (remember the app template - every server function has an <code>output</code> argument).</li>
<li>Build the object with a <code>render*</code> function, where <code>*</code> is the type of output.</li>
<li>Access input values using the <code>input</code> list (every server function has an <code>input</code> argument).</li>
</ol>
<p>The third rule is only required if you want your output to depend on some input, so let‚Äôs first see how to build a very basic output using only the first two rules. We‚Äôll create a plot and send it to the <em>coolplot</em> output.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>This simple code shows the first two rules: we‚Äôre creating a plot inside the <code>renderPlot()</code> function, and assigning it to <em>coolplot</em> in the <code>output</code> list. Remember that every output created in the UI must have a unique ID, now we see why. In order to attach an R object to an output with ID <em>x</em>, we assign the R object to <code>output$x</code>.</p>
<p>Since <em>coolplot</em> was defined as a <code>plotOutput</code>, we must use the <code>renderPlot</code> function, and we must create a plot inside the <code>renderPlot</code> function.</p>
<p>If you add the code above inside the server function, you should see a plot with 100 random points in the app.</p>
<p><strong>Exercise:</strong> The code inside <code>renderPlot()</code> doesn‚Äôt have to be only one line, it can be as long as you‚Äôd like as long as it returns a plot. Try making a more complex plot using ggplot2. The plot doesn‚Äôt have to use our dataset, it could be anything, just to make sure you can use <code>renderPlot()</code>.</p>
</div>
<div id="making-an-output-react-to-an-input" class="section level4 hasAnchor" number="87.4.1.2">
<h4 class="hasAnchor"><span class="header-section-number">87.4.1.2</span> Making an output react to an input<a href="#making-an-output-react-to-an-input" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now we‚Äôll take the plot one step further. Instead of always plotting the same plot (100 random numbers), let‚Äôs use the minimum price selected as the number of points to show. It doesn‚Äôt make too much sense, but it‚Äôs just to learn how to make an output depend on an input.</p>
<p>Replace the previous code in your server function with the code below, and run the app.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">rnorm</span>(input<span class="sc">$</span>priceInput[<span class="dv">1</span>]))</span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Whenever you choose a new minimum price range, the plot will update with a new number of points. Notice that the only thing different in the code is that instead of using the number <code>100</code> we are using <code>input$priceInput[1]</code>.</p>
<p>What does this mean? Just like the variable <code>output</code> contains a list of all the outputs (and we need to assign code into them), the variable <code>input</code> contains a list of all the inputs that are defined in the UI. <code>input$priceInput</code> return a vector of length two containing the minimum and maximum price. Whenever the user manipulates the slider in the app, these values are updated, and whatever code relies on it gets re-evaluated. This is a concept known as <strong>reactivity</strong>, which we will get to <a href="#reactivity-101">soon</a>.</p>
<p>Notice that these short three lines of code are using all the three rules for building outputs:</p>
<ul>
<li>We are saving to the <code>output</code> list (<code>output$coolplot &lt;-</code>).</li>
<li>We are using a <code>render*</code> function to build the output (<code>renderPlot({})</code>).</li>
<li>We are accessing an input value (<code>input$priceInput[1]</code>).</li>
</ul>
</div>
</div>
<div id="building-the-plot-output" class="section level3 hasAnchor" number="87.4.2">
<h3 class="hasAnchor"><span class="header-section-number">87.4.2</span> Building the plot output<a href="#building-the-plot-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we have all the knowledge required to build a plot visualizing some aspect of the data. We‚Äôll create a simple histogram of the alcohol content of the products by using the same three rules to create a plot output.</p>
<p>First we need to make sure ggplot2 is attached, so add a <code>library(ggplot2)</code> at the top.</p>
<p>Next we‚Äôll return a histogram of alcohol content from <code>renderPlot()</code>. Let‚Äôs start with just a histogram of the whole data, unfiltered.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(bcl, <span class="fu">aes</span>(Alcohol_Content)) <span class="sc">+</span></span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>()</span>
<span id="cb536-4"><a href="#cb536-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>If you run the app with this code inside your server, you should see a histogram in the app. But if you change the input values, nothing happens yet, so the next step is to actually filter the dataset based on the inputs.</p>
<p>Recall that we have 3 inputs: <code>priceInput</code>, <code>typeInput</code>, and <code>countryInput</code>. We can filter the data based on the values of these three inputs. We‚Äôll use dplyr functions to filter the data, so be sure to include dplyr at the top. Then we‚Äôll plot the filtered data instead of the original data.</p>
<p>Place this code in your server function and run the app:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a>  filtered <span class="ot">&lt;-</span></span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a>    bcl <span class="sc">%&gt;%</span></span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Price <span class="sc">&gt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">1</span>],</span>
<span id="cb537-5"><a href="#cb537-5" aria-hidden="true" tabindex="-1"></a>           Price <span class="sc">&lt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">2</span>],</span>
<span id="cb537-6"><a href="#cb537-6" aria-hidden="true" tabindex="-1"></a>           Type <span class="sc">==</span> input<span class="sc">$</span>typeInput,</span>
<span id="cb537-7"><a href="#cb537-7" aria-hidden="true" tabindex="-1"></a>           Country <span class="sc">==</span> input<span class="sc">$</span>countryInput</span>
<span id="cb537-8"><a href="#cb537-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb537-9"><a href="#cb537-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(filtered, <span class="fu">aes</span>(Alcohol_Content)) <span class="sc">+</span></span>
<span id="cb537-10"><a href="#cb537-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>()</span>
<span id="cb537-11"><a href="#cb537-11" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>If you change any input, you should see the histogram update. The way I know the histogram is correct is by noticing that the alcohol content is about 5% when I select beer, 40% for spirits, and 13% for wine. That sounds right.</p>
<p>Read this code and understand it. You‚Äôve successfully created an interactive app - the plot is changing according to the user‚Äôs selection.</p>
<p>To make sure we‚Äôre on the same page, here is what your code should look like at this point:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a>bcl <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bcl-data.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-7"><a href="#cb538-7" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb538-8"><a href="#cb538-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;BC Liquor Store prices&quot;</span>),</span>
<span id="cb538-9"><a href="#cb538-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb538-10"><a href="#cb538-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb538-11"><a href="#cb538-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;priceInput&quot;</span>, <span class="st">&quot;Price&quot;</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">40</span>), <span class="at">pre =</span> <span class="st">&quot;$&quot;</span>),</span>
<span id="cb538-12"><a href="#cb538-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">radioButtons</span>(<span class="st">&quot;typeInput&quot;</span>, <span class="st">&quot;Product type&quot;</span>,</span>
<span id="cb538-13"><a href="#cb538-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;BEER&quot;</span>, <span class="st">&quot;REFRESHMENT&quot;</span>, <span class="st">&quot;SPIRITS&quot;</span>, <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb538-14"><a href="#cb538-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb538-15"><a href="#cb538-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">&quot;countryInput&quot;</span>, <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb538-16"><a href="#cb538-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;CANADA&quot;</span>, <span class="st">&quot;FRANCE&quot;</span>, <span class="st">&quot;ITALY&quot;</span>))</span>
<span id="cb538-17"><a href="#cb538-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb538-18"><a href="#cb538-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb538-19"><a href="#cb538-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;coolplot&quot;</span>),</span>
<span id="cb538-20"><a href="#cb538-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">br</span>(), <span class="fu">br</span>(),</span>
<span id="cb538-21"><a href="#cb538-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tableOutput</span>(<span class="st">&quot;results&quot;</span>)</span>
<span id="cb538-22"><a href="#cb538-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb538-23"><a href="#cb538-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb538-24"><a href="#cb538-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb538-25"><a href="#cb538-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-26"><a href="#cb538-26" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb538-27"><a href="#cb538-27" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb538-28"><a href="#cb538-28" aria-hidden="true" tabindex="-1"></a>    filtered <span class="ot">&lt;-</span></span>
<span id="cb538-29"><a href="#cb538-29" aria-hidden="true" tabindex="-1"></a>      bcl <span class="sc">%&gt;%</span></span>
<span id="cb538-30"><a href="#cb538-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Price <span class="sc">&gt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">1</span>],</span>
<span id="cb538-31"><a href="#cb538-31" aria-hidden="true" tabindex="-1"></a>             Price <span class="sc">&lt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">2</span>],</span>
<span id="cb538-32"><a href="#cb538-32" aria-hidden="true" tabindex="-1"></a>             Type <span class="sc">==</span> input<span class="sc">$</span>typeInput,</span>
<span id="cb538-33"><a href="#cb538-33" aria-hidden="true" tabindex="-1"></a>             Country <span class="sc">==</span> input<span class="sc">$</span>countryInput</span>
<span id="cb538-34"><a href="#cb538-34" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb538-35"><a href="#cb538-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(filtered, <span class="fu">aes</span>(Alcohol_Content)) <span class="sc">+</span></span>
<span id="cb538-36"><a href="#cb538-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>()</span>
<span id="cb538-37"><a href="#cb538-37" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb538-38"><a href="#cb538-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb538-39"><a href="#cb538-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-40"><a href="#cb538-40" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<div class="figure">
<img src="img/shiny-addplot.png" alt="Adding a plot to our Shiny app" width="93%" />
<p class="caption">
(#fig:unnamed-chunk-8)Adding a plot to our Shiny app
</p>
</div>
<p><strong>Exercise:</strong> The current plot doesn‚Äôt look very nice, you could enhance the plot and make it much more pleasant to look at.</p>
<div id="building-the-table-output" class="section level4 hasAnchor" number="87.4.2.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.2.1</span> Building the table output<a href="#building-the-table-output" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Building the next output should be much easier now that we‚Äôve done it once. The other output we have was called <code>results</code> (as defined in the UI) and should be a table of all the products that match the filters. Since it‚Äôs a table output, we should use the <code>renderTable()</code> function. We‚Äôll do the exact same filtering on the data, and then simply return the data as a data.frame. Shiny will know that it needs to display it as a table because it‚Äôs defined as a <code>tableOutput</code>.</p>
<p>The code for creating the table output should make sense to you without too much explanation:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>results <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a>  filtered <span class="ot">&lt;-</span></span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a>    bcl <span class="sc">%&gt;%</span></span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Price <span class="sc">&gt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">1</span>],</span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>           Price <span class="sc">&lt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">2</span>],</span>
<span id="cb539-6"><a href="#cb539-6" aria-hidden="true" tabindex="-1"></a>           Type <span class="sc">==</span> input<span class="sc">$</span>typeInput,</span>
<span id="cb539-7"><a href="#cb539-7" aria-hidden="true" tabindex="-1"></a>           Country <span class="sc">==</span> input<span class="sc">$</span>countryInput</span>
<span id="cb539-8"><a href="#cb539-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb539-9"><a href="#cb539-9" aria-hidden="true" tabindex="-1"></a>  filtered</span>
<span id="cb539-10"><a href="#cb539-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Add this code to your server. Don‚Äôt overwrite the previous definition of <code>output$coolplot</code>, just add this code before or after that, but inside the server function. Run your app, and be amazed! You can now see a table showing all the products at the BC Liquor Store that match your criteria.</p>
<p><strong>Exercise:</strong> Add a new output. Either a new plot, a new table, or some piece of text that changes based on the inputs. For example, you could add a text output (<code>textOutput()</code> in the UI, <code>renderText()</code> in the server) that says how many results were found. If you choose to do this, I recommend first adding the output to the UI, then building the output in the server with static text to make sure you have the syntax correct. Only once you can see the text output in your app you should make it reflect the inputs. Pro-tip: since <code>textOutput()</code> is written in the UI, you can wrap it in other UI functions. For example, <code>h2(textOutput(...))</code> will result in larger text.</p>
</div>
</div>
<div id="shiny-tutorial-10" class="section level3 hasAnchor" number="87.4.3">
<h3 class="hasAnchor"><span class="header-section-number">87.4.3</span> Reactivity 101<a href="#shiny-tutorial-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Shiny uses a concept called <strong>reactive</strong> programming. This is what enables your outputs to <em>react</em> to changes in inputs. Reactivity in Shiny is complex, but as an extreme oversimplification, it means that when the value of a variable <code>x</code> changes, then anything that relies on <code>x</code> gets re-evaluated. Notice how this is very different from what you are used to in R. Consider the following code:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span></code></pre></div>
<p>What is the value of <code>y</code>? It‚Äôs 6. But in reactive programming, if <code>x</code> and <code>y</code> are reactive variables, then the value of <code>y</code> would be 11 because it would be updated whenever <code>x</code> is changed. This is a very powerful technique that is very useful for creating the responsiveness of Shiny apps, but it might be a bit weird at first because it‚Äôs a very different concept from what you‚Äôre used to.</p>
<p>Only <em>reactive</em> variables behave this way, and in Shiny all inputs are automatically reactive. That‚Äôs why you can always use <code>input$x</code> in render functions, and you can be sure that whatever output depends on <code>x</code> will use the updated value of <code>x</code> whenever <code>x</code> changes.</p>
<p>You might be wondering what it means to ‚Äúdepend‚Äù on a variable. This is not the official terminology, but it simply means that the variable is referenced in the code. So by merely accessing the value of a reactive variable, it causes the current code block to ‚Äúdepend‚Äù on that variable. Consider the following sample code to create a plot with a specific number of points in a specific colour:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>someoutput <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a>  col <span class="ot">&lt;-</span> input<span class="sc">$</span>mycolour</span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> input<span class="sc">$</span>mynumber</span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">rnorm</span>(num), <span class="at">col =</span> col)</span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>The above render function accesses two different inputs: <code>input$mycolour</code> and <code>input$mynumber</code>. This means that this code block depends on <em>both</em> of these variables, so whenever either one of the two inputs is updated, the code gets re-executed with the new input values and <code>output$someoutput</code> is updated.</p>
<div id="creating-and-accessing-reactive-variables" class="section level4 hasAnchor" number="87.4.3.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.3.1</span> Creating and accessing reactive variables<a href="#creating-and-accessing-reactive-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One very important thing to remember about reactive variables (such as the <code>input</code> list) is that <strong>they can only be used inside reactive contexts</strong>. Any <code>render*</code> function is a reactive context, so you can always use <code>input$x</code> or any other reactive variable inside render functions. There are two other common reactive contexts that we‚Äôll get to in a minute: <code>reactive({})</code> and <code>observe({})</code>. To show you what this means, let‚Äôs try accessing the price input value in the server function, without explicitly being inside a reactive context. Simply add <code>print(input$priceInput)</code> inside the <code>server</code> function, and you will get an error when running the app:</p>
<pre><code>Operation not allowed without an active reactive context. (You tried to do something that can only be done from inside a reactive expression or observer.)</code></pre>
<p>Shiny is very clear about what the error is: we are trying to access a reactive variable outside of a reactive context. To fix this, we can use the <code>observe({})</code> function to access the <code>input</code> variable. Inside the server, replace <code>print(input$priceInput)</code> with <code>observe({ print(input$priceInput) })</code>, and now the app should run fine. Note that this <code>observe({})</code> statement <em>depends</em> on <code>input$priceInput</code>, so whenever you change the value of the price, the code inside this <code>observe({})</code> will run again, and the new value will be printed. This is actually a very simple yet useful debugging technique in Shiny: often you want to know what value a reactive variable holds, so you need to remember to wrap the <code>cat(input$x)</code> or <code>print(input$x)</code> by an <code>observe({})</code>.</p>
<p>So far we only saw one reactive variable: the <code>input</code> list. You can also create your own reactive variables using the <code>reactive({})</code> function. The <code>reactive({})</code> function is similar to <code>observe({})</code> in that it is also a reactive context, which means that it will get re-run whenever any of the reactive variables in it get updated. The difference between them is that <code>reactive({})</code> returns a value. To see it in action, let‚Äôs create a variable called <code>priceDiff</code> that will be the difference between the maximum and minimum price selected. If you try to naively define <code>priceDiff &lt;- diff(input$priceInput)</code>, you‚Äôll see the same error as before about doing something outside a reactive context. This is because <code>input$priceInput</code> is a reactive variable, and we can‚Äôt use a reactive variable outside a reactive context. Since we want to assign a value, we use the <code>reactive({})</code> function. Try adding the following line to your server:</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>priceDiff <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(input<span class="sc">$</span>priceInput)</span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Now your app will run. If you want to access a reactive variable defined with <code>reactive({})</code>, <strong>you must add parentheses after the variable name, as if it‚Äôs a function</strong>. To demonstrate this, add <code>observe({ print(priceDiff()) })</code> to your server function. Notice that we use <code>priceDiff()</code> rather than <code>priceDiff</code>. It‚Äôs very important to remember this, because you can get confusing unclear errors if you simply try to access a custom reactive variable without the parentheses.</p>
<p>You can think of reactivity as causing a chain reaction: when one reactive value changes, anything that depends on it will get updated. If any of the updated values are themselves reactive variables, then any reactive contexts that depend on those variables will also get updated in turn. As a concrete example, let‚Äôs think about what happens when you change the value of the <code>priceInput</code> on the page. Since <code>input$priceInput</code> is a reactive variable, any expression that uses it will get updated. This means the two render functions from earlier will execute because they both depend on <code>input$priceInput</code>, as well as the <code>priceDiff</code> variable because it also depends on it. But since <code>priceDiff</code> is itself a reactive variable, Shiny will check if there is anything that depends on <code>priceDiff</code>, and indeed there is - the <code>observe({})</code> function that prints the value of <code>priceDiff</code>. So once <code>priceDiff</code> gets updated, the <code>observe({})</code> function will run, and the value will get printed.</p>
<p>Reactivity is usually the hardest part about Shiny to understand, so if you don‚Äôt quite get it, don‚Äôt feel bad. Try reading this section again, and I promise that with time and experience you will get more comfortable with reactivity. Once you do feel more confident with reactivity, it may be a good idea to read more advanced documentation describing reactivity, since this section greatly simplifies ideas to make them more understandable. A great resource is RStudio‚Äôs <a href="https://shiny.rstudio.com/articles/understanding-reactivity.html">tutorial on reactivity</a>.</p>
<p>Before continuing to the next section, you can remove all the <code>observe({})</code> and <code>reactive({})</code> functions we wrote in this section since they were all just for learning purposes.</p>
<p><strong>Exercise:</strong> Read this section again and really understand what a reactive variable means, what the three main reactive contexts are, how you can define reactive variables, and how a reactivity chain of events works.</p>
</div>
<div id="using-reactive-variables-to-reduce-code-duplication" class="section level4 hasAnchor" number="87.4.3.2">
<h4 class="hasAnchor"><span class="header-section-number">87.4.3.2</span> Using reactive variables to reduce code duplication<a href="#using-reactive-variables-to-reduce-code-duplication" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You may have noticed that we have the exact same code filtering the dataset in two places, once in each render function. We can solve that problem by defining a reactive variable that will hold the filtered dataset, and use that variable in the render functions.</p>
<p>The first step would be to create the reactive variable. The following code should be added to the server function.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>  bcl <span class="sc">%&gt;%</span></span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Price <span class="sc">&gt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">1</span>],</span>
<span id="cb544-4"><a href="#cb544-4" aria-hidden="true" tabindex="-1"></a>           Price <span class="sc">&lt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">2</span>],</span>
<span id="cb544-5"><a href="#cb544-5" aria-hidden="true" tabindex="-1"></a>           Type <span class="sc">==</span> input<span class="sc">$</span>typeInput,</span>
<span id="cb544-6"><a href="#cb544-6" aria-hidden="true" tabindex="-1"></a>           Country <span class="sc">==</span> input<span class="sc">$</span>countryInput</span>
<span id="cb544-7"><a href="#cb544-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb544-8"><a href="#cb544-8" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>The variable <code>filtered</code> is being defined exactly like before, except the body is wrapped by a <code>reactive({})</code>, and it‚Äôs defined in the server function instead of inside the individual render functions. Now that we have our reactive variable, we can use it in the output render functions. Try it yourself, and when you think you‚Äôre done, check the code below. Don‚Äôt forget that in order to access the value of a reactive expression, you must follow the name of the variable with parentheses! This is how your server function should look now:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true" tabindex="-1"></a>  filtered <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb545-3"><a href="#cb545-3" aria-hidden="true" tabindex="-1"></a>    bcl <span class="sc">%&gt;%</span></span>
<span id="cb545-4"><a href="#cb545-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Price <span class="sc">&gt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">1</span>],</span>
<span id="cb545-5"><a href="#cb545-5" aria-hidden="true" tabindex="-1"></a>             Price <span class="sc">&lt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">2</span>],</span>
<span id="cb545-6"><a href="#cb545-6" aria-hidden="true" tabindex="-1"></a>             Type <span class="sc">==</span> input<span class="sc">$</span>typeInput,</span>
<span id="cb545-7"><a href="#cb545-7" aria-hidden="true" tabindex="-1"></a>             Country <span class="sc">==</span> input<span class="sc">$</span>countryInput</span>
<span id="cb545-8"><a href="#cb545-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb545-9"><a href="#cb545-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb545-10"><a href="#cb545-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb545-11"><a href="#cb545-11" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb545-12"><a href="#cb545-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">filtered</span>(), <span class="fu">aes</span>(Alcohol_Content)) <span class="sc">+</span></span>
<span id="cb545-13"><a href="#cb545-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>()</span>
<span id="cb545-14"><a href="#cb545-14" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb545-15"><a href="#cb545-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-16"><a href="#cb545-16" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>results <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb545-17"><a href="#cb545-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filtered</span>()</span>
<span id="cb545-18"><a href="#cb545-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb545-19"><a href="#cb545-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>As a reminder, Shiny creates a dependency tree with all the reactive expressions to know what value depends on what other value. For example, when the price input changes, Shiny looks at what values depend on price, and sees that <code>filtered</code> is a reactive expression that depends on the price input, so it re-evaluates <code>filtered</code>. Then, because <code>filtered</code> is changed, Shiny now looks to see what expressions depend on <code>filtered</code>, and it finds that the two render functions use <code>filtered</code>. So Shiny re-executes the two render functions as well.</p>
</div>
</div>
<div id="shiny-tutorial-11" class="section level3 hasAnchor" number="87.4.4">
<h3 class="hasAnchor"><span class="header-section-number">87.4.4</span> Using <code>uiOutput()</code> to create UI elements dynamically<a href="#shiny-tutorial-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the output functions you can add in the UI is <code>uiOutput()</code>. According to the naming convention (e.g.¬†<code>plotOutput()</code> is an output to render a plot), this is an output used to render more UI. This may sound a bit confusing, but it‚Äôs actually very useful. It‚Äôs usually used to create inputs (or any other UI) from the server, or in other words - you can create inputs dynamically.</p>
<p>Any input that you normally create in the UI is created when the app starts, and it cannot be changed. But what if one of your inputs depends on another input? In that case, you want to be able to create an input dynamically, in the server, and you would use <code>uiOutput()</code>. <code>uiOutput()</code> can be used to create <em>any</em> UI element, but it‚Äôs most often used to create input UI elements. The same rules regarding building outputs apply, which means the output (which is a UI element in this case) is created with the function <code>renderUI()</code>.</p>
<div id="basic-example-of-uioutput" class="section level4 hasAnchor" number="87.4.4.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.4.1</span> Basic example of <code>uiOutput()</code><a href="#basic-example-of-uioutput" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As a very basic example, consider this app:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">numericInput</span>(<span class="st">&quot;num&quot;</span>, <span class="st">&quot;Maximum slider value&quot;</span>, <span class="dv">5</span>),</span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uiOutput</span>(<span class="st">&quot;slider&quot;</span>)</span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb546-6"><a href="#cb546-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-7"><a href="#cb546-7" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb546-8"><a href="#cb546-8" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>slider <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb546-9"><a href="#cb546-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sliderInput</span>(<span class="st">&quot;slider&quot;</span>, <span class="st">&quot;Slider&quot;</span>, <span class="at">min =</span> <span class="dv">0</span>,</span>
<span id="cb546-10"><a href="#cb546-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">max =</span> input<span class="sc">$</span>num, <span class="at">value =</span> <span class="dv">0</span>)</span>
<span id="cb546-11"><a href="#cb546-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb546-12"><a href="#cb546-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb546-13"><a href="#cb546-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-14"><a href="#cb546-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>If you run that tiny app, you will see that whenever you change the value of the numeric input, the slider input is re-generated. This behavior can come in handy often.</p>
</div>
</div>
<div id="use-uioutput-in-our-app-to-populate-the-countries" class="section level3 hasAnchor" number="87.4.5">
<h3 class="hasAnchor"><span class="header-section-number">87.4.5</span> Use <code>uiOutput()</code> in our app to populate the countries<a href="#use-uioutput-in-our-app-to-populate-the-countries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use this concept in our app to populate the choices for the country selector. The country selector currently only holds 3 values that we manually entered, but instead we could render the country selector in the server and use the data to determine what countries it can have.</p>
<p>First we need to replace the <code>selectInput("countryInput", ...)</code> in the UI with:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">uiOutput</span>(<span class="st">&quot;countryOutput&quot;</span>)</span></code></pre></div>
<p>Then we need to create the output (which will create a UI element - yeah, it can be a bit confusing at first), so add the following code to the server function:</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>countryOutput <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">selectInput</span>(<span class="st">&quot;countryInput&quot;</span>, <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">sort</span>(<span class="fu">unique</span>(bcl<span class="sc">$</span>Country)),</span>
<span id="cb548-4"><a href="#cb548-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">selected =</span> <span class="st">&quot;CANADA&quot;</span>)</span>
<span id="cb548-5"><a href="#cb548-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Now if you run the app, you should be able to see all the countries that BC Liquor stores import from.</p>
<div id="errors-showing-up-and-quickly-disappearing" class="section level4 hasAnchor" number="87.4.5.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.5.1</span> Errors showing up and quickly disappearing<a href="#errors-showing-up-and-quickly-disappearing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You might notice that when you first run the app, each of the two outputs are throwing an error message, but the error message goes away after a second. The problem is that when the app initializes, <code>filtered</code> is trying to access the country input, but the country input hasn‚Äôt been created yet. After Shiny finishes loading fully and the country input is generated, <code>filtered</code> tries accessing it again, this time it‚Äôs successful, and the error goes away.</p>
<p>Once we understand why the error is happening, fixing it is simple. Inside the <code>filtered</code> reactive function, we should check if the country input exists, and if not then just return <code>NULL</code>.</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(input<span class="sc">$</span>countryInput)) {</span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb549-4"><a href="#cb549-4" aria-hidden="true" tabindex="-1"></a>  }    </span>
<span id="cb549-5"><a href="#cb549-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb549-6"><a href="#cb549-6" aria-hidden="true" tabindex="-1"></a>  bcl <span class="sc">%&gt;%</span></span>
<span id="cb549-7"><a href="#cb549-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Price <span class="sc">&gt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">1</span>],</span>
<span id="cb549-8"><a href="#cb549-8" aria-hidden="true" tabindex="-1"></a>           Price <span class="sc">&lt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">2</span>],</span>
<span id="cb549-9"><a href="#cb549-9" aria-hidden="true" tabindex="-1"></a>           Type <span class="sc">==</span> input<span class="sc">$</span>typeInput,</span>
<span id="cb549-10"><a href="#cb549-10" aria-hidden="true" tabindex="-1"></a>           Country <span class="sc">==</span> input<span class="sc">$</span>countryInput</span>
<span id="cb549-11"><a href="#cb549-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb549-12"><a href="#cb549-12" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Now when the render function tries to access the data, it will get a <code>NULL</code> value before the app is fully loaded. You will still get an error, because the <code>ggplot()</code> function will not work with a <code>NULL</code> dataset, so we also need to make a similar check in the <code>renderPlot()</code> function. Only once the data is loaded, we can try to plot.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(<span class="fu">filtered</span>())) {</span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>()</span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb550-5"><a href="#cb550-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">filtered</span>(), <span class="fu">aes</span>(Alcohol_Content)) <span class="sc">+</span></span>
<span id="cb550-6"><a href="#cb550-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>()</span>
<span id="cb550-7"><a href="#cb550-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>The <code>renderTable()</code> function doesn‚Äôt need this fix applied because Shiny doesn‚Äôt have a problem rendering a <code>NULL</code> table.</p>
<p><strong>Exercise:</strong> Change the product type radio buttons to get generated in the server with the values from the dataset, instead of being created in the UI with the values entered manually. If you‚Äôre feeling confident, try adding an input for ‚Äúsubtype‚Äù that will get re-generated every time a new type is chosen, and will be populated with all the subtype options available for the currently selected type (for example, if <code>"WINE"</code> is selected, then the subtypes are white wine, red wine, etc.).</p>
</div>
</div>
<div id="shiny-tutorial-12" class="section level3 hasAnchor" number="87.4.6">
<h3 class="hasAnchor"><span class="header-section-number">87.4.6</span> Final Shiny app code<a href="#shiny-tutorial-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In case you got lost somewhere, here is the final code. The app is now functional, but there are plenty of features you can add to make it better.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true" tabindex="-1"></a>bcl <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bcl-data.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb551-6"><a href="#cb551-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-7"><a href="#cb551-7" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb551-8"><a href="#cb551-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">&quot;BC Liquor Store prices&quot;</span>),</span>
<span id="cb551-9"><a href="#cb551-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb551-10"><a href="#cb551-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb551-11"><a href="#cb551-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">&quot;priceInput&quot;</span>, <span class="st">&quot;Price&quot;</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">40</span>), <span class="at">pre =</span> <span class="st">&quot;$&quot;</span>),</span>
<span id="cb551-12"><a href="#cb551-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">radioButtons</span>(<span class="st">&quot;typeInput&quot;</span>, <span class="st">&quot;Product type&quot;</span>,</span>
<span id="cb551-13"><a href="#cb551-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">&quot;BEER&quot;</span>, <span class="st">&quot;REFRESHMENT&quot;</span>, <span class="st">&quot;SPIRITS&quot;</span>, <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb551-14"><a href="#cb551-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> <span class="st">&quot;WINE&quot;</span>),</span>
<span id="cb551-15"><a href="#cb551-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">&quot;countryOutput&quot;</span>)</span>
<span id="cb551-16"><a href="#cb551-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb551-17"><a href="#cb551-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb551-18"><a href="#cb551-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">&quot;coolplot&quot;</span>),</span>
<span id="cb551-19"><a href="#cb551-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">br</span>(), <span class="fu">br</span>(),</span>
<span id="cb551-20"><a href="#cb551-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tableOutput</span>(<span class="st">&quot;results&quot;</span>)</span>
<span id="cb551-21"><a href="#cb551-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb551-22"><a href="#cb551-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb551-23"><a href="#cb551-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb551-24"><a href="#cb551-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-25"><a href="#cb551-25" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb551-26"><a href="#cb551-26" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>countryOutput <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb551-27"><a href="#cb551-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">&quot;countryInput&quot;</span>, <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb551-28"><a href="#cb551-28" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sort</span>(<span class="fu">unique</span>(bcl<span class="sc">$</span>Country)),</span>
<span id="cb551-29"><a href="#cb551-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">selected =</span> <span class="st">&quot;CANADA&quot;</span>)</span>
<span id="cb551-30"><a href="#cb551-30" aria-hidden="true" tabindex="-1"></a>  })  </span>
<span id="cb551-31"><a href="#cb551-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb551-32"><a href="#cb551-32" aria-hidden="true" tabindex="-1"></a>  filtered <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb551-33"><a href="#cb551-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(input<span class="sc">$</span>countryInput)) {</span>
<span id="cb551-34"><a href="#cb551-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb551-35"><a href="#cb551-35" aria-hidden="true" tabindex="-1"></a>    }    </span>
<span id="cb551-36"><a href="#cb551-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb551-37"><a href="#cb551-37" aria-hidden="true" tabindex="-1"></a>    bcl <span class="sc">%&gt;%</span></span>
<span id="cb551-38"><a href="#cb551-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Price <span class="sc">&gt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">1</span>],</span>
<span id="cb551-39"><a href="#cb551-39" aria-hidden="true" tabindex="-1"></a>             Price <span class="sc">&lt;=</span> input<span class="sc">$</span>priceInput[<span class="dv">2</span>],</span>
<span id="cb551-40"><a href="#cb551-40" aria-hidden="true" tabindex="-1"></a>             Type <span class="sc">==</span> input<span class="sc">$</span>typeInput,</span>
<span id="cb551-41"><a href="#cb551-41" aria-hidden="true" tabindex="-1"></a>             Country <span class="sc">==</span> input<span class="sc">$</span>countryInput</span>
<span id="cb551-42"><a href="#cb551-42" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb551-43"><a href="#cb551-43" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb551-44"><a href="#cb551-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb551-45"><a href="#cb551-45" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>coolplot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb551-46"><a href="#cb551-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(<span class="fu">filtered</span>())) {</span>
<span id="cb551-47"><a href="#cb551-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>()</span>
<span id="cb551-48"><a href="#cb551-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb551-49"><a href="#cb551-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">filtered</span>(), <span class="fu">aes</span>(Alcohol_Content)) <span class="sc">+</span></span>
<span id="cb551-50"><a href="#cb551-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>()</span>
<span id="cb551-51"><a href="#cb551-51" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb551-52"><a href="#cb551-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-53"><a href="#cb551-53" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>results <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb551-54"><a href="#cb551-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filtered</span>()</span>
<span id="cb551-55"><a href="#cb551-55" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb551-56"><a href="#cb551-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb551-57"><a href="#cb551-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-58"><a href="#cb551-58" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
</div>
<div id="shiny-tutorial-13" class="section level3 hasAnchor" number="87.4.7">
<h3 class="hasAnchor"><span class="header-section-number">87.4.7</span> Share your app with the world<a href="#shiny-tutorial-13" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Remember how every single app is a web page powered by an R session on a computer? So far, you‚Äôve been running Shiny locally, which means your computer was used to power the app. It also means that the app was not accessible to anyone on the internet. If you want to share your app with the world, you need to host it somewhere.</p>
<div id="host-on-shinyapps.io" class="section level4 hasAnchor" number="87.4.7.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.7.1</span> Host on shinyapps.io<a href="#host-on-shinyapps.io" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>RStudio provides a service called <a href="https://www.shinyapps.io">shinyapps.io</a> which lets you host your apps for free. It is integrated seamlessly into RStudio so that you can publish your apps with the click of a button, and it has a free version. The free version allows a certain number of apps per user and a certain number of activity on each app, but it should be good enough for most of you. It also lets you see some basic stats about usage of your app.</p>
<p>Hosting your app on shinyapps.io is the easy and recommended way of getting your app online. Go to <a href="https://www.shinyapps.io">www.shinyapps.io</a> and sign up for an account. When you‚Äôre ready to publish your app, click on the ‚ÄúPublish Application‚Äù button in RStudio and follow the instructions. You might be asked to install a couple packages if it‚Äôs your first time.</p>
<div class="figure">
<img src="img/shiny-publish.png" alt="Shiny publish application button" width="93%" />
<p class="caption">
(#fig:unnamed-chunk-9)Shiny publish application button
</p>
</div>
<p>After a successful deployment to shinyapps.io, you will be redirected to your app in the browser. You can use that URL to show off to your family what a cool app you wrote.</p>
</div>
<div id="host-on-a-shiny-server" class="section level4 hasAnchor" number="87.4.7.2">
<h4 class="hasAnchor"><span class="header-section-number">87.4.7.2</span> Host on a Shiny Server<a href="#host-on-a-shiny-server" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The other option for hosting your app is on your own private <a href="https://www.rstudio.com/products/shiny/shiny-server/">Shiny Server</a>. Shiny Server is also a product by RStudio that lets you host apps on your own server. This means that instead of RStudio hosting the app for you, you have it on your own private server. This means you have a lot more freedom and flexibility, but it also means you need to have a server and be comfortable administering a server. I currently host all my apps on <a href="https://daattali.com/shiny/">my own Shiny Server</a> just because I like having the extra control, but when I first learned about Shiny I used shinyapps.io for several months.</p>
<p>If you‚Äôre feeling adventurous and want to host your own server, you can follow <a href="https://deanattali.com/2015/05/09/setup-rstudio-shiny-server-digital-ocean/">my tutorial for hosting a Shiny Server</a>.</p>
</div>
</div>
<div id="shiny-tutorial-14" class="section level3 hasAnchor" number="87.4.8">
<h3 class="hasAnchor"><span class="header-section-number">87.4.8</span> More Shiny features to check out<a href="#shiny-tutorial-14" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Shiny is extremely powerful and has lots of features that we haven‚Äôt covered. Here‚Äôs a sneak peek of just a few other common Shiny features that are not too advanced.</p>
<div id="shiny-in-r-markdown" class="section level4 hasAnchor" number="87.4.8.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.8.1</span> Shiny in R Markdown<a href="#shiny-in-r-markdown" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can include Shiny inputs and outputs in an R Markdown document! This means that your R Markdown document can be interactive. Learn more <a href="https://bookdown.org/yihui/rmarkdown/shiny-documents.html">here</a>. Here‚Äôs a simple example of how to include interactive Shiny elements in an R Markdown:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> html_document</span></span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true" tabindex="-1"></a><span class="an">runtime:</span><span class="co"> shiny</span></span>
<span id="cb552-4"><a href="#cb552-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb552-5"><a href="#cb552-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-6"><a href="#cb552-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb552-7"><a href="#cb552-7" aria-hidden="true" tabindex="-1"></a><span class="in">sliderInput(&quot;num&quot;, &quot;Choose a number&quot;,</span></span>
<span id="cb552-8"><a href="#cb552-8" aria-hidden="true" tabindex="-1"></a><span class="in">            0, 100, 20)</span></span>
<span id="cb552-9"><a href="#cb552-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-10"><a href="#cb552-10" aria-hidden="true" tabindex="-1"></a><span class="in">renderPlot({</span></span>
<span id="cb552-11"><a href="#cb552-11" aria-hidden="true" tabindex="-1"></a><span class="in">    plot(seq(input$num))</span></span>
<span id="cb552-12"><a href="#cb552-12" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb552-13"><a href="#cb552-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
</div>
<div id="use-conditionalpanel-to-conditionally-show-ui-elements" class="section level4 hasAnchor" number="87.4.8.2">
<h4 class="hasAnchor"><span class="header-section-number">87.4.8.2</span> Use <code>conditionalPanel()</code> to conditionally show UI elements<a href="#use-conditionalpanel-to-conditionally-show-ui-elements" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can use <code>conditionalPanel()</code> to either show or hide a UI element based on a simple condition, such as the value of another input. Learn more via <code>?conditionalPanel</code>.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">numericInput</span>(<span class="st">&quot;num&quot;</span>, <span class="st">&quot;Number&quot;</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb553-4"><a href="#cb553-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conditionalPanel</span>(</span>
<span id="cb553-5"><a href="#cb553-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;input.num &gt;=5&quot;</span>,</span>
<span id="cb553-6"><a href="#cb553-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Hello!&quot;</span></span>
<span id="cb553-7"><a href="#cb553-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb553-8"><a href="#cb553-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb553-9"><a href="#cb553-9" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {}</span>
<span id="cb553-10"><a href="#cb553-10" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
</div>
<div id="use-navbarpage-or-tabsetpanel-to-have-multiple-tabs-in-the-ui" class="section level4 hasAnchor" number="87.4.8.3">
<h4 class="hasAnchor"><span class="header-section-number">87.4.8.3</span> Use <code>navbarPage()</code> or <code>tabsetPanel()</code> to have multiple tabs in the UI<a href="#use-navbarpage-or-tabsetpanel-to-have-multiple-tabs-in-the-ui" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If your apps requires more than a single ‚Äúview‚Äù, you can have separate tabs. Learn more via <code>?navbarPage</code> or <code>?tabsetPanel</code>.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabsetPanel</span>(</span>
<span id="cb554-4"><a href="#cb554-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabPanel</span>(<span class="st">&quot;Tab 1&quot;</span>, <span class="st">&quot;Hello&quot;</span>),</span>
<span id="cb554-5"><a href="#cb554-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabPanel</span>(<span class="st">&quot;Tab 2&quot;</span>, <span class="st">&quot;there!&quot;</span>)</span>
<span id="cb554-6"><a href="#cb554-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb554-7"><a href="#cb554-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb554-8"><a href="#cb554-8" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {}</span>
<span id="cb554-9"><a href="#cb554-9" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
</div>
<div id="use-dt-for-beautiful-interactive-tables" class="section level4 hasAnchor" number="87.4.8.4">
<h4 class="hasAnchor"><span class="header-section-number">87.4.8.4</span> Use DT for beautiful, interactive tables<a href="#use-dt-for-beautiful-interactive-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Whenever you use <code>tableOutput()</code> + <code>renderTable()</code>, the table that Shiny creates is a static and boring-looking table. If you download the DT package, you can replace the default table with a much sleeker table by just using <code>DT::dataTableOutput()</code> + <code>DT::renderDataTable()</code>. It‚Äôs worth trying. Learn more on <a href="https://rstudio.github.io/DT/">DT‚Äôs website</a>.</p>
</div>
<div id="use-isolate-function-to-remove-a-dependency-on-a-reactive-variable" class="section level4 hasAnchor" number="87.4.8.5">
<h4 class="hasAnchor"><span class="header-section-number">87.4.8.5</span> Use <code>isolate()</code> function to remove a dependency on a reactive variable<a href="#use-isolate-function-to-remove-a-dependency-on-a-reactive-variable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When you have multiple reactive variables inside a reactive context, the whole code block will get re-executed whenever <em>any</em> of the reactive variables change because all the variables become dependencies of the code. If you want to suppress this behavior and cause a reactive variable to not be a dependency, you can wrap the code that uses that variable inside the <code>isolate()</code> function. Any reactive variables that are inside <code>isolate()</code> will not result in the code re-executing when their value is changed. Read more about this behavior via <code>?isolate</code>.</p>
</div>
<div id="use-updateinput-functions-to-update-input-values-programmatically" class="section level4 hasAnchor" number="87.4.8.6">
<h4 class="hasAnchor"><span class="header-section-number">87.4.8.6</span> Use <code>update*Input()</code> functions to update input values programmatically<a href="#use-updateinput-functions-to-update-input-values-programmatically" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Any input function has an equivalent <code>update*Input</code> function that can be used to update any of its parameters.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sliderInput</span>(<span class="st">&quot;slider&quot;</span>, <span class="st">&quot;Move me&quot;</span>, <span class="at">value =</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb555-4"><a href="#cb555-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">numericInput</span>(<span class="st">&quot;num&quot;</span>, <span class="st">&quot;Number&quot;</span>, <span class="at">value =</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb555-5"><a href="#cb555-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb555-6"><a href="#cb555-6" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb555-7"><a href="#cb555-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observe</span>({</span>
<span id="cb555-8"><a href="#cb555-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateNumericInput</span>(session, <span class="st">&quot;num&quot;</span>, <span class="at">value =</span> input<span class="sc">$</span>slider)</span>
<span id="cb555-9"><a href="#cb555-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb555-10"><a href="#cb555-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb555-11"><a href="#cb555-11" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>Note that we used an additional argument <code>session</code> when defining the <code>server</code> function. While the <code>input</code> and <code>output</code> arguments are mandatory, the <code>session</code> argument is optional. You need to define the <code>session</code> argument when you want to use functions that need to access the session. The <code>session</code> parameter actually has some useful information in it, you can learn more about this via <code>?shiny::session</code>.</p>
</div>
</div>
<div id="scoping-rules-in-shiny-apps" class="section level3 hasAnchor" number="87.4.9">
<h3 class="hasAnchor"><span class="header-section-number">87.4.9</span> Scoping rules in Shiny apps<a href="#scoping-rules-in-shiny-apps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Scoping is very important to understand in Shiny once you want to support more than one user at a time. Since your app can be hosted online, multiple users can use your app simultaneously. If there are any variables (such as datasets or global parameters) that should be shared by all users, then you can safely define them globally. But any variable that should be specific to each user‚Äôs session should be not be defined globally.</p>
<p>You can think of the <code>server</code> function as a sandbox for each user. Any code outside of the server function is run once and is shared by all the instances of your Shiny app. Any code inside the server is run once <em>for every user that visits your app</em>. This means that any user-specific variables should be defined inside server. If you look at the code in our BC Liquor Store app, you‚Äôll see that we followed this rule: the raw dataset was loaded outside the server and is therefore available to all users, but the <code>filtered</code> object is constructed inside the server so that every user has their own version of it. If <code>filtered</code> was a global variable, then when one user changes the values in your app, all other users connected to your app would see the change happen.</p>
<p>You can learn more about the scoping rules in Shiny <a href="https://shiny.rstudio.com/articles/scoping.html">here</a>.</p>
<div id="use-global.r-to-define-objects-available-to-both-ui.r-and-server.r" class="section level4 hasAnchor" number="87.4.9.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.9.1</span> Use <code>global.R</code> to define objects available to both <code>ui.R</code> and <code>server.R</code><a href="#use-global.r-to-define-objects-available-to-both-ui.r-and-server.r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If there are objects that you want to have available to both <code>ui.R</code> and <code>server.R</code>, you can place them in <code>global.R</code>. You can learn more about <code>global.R</code> and other scoping rules <a href="https://shiny.rstudio.com/articles/scoping.html">here</a>.</p>
</div>
</div>
<div id="add-images" class="section level3 hasAnchor" number="87.4.10">
<h3 class="hasAnchor"><span class="header-section-number">87.4.10</span> Add images<a href="#add-images" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can add an image to your Shiny app by placing an image under the <code>www/</code> folder and using the UI function <code>img(src = "image.png")</code>. Shiny will know to automatically look in the <code>www/</code> folder for the image.</p>
<div id="add-javascriptcss" class="section level4 hasAnchor" number="87.4.10.1">
<h4 class="hasAnchor"><span class="header-section-number">87.4.10.1</span> Add JavaScript/CSS<a href="#add-javascriptcss" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you know JavaScript or CSS you are more than welcome to use some in your app.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">head</span>(tags<span class="sc">$</span><span class="fu">script</span>(<span class="st">&quot;alert(&#39;Hello!&#39;);&quot;</span>)),</span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true" tabindex="-1"></a>  tags<span class="sc">$</span><span class="fu">head</span>(tags<span class="sc">$</span><span class="fu">style</span>(<span class="st">&quot;body{ color: blue; }&quot;</span>)),</span>
<span id="cb556-5"><a href="#cb556-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Hello&quot;</span></span>
<span id="cb556-6"><a href="#cb556-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb556-7"><a href="#cb556-7" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb556-8"><a href="#cb556-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb556-9"><a href="#cb556-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb556-10"><a href="#cb556-10" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>If you do want to add some JavaScript or use common JavaScript functions in your apps, you might want to check out <a href="https://deanattali.com/shinyjs/"><code>shinyjs</code></a>.</p>
</div>
</div>
</div>
<div id="shiny-tutorial-15" class="section level2 hasAnchor" number="87.5">
<h2 class="hasAnchor"><span class="header-section-number">87.5</span> Ideas to improve our app<a href="#shiny-tutorial-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The app we developed is functional, but there are plenty of improvements that can be made. You can compare the app we developed to <a href="https://daattali.com/shiny/bcl/">Dean‚Äôs version of this app</a> to get an idea of what a (slightly) more functional app could include. Here are some suggestions of varying difficulties. Each idea also has a hint, Dean recommends only reading the hint if you‚Äôre stuck for 10 minutes.</p>
<ol style="list-style-type: decimal">
<li>Split the app into two separate files: <code>ui.R</code> and <code>server.R</code>.
<ul>
<li><strong>Hint:</strong> All the code assigned into the <code>ui</code> variable goes into <code>ui.R</code> and all the code for the <code>server</code> function goes into <code>server.R</code>. You do not need to explicitly call the <code>shinyApp()</code> function.</li>
</ul></li>
<li>Add an option to sort the results table by price.
<ul>
<li><strong>Hint:</strong> Use <code>checkboxInput()</code> to get <code>TRUE</code>/<code>FALSE</code> values from the user.</li>
</ul></li>
<li>Add an image of the BC Liquor Store to the UI.
<ul>
<li><strong>Hint:</strong> Place the image in a folder named <code>www</code>, and use <code>img(src = "imagename.png")</code> to add the image.</li>
</ul></li>
<li>Share your app with everyone on the internet by deploying to shinyapps.io.
<ul>
<li><strong>Hint:</strong> Go to <a href="https://www.shinyapps.io">shinyapps.io</a>, register for an account, then click the ‚ÄúPublish App‚Äù button in RStudio.</li>
</ul></li>
<li>Use the DT package to turn the current results table into an interactive table.
<ul>
<li><strong>Hint:</strong> Install the DT package, replace <code>tableOutput()</code> with <code>DT::dataTableOutput()</code> and replace <code>renderTable()</code> with <code>DT::renderDataTable()</code>.</li>
</ul></li>
<li>Add parameters to the plot.
<ul>
<li><strong>Hint:</strong> You will need to add input functions that will be used as parameters for the plot. You could use <code>shinyjs::colourInput()</code> to let the user decide on the colours of the bars in the plot.</li>
</ul></li>
<li>The app currently behaves strangely when the user selects filters that return 0 results. For example, try searching for wines from Belgium. There will be an empty plot and empty table generated, and there will be a warning message in the R Console. Try to figure out why this warning message is appearing, and how to fix it.
<ul>
<li><strong>Hint:</strong> The problem happens because <code>renderPlot()</code> and <code>renderTable()</code> are trying to render an empty data frame. To fix this issue, the <code>filtered</code> reactive expression should check for the number of rows in the filtered data, and if that number is 0 then return <code>NULL</code> instead of a 0-row data frame.</li>
</ul></li>
<li>Place the plot and the table in separate tabs.
<ul>
<li><strong>Hint:</strong> Use <code>tabsetPanel()</code> to create an interface with multiple tabs.</li>
</ul></li>
<li>If you know CSS, add CSS to make your app look nicer.
<ul>
<li><strong>Hint:</strong> Add a CSS file under <code>www</code> and use the function <code>includeCSS()</code> to use it in your app.</li>
</ul></li>
<li>Experiment with packages that add extra features to Shiny, such as <code>shinyjs</code>, <code>leaflet</code>, <code>shinydashboard</code>, <code>shinythemes</code>, <code>ggvis</code>.
<ul>
<li><strong>Hint:</strong> Each package is unique and has a different purpose, so you need to read the documentation of each package in order to know what it provides and how to use it.</li>
</ul></li>
<li>Show the number of results found whenever the filters change. For example, when searching for Italian wines $20-$40, the app would show the text ‚ÄúWe found 122 options for you‚Äù.
<ul>
<li><strong>Hint:</strong> Add a <code>textOutput()</code> to the UI, and in its corresponding <code>renderText()</code> use the number of rows in the <code>filtered()</code> object.</li>
</ul></li>
<li>Allow the user to download the results table as a <code>.csv</code> file.
<ul>
<li><strong>Hint:</strong> Look into the <code>downloadButton()</code> and <code>downloadHandler()</code> functions.</li>
</ul></li>
<li>When the user wants to see only wines, show a new input that allows the user to filter by sweetness level. Only show this input if wines are selected.
<ul>
<li><strong>Hint:</strong> Create a new input function for the sweetness level, and use it in the server code that filters the data. Use <code>conditionalPanel()</code> to conditionally show this new input. The <code>condition</code> argument of <code>conditionalPanel</code> should be something like <code>input.typeInput == "WINE"</code>.</li>
</ul></li>
<li>Allow the user to search for multiple alcohol types simultaneously, instead of being able to choose only wines/beers/etc.
<ul>
<li><strong>Hint:</strong> There are two approaches to do this. Either change the <code>typeInput</code> radio buttons into checkboxes (<code>checkboxGroupInput()</code>) since checkboxes support choosing multiple items, or change <code>typeInput</code> into a select box (<code>selectInput()</code>) with the argument <code>multiple = TRUE</code> to support choosing multiple options.</li>
</ul></li>
<li>If you look at the dataset, you‚Äôll see that each product has a ‚Äútype‚Äù (beer, wine, spirit, or refreshment) and also a ‚Äúsubtype‚Äù (red wine, rum, cider, etc.). Add an input for ‚Äúsubtype‚Äù that will let the user filter for only a specific subtype of products. Since each type has different subtype options, the choices for subtype should get re-generated every time a new type is chosen. For example, if ‚Äúwine‚Äù is selected, then the subtypes available should be white wine, red wine, etc.
<ul>
<li><strong>Hint:</strong> Use <code>uiOutput()</code> to create this input in the server code.</li>
</ul></li>
<li>Provide a way for the user to show results from <em>all</em> countries (instead of forcing a filter by only one specific country).
<ul>
<li><strong>Hint:</strong> There are two ways to approach this. You can either add a value of ‚ÄúAll‚Äù to the dropdown list of country options, you can include a checkbox for ‚ÄúFilter by country‚Äù and only show the dropdown.</li>
</ul></li>
</ol>
</div>
</div>
<div id="shiny-resources" class="section level1 hasAnchor" number="88">
<h1 class="hasAnchor"><span class="header-section-number">88</span> Shiny Resources<a href="#shiny-resources" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Shiny is a very popular package and has lots of resources on the web. Here‚Äôs a compiled list of a few resources I recommend, which are all fairly easy to read and understand.</p>
<ul>
<li><a href="https://shiny.rstudio.com">Shiny official website</a></li>
<li><a href="https://shiny.rstudio.com/tutorial/">Shiny official tutorial</a></li>
<li><a href="https://shiny.rstudio.com/images/shiny-cheatsheet.pdf">Shiny cheatsheet</a></li>
<li><a href="https://shiny.rstudio.com/articles/">Lots of short useful articles about different topics in Shiny - <strong>highly recommended</strong></a></li>
<li><a href="http://rmarkdown.rstudio.com/authoring_shiny.html">Shiny in R Markdown</a></li>
<li>Get help from the <a href="https://groups.google.com/forum/#!forum/shiny-discuss">Shiny Google group</a> or <a href="https://stackoverflow.com/questions/tagged/shiny">StackOverflow</a></li>
<li><a href="https://www.shinyapps.io">Publish your apps for free with shinyapps.io</a></li>
<li><a href="https://deanattali.com/2015/05/09/setup-rstudio-shiny-server-digital-ocean/">Host your app on your own Shiny server</a></li>
<li><a href="https://shiny.rstudio.com/articles/understanding-reactivity.html">Learn about how reactivity works</a></li>
<li><a href="https://shiny.rstudio.com/articles/debugging.html">Learn about useful debugging techniques</a></li>
</ul>
<div id="awesome-add-on-packages-to-shiny" class="section level2 hasAnchor" number="88.1">
<h2 class="hasAnchor"><span class="header-section-number">88.1</span> Awesome add-on packages to Shiny<a href="#awesome-add-on-packages-to-shiny" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many people have written packages that enhance Shiny in some way or add extra functionality. Here is a list of several popular packages that people often use together with Shiny:</p>
<ul>
<li><a href="https://rstudio.github.io/shinythemes/">shinythemes</a> - Easily alter the appearance of your app (<a href="https://CRAN.R-project.org/package=shinythemes">cran</a>).</li>
<li><a href="https://deanattali.com/shinyjs/">shinyjs</a> - Enhance user experience in Shiny apps using JavaScript functions without knowing JavaScript (<a href="https://CRAN.R-project.org/package=shinyjs">cran</a>; <a href="https://github.com/daattali/shinyjs">GitHub</a>).</li>
<li><a href="https://rstudio.github.io/leaflet/">leaflet</a> - Add interactive maps to your apps (<a href="https://CRAN.R-project.org/package=leaflet">cran</a>; <a href="https://github.com/rstudio/leaflet">GitHub</a>).</li>
<li><a href="https://ggvis.rstudio.com">ggvis</a> - Similar to ggplot2, but the plots are focused on being web-based and are more interactive (<a href="https://CRAN.R-project.org/package=ggvis">cran</a>).</li>
<li><a href="https://rstudio.github.io/shinydashboard/">shinydashboard</a> - Gives you tools to create visual ‚Äúdashboards‚Äù (<a href="https://CRAN.R-project.org/package=shinydashboard">cran</a>; <a href="https://github.com/rstudio/shinydashboard">GitHub</a>).</li>
</ul>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--HappyGitWithR Links-->
<!--Package Links-->
<!--Shiny links-->
<!--Publications-->
<!--R Documentation-->
<!--Wikipedia Links-->
<!--Misc. Links-->
<!--chapter:end:1402_shinyinfo.Rmd-->
</div>
</div>
<div id="part-module-15" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Module 15<a href="#part-module-15" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="special-topics-machine-learn" class="section level1 hasAnchor" number="89">
<h1 class="hasAnchor"><span class="header-section-number">89</span> Special Topics: Machine, Learn!<a href="#special-topics-machine-learn" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This bonus module is designed to introduce machine learning and neural networks. Please watch the curated videos and work your way through the notes.
You can find the video playlist for this module <a href="https://www.youtube.com/playlist?list=PLKrrdtYgOUYa5MoYrV8EsWQ5jIr5ZYMpM">here</a>.
Most of the slides used to make the videos in this module can be found in the <a href="https://github.com/DataScience4Psych/slides">slides repo</a>.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">me, a statistician: *interviewing for a machine learning job* as i always say &quot;machine learning is basically statistics!&quot; <a href="https://t.co/OBY9KKDSRv">pic.twitter.com/OBY9KKDSRv</a></p>&mdash; Kareem Carr | Data Scientist (@kareem_carr) <a href="https://twitter.com/kareem_carr/status/1366565047019982856?ref_src=twsrc%5Etfw">March 2, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">I hate to tell you this but most deep learning models are just three or more logistic regressions in a trench coat.</p>&mdash; Kareem Carr | Data Scientist (@kareem_carr) <a href="https://twitter.com/kareem_carr/status/1351338586063458304?ref_src=twsrc%5Etfw">January 19, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Here&#39;s my new experiment with AI-generated Pok√©mon: I finetuned an AI on *only one image* of Pikachu and had it generate new images of Pikachu.<br><br>Merry Christmas! <a href="https://t.co/u4GQFC0ASY">pic.twitter.com/u4GQFC0ASY</a></p>&mdash; Max Woolf (@minimaxir) <a href="https://twitter.com/minimaxir/status/1474913997807755268?ref_src=twsrc%5Etfw">December 26, 2021</a></blockquote>

<div id="module-materials-14" class="section level2 hasAnchor" number="89.1">
<h2 class="hasAnchor"><span class="header-section-number">89.1</span> Module Materials<a href="#module-materials-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Readings
<ul>
<li><a href="http://www.r2d3.us/visual-intro-to-machine-learning-part-1/">A visual introduction to machine learning</a></li>
</ul></li>
</ul>
</div>
</div>
<div id="neural-networks" class="section level1 hasAnchor" number="90">
<h1 class="hasAnchor"><span class="header-section-number">90</span> Neural Networks!<a href="#neural-networks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-is-a-neural-network" class="section level2 hasAnchor" number="90.1">
<h2 class="hasAnchor"><span class="header-section-number">90.1</span> What is a Neural Network?<a href="#what-is-a-neural-network" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/aircAruvnKk" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">This is what <a href="https://twitter.com/hashtag/Tesla?src=hash&amp;ref_src=twsrc%5Etfw">#Tesla</a> Autopilot sees using <a href="https://twitter.com/hashtag/neuralnetworks?src=hash&amp;ref_src=twsrc%5Etfw">#neuralnetworks</a> that take 70.000 GPU hours to train and output 1,000 tensors at each timestep<a href="https://twitter.com/hashtag/AI?src=hash&amp;ref_src=twsrc%5Etfw">#AI</a> <a href="https://twitter.com/hashtag/DeepLearning?src=hash&amp;ref_src=twsrc%5Etfw">#DeepLearning</a> <a href="https://twitter.com/hashtag/AutonomousVehicles?src=hash&amp;ref_src=twsrc%5Etfw">#AutonomousVehicles</a><a href="https://twitter.com/mvollmer1?ref_src=twsrc%5Etfw">@mvollmer1</a> <a href="https://twitter.com/Hana_ElSayyed?ref_src=twsrc%5Etfw">@Hana_ElSayyed</a> <a href="https://twitter.com/JeroenBartelse?ref_src=twsrc%5Etfw">@JeroenBartelse</a> <a href="https://twitter.com/kalydeoo?ref_src=twsrc%5Etfw">@kalydeoo</a> <a href="https://twitter.com/WSWMUC?ref_src=twsrc%5Etfw">@WSWMUC</a> <a href="https://twitter.com/pascal_bornet?ref_src=twsrc%5Etfw">@pascal_bornet</a> <a href="https://twitter.com/CurieuxExplorer?ref_src=twsrc%5Etfw">@CurieuxExplorer</a> <a href="https://twitter.com/fogle_shane?ref_src=twsrc%5Etfw">@fogle_shane</a> <a href="https://t.co/h6ZOUSsoNF">pic.twitter.com/h6ZOUSsoNF</a></p>&mdash; Franco Ronconi üáÆüáπ (@FrRonconi) <a href="https://twitter.com/FrRonconi/status/1358045974451662854?ref_src=twsrc%5Etfw">February 6, 2021</a></blockquote>

<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Machine learning folks are like, &quot;you could use an unsupervised neural net!&quot; but like, I AM an unsupervised neural net and it&#39;s a problem.</p>&mdash; Celeste Labedz (@celestelabedz) <a href="https://twitter.com/celestelabedz/status/1481472675864215554?ref_src=twsrc%5Etfw">January 13, 2022</a></blockquote>

</div>
<div id="how-does-it-learn" class="section level2 hasAnchor" number="90.2">
<h2 class="hasAnchor"><span class="header-section-number">90.2</span> How does it learn?<a href="#how-does-it-learn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following videos by Youtuber and game developer <a href="https://www.youtube.com/c/DaniDev/about">Dani</a> illustrate the iterative learning process. Specifically, I think his video on ‚Äú<a href="https://www.youtube.com/watch?v=JxdcuHXn9dc">Teaching A.I. to Play my Game!</a>‚Äù introduces the basic ideas behind neural networks well and shows the dynamic developement process. His video on ‚Äú<a href="https://www.youtube.com/watch?v=kowCrRPqRMM">Stickman A.I. Learns To Walk</a>‚Äù builds upon these ideas and illustrates how the iterative learning process requires thoughtful interventions.</p>
<div id="teaching-a.i.-to-play-my-game" class="section level3 hasAnchor" number="90.2.1">
<h3 class="hasAnchor"><span class="header-section-number">90.2.1</span> Teaching A.I. to Play My Game!<a href="#teaching-a.i.-to-play-my-game" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/JxdcuHXn9dc" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="stickman-a.i.-learns-to-walk" class="section level3 hasAnchor" number="90.2.2">
<h3 class="hasAnchor"><span class="header-section-number">90.2.2</span> Stickman A.I. Learns To Walk<a href="#stickman-a.i.-learns-to-walk" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/kowCrRPqRMM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
</div>
<div id="natural-language-processing" class="section level1 hasAnchor" number="91">
<h1 class="hasAnchor"><span class="header-section-number">91</span> Natural Language Processing<a href="#natural-language-processing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/TfVYxnhuEdU" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Fw6GjAPpKuA" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>Resources:
- <a href="https://www.vox.com/future-perfect/2019/2/14/18222270/artificial-intelligence-open-ai-natural-language-processing" class="uri">https://www.vox.com/future-perfect/2019/2/14/18222270/artificial-intelligence-open-ai-natural-language-processing</a>
- <a href="https://app.inferkit.com/demo" class="uri">https://app.inferkit.com/demo</a></p>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1501_ml.Rmd-->
</div>
<div id="part-module-last" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART*) Module Last<a href="#part-module-last" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="dont-miss-the-last-module" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Don‚Äôt Miss The Last Module<a href="#dont-miss-the-last-module" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This course was designed to be a starting point. You have learned so much in a short span. I am so proud of each and every one of you!!!!!</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(embedr)</span></span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a><span class="co">#embed_audio(&quot;assets/audio/SoLongFarewellAllParts.mid&quot;)</span></span></code></pre></div>
<p>Before you go ‚Äì I have some important practical things to walk you thru. Most of these are Wake Forest Specific‚Ä¶ such as making sure to connect your github account to a non-WFU email. As well as a well other things‚Ä¶</p>
<div id="important-wake-forest-stuff" class="section level2 hasAnchor" number="91.1">
<h2 class="hasAnchor"><span class="header-section-number">91.1</span> Important Wake Forest Stuff<a href="#important-wake-forest-stuff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For those of you who are graduating from Wake Forest University, you may not be aware that your email address gets shut off very soon after you graduate. Why do they do this? I do not know and this it is a silly policy. Regardless, before you lose access to your WFU email, you need to add a 2nd email address to your github account. Otherwise you will not be able to get access to your materials after you graduate.</p>
<p>Github has some incredibly useful guides to do this‚Ä¶</p>
<ul>
<li><a href="https://docs.github.com/en/github/setting-up-and-managing-your-github-user-account/adding-an-email-address-to-your-github-account">How to add an email address to your github account</a></li>
<li><a href="https://docs.github.com/en/github/setting-up-and-managing-your-github-user-account/changing-your-primary-email-address">How to change your primary email address</a></li>
<li><a href="https://docs.github.com/en/github/setting-up-and-managing-your-github-user-account/setting-a-backup-email-address">How to set up a backup email address</a></li>
</ul>
<p>Please do not procrastinate this! It is really important to do this before you lose access!!!!</p>
</div>
<div id="what-next" class="section level2 hasAnchor" number="91.2">
<h2 class="hasAnchor"><span class="header-section-number">91.2</span> What Next?<a href="#what-next" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="und" dir="ltr">üíÄ <a href="https://t.co/I3tm9GzUV4">pic.twitter.com/I3tm9GzUV4</a></p>&mdash; sam (@samuelmehr) <a href="https://twitter.com/samuelmehr/status/1437884883590950920?ref_src=twsrc%5Etfw">September 14, 2021</a></blockquote>

<div id="industry-transition-stories" class="section level3 hasAnchor" number="91.2.1">
<h3 class="hasAnchor"><span class="header-section-number">91.2.1</span> Industry Transition Stories<a href="#industry-transition-stories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="joe-hilgard" class="section level4 hasAnchor" number="91.2.1.1">
<h4 class="hasAnchor"><span class="header-section-number">91.2.1.1</span> Joe Hilgard<a href="#joe-hilgard" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">I started a new job in industry as a data scientist. Smell you later. <a href="https://t.co/PkXniG7Mz5">https://t.co/PkXniG7Mz5</a></p>&mdash; Joe Hilgard, data guy (@JoeHilgard) <a href="https://twitter.com/JoeHilgard/status/1398692153451290624?ref_src=twsrc%5Etfw">May 29, 2021</a></blockquote>

</div>
<div id="michael-mullarkey" class="section level4 hasAnchor" number="91.2.1.2">
<h4 class="hasAnchor"><span class="header-section-number">91.2.1.2</span> Michael Mullarkey<a href="#michael-mullarkey" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Hi y&#39;all, I have some news: I&#39;m opting out of the PI track and transitioning to data science<br><br>I thought it might be helpful for at least one person out there if I wrote down some thoughts. If you&#39;re making hard career decisions you&#39;re not alone<a href="https://t.co/p1QyKYmus2">https://t.co/p1QyKYmus2</a></p>&mdash; Dr. Michael Mullarkey (@mcmullarkey) <a href="https://twitter.com/mcmullarkey/status/1394769217988268042?ref_src=twsrc%5Etfw">May 18, 2021</a></blockquote>

<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:1601_closer.Rmd-->
</div>
</div>
</div>
</div>
<div id="part-r" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) R<a href="#part-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="r-workflow" class="section level1 hasAnchor" number="92">
<h1 class="hasAnchor"><span class="header-section-number">92</span> R Workflow<a href="#r-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Note: Adapted from <a href="https://github.com/zsmith27/rmarkdown_crash-course">Zachary M. Smith</a> ]</p>
</div>
<div id="r-project-development" class="section level1 hasAnchor" number="93">
<h1 class="hasAnchor"><span class="header-section-number">93</span> R Project Development<a href="#r-project-development" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview-1" class="section level2 hasAnchor" number="93.1">
<h2 class="hasAnchor"><span class="header-section-number">93.1</span> Overview<a href="#overview-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Easier to access files (relative path)</p>
<ul>
<li><p>Relative paths help prevent broken paths</p>
<ul>
<li>In general, DO NOT use setwd()</li>
<li>Will work if the project folder is moved to a new location on you local machine or moved to a new machine.</li>
</ul></li>
</ul></li>
<li><p>Designed to easily integrate with version control (GIT)</p></li>
<li><p>In general, all data, scripts, and output should be stored within the project directory.</p></li>
</ul>
</div>
<div id="create-a-new-r-project" class="section level2 hasAnchor" number="93.2">
<h2 class="hasAnchor"><span class="header-section-number">93.2</span> Create a New R Project<a href="#create-a-new-r-project" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Create a new R project by clicking on the drop-down menu at the top right of RStudio and selecting ‚ÄúNew Project‚Äù</li>
</ol>
<p><img src="img/r_project/create_project.png" width="1000" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Select ‚ÄúNew Directory‚Äù within the ‚ÄúCreate Project‚Äù window</li>
</ol>
<p><img src="img/r_project/new_directory.png" width="500" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Select ‚ÄúNew Project‚Äù within the ‚ÄúProject Type‚Äù window</li>
</ol>
<p><img src="img/r_project/project_type.png" width="600" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Enter a project name (below I have given the name ‚Äúnew_project‚Äù), the project directory (where the project should live), and select ‚ÄúCreate Project‚Äù</li>
</ol>
<blockquote>
<p><strong>Tip</strong>: Create a ‚Äúproject‚Äù folder that will act as your parent directory for all R projects. This will make it much easier to navigate to and between projects.</p>
</blockquote>
<p><img src="img/r_project/create_new_project.png" /></p>
<ol start="5" style="list-style-type: decimal">
<li><p>A new session specific to your R project will start within RStudio</p>
<ul>
<li>There are a number of ways to tell which project is open‚Ä¶</li>
</ul></li>
</ol>
<p><img src="img/r_project/fresh_project.png" /></p>
</div>
<div id="navigate-between-projects" class="section level2 hasAnchor" number="93.3">
<h2 class="hasAnchor"><span class="header-section-number">93.3</span> Navigate Between Projects<a href="#navigate-between-projects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quickly navigate between recently opened R projects by clicking on the drop-down menu at the top right of RStudio and selecting the project of interest.</p>
<p><img src="img/r_project/nav_project.png" width="400" /></p>
</div>
<div id="recommended-workflow" class="section level2 hasAnchor" number="93.4">
<h2 class="hasAnchor"><span class="header-section-number">93.4</span> Recommended Workflow<a href="#recommended-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Set up a GitHub repository.</li>
<li>Create an R-project connected to the GitHub repository.</li>
<li>Develop R-scripts.</li>
<li>Push and pull project changes to and from GitHub.</li>
</ol>
<p><img src="img/r_project/workflow.png" /></p>
</div>
<div id="your-turn" class="section level2 hasAnchor" number="93.5">
<h2 class="hasAnchor"><span class="header-section-number">93.5</span> Your Turn<a href="#your-turn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Open R Studio.</p></li>
<li><p>Create a new Project.</p></li>
<li><p>Add an ‚Äúdata‚Äù folder and add the example data set to this folder.</p></li>
<li><p>Create a new R Script (Ctrl + Shift + N) and save the script as ‚Äúlesson_1.R‚Äù to your project root folder.</p></li>
<li><p>Add the following script and run it (Ctrl + Enter)</p>
<ul>
<li>Notice that the entire file path to CSV of interest (‚Äúzms_thesis_metrics.csv‚Äù) was not specified just <code>file.path("data", "zms_thesis_metrics.csv")</code>.</li>
</ul>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a>thesis.df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>,</span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;zms_thesis_metrics.csv&quot;</span>),</span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb558-4"><a href="#cb558-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-5"><a href="#cb558-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(thesis.df)</span></code></pre></div></li>
<li><p>View <code>thesis.df</code> in the Environment panel</p>
<ul>
<li><p>How many rows and columns does our data frame have?</p></li>
<li><p>Click on the drop-down menu (the blue circle to the left of <code>thesis.df</code>).</p>
<ul>
<li>Can you identify the column type (e.g., Character, Numeric, Integer, or Factor) of the columns <code>unique_id</code>, <code>substrate_size_d50</code>, <code>richness</code>, and <code>pct_diptera</code>?</li>
<li>What are the first, second, and third <code>unique_id</code>‚Äôs represented in the data frame and which <code>richness</code> values are associated with each <code>unique_id</code>?</li>
</ul></li>
<li><p>Click on the button to view the data (the small girdded table to the far-right of <code>thesis.df</code>)</p>
<ul>
<li>Filter the data frame to only see data from Onondaga Lake (<code>lake</code> = ‚Äúonon‚Äù)</li>
</ul></li>
</ul></li>
</ol>
</div>
</div>
<div id="rmd-creation" class="section level1 hasAnchor" number="94">
<h1 class="hasAnchor"><span class="header-section-number">94</span> Rmd Creation<a href="#rmd-creation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="create-a-new-document" class="section level2 hasAnchor" number="94.1">
<h2 class="hasAnchor"><span class="header-section-number">94.1</span> Create a New Document<a href="#create-a-new-document" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Click on the new document button:</li>
</ol>
<p><img src="img/rstudio/new_document_button.png" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Click on R Markdown:</li>
</ol>
<p><img src="img/rmarkdown/rmarkdown_button.png" width="400" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Provide a ‚ÄúTitle:‚Äù, select the ‚ÄúDefault Output Format:‚Äù, and click ‚ÄúOK‚Äù</li>
</ol>
<p><img src="img/rmarkdown/new_rmarkdown_window.png" width="600" /></p>
<ol start="4" style="list-style-type: decimal">
<li>A new R Markdown document will appear with some instructions and example text/code.</li>
</ol>
<p><img src="img/rmarkdown/new_rmarkdown_window.png" width="600" /></p>
</div>
<div id="compile-the-document" class="section level2 hasAnchor" number="94.2">
<h2 class="hasAnchor"><span class="header-section-number">94.2</span> Compile the Document<a href="#compile-the-document" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="img/rmarkdown/knit_button.png" width="160" /></p>
<p>To view the html document, you must compile the document using Knit. The easiest way to knit a document is to navigate to and click on the Knit button (it looks like a ball of yarn) in the toolbar above the editor window. If a window appears saying ‚ÄúInstall Required Packages‚Äù for R Markdown, install the necessary packages for knitting the document. The compiled file will be saved in the same directory as your Rmd file (your R Markdown file). I generally store the R Markdown file(s) in a sub-directory labeled ‚Äúrmarkdown‚Äù within the R-project folder (rproject/markdown), which prevents the project directory from becoming cluttered‚Äì this is <strong>NOT</strong> necessary.</p>
<p>You can click on the small triangle to the right of the Knit button to view a drop-down menu of knitting options. Here you have the option to update the document type you want to knit (examples listed below).</p>
<ul>
<li>Knit to HTML</li>
<li>Knit to PDF</li>
<li>Knit to Word</li>
</ul>
<p>By clicking one of these options your YAML header updates automatically. We will discuss YAML headers in a later section, but in short the YAML header defines some of the formatting options associated with the document, including the output type. You can have multiple document types render at once (e.g., a separate HTML and Word document are created with each knit call).</p>
</div>
<div id="document-types" class="section level2 hasAnchor" number="94.3">
<h2 class="hasAnchor"><span class="header-section-number">94.3</span> Document Types<a href="#document-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are multiple document types available which designate how the .Rmd file will be rendered (knit).</p>
<div id="html" class="section level3 hasAnchor" number="94.3.1">
<h3 class="hasAnchor"><span class="header-section-number">94.3.1</span> HTML<a href="#html" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Knitting to a Hyper Text Markup Language (HTML) document is the default for R Markdown. Using HTML will enable you to add interactive features to your document. To view HTML documents, simply open them in your internet browser of choice‚Äì by default, your machine should open HTML documents in your default browser automatically.</p>
<div id="r-markdown-vs.-r-notebook" class="section level4 hasAnchor" number="94.3.1.1">
<h4 class="hasAnchor"><span class="header-section-number">94.3.1.1</span> R Markdown vs.¬†R Notebook<a href="#r-markdown-vs.-r-notebook" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>R Markdown documents (<code>html_documents</code>) and R Notebook documents (<code>html_notebook</code>) are very similar; in fact, an R Notebook document is a special type of R Markdown document. The main difference is using R Markdown document (<code>html_documents</code>) you have to knit (render) the entire document each time you want to preview the document, even if you have made a minor change. However, using an R Notebook document (<code>html_notebook</code>) you can view a preview of the final document without rendering the entire document.</p>
<p>For all document types you can specify how you want to preview the rendered documents by clicking on the cog in the Source window toolbar to reveal a drop-down menu of options. The recommended setup for use of an R Notebook document would be to specify you want to view the preview in the Viewer pane (i.e., the bottom right pane shared with Files, Plots, Packages, and Help).</p>
<p><img src="img/rmarkdown/rmarkdown_cog_preview-chunk-output-inline.png" /></p>
<p>Then click on the ‚ÄúPreview‚Äù button in the Source window toolbar to render a preview of the final document.</p>
<p><img src="img/rmarkdown/rnotebook_preview-button.png" /></p>
<p>Keep the Viewer pane open and do not close the preview of the document. Now begin to edit the markdown syntax in the document. Each time you save the document the preview window will render the changes made to the markdown syntax. If you edit R code chunks, you must run the code chunks within the notebook file prior to saving to see the changes in the Viewer window.</p>
</div>
</div>
<div id="pdf" class="section level3 hasAnchor" number="94.3.2">
<h3 class="hasAnchor"><span class="header-section-number">94.3.2</span> PDF<a href="#pdf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have the ability to knit to Portable Document Format (PDF) but you will not be able include interactive features in the document. Knitting to a PDF requires you to have the program LaTeX installed. You will get the following error message if you try to knit a PDF document without LaTeX installed on your machine: &gt; No LaTeX installation detected (LaTeX is required to create PDF output). You should install a LaTeX distribution for your platform: <a href="https://www.latex-project.org/get/" class="uri">https://www.latex-project.org/get/</a> If you are not sure, you may install TinyTeX in R: tinytex::install_tinytex() Otherwise consider MiKTeX on Windows - <a href="http://miktex.org" class="uri">http://miktex.org</a> MacTeX on macOS - <a href="https://tug.org/mactex/" class="uri">https://tug.org/mactex/</a> (NOTE: Download with Safari rather than Chrome <em>strongly</em> recommended) Linux: Use system package manager</p>
</div>
<div id="word" class="section level3 hasAnchor" number="94.3.3">
<h3 class="hasAnchor"><span class="header-section-number">94.3.3</span> Word<a href="#word" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have the ability to knit to Microsoft Word if you have Microsoft Word installed on your machine. Similarly to PDFs, you will not be able to include interactive features in your Word documents.</p>
</div>
<div id="templates" class="section level3 hasAnchor" number="94.3.4">
<h3 class="hasAnchor"><span class="header-section-number">94.3.4</span> Templates<a href="#templates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="provide-templates" class="section level4 hasAnchor" number="94.3.4.1">
<h4 class="hasAnchor"><span class="header-section-number">94.3.4.1</span> Provide Templates<a href="#provide-templates" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are a number of templates you can install or will come with packages you install, which you can view in the pop-up window that appears when you select that you want to create a new R Markdown file.</p>
<p><img src="img/rmarkdown/from_template.png" /></p>
<p>These templates may give you a jump-start to provide a large portion of the formatting specification to make specific documents. Some example templates from the package <strong>pagedown</strong> are:
- Business Card
- Letter
- Paged HTML Documents
- Resume
- Journal Article
- Poster
- Thesis
- Package Vignette</p>
</div>
<div id="custom-templates" class="section level4 hasAnchor" number="94.3.4.2">
<h4 class="hasAnchor"><span class="header-section-number">94.3.4.2</span> Custom Templates<a href="#custom-templates" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You also have the ability to specify custom templates in your YAML header. We will discuss YAML headers in a later section (<a href="#lesson-4-yaml-headers">Lesson 4: YAML Headers</a>).</p>
<p>I have only used this feature for Microsoft Word documents. I created a new document within Microsoft Word and selected all of the formatting options I wanted for my document. I then added the template to the YAML header of my R Markdown document to specify that when the document is knit (rendered) to apply the formatting specifications found in the template Microsoft Word document.</p>
</div>
</div>
<div id="other-types" class="section level3 hasAnchor" number="94.3.5">
<h3 class="hasAnchor"><span class="header-section-number">94.3.5</span> Other Types<a href="#other-types" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="presentations" class="section level4 hasAnchor" number="94.3.5.1">
<h4 class="hasAnchor"><span class="header-section-number">94.3.5.1</span> Presentations<a href="#presentations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You have the ability to create presentation slides using R Markdown. Below are the different format options available. Examples can be found in the following link under the ‚ÄúPresentation‚Äù section: <a href="https://rmarkdown.rstudio.com/gallery.html" class="uri">https://rmarkdown.rstudio.com/gallery.html</a></p>
<ul>
<li>ioslides (HTML)</li>
<li>Slidy (HTML)</li>
<li>Beamer (PDF)
<ul>
<li>Requires LaTeX</li>
</ul></li>
<li>Microsoft PowerPoint
<ul>
<li>Requires Microsoft PowerPoint</li>
</ul></li>
</ul>
<p>I have tried to create presentations with R Markdown on several occasions but I always revert back to using Microsoft PowerPoint. I have not found these slides to be very flexible and seem to only be able to generate simple slides without much content. My recommendation would be to try these slides out if you are making a presentation demonstrating how to use simple R code.</p>
</div>
<div id="shiny-documents" class="section level4 hasAnchor" number="94.3.5.2">
<h4 class="hasAnchor"><span class="header-section-number">94.3.5.2</span> Shiny Documents<a href="#shiny-documents" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Shiny documents enable you to embed a shiny application into an R Markdown document. This will enable you to insert custom interactive features into your document. The final document will need to be an HTML file.</p>
</div>
</div>
</div>
<div id="your-turn-1" class="section level2 hasAnchor" number="94.4">
<h2 class="hasAnchor"><span class="header-section-number">94.4</span> Your Turn<a href="#your-turn-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Create a new HTML .Rmd file.</p></li>
<li><p>Save the document to your project root folder.</p></li>
<li><p>Knit the default document produced by RStudio.</p></li>
<li><p>Using the Knit drop-down menu, specify that you want to create a Word document.</p>
<ul>
<li>This will only be possible if you have Microsoft Word installed on your machine.</li>
</ul></li>
<li><p><strong>Bonus:</strong> Try creating new R Markdown documents and selecting Presentation, Shiny, and other templates available. Each selection will provide you with an example .Rmd file that you can knit (render) and explore.</p></li>
</ol>
</div>
</div>
<div id="basic-syntax" class="section level1 hasAnchor" number="95">
<h1 class="hasAnchor"><span class="header-section-number">95</span> Basic Syntax<a href="#basic-syntax" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><strong>Source:</strong> <a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf</a></li>
</ul>
<center>
<p><img src="img/rmarkdown/reference.png" width="800" /></p>
</center>
<div id="heading-text" class="section level2 hasAnchor" number="95.1">
<h2 class="hasAnchor"><span class="header-section-number">95.1</span> Heading Text<a href="#heading-text" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Heading text follows one or more hash-sign(s) (#). The number of hash-signs determines the hierarchy of headings. For example, ‚Äú# Heading 1‚Äù would represent the primary heading, ‚Äú## Heading 2‚Äù would represent the secondary heading, ‚Äú### Heading 3‚Äù would represent the tertiary heading, and so forth.</p>
</div>
<div id="plain-text" class="section level2 hasAnchor" number="95.2">
<h2 class="hasAnchor"><span class="header-section-number">95.2</span> Plain Text<a href="#plain-text" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simply add text below the YAML header. To start a new paragraph, you will need to end your plain text line with two (2) spaces.</p>
</div>
<div id="bold-and-italicized-text" class="section level2 hasAnchor" number="95.3">
<h2 class="hasAnchor"><span class="header-section-number">95.3</span> <strong>Bold</strong> and <em>Italicized</em> Text<a href="#bold-and-italicized-text" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two ways to format your text to be <strong>bold</strong> or <em>italicized</em>.</p>
<ul>
<li><p><strong>Bold</strong></p>
<ul>
<li>Surround your text with two (2) asterisks (*) on each side.</li>
<li>Surround your text with two (2) underscores (_) on each side.</li>
</ul></li>
<li><p><em>Italicized</em></p>
<ul>
<li>Surround your text with one (1) asterisk (*) on each side.</li>
<li>Surround your text with one (1) underscore (_) on each side.</li>
</ul></li>
</ul>
<p>The markdown syntax‚Ä¶</p>
<p><img src="img/rmarkdown/bold_italics_syntax.png" /></p>
<p>which renders to‚Ä¶</p>
<p><strong>Bold Text Example</strong></p>
<p><strong>Bold Text Example</strong></p>
<p><em>Italicize Text Example</em></p>
<p><em>Italicize Text Example</em></p>
</div>
<div id="lists" class="section level2 hasAnchor" number="95.4">
<h2 class="hasAnchor"><span class="header-section-number">95.4</span> Lists<a href="#lists" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="unordered-lists" class="section level3 hasAnchor" number="95.4.1">
<h3 class="hasAnchor"><span class="header-section-number">95.4.1</span> Unordered Lists<a href="#unordered-lists" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unordered or bulleted lists can be generated by using a single asterisk (*) followed by a space and the plain text intended to represent the bullet. To add another bullet, just hit enter or return and follow the previous steps. To add sub-bullets, insert two spaces and a plus sign (+) followed by a space and the plain text intended to represent the sub-bullet. You can do this at multiple levels; meaning you can add four spaces and a plus sign (+) to insert a sub-sub-bullet and six spaces and a plus sign (+) to add a sub-sub-sub-bullet.</p>
<p>The markdown syntax‚Ä¶</p>
<p><img src="img/rmarkdown/unordered_list_syntax.png" /></p>
<p>which renders to‚Ä¶</p>
<ul>
<li><p>Bullet 1</p></li>
<li><p>Bullet 2</p>
<ul>
<li><p>Sub-Bullet 1</p></li>
<li><p>Sub-Bullet 2</p>
<ul>
<li>Sub-Sub-Bullet 1</li>
<li>Sub-Sub-Bullet 2</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="ordered-lists" class="section level3 hasAnchor" number="95.4.2">
<h3 class="hasAnchor"><span class="header-section-number">95.4.2</span> Ordered Lists<a href="#ordered-lists" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Follow the steps in Unordered Lists but instead of using asterisk (*) use sequential numbers followed by a period (.)‚Äì this cannot be done for sub-bullets. For example, ‚Äú1.‚Äù, ‚Äú2.‚Äù, and ‚Äú3.‚Äù.</p>
<p>The markdown syntax‚Ä¶</p>
<p><img src="img/rmarkdown/ordered_list_syntax.png" /></p>
<p>which renders to‚Ä¶</p>
<ol style="list-style-type: decimal">
<li><p>Bullet 1</p>
<ul>
<li>Sub-Bullet 1</li>
</ul></li>
<li><p>Bullet 2</p>
<ul>
<li><p>Sub-Bullet 1</p></li>
<li><p>Sub-Bullet 2</p>
<ul>
<li>Sub-Sub-Bullet 1</li>
</ul></li>
</ul></li>
</ol>
</div>
</div>
<div id="link-to-a-section" class="section level2 hasAnchor" number="95.5">
<h2 class="hasAnchor"><span class="header-section-number">95.5</span> Link to a Section<a href="#link-to-a-section" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can link to a section within the document by surrounding the name of the section in square brackets.</p>
<p>The markdown syntax‚Ä¶</p>
<p><code>[Lesson 3: Basic Syntax]</code></p>
<p>would render to this‚Ä¶</p>
<p>[Lesson 3: Basic Syntax]</p>
<p>If you click on the ‚ÄúLesson 3: Basic Syntax‚Äù above, it will jump you to the head of this section.</p>
</div>
<div id="hyperlink" class="section level2 hasAnchor" number="95.6">
<h2 class="hasAnchor"><span class="header-section-number">95.6</span> Hyperlink<a href="#hyperlink" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You simply need to paste in a full URL into your document and it will automatically be recognized as a hyperlink. For example‚Ä¶</p>
<p><a href="https://bookdown.org/yihui/rmarkdown" class="uri">https://bookdown.org/yihui/rmarkdown</a></p>
<p>If you want to hide the full link and represent it with text, then surround the text with square brackets followed by the URL in parenthesis.</p>
<p>The markdown syntax‚Ä¶</p>
<p><code>[link](https://bookdown.org/yihui/rmarkdown/)</code></p>
<p>would render to this‚Ä¶</p>
<p><a href="https://bookdown.org/yihui/rmarkdown/">link</a>.</p>
</div>
<div id="insert-images" class="section level2 hasAnchor" number="95.7">
<h2 class="hasAnchor"><span class="header-section-number">95.7</span> Insert Images<a href="#insert-images" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can insert images into your document using syntax similar to the hyperlink syntax above.</p>
<p>In the code below, you can see the file path the to the image. This image will render without a caption</p>
<p><code>![](img/hex_symbols/rmarkdown.png)</code></p>
<p><img src="img/hex_symbols/rmarkdown.png" /></p>
<p>You can add a caption for the image in between the square brackets.</p>
<p><code>![This is my caption for the image.](img/hex_symbols/rmarkdown.png)</code></p>
<div class="figure">
<img src="img/hex_symbols/rmarkdown.png" alt="" />
<p class="caption">This is my caption for the image.</p>
</div>
<p>You can control the size of the image like this‚Ä¶</p>
<p><code>![This is my caption for the image.](img/hex_symbols/rmarkdown.png){width=200px}</code></p>
<div class="figure">
<img src="img/hex_symbols/rmarkdown.png" width="100" alt="" />
<p class="caption">This is my caption for the image.</p>
</div>
<p>You can center the image with HTML like this‚Ä¶</p>
<p><img src="img/rmarkdown/centered_image.png" /></p>
<center>
<div class="figure">
<img src="img/hex_symbols/rmarkdown.png" width="100" alt="" />
<p class="caption">This is my caption for the image.</p>
</div>
</center>
</div>
<div id="tabbed-sections" class="section level2 hasAnchor" number="95.8">
<h2 class="hasAnchor"><span class="header-section-number">95.8</span> Tabbed Sections<a href="#tabbed-sections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tabbed sections can be added to section of an HTML documents that will fold all of the subsequent sub-sections into separate tabs. To do this you specify a section header followed by <code>{.tabset}</code>. For example, <code>## My Section Header {.tabset}</code>.</p>
<p><img src="img/rmarkdown/tabset.png" /></p>
<p>Note this feature is not available for use with <strong>bookdown</strong>.</p>
</div>
<div id="your-turn-2" class="section level2 hasAnchor" number="95.9">
<h2 class="hasAnchor"><span class="header-section-number">95.9</span> Your Turn<a href="#your-turn-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Using the .Rmd file created in [Lesson 2: Rmd Creation], delete everything below the YAML header.</p></li>
<li><p>Add the following level-1 headers and knit the document.</p>
<ul>
<li>Introduction</li>
<li>Workflow</li>
<li>Import Data</li>
<li>Preprocessing</li>
<li>Study Area</li>
<li>Plot</li>
<li>Conclusions</li>
</ul></li>
<li><p>Add two level-2 headers below the Plot header and knit the document.</p>
<ul>
<li>Scatter Plot</li>
<li>LOESS Plot</li>
</ul></li>
<li><p>Add plain text below the Introduction header and knit the document.</p>
<ul>
<li>Be sure to include some <strong>bold</strong> and <em>italicized</em> text.</li>
<li>Explain the purpose of the document (e.g., ‚ÄúThis document was created during the 2020 NABs R Markdown workshop and will serve as an example workflow for my future use of R Markdown.‚Äù)</li>
<li>Include the hyperlink to R Markdown: The Definitive Guide (<a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a>). This will be a helpful resource in the future.</li>
</ul></li>
<li><p>Add unordered or ordered list below the Workflow header and knit the document.</p>
<ul>
<li>Describe the workflow we have talked about thus far (e.g., create an R project, add folders, create an rmarkdown document, knit the document to render).</li>
<li>Add sub-bullets with helpful details.</li>
</ul></li>
<li><p>Add the image provided with the data to the Introduction.</p></li>
<li><p>Make the Plot section tabbed section with <code>{.tabset}</code>.</p></li>
</ol>
</div>
</div>
<div id="lesson-4-yaml-headers" class="section level1 hasAnchor" number="96">
<h1 class="hasAnchor"><span class="header-section-number">96</span> Lesson 4: YAML Headers<a href="#lesson-4-yaml-headers" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>YAML:</strong> YAML Ain‚Äôt Markup Language</p>
<p>A YAML header contains YAML arguments, such as ‚Äútitle‚Äù, ‚Äúauthor‚Äù, and ‚Äúoutput‚Äù, demarcated by three dashes (‚Äî) on either end.</p>
<center>
<p><img src="img/rmarkdown/yaml_1.png" /></p>
</center>
<div id="title" class="section level2 hasAnchor" number="96.1">
<h2 class="hasAnchor"><span class="header-section-number">96.1</span> Title<a href="#title" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The specified title (<code>title: "My Title"</code>) will appear at the head of the document with a larger font size than the rest of the document.</p>
<div id="subtitle" class="section level3 hasAnchor" number="96.1.1">
<h3 class="hasAnchor"><span class="header-section-number">96.1.1</span> Subtitle<a href="#subtitle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can specify subtitle (<code>subtitle: "My Subtitle"</code>), which will appear below and in slightly smaller font size than the title of the document.</p>
</div>
</div>
<div id="authors" class="section level2 hasAnchor" number="96.2">
<h2 class="hasAnchor"><span class="header-section-number">96.2</span> Author(s)<a href="#authors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An author can be specified (<code>author: "Zachary M. Smith"</code>) and will appear at the head of the document but below the title(s). You can specify multiple authors by separating the names of the authors by a comma (<code>author: "Zachary M. Smith, John Doe"</code>).</p>
</div>
<div id="date" class="section level2 hasAnchor" number="96.3">
<h2 class="hasAnchor"><span class="header-section-number">96.3</span> Date<a href="#date" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can supply a date (<code>date: "March 3rd, 2020"</code>) that will be added to the head of the document. You can specify a static date (<code>date: "March 3rd, 2020"</code>) or a dynamic date (see image below) that will update each time you knit (render) the document‚Äì we will discuss this further in a subsequent section.</p>
<center>
<p><img src="img/rmarkdown/yaml_dynamic-date.png" /></p>
</center>
</div>
<div id="table-of-contents-toc" class="section level2 hasAnchor" number="96.4">
<h2 class="hasAnchor"><span class="header-section-number">96.4</span> Table of Contents (TOC)<a href="#table-of-contents-toc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<center>
<p><img src="img/rmarkdown/yaml_2.png" /></p>
</center>
<div id="floating-table-of-contents-toc" class="section level3 hasAnchor" number="96.4.1">
<h3 class="hasAnchor"><span class="header-section-number">96.4.1</span> Floating Table of Contents (TOC)<a href="#floating-table-of-contents-toc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<center>
<p><img src="img/rmarkdown/yaml_3.png" /></p>
</center>
</div>
</div>
<div id="themes" class="section level2 hasAnchor" number="96.5">
<h2 class="hasAnchor"><span class="header-section-number">96.5</span> Themes<a href="#themes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can modify the YAML to specify the .theme of the document, which will change document styling (e.g., font type, color, size)</p>
<p>The following link provides examples of some of the available R Markdown themes: <a href="https://www.datadreaming.org/post/r-markdown-theme-gallery/" class="uri">https://www.datadreaming.org/post/r-markdown-theme-gallery/</a></p>
<center>
<p><img src="img/rmarkdown/yaml_4.png" /></p>
</center>
</div>
<div id="code-folding" class="section level2 hasAnchor" number="96.6">
<h2 class="hasAnchor"><span class="header-section-number">96.6</span> Code Folding<a href="#code-folding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Code folding refers to the HTML YAML option to hide code chunks by default, but enable the reader to click a button to show the underlying code chunk.</p>
<div id="example-without-code-folding" class="section level3 hasAnchor" number="96.6.1">
<h3 class="hasAnchor"><span class="header-section-number">96.6.1</span> Example without Code Folding<a href="#example-without-code-folding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<center>
<p><img src="img/rmarkdown/folding_non.png" /></p>
</center>
</div>
<div id="examples-with-code-folding" class="section level3 hasAnchor" number="96.6.2">
<h3 class="hasAnchor"><span class="header-section-number">96.6.2</span> Examples with Code Folding<a href="#examples-with-code-folding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="show" class="section level4 hasAnchor" number="96.6.2.1">
<h4 class="hasAnchor"><span class="header-section-number">96.6.2.1</span> Show<a href="#show" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<center>
<p><img src="img/rmarkdown/folding_show.png" /></p>
</center>
</div>
<div id="hide" class="section level4 hasAnchor" number="96.6.2.2">
<h4 class="hasAnchor"><span class="header-section-number">96.6.2.2</span> Hide<a href="#hide" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<center>
<p><img src="img/rmarkdown/folding_hide.png" /></p>
</center>
</div>
</div>
</div>
<div id="output" class="section level2 hasAnchor" number="96.7">
<h2 class="hasAnchor"><span class="header-section-number">96.7</span> output<a href="#output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The output option allows you to specify the type of document you want to create. This will be auto-populated if you generate the .Rmd file in RStudio by creating a new R Markdown file through the toolbar. You can manually modify the output type, but you must specify valid arguments.</p>
<p>Some valid arguments include:</p>
<ul>
<li><code>html_document</code></li>
<li><code>html_notebook</code></li>
<li><code>pdf_document</code></li>
<li><code>word_document</code></li>
</ul>
<p>You can click on the small triangle to the right of the Knit button to view a drop-down menu of knitting options. Here you have the option to update the document type you want to knit (examples listed below).</p>
<ul>
<li>Knit to HTML</li>
<li>Knit to PDF</li>
<li>Knit to Word</li>
</ul>
<p>By clicking one of these options, your YAML header updates automatically. You can have multiple document types render at once (e.g., a separate HTML and Word document are created with each knit call).</p>
<center>
<p><img src="img/rmarkdown/yaml-two-outputs.png" /></p>
</center>
</div>
<div id="custom-template" class="section level2 hasAnchor" number="96.8">
<h2 class="hasAnchor"><span class="header-section-number">96.8</span> Custom Template<a href="#custom-template" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You have the ability to specify custom templates in your YAML header.</p>
<p>I have only used this feature for Microsoft Word documents. I created a new document within Microsoft Word and selected all of the formatting options I wanted for my document. I then added the template to the YAML header of my R Markdown document to specify that when the document is knit (rendered) to apply the formatting specifications found in the template Microsoft Word document.</p>
<center>
<p><img src="img/rmarkdown/yaml_word-template.png" /></p>
</center>
</div>
<div id="ymlthis" class="section level2 hasAnchor" number="96.9">
<h2 class="hasAnchor"><span class="header-section-number">96.9</span> ymlthis<a href="#ymlthis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>ymlthis</strong> is an R package intended to make it easier for you to generate YAML headers. The package also includes an interactive addin that provides an intuitive user-interface for generating YAML headers. You can visit the following link to learn more about how to use ymlthis: []<a href="https://ymlthis.r-lib.org/" class="uri">https://ymlthis.r-lib.org/</a></p>
<p>Addins can be accessed by navigating to ‚ÄúTools‚Äù in the RStudio banner, scrolling down to ‚ÄúAddins‚Äù, and selecting ‚ÄúBrowse Addins.‚Äù A pop-up window will appear. If you have <strong>ymlthis</strong> installed on your machine, you will see the <strong>ymlthis</strong> addin in the pop-up window table. Once you select the <strong>ymlthis</strong> addin, you will see a pop-up window like this‚Ä¶</p>
<center>
<p><img src="img/rmarkdown/ymlthis_popup.png" /></p>
</center>
</div>
<div id="your-turn-3" class="section level2 hasAnchor" number="96.10">
<h2 class="hasAnchor"><span class="header-section-number">96.10</span> Your Turn<a href="#your-turn-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Edit the YAML title and author and knit the document.</p></li>
<li><p>Specify in the YAML that you want to include a table of contents and knit the document.</p></li>
<li><p>Specify in the YAML that you want a floating table of contents and knit the document.</p></li>
<li><p>Specify in the YAML that you want to change the theme to ‚Äújournal‚Äù and knit the document.</p></li>
<li><p>If you have Microsoft Word installed on your computer, change the YAML output to <code>word_document</code> and the knit the document.</p></li>
<li><p><strong>Bonus:</strong> If you finish early, install <strong>ymlthis</strong> (<code>install.packages("ymlthis")</code>), navigate to the <strong>ymlthis</strong> addin, and try to re-create the YAML header from steps 1-4.</p></li>
</ol>
</div>
</div>
<div id="lesson-5-code-chunks-and-inline-code" class="section level1 hasAnchor" number="97">
<h1 class="hasAnchor"><span class="header-section-number">97</span> Lesson 5: Code Chunks and Inline Code<a href="#lesson-5-code-chunks-and-inline-code" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Up to this point in the workshop we have mostly just written a standard markdown document. However, we want to integrate R code into our document to create reproducible objects, such as figures, tables, and text.</p>
<div id="code-chunks" class="section level2 hasAnchor" number="97.1">
<h2 class="hasAnchor"><span class="header-section-number">97.1</span> Code Chunks<a href="#code-chunks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To insert a code chunk, press <strong>Ctrl + Alt + I</strong> in the source pane (top left pane in the default settings of RStudio). A code chunk will appear: <img src="img/rmarkdown/code_chunk.png" /></p>
<p>Inside the code chunk you can write and run R-code. If you print the output of your R-code it will appear below the code chunk in the source pane and the printed output will appear in the final compiled document. This is useful for producing figures and tables.</p>
<p><img src="img/rmarkdown/example_chunk_ouptut.png" /></p>
<ul>
<li><p>On the far right of the code chunk you will see three buttons.</p>
<ul>
<li>The cog makes it easy to specify code chunk options‚Äì discussed below.</li>
<li>The middle button will execute all code chunks prior to a given function (<code>Ctrl + Alt + P</code>)</li>
<li>The far right button will execute all of the code in a code chunk.</li>
</ul></li>
</ul>
<center>
<p><img src="img/rmarkdown/code-chunk_tools.png" /></p>
</center>
<div id="shortcuts" class="section level3 hasAnchor" number="97.1.1">
<h3 class="hasAnchor"><span class="header-section-number">97.1.1</span> Shortcuts<a href="#shortcuts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>You will want to learn these ASAP.</strong></p>
<ul>
<li><code>Ctrl + Alt + I</code> - Insert a new code chunk</li>
<li><code>Ctrl + Enter</code> - Run the line of code your cursor is on</li>
<li><code>Ctrl + Alt + R</code> - Run all of the code in the document</li>
<li><code>Ctrl + Alt + P</code> - Run all code chunks above your cursor</li>
<li><code>Ctrl + Shift + F10</code> - Restart R</li>
</ul>
</div>
<div id="options" class="section level3 hasAnchor" number="97.1.2">
<h3 class="hasAnchor"><span class="header-section-number">97.1.2</span> Options<a href="#options" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of code chunk options that can be specified in the code chunk header to modify how the code chunk is rendered while kniting. These options will not be visible in the rendered document‚Äì even if you choose not to hide the code chunks in your rendered document.</p>
<p>A comprehensive list of chunk options can be found here: <a href="https://yihui.org/knitr/options/" class="uri">https://yihui.org/knitr/options/</a></p>
<div id="name" class="section level4 hasAnchor" number="97.1.2.1">
<h4 class="hasAnchor"><span class="header-section-number">97.1.2.1</span> name<a href="#name" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Best practice is to include a short and unique name within each code chunk header. This will be especially beneficial if you need to troubleshoot an error in your document as you will be able to track the source of the error down by code chunk name. The ‚Äúname‚Äù is not specified as an argument within the header; it is simply separated from the ‚Äúr‚Äù by a space. This is exemplified in the image below on line 9 where ‚Äúaddition‚Äù is supplied as the name of the code chunk (<code>{r addition}</code>).</p>
<p><img src="img/rmarkdown/code-chunk_name.png" /></p>
</div>
<div id="echo" class="section level4 hasAnchor" number="97.1.2.2">
<h4 class="hasAnchor"><span class="header-section-number">97.1.2.2</span> echo<a href="#echo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A logical value (true or false) indicating if the code chunk should be visible in the rendered document. By default the code chunk will be visible upon knitting (<code>echo=true</code>). To hide a specific code chunk set echo to ‚Äúfalse‚Äù (<code>echo=false</code>).</p>
<p>Include the code chunk in the rendered document with <code>echo=true</code>. <img src="img/rmarkdown/code-chunk_echo-true.png" /></p>
<p>Exclude the code chunk in the rendered document with <code>echo=false</code>. <img src="img/rmarkdown/code-chunk_echo-false.png" /></p>
</div>
<div id="fig.width-fig.height-and-fig.cap" class="section level4 hasAnchor" number="97.1.2.3">
<h4 class="hasAnchor"><span class="header-section-number">97.1.2.3</span> fig.width, fig.height, and fig.cap<a href="#fig.width-fig.height-and-fig.cap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>fig.width</code> and <code>fig.height</code> options allow you to control the size of the figure generated from a given code chunk. <code>fig.cap</code> provides the ability to add a caption below the figure generated from a given code chunk.</p>
<p>Here is an example of the plot output form a code chunk. <img src="img/rmarkdown/fig-options_default.png" /></p>
<p>Here I have specified <code>fig.width</code>, <code>fig.height</code>, and <code>fig.cap</code>. Notice that plot dimensions have changed from the previous image and a caption has been added to the bottom of the figure. <img src="img/rmarkdown/fig-options_fig-cap-default.png" /></p>
<p>In many cases, you will want the captions to be numbered and you will want this to occur automatically. To this you will first need to install the package <strong>bookdown</strong> (<code>install.packages("bookdown")</code>). Specify in the YAML header that the output should be ‚Äúhtml_document2‚Äù from the <strong>bookdown</strong> package (<code>output: bookdown::html_document2</code>). When you render the document the figures will now be automatically numbered by the order they appear in the document. To cross reference a figure by name in the text use <code>\@ref(fig:figure_name)</code>. Using the example from the figure below, you might write ‚ÄúIn <code>\@ref(fig:IrisScatter)</code> we can see that the species setosoa tend to have shorter sepal lengths than the other two species.‚Äù For more information visit <a href="https://bookdown.org/yihui/rmarkdown-cookbook/figure-number.html" class="uri">https://bookdown.org/yihui/rmarkdown-cookbook/figure-number.html</a>. <img src="img/rmarkdown/fig-options_fig-cap-bookdown-html2.png" /></p>
</div>
<div id="message-and-warning" class="section level4 hasAnchor" number="97.1.2.4">
<h4 class="hasAnchor"><span class="header-section-number">97.1.2.4</span> message and warning<a href="#message-and-warning" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using <code>message=FALSE</code> and/or <code>warning=FALSE</code> will suppress messages and warnings preventing them from printing in the rendered document. <strong>Warning:</strong> Suppress these messages/warnings at your own risk. Without these messages/warnings you may make it very difficult to track down any issues in your code.</p>
<p>An example of messages that are produced with the default <code>message=TRUE</code>. <img src="img/rmarkdown/code-chunk_message-true.png" /></p>
<p>The messages above can be suppressed by setting <code>message=FALSE</code> in the code chunk header. <img src="img/rmarkdown/code-chunk_message-false.png" /></p>
</div>
<div id="include" class="section level4 hasAnchor" number="97.1.2.5">
<h4 class="hasAnchor"><span class="header-section-number">97.1.2.5</span> include<a href="#include" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Code chunk headers with <code>include=FALSE</code> will be ignored when the document is rendered. This can be useful during document development. For example, you may have a code chunk producing an error that prevents you from rendering the rest of your document or you may be questioning the need to keep a given code chunk. <code>include=FALSE</code> will exclude the code from the rendered document without deleting the code entirely from the .Rmd file.</p>
<p>The default is <code>include=TRUE</code>. In the example below, <code>include</code> is not altered from the default and therefore all of the code chunks are present in the rendered document. <img src="img/rmarkdown/code-chunk_include-true.png" /></p>
<p>In the example below I added <code>include=FALSE</code> to the header of the second code chunk named ‚Äúiris-sepal-scatter.‚Äù The second code chunk is excluded from the rendered document. <img src="img/rmarkdown/code-chunk_include-false.png" /></p>
</div>
<div id="setting-global-options" class="section level4 hasAnchor" number="97.1.2.6">
<h4 class="hasAnchor"><span class="header-section-number">97.1.2.6</span> Setting Global Options<a href="#setting-global-options" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It can be helpful to establish global options to produce a standard format throughout the document. You can set this with the <strong>knitr</strong> function <code>opts_chunk$set()</code>. For instance, you may want to set a standard dimensions for figures produced by code chunks throughout your document. In the code chunk below, you can see that I set <code>fig.width</code> to 8 and <code>fig.height</code> to 4.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">fig.width =</span> <span class="dv">8</span>, <span class="at">fig.height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>The options specified in <code>opts_chunk$set()</code> become the default when rendering the document. However, you still have the ability to overwrite these options for specific code chunks. Building off of the previous example, you may find that one out of ten of your plots is not aesthetically pleasing with <code>fig.width = 8</code> and <code>fig.height = 4</code>. You could specify in the code chunk producing that plot that you want to set <code>fig.width = 6</code> and <code>fig.height = 6</code>, for example.</p>
</div>
</div>
</div>
<div id="inline-code" class="section level2 hasAnchor" number="97.2">
<h2 class="hasAnchor"><span class="header-section-number">97.2</span> Inline Code<a href="#inline-code" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Inline code enables you to insert R code into your document to dynamically updated portions of your text.</p>
<p>To insert inline code you need to encompass your R code within: <img src="img/rmarkdown/inline_syntax.png" />.</p>
<p>For example, you could write:</p>
<p><img src="img/rmarkdown/inline_example_iris-mean-sepal-length.png" /> <strong>Which would render to:</strong> The mean sepal length found in the <em>iris</em> data set is 5.843.</p>
<p>I frequently use inline code to make my YAML header date update to the date the document was last rendered.</p>
<center>
<p><img src="img/rmarkdown/inline_yaml-date.png" /></p>
</center>
<p>You can reformat the date using the <code>format()</code> function, as depicted in the image below. <img src="img/rmarkdown/inline_yaml-date-format.png" /></p>
</div>
<div id="your-turn-part-1" class="section level2 hasAnchor" number="97.3">
<h2 class="hasAnchor"><span class="header-section-number">97.3</span> Your Turn (Part 1)<a href="#your-turn-part-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>The point of this exercise is to get you familiar with code chunks and inline code, NOT to test your R knowledge; therefore, I have included the necessary code below each task.</em></p>
<ol style="list-style-type: decimal">
<li><p>Add a code chunk using <strong>Ctrl + Alt + i</strong> to import the example data set.</p>
<ul>
<li><p><code>read.csv(file = file.path("data", "zms_thesis_metrics.csv"), stringsAsFactors = FALSE)</code></p></li>
<li><p>Add a name to this code chunk header and all subsequent code chunk headers.</p></li>
<li><p>Add plain text description above the code chunk.</p></li>
<li><p>Add the following unordered list describing the contents of the imported data.</p>
<ul>
<li><code>unique_id</code> (character) unique sample ID</li>
<li><code>lake</code> (character) lake code: caz = Cazenovia lake, onon = Onondaga, and ot = Otisco</li>
<li><code>lat</code> (numeric) latitude of sampling location</li>
<li><code>long</code> (numeric) longitude of sampling location</li>
<li><code>substrate_size_d50</code> (numeric) median particle size from pebble count</li>
<li><code>conductivity</code> (numeric) specific conductivity (¬µS/cm)</li>
<li><code>richness</code> (numeric) taxonomic richness</li>
<li><code>shannon</code> (numeric) Shannon-Wiener diversity index values</li>
<li><code>pct_ephemeroptera</code> (numeric) relative abundance of Ephemeroptera taxa</li>
<li><code>pct_amphipoda</code> (numeric) relative abundance of Amphipoda taxa</li>
<li><code>pct_diptera</code> (numeric) relative abundance of Diptera taxa</li>
<li><code>dom_1</code> (numeric) relative abundance of the most dominant taxon observed in each sample</li>
</ul></li>
</ul></li>
<li><p>Add a code chunk to import the <strong>tidyverse</strong> packages.</p>
<ul>
<li><code>library(tidyverse)</code></li>
<li>Add plain text description above the code chunk.</li>
<li>Add <code>message=FALSE</code> to the code chunk header to prevent the package start-up messages</li>
</ul></li>
<li><p>Add a code chunk below <code>libary(tidyverse)</code> to preprocess lake name (<code>lake</code>) associated with each sample.</p></li>
</ol>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a>thesis.df <span class="ot">&lt;-</span> thesis.df <span class="sc">%&gt;%</span> </span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lake =</span> <span class="fu">case_when</span>(</span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true" tabindex="-1"></a>    lake <span class="sc">%in%</span> <span class="st">&quot;caz&quot;</span> <span class="sc">~</span> <span class="st">&quot;Cazenovia&quot;</span>,</span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true" tabindex="-1"></a>    lake <span class="sc">%in%</span> <span class="st">&quot;onon&quot;</span> <span class="sc">~</span> <span class="st">&quot;Onondaga&quot;</span>,</span>
<span id="cb560-5"><a href="#cb560-5" aria-hidden="true" tabindex="-1"></a>    lake <span class="sc">%in%</span> <span class="st">&quot;ot&quot;</span> <span class="sc">~</span> <span class="st">&quot;Otisco&quot;</span>,</span>
<span id="cb560-6"><a href="#cb560-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;ERROR&quot;</span></span>
<span id="cb560-7"><a href="#cb560-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb560-8"><a href="#cb560-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lake =</span> <span class="fu">factor</span>(lake, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Onondaga&quot;</span>,</span>
<span id="cb560-9"><a href="#cb560-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Otisco&quot;</span>,</span>
<span id="cb560-10"><a href="#cb560-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Cazenovia&quot;</span>)))</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><p>Add a code chunk just below the YAML header to specify global code chunk options</p>
<ul>
<li>specify <code>fig.width</code> and <code>fig.height</code></li>
<li>in the header specify <code>echo=FALSE</code> to hide this code chunk‚Äì your reader does not need to see this</li>
</ul>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>()</span></code></pre></div></li>
<li><p>Add a code chunk to generate a scatter plot.</p>
<ul>
<li>Add a caption</li>
</ul>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(thesis.df, <span class="fu">aes</span>(substrate_size_d50, pct_diptera, <span class="at">color =</span> lake)) <span class="sc">+</span></span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div></li>
<li><p>Add a code chunk generate a boxplot.</p>
<ul>
<li>Modify the figure size</li>
<li>Add a caption</li>
</ul>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(thesis.df, <span class="fu">aes</span>(lake, richness, <span class="at">fill =</span> lake)) <span class="sc">+</span></span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div></li>
<li><p>Add a brief interpretation of the figures into the ‚ÄúConclusions‚Äù section.</p></li>
<li><p><strong>Bonus:</strong> Try using the cog at the top right of the code chunk to update a code chunks options.</p></li>
</ol>
<center>
<p><img src="img/rmarkdown/code-chunk_tools.png" /></p>
</center>
</div>
<div id="interactive-features" class="section level2 hasAnchor" number="97.4">
<h2 class="hasAnchor"><span class="header-section-number">97.4</span> Interactive Features<a href="#interactive-features" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Interactive tables and figures are a great way to make your document more interesting and can be very useful for data exploration. I will warn you that if you use these features too frequently your document will become cluttered and will likely load and run slowly.</p>
<div id="dt" class="section level3 hasAnchor" number="97.4.1">
<h3 class="hasAnchor"><span class="header-section-number">97.4.1</span> DT<a href="#dt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>DT</strong> package enables you and your readers to interact with tables in your document. You can filter and sort the table to view data that you are most interested in exploring or understanding.</p>
<p>For more information visit <a href="https://rstudio.github.io/DT/" class="uri">https://rstudio.github.io/DT/</a></p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(iris)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4a67bee628ff89d31e3a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4a67bee628ff89d31e3a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150"],[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5,7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7,6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3,3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8,3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],[1.4,1.4,1.3,1.5,1.4,1.7,1.4,1.5,1.4,1.5,1.5,1.6,1.4,1.1,1.2,1.5,1.3,1.4,1.7,1.5,1.7,1.5,1,1.7,1.9,1.6,1.6,1.5,1.4,1.6,1.6,1.5,1.5,1.4,1.5,1.2,1.3,1.4,1.3,1.5,1.3,1.3,1.3,1.6,1.9,1.4,1.6,1.4,1.5,1.4,4.7,4.5,4.9,4,4.6,4.5,4.7,3.3,4.6,3.9,3.5,4.2,4,4.7,3.6,4.4,4.5,4.1,4.5,3.9,4.8,4,4.9,4.7,4.3,4.4,4.8,5,4.5,3.5,3.8,3.7,3.9,5.1,4.5,4.5,4.7,4.4,4.1,4,4.4,4.6,4,3.3,4.2,4.2,4.2,4.3,3,4.1,6,5.1,5.9,5.6,5.8,6.6,4.5,6.3,5.8,6.1,5.1,5.3,5.5,5,5.1,5.3,5.5,6.7,6.9,5,5.7,4.9,6.7,4.9,5.7,6,4.8,4.9,5.6,5.8,6.1,6.4,5.6,5.1,5.6,6.1,5.6,5.5,4.8,5.4,5.6,5.1,5.1,5.9,5.7,5.2,5,5.2,5.4,5.1],[0.2,0.2,0.2,0.2,0.2,0.4,0.3,0.2,0.2,0.1,0.2,0.2,0.1,0.1,0.2,0.4,0.4,0.3,0.3,0.3,0.2,0.4,0.2,0.5,0.2,0.2,0.4,0.2,0.2,0.2,0.2,0.4,0.1,0.2,0.2,0.2,0.2,0.1,0.2,0.2,0.3,0.3,0.2,0.6,0.4,0.3,0.2,0.2,0.2,0.2,1.4,1.5,1.5,1.3,1.5,1.3,1.6,1,1.3,1.4,1,1.5,1,1.4,1.3,1.4,1.5,1,1.5,1.1,1.8,1.3,1.5,1.2,1.3,1.4,1.4,1.7,1.5,1,1.1,1,1.2,1.6,1.5,1.6,1.5,1.3,1.3,1.3,1.2,1.4,1.2,1,1.3,1.2,1.3,1.3,1.1,1.3,2.5,1.9,2.1,1.8,2.2,2.1,1.7,1.8,1.8,2.5,2,1.9,2.1,2,2.4,2.3,1.8,2.2,2.3,1.5,2.3,2,2,1.8,2.1,1.8,1.8,1.8,2.1,1.6,1.9,2,2.2,1.5,1.4,2.3,2.4,1.8,1.8,2.1,2.4,2.3,1.9,2.3,2.5,2.3,1.9,2,2.3,1.8],["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Sepal.Length<\/th>\n      <th>Sepal.Width<\/th>\n      <th>Petal.Length<\/th>\n      <th>Petal.Width<\/th>\n      <th>Species<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="plotly" class="section level3 hasAnchor" number="97.4.2">
<h3 class="hasAnchor"><span class="header-section-number">97.4.2</span> Plotly<a href="#plotly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Plotly</strong> makes it easy to create interactive figures. Some of the most useful features are the ability to‚Ä¶</p>
<ul>
<li>rollover figure objects and see a pop-up information related to specific features</li>
<li>Zoom-in and zoom-out</li>
<li>take a picture of the figure</li>
</ul>
<p>For more information visit: <a href="https://plot.ly/ggplot2/" class="uri">https://plot.ly/ggplot2/</a></p>
<p>I generally use <strong>plotly</strong> in conjunction with <strong>ggplot2</strong>. The <strong>plotly</strong> function, <code>ggplotly()</code>, makes it simple to convert <strong>ggplot2</strong> figures to interactive <strong>plotly</strong> figures.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a>scatter.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Width, <span class="at">y =</span> Petal.Length,</span>
<span id="cb565-4"><a href="#cb565-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb565-5"><a href="#cb565-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb565-6"><a href="#cb565-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-7"><a href="#cb565-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(scatter.plot)</span></code></pre></div>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4dfcaa8f2ec5ea9efc85" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-4dfcaa8f2ec5ea9efc85">{"x":{"data":[{"x":[0.2,0.2,0.2,0.2,0.2,0.4,0.3,0.2,0.2,0.1,0.2,0.2,0.1,0.1,0.2,0.4,0.4,0.3,0.3,0.3,0.2,0.4,0.2,0.5,0.2,0.2,0.4,0.2,0.2,0.2,0.2,0.4,0.1,0.2,0.2,0.2,0.2,0.1,0.2,0.2,0.3,0.3,0.2,0.6,0.4,0.3,0.2,0.2,0.2,0.2],"y":[1.4,1.4,1.3,1.5,1.4,1.7,1.4,1.5,1.4,1.5,1.5,1.6,1.4,1.1,1.2,1.5,1.3,1.4,1.7,1.5,1.7,1.5,1,1.7,1.9,1.6,1.6,1.5,1.4,1.6,1.6,1.5,1.5,1.4,1.5,1.2,1.3,1.4,1.3,1.5,1.3,1.3,1.3,1.6,1.9,1.4,1.6,1.4,1.5,1.4],"text":["Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.3<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.4<br />Petal.Length: 1.7<br />Species: setosa","Petal.Width: 0.3<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.1<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.6<br />Species: setosa","Petal.Width: 0.1<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.1<br />Petal.Length: 1.1<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.2<br />Species: setosa","Petal.Width: 0.4<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.4<br />Petal.Length: 1.3<br />Species: setosa","Petal.Width: 0.3<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.3<br />Petal.Length: 1.7<br />Species: setosa","Petal.Width: 0.3<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.7<br />Species: setosa","Petal.Width: 0.4<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.0<br />Species: setosa","Petal.Width: 0.5<br />Petal.Length: 1.7<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.9<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.6<br />Species: setosa","Petal.Width: 0.4<br />Petal.Length: 1.6<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.6<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.6<br />Species: setosa","Petal.Width: 0.4<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.1<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.2<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.3<br />Species: setosa","Petal.Width: 0.1<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.3<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.3<br />Petal.Length: 1.3<br />Species: setosa","Petal.Width: 0.3<br />Petal.Length: 1.3<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.3<br />Species: setosa","Petal.Width: 0.6<br />Petal.Length: 1.6<br />Species: setosa","Petal.Width: 0.4<br />Petal.Length: 1.9<br />Species: setosa","Petal.Width: 0.3<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.6<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.5<br />Species: setosa","Petal.Width: 0.2<br />Petal.Length: 1.4<br />Species: setosa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"setosa","legendgroup":"setosa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.4,1.5,1.5,1.3,1.5,1.3,1.6,1,1.3,1.4,1,1.5,1,1.4,1.3,1.4,1.5,1,1.5,1.1,1.8,1.3,1.5,1.2,1.3,1.4,1.4,1.7,1.5,1,1.1,1,1.2,1.6,1.5,1.6,1.5,1.3,1.3,1.3,1.2,1.4,1.2,1,1.3,1.2,1.3,1.3,1.1,1.3],"y":[4.7,4.5,4.9,4,4.6,4.5,4.7,3.3,4.6,3.9,3.5,4.2,4,4.7,3.6,4.4,4.5,4.1,4.5,3.9,4.8,4,4.9,4.7,4.3,4.4,4.8,5,4.5,3.5,3.8,3.7,3.9,5.1,4.5,4.5,4.7,4.4,4.1,4,4.4,4.6,4,3.3,4.2,4.2,4.2,4.3,3,4.1],"text":["Petal.Width: 1.4<br />Petal.Length: 4.7<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.5<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.9<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.0<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.6<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.5<br />Species: versicolor","Petal.Width: 1.6<br />Petal.Length: 4.7<br />Species: versicolor","Petal.Width: 1.0<br />Petal.Length: 3.3<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.6<br />Species: versicolor","Petal.Width: 1.4<br />Petal.Length: 3.9<br />Species: versicolor","Petal.Width: 1.0<br />Petal.Length: 3.5<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.2<br />Species: versicolor","Petal.Width: 1.0<br />Petal.Length: 4.0<br />Species: versicolor","Petal.Width: 1.4<br />Petal.Length: 4.7<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 3.6<br />Species: versicolor","Petal.Width: 1.4<br />Petal.Length: 4.4<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.5<br />Species: versicolor","Petal.Width: 1.0<br />Petal.Length: 4.1<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.5<br />Species: versicolor","Petal.Width: 1.1<br />Petal.Length: 3.9<br />Species: versicolor","Petal.Width: 1.8<br />Petal.Length: 4.8<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.0<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.9<br />Species: versicolor","Petal.Width: 1.2<br />Petal.Length: 4.7<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.3<br />Species: versicolor","Petal.Width: 1.4<br />Petal.Length: 4.4<br />Species: versicolor","Petal.Width: 1.4<br />Petal.Length: 4.8<br />Species: versicolor","Petal.Width: 1.7<br />Petal.Length: 5.0<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.5<br />Species: versicolor","Petal.Width: 1.0<br />Petal.Length: 3.5<br />Species: versicolor","Petal.Width: 1.1<br />Petal.Length: 3.8<br />Species: versicolor","Petal.Width: 1.0<br />Petal.Length: 3.7<br />Species: versicolor","Petal.Width: 1.2<br />Petal.Length: 3.9<br />Species: versicolor","Petal.Width: 1.6<br />Petal.Length: 5.1<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.5<br />Species: versicolor","Petal.Width: 1.6<br />Petal.Length: 4.5<br />Species: versicolor","Petal.Width: 1.5<br />Petal.Length: 4.7<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.4<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.1<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.0<br />Species: versicolor","Petal.Width: 1.2<br />Petal.Length: 4.4<br />Species: versicolor","Petal.Width: 1.4<br />Petal.Length: 4.6<br />Species: versicolor","Petal.Width: 1.2<br />Petal.Length: 4.0<br />Species: versicolor","Petal.Width: 1.0<br />Petal.Length: 3.3<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.2<br />Species: versicolor","Petal.Width: 1.2<br />Petal.Length: 4.2<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.2<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.3<br />Species: versicolor","Petal.Width: 1.1<br />Petal.Length: 3.0<br />Species: versicolor","Petal.Width: 1.3<br />Petal.Length: 4.1<br />Species: versicolor"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"versicolor","legendgroup":"versicolor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.5,1.9,2.1,1.8,2.2,2.1,1.7,1.8,1.8,2.5,2,1.9,2.1,2,2.4,2.3,1.8,2.2,2.3,1.5,2.3,2,2,1.8,2.1,1.8,1.8,1.8,2.1,1.6,1.9,2,2.2,1.5,1.4,2.3,2.4,1.8,1.8,2.1,2.4,2.3,1.9,2.3,2.5,2.3,1.9,2,2.3,1.8],"y":[6,5.1,5.9,5.6,5.8,6.6,4.5,6.3,5.8,6.1,5.1,5.3,5.5,5,5.1,5.3,5.5,6.7,6.9,5,5.7,4.9,6.7,4.9,5.7,6,4.8,4.9,5.6,5.8,6.1,6.4,5.6,5.1,5.6,6.1,5.6,5.5,4.8,5.4,5.6,5.1,5.1,5.9,5.7,5.2,5,5.2,5.4,5.1],"text":["Petal.Width: 2.5<br />Petal.Length: 6.0<br />Species: virginica","Petal.Width: 1.9<br />Petal.Length: 5.1<br />Species: virginica","Petal.Width: 2.1<br />Petal.Length: 5.9<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 5.6<br />Species: virginica","Petal.Width: 2.2<br />Petal.Length: 5.8<br />Species: virginica","Petal.Width: 2.1<br />Petal.Length: 6.6<br />Species: virginica","Petal.Width: 1.7<br />Petal.Length: 4.5<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 6.3<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 5.8<br />Species: virginica","Petal.Width: 2.5<br />Petal.Length: 6.1<br />Species: virginica","Petal.Width: 2.0<br />Petal.Length: 5.1<br />Species: virginica","Petal.Width: 1.9<br />Petal.Length: 5.3<br />Species: virginica","Petal.Width: 2.1<br />Petal.Length: 5.5<br />Species: virginica","Petal.Width: 2.0<br />Petal.Length: 5.0<br />Species: virginica","Petal.Width: 2.4<br />Petal.Length: 5.1<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 5.3<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 5.5<br />Species: virginica","Petal.Width: 2.2<br />Petal.Length: 6.7<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 6.9<br />Species: virginica","Petal.Width: 1.5<br />Petal.Length: 5.0<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 5.7<br />Species: virginica","Petal.Width: 2.0<br />Petal.Length: 4.9<br />Species: virginica","Petal.Width: 2.0<br />Petal.Length: 6.7<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 4.9<br />Species: virginica","Petal.Width: 2.1<br />Petal.Length: 5.7<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 6.0<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 4.8<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 4.9<br />Species: virginica","Petal.Width: 2.1<br />Petal.Length: 5.6<br />Species: virginica","Petal.Width: 1.6<br />Petal.Length: 5.8<br />Species: virginica","Petal.Width: 1.9<br />Petal.Length: 6.1<br />Species: virginica","Petal.Width: 2.0<br />Petal.Length: 6.4<br />Species: virginica","Petal.Width: 2.2<br />Petal.Length: 5.6<br />Species: virginica","Petal.Width: 1.5<br />Petal.Length: 5.1<br />Species: virginica","Petal.Width: 1.4<br />Petal.Length: 5.6<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 6.1<br />Species: virginica","Petal.Width: 2.4<br />Petal.Length: 5.6<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 5.5<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 4.8<br />Species: virginica","Petal.Width: 2.1<br />Petal.Length: 5.4<br />Species: virginica","Petal.Width: 2.4<br />Petal.Length: 5.6<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 5.1<br />Species: virginica","Petal.Width: 1.9<br />Petal.Length: 5.1<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 5.9<br />Species: virginica","Petal.Width: 2.5<br />Petal.Length: 5.7<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 5.2<br />Species: virginica","Petal.Width: 1.9<br />Petal.Length: 5.0<br />Species: virginica","Petal.Width: 2.0<br />Petal.Length: 5.2<br />Species: virginica","Petal.Width: 2.3<br />Petal.Length: 5.4<br />Species: virginica","Petal.Width: 1.8<br />Petal.Length: 5.1<br />Species: virginica"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"virginica","legendgroup":"virginica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":31.4155251141553},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.02,2.62],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5","2.0","2.5"],"tickvals":[0,0.5,1,1.5,2,2.5],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5","2.0","2.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Petal.Width","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.705,7.195],"tickmode":"array","ticktext":["2","4","6"],"tickvals":[2,4,6],"categoryorder":"array","categoryarray":["2","4","6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Petal.Length","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Species","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"2de42ed3517":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"2de42ed3517","visdat":{"2de42ed3517":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="leaflet" class="section level3 hasAnchor" number="97.4.3">
<h3 class="hasAnchor"><span class="header-section-number">97.4.3</span> Leaflet<a href="#leaflet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Leaflet</strong> is a great resource for creating interactive maps with minimal amount of coding.</p>
<p>For more information visit: <a href="https://rstudio.github.io/leaflet/" class="uri">https://rstudio.github.io/leaflet/</a></p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-3"><a href="#cb566-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;quakes&quot;</span>)</span>
<span id="cb566-4"><a href="#cb566-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-5"><a href="#cb566-5" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(</span>
<span id="cb566-6"><a href="#cb566-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> quakes,</span>
<span id="cb566-7"><a href="#cb566-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">leafletOptions</span>(</span>
<span id="cb566-8"><a href="#cb566-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">minZoom =</span> <span class="dv">4</span>,</span>
<span id="cb566-9"><a href="#cb566-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxZoom =</span> <span class="dv">18</span></span>
<span id="cb566-10"><a href="#cb566-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb566-11"><a href="#cb566-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb566-12"><a href="#cb566-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb566-13"><a href="#cb566-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="sc">~</span>long, <span class="sc">~</span>lat,</span>
<span id="cb566-14"><a href="#cb566-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.75</span>,</span>
<span id="cb566-15"><a href="#cb566-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke =</span> <span class="cn">FALSE</span>,</span>
<span id="cb566-16"><a href="#cb566-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="fu">paste</span>(</span>
<span id="cb566-17"><a href="#cb566-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Sample ID:&quot;</span>, quakes<span class="sc">$</span>unique_id, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb566-18"><a href="#cb566-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Magnitude:&quot;</span>, quakes<span class="sc">$</span>mag, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb566-19"><a href="#cb566-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Latitude:&quot;</span>, quakes<span class="sc">$</span>lat, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb566-20"><a href="#cb566-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Longitude:&quot;</span>, quakes<span class="sc">$</span>long</span>
<span id="cb566-21"><a href="#cb566-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb566-22"><a href="#cb566-22" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2ca96382dfca19eb2114" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2ca96382dfca19eb2114">{"x":{"options":{"minZoom":4,"maxZoom":18,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[-20.42,-20.62,-26,-17.97,-20.42,-19.68,-11.7,-28.11,-28.74,-17.47,-21.44,-12.26,-18.54,-21,-20.7,-15.94,-13.64,-17.83,-23.5,-22.63,-20.84,-10.98,-23.3,-30.2,-19.66,-17.94,-14.72,-16.46,-20.97,-19.84,-22.58,-16.32,-15.55,-23.55,-16.3,-25.82,-18.73,-17.64,-17.66,-18.82,-37.37,-15.31,-24.97,-15.49,-19.23,-30.1,-26.4,-11.77,-24.12,-18.97,-18.75,-19.26,-22.75,-21.37,-20.1,-19.85,-22.7,-22.06,-17.8,-24.2,-20.69,-21.16,-13.82,-11.49,-20.68,-17.1,-20.14,-21.96,-20.42,-15.46,-15.31,-19.86,-11.55,-23.74,-17.7,-23.54,-19.21,-12.11,-21.81,-28.98,-34.02,-23.84,-19.57,-20.12,-17.7,-19.66,-21.5,-23.64,-15.43,-15.41,-15.48,-13.36,-20.64,-19.72,-15.44,-19.73,-27.24,-18.16,-13.66,-24.57,-16.98,-26.2,-21.88,-33,-21.33,-19.44,-34.89,-20.24,-22.55,-36.95,-15.75,-16.85,-19.06,-26.11,-26.2,-26.13,-13.66,-13.47,-14.6,-18.96,-14.65,-19.9,-22.05,-19.22,-31.24,-17.93,-19.3,-26.53,-27.72,-19.19,-17.43,-17.05,-19.52,-23.71,-21.3,-16.24,-16.14,-23.95,-25.2,-18.84,-12.66,-20.65,-13.23,-29.91,-14.31,-20.1,-17.8,-21.27,-23.58,-17.9,-23.34,-15.56,-23.83,-11.8,-15.54,-20.65,-11.75,-24.81,-20.9,-11.34,-17.98,-24.34,-13.86,-35.56,-35.48,-34.2,-26,-19.89,-23.43,-18.89,-17.82,-25.68,-20.2,-15.2,-15.03,-32.22,-22.64,-17.42,-17.84,-15.02,-18.04,-24.6,-19.88,-20.3,-20.45,-17.67,-22.3,-19.85,-24.27,-15.85,-20.02,-18.56,-17.87,-24.08,-32.2,-20.36,-23.85,-24,-20.41,-17.72,-19.67,-17.7,-16.23,-26.72,-12.95,-21.97,-21.96,-20.32,-30.28,-20.2,-30.66,-16.17,-28.25,-20.47,-23.55,-20.94,-26.67,-18.13,-20.21,-18.31,-16.52,-22.36,-22.43,-20.37,-23.77,-13.65,-21.55,-16.24,-23.73,-22.34,-19.4,-24.64,-16,-19.62,-23.84,-23.54,-28.23,-21.68,-13.44,-24.96,-20.08,-24.36,-14.7,-18.2,-16.65,-18.11,-17.95,-15.5,-23.36,-19.15,-10.97,-14.85,-17.8,-22.5,-29.1,-20.32,-16.09,-19.18,-23.81,-23.79,-19.02,-20.9,-19.06,-17.88,-19.41,-26.17,-14.95,-18.73,-20.21,-21.29,-19.76,-22.09,-23.8,-20.16,-22.13,-17.44,-23.33,-24.78,-22,-19.13,-30.72,-22.32,-16.45,-17.7,-17.95,-24.4,-19.3,-21.13,-18.07,-20.6,-18.48,-13.34,-20.92,-25.31,-15.24,-16.4,-24.57,-17.94,-30.64,-18.64,-13.09,-19.68,-16.44,-21.09,-14.99,-23.3,-17.68,-22,-21.38,-32.62,-13.05,-12.93,-18.6,-21.34,-21.48,-17.4,-17.32,-18.77,-26.16,-12.59,-14.82,-21.79,-19.83,-29.5,-12.49,-26.1,-21.04,-10.78,-20.76,-11.41,-19.1,-23.91,-27.33,-12.25,-23.49,-27.18,-25.8,-27.19,-27.27,-27.1,-27.22,-27.38,-27.27,-27.54,-27.2,-27.71,-27.6,-27.38,-21.54,-27.21,-28.96,-12.01,-17.46,-30.17,-27.27,-17.79,-22.19,-17.1,-27.18,-11.64,-17.98,-16.9,-21.98,-32.14,-18.8,-26.78,-20.43,-18.3,-15.83,-23.44,-23.73,-19.89,-17.59,-19.77,-20.31,-15.33,-18.2,-15.36,-15.29,-15.36,-16.24,-13.47,-25.5,-14.32,-20.04,-28.83,-17.82,-27.23,-10.72,-27,-20.36,-27.17,-20.94,-17.46,-21.04,-23.7,-17.72,-15.87,-17.84,-13.45,-30.8,-11.63,-30.4,-26.18,-15.7,-17.95,-20.51,-15.36,-23.61,-33.2,-17.68,-22.24,-20.07,-25.04,-21.5,-14.28,-14.43,-32.7,-34.1,-19.7,-24.19,-26.6,-17.04,-22.1,-32.6,-33,-20.58,-20.61,-19.47,-17.47,-18.4,-23.33,-18.55,-26.16,-21.8,-27.63,-18.89,-20.3,-20.56,-16.1,-12.66,-21.05,-17.97,-19.83,-22.55,-22.28,-15.72,-20.85,-21.11,-25.31,-26.46,-24.09,-16.96,-23.19,-20.81,-15.03,-18.06,-19,-23.53,-18.18,-15.66,-18,-18.08,-18.05,-29.9,-20.9,-15.61,-16.03,-17.68,-31.94,-19.14,-18,-16.95,-10.79,-20.83,-32.9,-37.93,-29.09,-23.56,-19.6,-21.39,-14.85,-22.7,-32.42,-17.9,-23.58,-34.4,-17.61,-21.07,-13.84,-30.24,-18.49,-23.45,-16.04,-17.14,-22.54,-15.9,-30.04,-24.03,-18.89,-16.51,-20.1,-21.06,-13.07,-23.46,-19.41,-11.81,-11.76,-12.08,-25.59,-26.54,-20.9,-16.99,-23.46,-17.81,-15.17,-11.67,-20.75,-19.5,-26.18,-20.66,-19.22,-24.68,-15.43,-32.45,-21.31,-15.44,-13.26,-15.26,-33.57,-15.77,-15.79,-21,-16.28,-23.28,-16.1,-17.7,-15.96,-15.95,-17.56,-15.9,-15.29,-15.86,-16.2,-15.71,-16.45,-11.54,-19.61,-15.61,-21.16,-20.65,-20.33,-15.08,-23.28,-23.44,-23.12,-23.65,-22.91,-22.06,-13.56,-17.99,-23.92,-30.69,-21.92,-25.04,-19.92,-27.75,-17.71,-19.6,-34.68,-14.46,-18.85,-17.02,-20.41,-18.18,-16.49,-17.74,-20.49,-18.51,-27.28,-15.9,-20.57,-11.25,-20.04,-20.89,-16.62,-20.09,-24.96,-20.95,-23.31,-20.95,-21.58,-13.62,-12.72,-21.79,-20.48,-12.84,-17.02,-23.89,-23.07,-27.98,-28.1,-21.24,-21.24,-19.89,-32.82,-22,-21.57,-24.5,-33.03,-30.09,-22.75,-17.99,-19.6,-15.65,-17.78,-22.04,-20.06,-18.07,-12.85,-33.29,-34.63,-24.18,-23.78,-22.37,-23.97,-34.12,-25.25,-22.87,-18.48,-21.46,-28.56,-28.56,-21.3,-20.08,-18.82,-19.51,-12.05,-17.4,-23.93,-21.23,-16.23,-28.15,-20.81,-20.72,-23.29,-38.46,-15.48,-37.03,-20.48,-18.12,-18.17,-11.4,-23.1,-14.28,-22.87,-17.59,-27.6,-17.94,-17.88,-30.01,-19.19,-18.14,-23.46,-18.44,-18.21,-18.26,-15.85,-23.82,-18.6,-17.8,-10.78,-18.12,-19.34,-15.34,-24.97,-15.97,-23.47,-23.11,-20.54,-18.92,-20.16,-25.48,-18.19,-15.35,-18.69,-18.89,-17.61,-20.93,-17.6,-17.96,-18.8,-20.61,-20.74,-25.23,-23.9,-18.07,-15.43,-14.3,-18.04,-13.9,-17.64,-17.98,-25,-19.45,-16.11,-23.73,-17.74,-21.56,-20.97,-15.45,-15.93,-21.47,-21.44,-22.16,-13.36,-21.22,-26.1,-18.35,-17.2,-22.42,-17.91,-26.53,-26.5,-16.31,-18.76,-17.1,-19.28,-23.5,-21.26,-17.97,-26.02,-30.3,-24.89,-14.57,-15.4,-22.06,-25.14,-20.3,-25.28,-20.63,-19.02,-22.1,-38.59,-19.3,-31.03,-30.51,-22.55,-22.14,-25.6,-18.04,-21.29,-21.08,-20.64,-24.41,-12.16,-17.1,-21.13,-12.34,-16.43,-20.7,-21.18,-17.78,-21.57,-13.7,-12.27,-19.1,-19.85,-11.37,-20.7,-20.24,-16.4,-19.6,-21.63,-21.6,-21.77,-21.8,-21.05,-10.8,-17.9,-22.26,-22.33,-24.04,-20.4,-15,-27.87,-14.12,-23.61,-21.56,-21.19,-18.07,-26,-20.21,-28,-20.74,-31.8,-18.91,-20.45,-22.9,-18.11,-23.8,-23.42,-23.2,-12.93,-21.14,-19.13,-21.08,-20.07,-20.9,-25.04,-21.85,-19.34,-15.83,-23.73,-18.1,-22.12,-15.39,-16.21,-21.75,-22.1,-24.97,-19.36,-22.14,-21.48,-18.54,-21.62,-13.4,-15.5,-15.67,-21.78,-30.63,-15.7,-19.2,-19.7,-19.4,-15.85,-17.38,-24.33,-20.89,-18.97,-17.99,-15.8,-25.42,-21.6,-26.06,-17.56,-25.63,-25.46,-22.23,-21.55,-15.18,-13.79,-15.18,-18.78,-17.9,-18.5,-14.82,-15.65,-30.01,-13.16,-21.03,-21.4,-17.93,-20.87,-12.01,-19.1,-22.85,-17.08,-21.14,-12.23,-20.91,-11.38,-11.02,-22.09,-17.8,-18.94,-18.85,-21.91,-22.03,-18.1,-18.4,-21.2,-12,-11.7,-26.72,-24.39,-19.64,-21.35,-22.82,-38.28,-12.57,-22.24,-13.8,-21.07,-17.74,-23.87,-21.29,-22.2,-15.24,-17.82,-32.14,-19.3,-33.09,-20.18,-17.46,-17.44,-24.71,-21.53,-19.17,-28.05,-23.39,-22.33,-15.28,-20.27,-10.96,-21.52,-19.57,-23.08,-25.06,-17.85,-15.99,-20.56,-17.98,-18.4,-27.64,-20.99,-14.86,-29.33,-25.81,-14.1,-17.63,-23.47,-23.92,-20.88,-20.25,-19.33,-18.14,-22.41,-20.77,-17.95,-20.83,-27.84,-19.94,-23.6,-23.7,-30.39,-18.98,-27.89,-23.5,-23.73,-17.93,-35.94,-18.68,-23.47,-23.49,-23.85,-27.08,-20.88,-20.97,-21.71,-23.9,-15.78,-12.57,-19.69,-22.04,-17.99,-23.5,-21.4,-15.86,-23.95,-25.79,-23.75,-24.1,-18.56,-23.3,-17.03,-20.77,-28.1,-18.83,-23,-20.82,-22.95,-28.22,-27.99,-15.54,-12.37,-22.33,-22.7,-17.86,-16,-20.73,-15.45,-20.05,-17.95,-17.7,-25.93,-12.28,-20.13,-17.4,-21.59],[181.62,181.03,184.1,181.66,181.96,184.31,166.1,181.93,181.74,179.59,180.69,167,182.11,181.66,169.92,184.95,165.96,181.5,179.78,180.31,181.16,166.32,180.16,182,180.28,181.49,167.51,180.79,181.47,182.37,179.24,166.74,185.05,180.8,186,179.33,169.23,181.28,181.4,169.33,176.78,186.1,179.82,186.04,169.41,182.3,181.7,166.32,180.08,185.25,182.35,184.42,173.2,180.67,182.16,182.13,181,180.6,181.35,179.2,181.55,182.4,172.38,166.22,181.41,184.93,181.6,179.62,181.86,187.81,185.8,184.35,166.2,179.99,181.23,180.04,184.7,167.06,181.71,181.11,180.21,180.99,182.38,183.4,181.7,184.31,170.5,179.96,186.3,186.44,167.53,167.06,182.02,169.71,185.26,182.4,181.11,183.41,166.54,179.92,185.61,178.41,180.39,181.6,180.69,183.5,180.6,169.49,185.9,177.81,185.23,182.31,182.45,178.3,178.35,178.31,172.23,172.29,167.4,169.48,166.97,178.9,180.4,182.43,180.6,167.89,183.84,178.57,181.7,183.51,185.43,181.22,168.98,180.3,180.82,168.02,187.32,182.8,182.6,184.16,169.46,181.4,167.1,181.43,173.5,184.4,185.17,173.49,180.17,181.5,184.5,167.62,182.56,165.8,167.68,181.32,166.07,180,169.84,166.24,180.5,179.52,167.16,180.2,179.9,179.43,182.12,183.84,180,169.42,181.83,180.34,180.9,184.68,182.29,180.2,180.64,185.16,181.48,184.24,181.75,183.5,184.3,183,181.85,187.09,181.9,181.85,179.88,185.13,184.09,169.31,182,179.5,179.61,181.19,182.53,182.75,181.74,180.3,182.18,182.2,183.59,183.35,169.09,182.32,180.54,181.69,180.62,182.3,180.13,184.1,181.71,185.68,180.27,181.58,182.4,181.52,183.83,182.39,185.7,171.65,184.48,182.1,180.16,166.66,182.9,185.75,182.53,171.52,180.94,180.81,182.82,185.35,180.13,179.93,182.68,180.63,166.53,180.22,182.74,182.84,166,183.68,185.51,181.67,181.65,186.9,180.01,169.5,166.26,167.24,181.38,170.4,182.1,180.88,184.89,169.33,179.36,179.89,184.23,181.51,169.01,181.47,183.05,184.2,167.24,168.8,182.37,180.85,181.41,180.38,179.9,181.99,180.38,181.4,180.18,179.22,180.52,182.51,180.1,180.54,177.77,185,184.68,179.85,180.6,185.32,181.57,182.28,181.49,166.2,181.5,179.69,186.21,185.86,178.4,181.51,181.2,169.32,169.28,184.14,185.74,181.38,171.39,179.7,181.36,180.53,181.39,181.5,169.58,169.63,181.91,181.41,183.78,181.02,181.03,169.24,179.5,167.1,167.32,183.48,182.04,182.31,166.36,182.3,181.2,165.77,185.77,166.24,183.87,180,182.6,166.6,179.07,182.18,182.1,182.18,182.38,182.18,182.28,181.7,182.5,182.5,182.39,182.47,182.4,182.39,185.48,182.43,182.61,166.29,181.32,182.02,182.36,181.32,171.4,182.68,182.53,166.47,181.58,185.72,179.6,179.9,169.21,183.61,182.37,183.2,182.51,182.93,179.99,184.08,181.09,181.4,184.06,186.75,181.6,186.66,186.42,186.71,167.95,167.14,182.82,167.33,182.01,181.66,181.49,180.98,165.99,183.88,186.16,183.68,181.26,181.9,181.2,179.6,181.42,188.13,181.3,170.3,182.16,166.14,181.4,178.59,184.5,181.5,182.3,167.51,180.23,181.6,186.8,184.56,169.14,180.1,185.2,167.26,167.26,181.7,181.8,186.2,180.38,182.77,186.8,179.71,180.9,182.4,181.24,182.6,169.15,180.96,183.4,180.26,182.23,178.47,183.2,182.93,169.48,182.3,182.04,185.32,166.37,184.68,168.52,182.54,183.81,183.52,185.64,181.59,181.5,180.15,182.5,179.68,167.7,182.8,184.7,167.32,181.59,185.6,179.99,180.63,186.8,180.62,180.7,180.86,181.16,181.9,167.5,185.43,181.11,180.57,184.36,185.48,185.94,166.06,185.9,181.6,177.47,183.2,180.23,185.2,180.68,184.87,183.3,181.21,181.3,183.4,180.5,181.2,181.13,170.62,181.63,169.04,180.23,183.54,185.31,172.91,185.3,181.2,180.22,184.46,187.1,186.3,183.81,166.87,180.09,182.3,165.98,165.96,165.76,180.02,183.63,184.28,187,180.17,181.82,187.2,166.02,184.52,186.9,179.79,185.77,182.54,183.33,167.38,181.15,180.84,167.18,167.01,183.13,180.8,167.01,166.83,183.2,166.94,184.6,167.25,181.31,166.69,167.34,181.59,167.42,166.9,166.85,166.8,166.91,167.54,166.18,181.91,187.15,181.41,182.22,168.71,166.62,184.61,184.6,184.42,184.46,183.95,180.47,166.49,181.57,184.47,182.1,182.8,180.97,183.91,182.26,181.18,183.84,179.82,167.26,187.55,182.41,186.51,182.04,187.8,181.31,181.69,182.64,183.4,167.16,181.33,166.36,181.87,181.25,186.74,168.75,179.87,181.42,179.27,181.06,181.9,167.15,166.28,185,169.76,166.78,182.93,182.39,184.03,181.96,182.25,180.81,180.86,174.46,179.8,185.5,185.62,180.92,180.2,182.4,170.99,168.98,181.87,186.26,181.53,184.91,168.69,181.54,165.67,181.3,179.1,179.02,180.31,171.5,179.91,181.75,179.86,172.65,182.37,181.02,183.47,183.59,180.92,183.22,182.21,183.97,167.39,186.54,180.18,181.09,167.91,183.4,185.01,181.41,184,176.03,186.73,177.52,181.38,181.88,181.98,166.07,180.12,170.34,171.72,180.98,182.1,180.6,180.58,180.8,182.3,180.87,180.11,181.04,180.87,180.98,184.83,180.09,184.28,181.32,166.1,181.71,182.62,167.1,182.85,186.08,180.24,179.15,181.66,169.37,184.27,180.94,181.74,186.4,169.1,181.24,183.32,181.54,181.5,181.4,182.41,182.44,181.53,179.86,179.9,181.58,185.19,167.32,181.57,167.18,177.01,181.51,180,184.48,187.48,179.98,186.78,183.23,181.72,186.73,167.91,185.86,170.45,180.49,172.76,181.51,182.5,185.27,182.9,171.4,181.48,178.3,178.29,168.08,169.71,182.8,182.78,180,181.69,181.48,181.2,180.8,179.67,167.24,186.87,183.95,178.42,181.4,181.17,181.61,186.83,185.3,175.7,183,181.59,181.3,183.34,180.64,180.3,181.84,185.77,180.85,169.66,180.03,167.03,185.9,185.6,167.43,186.73,184.3,180.92,185.33,183.86,166.75,167.41,184.52,184.51,166.55,186.3,185.1,182.73,184.53,180.77,180.5,181,183.6,180.9,165.8,181.5,171.44,171.46,184.85,186.1,184.62,183.4,166.64,180.27,185.5,181.58,181.65,178.43,181.9,182,180.7,180.6,169.46,182.1,183.8,181.63,184.7,180.21,184.8,169.52,181.06,184.97,181.3,181.75,182.02,179.84,180.89,186.59,167.1,183,181.72,180.49,185.1,186.52,180.67,180.4,179.54,186.36,179.62,182.44,168.93,182.4,166.9,185.3,185.23,183.11,180.9,185.1,184.37,182.44,182.29,185.9,168.63,179.97,185.26,169.44,181.62,185.25,182.65,169.9,180.05,181.23,180.26,179.98,180.48,181.39,185.93,166.56,167.23,186.72,181.41,185.4,171.17,185.17,181.15,167.24,180.78,180.78,181.89,181.7,166.66,169.63,181.37,185.96,174.21,167.02,181.57,167.05,167.01,180.58,181.2,182.43,182.2,181.28,179.77,181.63,184.84,181.4,166.2,166.3,182.69,178.98,169.5,170.04,184.52,177.1,167.11,180.28,166.53,183.78,181.25,180.15,185.8,180.58,185.11,181.27,180,185.86,180.94,181.62,181.42,181.33,179.85,170.52,169.53,182.39,179.97,171.51,185.98,181.51,165.97,169.75,184.47,183.45,182.8,181.44,167.95,184.41,181.61,181.77,182.22,181.02,167.32,182.72,182.54,166.01,185.13,180.21,180.21,185.18,184.75,186.16,181.71,183.99,181.16,181.73,181.01,182.1,182.39,183.99,184.13,182.4,182.32,182.92,184.9,184.49,181.62,178.52,184.5,179.95,180.06,180.26,183.44,184.95,181.2,183.58,184.6,167.44,166.72,184.23,183.95,181.59,180.13,180.74,166.98,184.64,182.38,184.5,184.5,169.05,184.68,185.74,183.71,183.5,182.26,170.7,181.67,170.56,183.6,183.5,187.15,166.93,171.66,170.3,181.3,184.53,181.42,181.42,183.86,181.37,188.1,179.54,167.06,184.2,187.8,170.56],10,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.75},null,null,["Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -20.42 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.62 <br/> Longitude: 181.03","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -26 <br/> Longitude: 184.1","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.97 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -20.42 <br/> Longitude: 181.96","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.68 <br/> Longitude: 184.31","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -11.7 <br/> Longitude: 166.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.11 <br/> Longitude: 181.93","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -28.74 <br/> Longitude: 181.74","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.47 <br/> Longitude: 179.59","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.44 <br/> Longitude: 180.69","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -12.26 <br/> Longitude: 167","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.54 <br/> Longitude: 182.11","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 6.1 <br/> Latitude: -20.7 <br/> Longitude: 169.92","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.94 <br/> Longitude: 184.95","Sample ID:  <br/> Magnitude: 6 <br/> Latitude: -13.64 <br/> Longitude: 165.96","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.83 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.5 <br/> Longitude: 179.78","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -22.63 <br/> Longitude: 180.31","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.84 <br/> Longitude: 181.16","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -10.98 <br/> Longitude: 166.32","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.3 <br/> Longitude: 180.16","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.2 <br/> Longitude: 182","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -19.66 <br/> Longitude: 180.28","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.94 <br/> Longitude: 181.49","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -14.72 <br/> Longitude: 167.51","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -16.46 <br/> Longitude: 180.79","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.97 <br/> Longitude: 181.47","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.84 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.58 <br/> Longitude: 179.24","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.32 <br/> Longitude: 166.74","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.55 <br/> Longitude: 185.05","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -23.55 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.3 <br/> Longitude: 186","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -25.82 <br/> Longitude: 179.33","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.73 <br/> Longitude: 169.23","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.64 <br/> Longitude: 181.28","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.66 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.82 <br/> Longitude: 169.33","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -37.37 <br/> Longitude: 176.78","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.31 <br/> Longitude: 186.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -24.97 <br/> Longitude: 179.82","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.49 <br/> Longitude: 186.04","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.23 <br/> Longitude: 169.41","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -30.1 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.4 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -11.77 <br/> Longitude: 166.32","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.12 <br/> Longitude: 180.08","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -18.97 <br/> Longitude: 185.25","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.75 <br/> Longitude: 182.35","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.26 <br/> Longitude: 184.42","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.75 <br/> Longitude: 173.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.37 <br/> Longitude: 180.67","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.1 <br/> Longitude: 182.16","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.85 <br/> Longitude: 182.13","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.7 <br/> Longitude: 181","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -22.06 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.8 <br/> Longitude: 181.35","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.2 <br/> Longitude: 179.2","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.69 <br/> Longitude: 181.55","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -21.16 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -13.82 <br/> Longitude: 172.38","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.49 <br/> Longitude: 166.22","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.68 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.1 <br/> Longitude: 184.93","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.14 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.96 <br/> Longitude: 179.62","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.42 <br/> Longitude: 181.86","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.46 <br/> Longitude: 187.81","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -15.31 <br/> Longitude: 185.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.86 <br/> Longitude: 184.35","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -11.55 <br/> Longitude: 166.2","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -23.74 <br/> Longitude: 179.99","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.7 <br/> Longitude: 181.23","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.54 <br/> Longitude: 180.04","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.21 <br/> Longitude: 184.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.11 <br/> Longitude: 167.06","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.81 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -28.98 <br/> Longitude: 181.11","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -34.02 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.84 <br/> Longitude: 180.99","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.57 <br/> Longitude: 182.38","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.12 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.7 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.66 <br/> Longitude: 184.31","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.5 <br/> Longitude: 170.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.64 <br/> Longitude: 179.96","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.43 <br/> Longitude: 186.3","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.41 <br/> Longitude: 186.44","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15.48 <br/> Longitude: 167.53","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.36 <br/> Longitude: 167.06","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -20.64 <br/> Longitude: 182.02","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.72 <br/> Longitude: 169.71","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.44 <br/> Longitude: 185.26","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.73 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.24 <br/> Longitude: 181.11","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.16 <br/> Longitude: 183.41","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -13.66 <br/> Longitude: 166.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.57 <br/> Longitude: 179.92","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -16.98 <br/> Longitude: 185.61","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -26.2 <br/> Longitude: 178.41","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.88 <br/> Longitude: 180.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -33 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.33 <br/> Longitude: 180.69","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.44 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -34.89 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.24 <br/> Longitude: 169.49","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -22.55 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -36.95 <br/> Longitude: 177.81","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.75 <br/> Longitude: 185.23","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -16.85 <br/> Longitude: 182.31","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.06 <br/> Longitude: 182.45","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -26.11 <br/> Longitude: 178.3","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -26.2 <br/> Longitude: 178.35","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.13 <br/> Longitude: 178.31","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -13.66 <br/> Longitude: 172.23","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.47 <br/> Longitude: 172.29","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.6 <br/> Longitude: 167.4","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.96 <br/> Longitude: 169.48","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.65 <br/> Longitude: 166.97","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.9 <br/> Longitude: 178.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.05 <br/> Longitude: 180.4","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.22 <br/> Longitude: 182.43","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -31.24 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.93 <br/> Longitude: 167.89","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.3 <br/> Longitude: 183.84","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -26.53 <br/> Longitude: 178.57","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.72 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.19 <br/> Longitude: 183.51","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.43 <br/> Longitude: 185.43","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.05 <br/> Longitude: 181.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.52 <br/> Longitude: 168.98","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.71 <br/> Longitude: 180.3","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.3 <br/> Longitude: 180.82","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.24 <br/> Longitude: 168.02","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -16.14 <br/> Longitude: 187.32","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.95 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -25.2 <br/> Longitude: 182.6","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.84 <br/> Longitude: 184.16","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -12.66 <br/> Longitude: 169.46","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -20.65 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -13.23 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -29.91 <br/> Longitude: 181.43","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -14.31 <br/> Longitude: 173.5","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.1 <br/> Longitude: 184.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.8 <br/> Longitude: 185.17","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.27 <br/> Longitude: 173.49","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -23.58 <br/> Longitude: 180.17","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.9 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -23.34 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 6.4 <br/> Latitude: -15.56 <br/> Longitude: 167.62","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.83 <br/> Longitude: 182.56","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -11.8 <br/> Longitude: 165.8","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.54 <br/> Longitude: 167.68","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.65 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -11.75 <br/> Longitude: 166.07","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.81 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.9 <br/> Longitude: 169.84","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.34 <br/> Longitude: 166.24","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.98 <br/> Longitude: 180.5","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.34 <br/> Longitude: 179.52","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -13.86 <br/> Longitude: 167.16","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -35.56 <br/> Longitude: 180.2","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -35.48 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -34.2 <br/> Longitude: 179.43","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -26 <br/> Longitude: 182.12","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -19.89 <br/> Longitude: 183.84","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.43 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.89 <br/> Longitude: 169.42","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.82 <br/> Longitude: 181.83","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.68 <br/> Longitude: 180.34","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.2 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.2 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.03 <br/> Longitude: 182.29","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -32.22 <br/> Longitude: 180.2","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.64 <br/> Longitude: 180.64","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.42 <br/> Longitude: 185.16","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.84 <br/> Longitude: 181.48","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.02 <br/> Longitude: 184.24","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.04 <br/> Longitude: 181.75","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.6 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.88 <br/> Longitude: 184.3","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.3 <br/> Longitude: 183","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.45 <br/> Longitude: 181.85","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -17.67 <br/> Longitude: 187.09","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -22.3 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -19.85 <br/> Longitude: 181.85","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -24.27 <br/> Longitude: 179.88","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.85 <br/> Longitude: 185.13","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -20.02 <br/> Longitude: 184.09","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -18.56 <br/> Longitude: 169.31","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.87 <br/> Longitude: 182","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -24.08 <br/> Longitude: 179.5","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -32.2 <br/> Longitude: 179.61","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.36 <br/> Longitude: 181.19","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.85 <br/> Longitude: 182.53","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -24 <br/> Longitude: 182.75","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.41 <br/> Longitude: 181.74","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.72 <br/> Longitude: 180.3","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.67 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.7 <br/> Longitude: 182.2","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.23 <br/> Longitude: 183.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.72 <br/> Longitude: 183.35","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.95 <br/> Longitude: 169.09","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.97 <br/> Longitude: 182.32","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.96 <br/> Longitude: 180.54","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.32 <br/> Longitude: 181.69","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.28 <br/> Longitude: 180.62","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.2 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.66 <br/> Longitude: 180.13","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -16.17 <br/> Longitude: 184.1","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -28.25 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -20.47 <br/> Longitude: 185.68","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.55 <br/> Longitude: 180.27","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.94 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.67 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.13 <br/> Longitude: 181.52","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.21 <br/> Longitude: 183.83","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.31 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.52 <br/> Longitude: 185.7","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.36 <br/> Longitude: 171.65","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.43 <br/> Longitude: 184.48","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.37 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.77 <br/> Longitude: 180.16","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -13.65 <br/> Longitude: 166.66","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.55 <br/> Longitude: 182.9","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.24 <br/> Longitude: 185.75","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.73 <br/> Longitude: 182.53","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.34 <br/> Longitude: 171.52","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.4 <br/> Longitude: 180.94","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.64 <br/> Longitude: 180.81","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -16 <br/> Longitude: 182.82","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -19.62 <br/> Longitude: 185.35","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.84 <br/> Longitude: 180.13","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -23.54 <br/> Longitude: 179.93","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.23 <br/> Longitude: 182.68","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.68 <br/> Longitude: 180.63","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.44 <br/> Longitude: 166.53","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.96 <br/> Longitude: 180.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.08 <br/> Longitude: 182.74","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -24.36 <br/> Longitude: 182.84","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -14.7 <br/> Longitude: 166","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.2 <br/> Longitude: 183.68","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -16.65 <br/> Longitude: 185.51","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.11 <br/> Longitude: 181.67","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.95 <br/> Longitude: 181.65","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.5 <br/> Longitude: 186.9","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -23.36 <br/> Longitude: 180.01","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.15 <br/> Longitude: 169.5","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -10.97 <br/> Longitude: 166.26","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -14.85 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.8 <br/> Longitude: 181.38","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.5 <br/> Longitude: 170.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -29.1 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.32 <br/> Longitude: 180.88","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.09 <br/> Longitude: 184.89","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.18 <br/> Longitude: 169.33","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.81 <br/> Longitude: 179.36","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -23.79 <br/> Longitude: 179.89","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -19.02 <br/> Longitude: 184.23","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.9 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.06 <br/> Longitude: 169.01","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.88 <br/> Longitude: 181.47","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.41 <br/> Longitude: 183.05","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -26.17 <br/> Longitude: 184.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -14.95 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.73 <br/> Longitude: 168.8","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.21 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.29 <br/> Longitude: 180.85","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.76 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.09 <br/> Longitude: 180.38","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -23.8 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.16 <br/> Longitude: 181.99","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -22.13 <br/> Longitude: 180.38","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.44 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.33 <br/> Longitude: 180.18","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.78 <br/> Longitude: 179.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22 <br/> Longitude: 180.52","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -19.13 <br/> Longitude: 182.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -30.72 <br/> Longitude: 180.1","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -22.32 <br/> Longitude: 180.54","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.45 <br/> Longitude: 177.77","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.7 <br/> Longitude: 185","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.95 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.4 <br/> Longitude: 179.85","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.3 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.13 <br/> Longitude: 185.32","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.07 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.6 <br/> Longitude: 182.28","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.48 <br/> Longitude: 181.49","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -13.34 <br/> Longitude: 166.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.92 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.31 <br/> Longitude: 179.69","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -15.24 <br/> Longitude: 186.21","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -16.4 <br/> Longitude: 185.86","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -24.57 <br/> Longitude: 178.4","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.94 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -30.64 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.64 <br/> Longitude: 169.32","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.09 <br/> Longitude: 169.28","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -19.68 <br/> Longitude: 184.14","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.44 <br/> Longitude: 185.74","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.09 <br/> Longitude: 181.38","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -14.99 <br/> Longitude: 171.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.3 <br/> Longitude: 179.7","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.68 <br/> Longitude: 181.36","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22 <br/> Longitude: 180.53","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.38 <br/> Longitude: 181.39","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -32.62 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -13.05 <br/> Longitude: 169.58","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -12.93 <br/> Longitude: 169.63","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -18.6 <br/> Longitude: 181.91","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.34 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.48 <br/> Longitude: 183.78","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.4 <br/> Longitude: 181.02","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.32 <br/> Longitude: 181.03","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -18.77 <br/> Longitude: 169.24","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.16 <br/> Longitude: 179.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.59 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.82 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.79 <br/> Longitude: 183.48","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.83 <br/> Longitude: 182.04","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -29.5 <br/> Longitude: 182.31","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.49 <br/> Longitude: 166.36","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -26.1 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.04 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -10.78 <br/> Longitude: 165.77","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.76 <br/> Longitude: 185.77","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -11.41 <br/> Longitude: 166.24","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -19.1 <br/> Longitude: 183.87","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.91 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -27.33 <br/> Longitude: 182.6","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -12.25 <br/> Longitude: 166.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.49 <br/> Longitude: 179.07","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.18 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25.8 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -27.19 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.27 <br/> Longitude: 182.38","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.1 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -27.22 <br/> Longitude: 182.28","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.38 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.27 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.54 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.2 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.71 <br/> Longitude: 182.47","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.6 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.38 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.54 <br/> Longitude: 185.48","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.21 <br/> Longitude: 182.43","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -28.96 <br/> Longitude: 182.61","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.01 <br/> Longitude: 166.29","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.46 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -30.17 <br/> Longitude: 182.02","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.27 <br/> Longitude: 182.36","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -17.79 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.19 <br/> Longitude: 171.4","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -17.1 <br/> Longitude: 182.68","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.18 <br/> Longitude: 182.53","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -11.64 <br/> Longitude: 166.47","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.98 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -16.9 <br/> Longitude: 185.72","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -21.98 <br/> Longitude: 179.6","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -32.14 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.8 <br/> Longitude: 169.21","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -26.78 <br/> Longitude: 183.61","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.43 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.3 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.83 <br/> Longitude: 182.51","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -23.44 <br/> Longitude: 182.93","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.73 <br/> Longitude: 179.99","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -19.89 <br/> Longitude: 184.08","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.59 <br/> Longitude: 181.09","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -19.77 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.31 <br/> Longitude: 184.06","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -15.33 <br/> Longitude: 186.75","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.2 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15.36 <br/> Longitude: 186.66","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.29 <br/> Longitude: 186.42","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.36 <br/> Longitude: 186.71","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -16.24 <br/> Longitude: 167.95","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.47 <br/> Longitude: 167.14","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -25.5 <br/> Longitude: 182.82","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -14.32 <br/> Longitude: 167.33","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.04 <br/> Longitude: 182.01","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -28.83 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.82 <br/> Longitude: 181.49","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.23 <br/> Longitude: 180.98","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -10.72 <br/> Longitude: 165.99","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -27 <br/> Longitude: 183.88","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.36 <br/> Longitude: 186.16","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.17 <br/> Longitude: 183.68","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.94 <br/> Longitude: 181.26","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.46 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.04 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.7 <br/> Longitude: 179.6","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -17.72 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -15.87 <br/> Longitude: 188.13","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -17.84 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -13.45 <br/> Longitude: 170.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.8 <br/> Longitude: 182.16","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.63 <br/> Longitude: 166.14","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -30.4 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -26.18 <br/> Longitude: 178.59","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.7 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.95 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.51 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.36 <br/> Longitude: 167.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.61 <br/> Longitude: 180.23","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -33.2 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.68 <br/> Longitude: 186.8","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.24 <br/> Longitude: 184.56","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -20.07 <br/> Longitude: 169.14","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -25.04 <br/> Longitude: 180.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.5 <br/> Longitude: 185.2","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -14.28 <br/> Longitude: 167.26","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -14.43 <br/> Longitude: 167.26","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -32.7 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -34.1 <br/> Longitude: 181.8","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -19.7 <br/> Longitude: 186.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.19 <br/> Longitude: 180.38","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.6 <br/> Longitude: 182.77","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.04 <br/> Longitude: 186.8","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.1 <br/> Longitude: 179.71","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -32.6 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -33 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.58 <br/> Longitude: 181.24","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.61 <br/> Longitude: 182.6","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.47 <br/> Longitude: 169.15","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.47 <br/> Longitude: 180.96","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.4 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.33 <br/> Longitude: 180.26","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -18.55 <br/> Longitude: 182.23","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -26.16 <br/> Longitude: 178.47","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.8 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.63 <br/> Longitude: 182.93","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.89 <br/> Longitude: 169.48","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.3 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.56 <br/> Longitude: 182.04","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.1 <br/> Longitude: 185.32","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -12.66 <br/> Longitude: 166.37","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.05 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -17.97 <br/> Longitude: 168.52","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.83 <br/> Longitude: 182.54","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.55 <br/> Longitude: 183.81","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.28 <br/> Longitude: 183.52","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.72 <br/> Longitude: 185.64","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.85 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -21.11 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25.31 <br/> Longitude: 180.15","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -26.46 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.09 <br/> Longitude: 179.68","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.96 <br/> Longitude: 167.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.19 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.81 <br/> Longitude: 184.7","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.03 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.06 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19 <br/> Longitude: 185.6","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -23.53 <br/> Longitude: 179.99","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.18 <br/> Longitude: 180.63","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.66 <br/> Longitude: 186.8","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18 <br/> Longitude: 180.62","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.08 <br/> Longitude: 180.7","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.05 <br/> Longitude: 180.86","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -29.9 <br/> Longitude: 181.16","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.9 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.61 <br/> Longitude: 167.5","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -16.03 <br/> Longitude: 185.43","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.68 <br/> Longitude: 181.11","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -31.94 <br/> Longitude: 180.57","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.14 <br/> Longitude: 184.36","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18 <br/> Longitude: 185.48","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -16.95 <br/> Longitude: 185.94","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -10.79 <br/> Longitude: 166.06","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.83 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -32.9 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -37.93 <br/> Longitude: 177.47","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -29.09 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.56 <br/> Longitude: 180.23","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.6 <br/> Longitude: 185.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.39 <br/> Longitude: 180.68","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -14.85 <br/> Longitude: 184.87","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -22.7 <br/> Longitude: 183.3","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -32.42 <br/> Longitude: 181.21","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.9 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -23.58 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -34.4 <br/> Longitude: 180.5","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.61 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.07 <br/> Longitude: 181.13","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -13.84 <br/> Longitude: 170.62","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -30.24 <br/> Longitude: 181.63","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.49 <br/> Longitude: 169.04","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.45 <br/> Longitude: 180.23","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -16.04 <br/> Longitude: 183.54","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.14 <br/> Longitude: 185.31","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -22.54 <br/> Longitude: 172.91","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.9 <br/> Longitude: 185.3","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -30.04 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -24.03 <br/> Longitude: 180.22","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.89 <br/> Longitude: 184.46","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -16.51 <br/> Longitude: 187.1","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.1 <br/> Longitude: 186.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.06 <br/> Longitude: 183.81","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.07 <br/> Longitude: 166.87","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.46 <br/> Longitude: 180.09","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.41 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -11.81 <br/> Longitude: 165.98","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -11.76 <br/> Longitude: 165.96","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.08 <br/> Longitude: 165.76","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -25.59 <br/> Longitude: 180.02","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -26.54 <br/> Longitude: 183.63","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -20.9 <br/> Longitude: 184.28","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.99 <br/> Longitude: 187","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.46 <br/> Longitude: 180.17","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.81 <br/> Longitude: 181.82","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.17 <br/> Longitude: 187.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.67 <br/> Longitude: 166.02","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.75 <br/> Longitude: 184.52","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.5 <br/> Longitude: 186.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -26.18 <br/> Longitude: 179.79","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.66 <br/> Longitude: 185.77","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.22 <br/> Longitude: 182.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.68 <br/> Longitude: 183.33","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.43 <br/> Longitude: 167.38","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -32.45 <br/> Longitude: 181.15","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.31 <br/> Longitude: 180.84","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.44 <br/> Longitude: 167.18","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -13.26 <br/> Longitude: 167.01","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.26 <br/> Longitude: 183.13","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -33.57 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.77 <br/> Longitude: 167.01","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.79 <br/> Longitude: 166.83","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.28 <br/> Longitude: 166.94","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.28 <br/> Longitude: 184.6","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.1 <br/> Longitude: 167.25","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.7 <br/> Longitude: 181.31","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.96 <br/> Longitude: 166.69","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -15.95 <br/> Longitude: 167.34","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.56 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.9 <br/> Longitude: 167.42","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.29 <br/> Longitude: 166.9","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.86 <br/> Longitude: 166.85","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.2 <br/> Longitude: 166.8","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.71 <br/> Longitude: 166.91","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.45 <br/> Longitude: 167.54","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -11.54 <br/> Longitude: 166.18","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.61 <br/> Longitude: 181.91","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -15.61 <br/> Longitude: 187.15","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.16 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.65 <br/> Longitude: 182.22","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -20.33 <br/> Longitude: 168.71","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.08 <br/> Longitude: 166.62","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.28 <br/> Longitude: 184.61","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.44 <br/> Longitude: 184.6","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.12 <br/> Longitude: 184.42","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.65 <br/> Longitude: 184.46","Sample ID:  <br/> Magnitude: 5.9 <br/> Latitude: -22.91 <br/> Longitude: 183.95","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.06 <br/> Longitude: 180.47","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -13.56 <br/> Longitude: 166.49","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -17.99 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.92 <br/> Longitude: 184.47","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -30.69 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -21.92 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -25.04 <br/> Longitude: 180.97","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.92 <br/> Longitude: 183.91","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.75 <br/> Longitude: 182.26","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.71 <br/> Longitude: 181.18","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.6 <br/> Longitude: 183.84","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -34.68 <br/> Longitude: 179.82","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -14.46 <br/> Longitude: 167.26","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.85 <br/> Longitude: 187.55","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.02 <br/> Longitude: 182.41","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.41 <br/> Longitude: 186.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.18 <br/> Longitude: 182.04","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.49 <br/> Longitude: 187.8","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.74 <br/> Longitude: 181.31","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.49 <br/> Longitude: 181.69","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.51 <br/> Longitude: 182.64","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -27.28 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.9 <br/> Longitude: 167.16","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.57 <br/> Longitude: 181.33","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -11.25 <br/> Longitude: 166.36","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.04 <br/> Longitude: 181.87","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.89 <br/> Longitude: 181.25","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -16.62 <br/> Longitude: 186.74","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.09 <br/> Longitude: 168.75","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -24.96 <br/> Longitude: 179.87","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.95 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.31 <br/> Longitude: 179.27","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.95 <br/> Longitude: 181.06","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.58 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.62 <br/> Longitude: 167.15","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -12.72 <br/> Longitude: 166.28","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -21.79 <br/> Longitude: 185","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.48 <br/> Longitude: 169.76","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.84 <br/> Longitude: 166.78","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.02 <br/> Longitude: 182.93","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.89 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.07 <br/> Longitude: 184.03","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -27.98 <br/> Longitude: 181.96","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -28.1 <br/> Longitude: 182.25","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.24 <br/> Longitude: 180.81","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.24 <br/> Longitude: 180.86","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -19.89 <br/> Longitude: 174.46","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -32.82 <br/> Longitude: 179.8","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -22 <br/> Longitude: 185.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.57 <br/> Longitude: 185.62","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.5 <br/> Longitude: 180.92","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -33.03 <br/> Longitude: 180.2","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -30.09 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.75 <br/> Longitude: 170.99","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.99 <br/> Longitude: 168.98","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.6 <br/> Longitude: 181.87","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15.65 <br/> Longitude: 186.26","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -17.78 <br/> Longitude: 181.53","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.04 <br/> Longitude: 184.91","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.06 <br/> Longitude: 168.69","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.07 <br/> Longitude: 181.54","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -12.85 <br/> Longitude: 165.67","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -33.29 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -34.63 <br/> Longitude: 179.1","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -24.18 <br/> Longitude: 179.02","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.78 <br/> Longitude: 180.31","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.37 <br/> Longitude: 171.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.97 <br/> Longitude: 179.91","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -34.12 <br/> Longitude: 181.75","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -25.25 <br/> Longitude: 179.86","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.87 <br/> Longitude: 172.65","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.48 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.46 <br/> Longitude: 181.02","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -28.56 <br/> Longitude: 183.47","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.56 <br/> Longitude: 183.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.3 <br/> Longitude: 180.92","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.08 <br/> Longitude: 183.22","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -18.82 <br/> Longitude: 182.21","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.51 <br/> Longitude: 183.97","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -12.05 <br/> Longitude: 167.39","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.4 <br/> Longitude: 186.54","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.93 <br/> Longitude: 180.18","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.23 <br/> Longitude: 181.09","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.23 <br/> Longitude: 167.91","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -28.15 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.81 <br/> Longitude: 185.01","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.72 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.29 <br/> Longitude: 184","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -38.46 <br/> Longitude: 176.03","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.48 <br/> Longitude: 186.73","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -37.03 <br/> Longitude: 177.52","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.48 <br/> Longitude: 181.38","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -18.12 <br/> Longitude: 181.88","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.17 <br/> Longitude: 181.98","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -11.4 <br/> Longitude: 166.07","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.1 <br/> Longitude: 180.12","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -14.28 <br/> Longitude: 170.34","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.87 <br/> Longitude: 171.72","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.59 <br/> Longitude: 180.98","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.6 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.94 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.88 <br/> Longitude: 180.58","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -30.01 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -19.19 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -18.14 <br/> Longitude: 180.87","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.46 <br/> Longitude: 180.11","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.44 <br/> Longitude: 181.04","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.21 <br/> Longitude: 180.87","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.26 <br/> Longitude: 180.98","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.85 <br/> Longitude: 184.83","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.82 <br/> Longitude: 180.09","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.6 <br/> Longitude: 184.28","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.8 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -10.78 <br/> Longitude: 166.1","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.12 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.34 <br/> Longitude: 182.62","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -15.34 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.97 <br/> Longitude: 182.85","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.97 <br/> Longitude: 186.08","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.47 <br/> Longitude: 180.24","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.11 <br/> Longitude: 179.15","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.54 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -18.92 <br/> Longitude: 169.37","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.16 <br/> Longitude: 184.27","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.48 <br/> Longitude: 180.94","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.19 <br/> Longitude: 181.74","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.35 <br/> Longitude: 186.4","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.69 <br/> Longitude: 169.1","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.89 <br/> Longitude: 181.24","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.61 <br/> Longitude: 183.32","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.93 <br/> Longitude: 181.54","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.6 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.96 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.8 <br/> Longitude: 182.41","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.61 <br/> Longitude: 182.44","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.74 <br/> Longitude: 181.53","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -25.23 <br/> Longitude: 179.86","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.9 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.07 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -15.43 <br/> Longitude: 185.19","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.3 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.04 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -13.9 <br/> Longitude: 167.18","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.64 <br/> Longitude: 177.01","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.98 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.45 <br/> Longitude: 184.48","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.11 <br/> Longitude: 187.48","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.73 <br/> Longitude: 179.98","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.74 <br/> Longitude: 186.78","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.56 <br/> Longitude: 183.23","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.97 <br/> Longitude: 181.72","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.45 <br/> Longitude: 186.73","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -15.93 <br/> Longitude: 167.91","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.47 <br/> Longitude: 185.86","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.44 <br/> Longitude: 170.45","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.16 <br/> Longitude: 180.49","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.36 <br/> Longitude: 172.76","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -21.22 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.1 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -18.35 <br/> Longitude: 185.27","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.2 <br/> Longitude: 182.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.42 <br/> Longitude: 171.4","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.91 <br/> Longitude: 181.48","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -26.53 <br/> Longitude: 178.3","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -26.5 <br/> Longitude: 178.29","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.31 <br/> Longitude: 168.08","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.76 <br/> Longitude: 169.71","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.1 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.28 <br/> Longitude: 182.78","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.5 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.26 <br/> Longitude: 181.69","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.97 <br/> Longitude: 181.48","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -26.02 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -30.3 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -24.89 <br/> Longitude: 179.67","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -14.57 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.4 <br/> Longitude: 186.87","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.06 <br/> Longitude: 183.95","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -25.14 <br/> Longitude: 178.42","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.3 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -25.28 <br/> Longitude: 181.17","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.63 <br/> Longitude: 181.61","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -19.02 <br/> Longitude: 186.83","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.1 <br/> Longitude: 185.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -38.59 <br/> Longitude: 175.7","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -19.3 <br/> Longitude: 183","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -31.03 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -30.51 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.55 <br/> Longitude: 183.34","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.14 <br/> Longitude: 180.64","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -25.6 <br/> Longitude: 180.3","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.04 <br/> Longitude: 181.84","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -21.29 <br/> Longitude: 185.77","Sample ID:  <br/> Magnitude: 5.9 <br/> Latitude: -21.08 <br/> Longitude: 180.85","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.64 <br/> Longitude: 169.66","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -24.41 <br/> Longitude: 180.03","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -12.16 <br/> Longitude: 167.03","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -17.1 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -21.13 <br/> Longitude: 185.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -12.34 <br/> Longitude: 167.43","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -16.43 <br/> Longitude: 186.73","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.7 <br/> Longitude: 184.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.18 <br/> Longitude: 180.92","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.78 <br/> Longitude: 185.33","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.57 <br/> Longitude: 183.86","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -13.7 <br/> Longitude: 166.75","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.27 <br/> Longitude: 167.41","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.1 <br/> Longitude: 184.52","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.85 <br/> Longitude: 184.51","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -11.37 <br/> Longitude: 166.55","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -20.7 <br/> Longitude: 186.3","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.24 <br/> Longitude: 185.1","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -16.4 <br/> Longitude: 182.73","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.6 <br/> Longitude: 184.53","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.63 <br/> Longitude: 180.77","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21.6 <br/> Longitude: 180.5","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -21.77 <br/> Longitude: 181","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.8 <br/> Longitude: 183.6","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.05 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -10.8 <br/> Longitude: 165.8","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.9 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.26 <br/> Longitude: 171.44","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.33 <br/> Longitude: 171.46","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -24.04 <br/> Longitude: 184.85","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.4 <br/> Longitude: 186.1","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15 <br/> Longitude: 184.62","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.87 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -14.12 <br/> Longitude: 166.64","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.61 <br/> Longitude: 180.27","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.56 <br/> Longitude: 185.5","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.19 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.07 <br/> Longitude: 181.65","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -26 <br/> Longitude: 178.43","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.21 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -28 <br/> Longitude: 182","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.74 <br/> Longitude: 180.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -31.8 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.91 <br/> Longitude: 169.46","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.45 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -22.9 <br/> Longitude: 183.8","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.11 <br/> Longitude: 181.63","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.8 <br/> Longitude: 184.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.42 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.2 <br/> Longitude: 184.8","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -12.93 <br/> Longitude: 169.52","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.14 <br/> Longitude: 181.06","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.13 <br/> Longitude: 184.97","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.08 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.07 <br/> Longitude: 181.75","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.9 <br/> Longitude: 182.02","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.04 <br/> Longitude: 179.84","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.85 <br/> Longitude: 180.89","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -19.34 <br/> Longitude: 186.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.83 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.73 <br/> Longitude: 183","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.1 <br/> Longitude: 181.72","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -22.12 <br/> Longitude: 180.49","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.39 <br/> Longitude: 185.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -16.21 <br/> Longitude: 186.52","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.75 <br/> Longitude: 180.67","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -22.1 <br/> Longitude: 180.4","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -24.97 <br/> Longitude: 179.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.36 <br/> Longitude: 186.36","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -22.14 <br/> Longitude: 179.62","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.48 <br/> Longitude: 182.44","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.54 <br/> Longitude: 168.93","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21.62 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -13.4 <br/> Longitude: 166.9","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.5 <br/> Longitude: 185.3","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.67 <br/> Longitude: 185.23","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.78 <br/> Longitude: 183.11","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -30.63 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.7 <br/> Longitude: 185.1","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.2 <br/> Longitude: 184.37","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.7 <br/> Longitude: 182.44","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.4 <br/> Longitude: 182.29","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.85 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.38 <br/> Longitude: 168.63","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.33 <br/> Longitude: 179.97","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.89 <br/> Longitude: 185.26","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.97 <br/> Longitude: 169.44","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -17.99 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.8 <br/> Longitude: 185.25","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -25.42 <br/> Longitude: 182.65","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.6 <br/> Longitude: 169.9","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.06 <br/> Longitude: 180.05","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.56 <br/> Longitude: 181.23","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -25.63 <br/> Longitude: 180.26","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25.46 <br/> Longitude: 179.98","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.23 <br/> Longitude: 180.48","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.55 <br/> Longitude: 181.39","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.18 <br/> Longitude: 185.93","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.79 <br/> Longitude: 166.56","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -15.18 <br/> Longitude: 167.23","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.78 <br/> Longitude: 186.72","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.9 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -18.5 <br/> Longitude: 185.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -14.82 <br/> Longitude: 171.17","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.65 <br/> Longitude: 185.17","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -30.01 <br/> Longitude: 181.15","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -13.16 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21.03 <br/> Longitude: 180.78","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.4 <br/> Longitude: 180.78","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.93 <br/> Longitude: 181.89","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.87 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -12.01 <br/> Longitude: 166.66","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -19.1 <br/> Longitude: 169.63","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -22.85 <br/> Longitude: 181.37","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.08 <br/> Longitude: 185.96","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -21.14 <br/> Longitude: 174.21","Sample ID:  <br/> Magnitude: 6 <br/> Latitude: -12.23 <br/> Longitude: 167.02","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.91 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -11.38 <br/> Longitude: 167.05","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -11.02 <br/> Longitude: 167.01","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -22.09 <br/> Longitude: 180.58","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.8 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.94 <br/> Longitude: 182.43","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.85 <br/> Longitude: 182.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.91 <br/> Longitude: 181.28","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.03 <br/> Longitude: 179.77","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.1 <br/> Longitude: 181.63","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.4 <br/> Longitude: 184.84","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.2 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -12 <br/> Longitude: 166.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -11.7 <br/> Longitude: 166.3","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -26.72 <br/> Longitude: 182.69","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -24.39 <br/> Longitude: 178.98","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.64 <br/> Longitude: 169.5","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.35 <br/> Longitude: 170.04","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.82 <br/> Longitude: 184.52","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -38.28 <br/> Longitude: 177.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -12.57 <br/> Longitude: 167.11","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -22.24 <br/> Longitude: 180.28","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -13.8 <br/> Longitude: 166.53","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.07 <br/> Longitude: 183.78","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.74 <br/> Longitude: 181.25","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.87 <br/> Longitude: 180.15","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.29 <br/> Longitude: 185.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.2 <br/> Longitude: 180.58","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -15.24 <br/> Longitude: 185.11","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.82 <br/> Longitude: 181.27","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -32.14 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -19.3 <br/> Longitude: 185.86","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -33.09 <br/> Longitude: 180.94","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.18 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.46 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.44 <br/> Longitude: 181.33","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -24.71 <br/> Longitude: 179.85","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.53 <br/> Longitude: 170.52","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.17 <br/> Longitude: 169.53","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -28.05 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.39 <br/> Longitude: 179.97","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.33 <br/> Longitude: 171.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.28 <br/> Longitude: 185.98","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.27 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -10.96 <br/> Longitude: 165.97","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.52 <br/> Longitude: 169.75","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.57 <br/> Longitude: 184.47","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.08 <br/> Longitude: 183.45","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -25.06 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -17.85 <br/> Longitude: 181.44","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -15.99 <br/> Longitude: 167.95","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.56 <br/> Longitude: 184.41","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.98 <br/> Longitude: 181.61","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.4 <br/> Longitude: 181.77","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -27.64 <br/> Longitude: 182.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.99 <br/> Longitude: 181.02","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -14.86 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -29.33 <br/> Longitude: 182.72","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -25.81 <br/> Longitude: 182.54","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.1 <br/> Longitude: 166.01","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.63 <br/> Longitude: 185.13","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.47 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.92 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.88 <br/> Longitude: 185.18","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -20.25 <br/> Longitude: 184.75","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -19.33 <br/> Longitude: 186.16","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -18.14 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -22.41 <br/> Longitude: 183.99","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.77 <br/> Longitude: 181.16","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.95 <br/> Longitude: 181.73","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.83 <br/> Longitude: 181.01","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.84 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.94 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -23.6 <br/> Longitude: 183.99","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.7 <br/> Longitude: 184.13","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -30.39 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.98 <br/> Longitude: 182.32","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -27.89 <br/> Longitude: 182.92","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.5 <br/> Longitude: 184.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.73 <br/> Longitude: 184.49","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.93 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -35.94 <br/> Longitude: 178.52","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.68 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -23.47 <br/> Longitude: 179.95","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -23.49 <br/> Longitude: 180.06","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.85 <br/> Longitude: 180.26","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.08 <br/> Longitude: 183.44","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.88 <br/> Longitude: 184.95","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.97 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.71 <br/> Longitude: 183.58","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.9 <br/> Longitude: 184.6","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.78 <br/> Longitude: 167.44","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -12.57 <br/> Longitude: 166.72","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.69 <br/> Longitude: 184.23","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -22.04 <br/> Longitude: 183.95","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.99 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.5 <br/> Longitude: 180.13","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.4 <br/> Longitude: 180.74","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.86 <br/> Longitude: 166.98","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -23.95 <br/> Longitude: 184.64","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -25.79 <br/> Longitude: 182.38","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -23.75 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.1 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -18.56 <br/> Longitude: 169.05","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -23.3 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.03 <br/> Longitude: 185.74","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.77 <br/> Longitude: 183.71","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.1 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.83 <br/> Longitude: 182.26","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -23 <br/> Longitude: 170.7","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.82 <br/> Longitude: 181.67","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.95 <br/> Longitude: 170.56","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -28.22 <br/> Longitude: 183.6","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.99 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.54 <br/> Longitude: 187.15","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -12.37 <br/> Longitude: 166.93","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -22.33 <br/> Longitude: 171.66","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.7 <br/> Longitude: 170.3","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.86 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16 <br/> Longitude: 184.53","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.73 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.45 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.05 <br/> Longitude: 183.86","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.95 <br/> Longitude: 181.37","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.7 <br/> Longitude: 188.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -25.93 <br/> Longitude: 179.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -12.28 <br/> Longitude: 167.06","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.13 <br/> Longitude: 184.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.4 <br/> Longitude: 187.8","Sample ID:  <br/> Magnitude: 6 <br/> Latitude: -21.59 <br/> Longitude: 170.56"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-38.59,-10.72],"lng":[165.67,188.13]}},"evals":[],"jsHooks":[]}</script>
<p>Another neat feature is the ability to cluster points to better visualize density. You can do this by setting <code>clusterOptions = markerClusterOptions()</code>.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;quakes&quot;</span>)</span>
<span id="cb567-4"><a href="#cb567-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-5"><a href="#cb567-5" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(<span class="at">data =</span> quakes,</span>
<span id="cb567-6"><a href="#cb567-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">options =</span> <span class="fu">leafletOptions</span>(<span class="at">minZoom =</span> <span class="dv">4</span>,</span>
<span id="cb567-7"><a href="#cb567-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">maxZoom =</span> <span class="dv">18</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb567-8"><a href="#cb567-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb567-9"><a href="#cb567-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="sc">~</span>long, <span class="sc">~</span>lat,</span>
<span id="cb567-10"><a href="#cb567-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillOpacity =</span> <span class="fl">0.75</span>,</span>
<span id="cb567-11"><a href="#cb567-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stroke =</span> <span class="cn">FALSE</span>,</span>
<span id="cb567-12"><a href="#cb567-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">popup =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample ID:&quot;</span>, quakes<span class="sc">$</span>unique_id, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb567-13"><a href="#cb567-13" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Magnitude:&quot;</span>, quakes<span class="sc">$</span>mag, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb567-14"><a href="#cb567-14" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Latitude:&quot;</span>, quakes<span class="sc">$</span>lat, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb567-15"><a href="#cb567-15" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Longitude:&quot;</span>, quakes<span class="sc">$</span>long),</span>
<span id="cb567-16"><a href="#cb567-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">clusterOptions =</span> <span class="fu">markerClusterOptions</span>()</span>
<span id="cb567-17"><a href="#cb567-17" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-af9496129f7b74c9f8e7" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-af9496129f7b74c9f8e7">{"x":{"options":{"minZoom":4,"maxZoom":18,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[-20.42,-20.62,-26,-17.97,-20.42,-19.68,-11.7,-28.11,-28.74,-17.47,-21.44,-12.26,-18.54,-21,-20.7,-15.94,-13.64,-17.83,-23.5,-22.63,-20.84,-10.98,-23.3,-30.2,-19.66,-17.94,-14.72,-16.46,-20.97,-19.84,-22.58,-16.32,-15.55,-23.55,-16.3,-25.82,-18.73,-17.64,-17.66,-18.82,-37.37,-15.31,-24.97,-15.49,-19.23,-30.1,-26.4,-11.77,-24.12,-18.97,-18.75,-19.26,-22.75,-21.37,-20.1,-19.85,-22.7,-22.06,-17.8,-24.2,-20.69,-21.16,-13.82,-11.49,-20.68,-17.1,-20.14,-21.96,-20.42,-15.46,-15.31,-19.86,-11.55,-23.74,-17.7,-23.54,-19.21,-12.11,-21.81,-28.98,-34.02,-23.84,-19.57,-20.12,-17.7,-19.66,-21.5,-23.64,-15.43,-15.41,-15.48,-13.36,-20.64,-19.72,-15.44,-19.73,-27.24,-18.16,-13.66,-24.57,-16.98,-26.2,-21.88,-33,-21.33,-19.44,-34.89,-20.24,-22.55,-36.95,-15.75,-16.85,-19.06,-26.11,-26.2,-26.13,-13.66,-13.47,-14.6,-18.96,-14.65,-19.9,-22.05,-19.22,-31.24,-17.93,-19.3,-26.53,-27.72,-19.19,-17.43,-17.05,-19.52,-23.71,-21.3,-16.24,-16.14,-23.95,-25.2,-18.84,-12.66,-20.65,-13.23,-29.91,-14.31,-20.1,-17.8,-21.27,-23.58,-17.9,-23.34,-15.56,-23.83,-11.8,-15.54,-20.65,-11.75,-24.81,-20.9,-11.34,-17.98,-24.34,-13.86,-35.56,-35.48,-34.2,-26,-19.89,-23.43,-18.89,-17.82,-25.68,-20.2,-15.2,-15.03,-32.22,-22.64,-17.42,-17.84,-15.02,-18.04,-24.6,-19.88,-20.3,-20.45,-17.67,-22.3,-19.85,-24.27,-15.85,-20.02,-18.56,-17.87,-24.08,-32.2,-20.36,-23.85,-24,-20.41,-17.72,-19.67,-17.7,-16.23,-26.72,-12.95,-21.97,-21.96,-20.32,-30.28,-20.2,-30.66,-16.17,-28.25,-20.47,-23.55,-20.94,-26.67,-18.13,-20.21,-18.31,-16.52,-22.36,-22.43,-20.37,-23.77,-13.65,-21.55,-16.24,-23.73,-22.34,-19.4,-24.64,-16,-19.62,-23.84,-23.54,-28.23,-21.68,-13.44,-24.96,-20.08,-24.36,-14.7,-18.2,-16.65,-18.11,-17.95,-15.5,-23.36,-19.15,-10.97,-14.85,-17.8,-22.5,-29.1,-20.32,-16.09,-19.18,-23.81,-23.79,-19.02,-20.9,-19.06,-17.88,-19.41,-26.17,-14.95,-18.73,-20.21,-21.29,-19.76,-22.09,-23.8,-20.16,-22.13,-17.44,-23.33,-24.78,-22,-19.13,-30.72,-22.32,-16.45,-17.7,-17.95,-24.4,-19.3,-21.13,-18.07,-20.6,-18.48,-13.34,-20.92,-25.31,-15.24,-16.4,-24.57,-17.94,-30.64,-18.64,-13.09,-19.68,-16.44,-21.09,-14.99,-23.3,-17.68,-22,-21.38,-32.62,-13.05,-12.93,-18.6,-21.34,-21.48,-17.4,-17.32,-18.77,-26.16,-12.59,-14.82,-21.79,-19.83,-29.5,-12.49,-26.1,-21.04,-10.78,-20.76,-11.41,-19.1,-23.91,-27.33,-12.25,-23.49,-27.18,-25.8,-27.19,-27.27,-27.1,-27.22,-27.38,-27.27,-27.54,-27.2,-27.71,-27.6,-27.38,-21.54,-27.21,-28.96,-12.01,-17.46,-30.17,-27.27,-17.79,-22.19,-17.1,-27.18,-11.64,-17.98,-16.9,-21.98,-32.14,-18.8,-26.78,-20.43,-18.3,-15.83,-23.44,-23.73,-19.89,-17.59,-19.77,-20.31,-15.33,-18.2,-15.36,-15.29,-15.36,-16.24,-13.47,-25.5,-14.32,-20.04,-28.83,-17.82,-27.23,-10.72,-27,-20.36,-27.17,-20.94,-17.46,-21.04,-23.7,-17.72,-15.87,-17.84,-13.45,-30.8,-11.63,-30.4,-26.18,-15.7,-17.95,-20.51,-15.36,-23.61,-33.2,-17.68,-22.24,-20.07,-25.04,-21.5,-14.28,-14.43,-32.7,-34.1,-19.7,-24.19,-26.6,-17.04,-22.1,-32.6,-33,-20.58,-20.61,-19.47,-17.47,-18.4,-23.33,-18.55,-26.16,-21.8,-27.63,-18.89,-20.3,-20.56,-16.1,-12.66,-21.05,-17.97,-19.83,-22.55,-22.28,-15.72,-20.85,-21.11,-25.31,-26.46,-24.09,-16.96,-23.19,-20.81,-15.03,-18.06,-19,-23.53,-18.18,-15.66,-18,-18.08,-18.05,-29.9,-20.9,-15.61,-16.03,-17.68,-31.94,-19.14,-18,-16.95,-10.79,-20.83,-32.9,-37.93,-29.09,-23.56,-19.6,-21.39,-14.85,-22.7,-32.42,-17.9,-23.58,-34.4,-17.61,-21.07,-13.84,-30.24,-18.49,-23.45,-16.04,-17.14,-22.54,-15.9,-30.04,-24.03,-18.89,-16.51,-20.1,-21.06,-13.07,-23.46,-19.41,-11.81,-11.76,-12.08,-25.59,-26.54,-20.9,-16.99,-23.46,-17.81,-15.17,-11.67,-20.75,-19.5,-26.18,-20.66,-19.22,-24.68,-15.43,-32.45,-21.31,-15.44,-13.26,-15.26,-33.57,-15.77,-15.79,-21,-16.28,-23.28,-16.1,-17.7,-15.96,-15.95,-17.56,-15.9,-15.29,-15.86,-16.2,-15.71,-16.45,-11.54,-19.61,-15.61,-21.16,-20.65,-20.33,-15.08,-23.28,-23.44,-23.12,-23.65,-22.91,-22.06,-13.56,-17.99,-23.92,-30.69,-21.92,-25.04,-19.92,-27.75,-17.71,-19.6,-34.68,-14.46,-18.85,-17.02,-20.41,-18.18,-16.49,-17.74,-20.49,-18.51,-27.28,-15.9,-20.57,-11.25,-20.04,-20.89,-16.62,-20.09,-24.96,-20.95,-23.31,-20.95,-21.58,-13.62,-12.72,-21.79,-20.48,-12.84,-17.02,-23.89,-23.07,-27.98,-28.1,-21.24,-21.24,-19.89,-32.82,-22,-21.57,-24.5,-33.03,-30.09,-22.75,-17.99,-19.6,-15.65,-17.78,-22.04,-20.06,-18.07,-12.85,-33.29,-34.63,-24.18,-23.78,-22.37,-23.97,-34.12,-25.25,-22.87,-18.48,-21.46,-28.56,-28.56,-21.3,-20.08,-18.82,-19.51,-12.05,-17.4,-23.93,-21.23,-16.23,-28.15,-20.81,-20.72,-23.29,-38.46,-15.48,-37.03,-20.48,-18.12,-18.17,-11.4,-23.1,-14.28,-22.87,-17.59,-27.6,-17.94,-17.88,-30.01,-19.19,-18.14,-23.46,-18.44,-18.21,-18.26,-15.85,-23.82,-18.6,-17.8,-10.78,-18.12,-19.34,-15.34,-24.97,-15.97,-23.47,-23.11,-20.54,-18.92,-20.16,-25.48,-18.19,-15.35,-18.69,-18.89,-17.61,-20.93,-17.6,-17.96,-18.8,-20.61,-20.74,-25.23,-23.9,-18.07,-15.43,-14.3,-18.04,-13.9,-17.64,-17.98,-25,-19.45,-16.11,-23.73,-17.74,-21.56,-20.97,-15.45,-15.93,-21.47,-21.44,-22.16,-13.36,-21.22,-26.1,-18.35,-17.2,-22.42,-17.91,-26.53,-26.5,-16.31,-18.76,-17.1,-19.28,-23.5,-21.26,-17.97,-26.02,-30.3,-24.89,-14.57,-15.4,-22.06,-25.14,-20.3,-25.28,-20.63,-19.02,-22.1,-38.59,-19.3,-31.03,-30.51,-22.55,-22.14,-25.6,-18.04,-21.29,-21.08,-20.64,-24.41,-12.16,-17.1,-21.13,-12.34,-16.43,-20.7,-21.18,-17.78,-21.57,-13.7,-12.27,-19.1,-19.85,-11.37,-20.7,-20.24,-16.4,-19.6,-21.63,-21.6,-21.77,-21.8,-21.05,-10.8,-17.9,-22.26,-22.33,-24.04,-20.4,-15,-27.87,-14.12,-23.61,-21.56,-21.19,-18.07,-26,-20.21,-28,-20.74,-31.8,-18.91,-20.45,-22.9,-18.11,-23.8,-23.42,-23.2,-12.93,-21.14,-19.13,-21.08,-20.07,-20.9,-25.04,-21.85,-19.34,-15.83,-23.73,-18.1,-22.12,-15.39,-16.21,-21.75,-22.1,-24.97,-19.36,-22.14,-21.48,-18.54,-21.62,-13.4,-15.5,-15.67,-21.78,-30.63,-15.7,-19.2,-19.7,-19.4,-15.85,-17.38,-24.33,-20.89,-18.97,-17.99,-15.8,-25.42,-21.6,-26.06,-17.56,-25.63,-25.46,-22.23,-21.55,-15.18,-13.79,-15.18,-18.78,-17.9,-18.5,-14.82,-15.65,-30.01,-13.16,-21.03,-21.4,-17.93,-20.87,-12.01,-19.1,-22.85,-17.08,-21.14,-12.23,-20.91,-11.38,-11.02,-22.09,-17.8,-18.94,-18.85,-21.91,-22.03,-18.1,-18.4,-21.2,-12,-11.7,-26.72,-24.39,-19.64,-21.35,-22.82,-38.28,-12.57,-22.24,-13.8,-21.07,-17.74,-23.87,-21.29,-22.2,-15.24,-17.82,-32.14,-19.3,-33.09,-20.18,-17.46,-17.44,-24.71,-21.53,-19.17,-28.05,-23.39,-22.33,-15.28,-20.27,-10.96,-21.52,-19.57,-23.08,-25.06,-17.85,-15.99,-20.56,-17.98,-18.4,-27.64,-20.99,-14.86,-29.33,-25.81,-14.1,-17.63,-23.47,-23.92,-20.88,-20.25,-19.33,-18.14,-22.41,-20.77,-17.95,-20.83,-27.84,-19.94,-23.6,-23.7,-30.39,-18.98,-27.89,-23.5,-23.73,-17.93,-35.94,-18.68,-23.47,-23.49,-23.85,-27.08,-20.88,-20.97,-21.71,-23.9,-15.78,-12.57,-19.69,-22.04,-17.99,-23.5,-21.4,-15.86,-23.95,-25.79,-23.75,-24.1,-18.56,-23.3,-17.03,-20.77,-28.1,-18.83,-23,-20.82,-22.95,-28.22,-27.99,-15.54,-12.37,-22.33,-22.7,-17.86,-16,-20.73,-15.45,-20.05,-17.95,-17.7,-25.93,-12.28,-20.13,-17.4,-21.59],[181.62,181.03,184.1,181.66,181.96,184.31,166.1,181.93,181.74,179.59,180.69,167,182.11,181.66,169.92,184.95,165.96,181.5,179.78,180.31,181.16,166.32,180.16,182,180.28,181.49,167.51,180.79,181.47,182.37,179.24,166.74,185.05,180.8,186,179.33,169.23,181.28,181.4,169.33,176.78,186.1,179.82,186.04,169.41,182.3,181.7,166.32,180.08,185.25,182.35,184.42,173.2,180.67,182.16,182.13,181,180.6,181.35,179.2,181.55,182.4,172.38,166.22,181.41,184.93,181.6,179.62,181.86,187.81,185.8,184.35,166.2,179.99,181.23,180.04,184.7,167.06,181.71,181.11,180.21,180.99,182.38,183.4,181.7,184.31,170.5,179.96,186.3,186.44,167.53,167.06,182.02,169.71,185.26,182.4,181.11,183.41,166.54,179.92,185.61,178.41,180.39,181.6,180.69,183.5,180.6,169.49,185.9,177.81,185.23,182.31,182.45,178.3,178.35,178.31,172.23,172.29,167.4,169.48,166.97,178.9,180.4,182.43,180.6,167.89,183.84,178.57,181.7,183.51,185.43,181.22,168.98,180.3,180.82,168.02,187.32,182.8,182.6,184.16,169.46,181.4,167.1,181.43,173.5,184.4,185.17,173.49,180.17,181.5,184.5,167.62,182.56,165.8,167.68,181.32,166.07,180,169.84,166.24,180.5,179.52,167.16,180.2,179.9,179.43,182.12,183.84,180,169.42,181.83,180.34,180.9,184.68,182.29,180.2,180.64,185.16,181.48,184.24,181.75,183.5,184.3,183,181.85,187.09,181.9,181.85,179.88,185.13,184.09,169.31,182,179.5,179.61,181.19,182.53,182.75,181.74,180.3,182.18,182.2,183.59,183.35,169.09,182.32,180.54,181.69,180.62,182.3,180.13,184.1,181.71,185.68,180.27,181.58,182.4,181.52,183.83,182.39,185.7,171.65,184.48,182.1,180.16,166.66,182.9,185.75,182.53,171.52,180.94,180.81,182.82,185.35,180.13,179.93,182.68,180.63,166.53,180.22,182.74,182.84,166,183.68,185.51,181.67,181.65,186.9,180.01,169.5,166.26,167.24,181.38,170.4,182.1,180.88,184.89,169.33,179.36,179.89,184.23,181.51,169.01,181.47,183.05,184.2,167.24,168.8,182.37,180.85,181.41,180.38,179.9,181.99,180.38,181.4,180.18,179.22,180.52,182.51,180.1,180.54,177.77,185,184.68,179.85,180.6,185.32,181.57,182.28,181.49,166.2,181.5,179.69,186.21,185.86,178.4,181.51,181.2,169.32,169.28,184.14,185.74,181.38,171.39,179.7,181.36,180.53,181.39,181.5,169.58,169.63,181.91,181.41,183.78,181.02,181.03,169.24,179.5,167.1,167.32,183.48,182.04,182.31,166.36,182.3,181.2,165.77,185.77,166.24,183.87,180,182.6,166.6,179.07,182.18,182.1,182.18,182.38,182.18,182.28,181.7,182.5,182.5,182.39,182.47,182.4,182.39,185.48,182.43,182.61,166.29,181.32,182.02,182.36,181.32,171.4,182.68,182.53,166.47,181.58,185.72,179.6,179.9,169.21,183.61,182.37,183.2,182.51,182.93,179.99,184.08,181.09,181.4,184.06,186.75,181.6,186.66,186.42,186.71,167.95,167.14,182.82,167.33,182.01,181.66,181.49,180.98,165.99,183.88,186.16,183.68,181.26,181.9,181.2,179.6,181.42,188.13,181.3,170.3,182.16,166.14,181.4,178.59,184.5,181.5,182.3,167.51,180.23,181.6,186.8,184.56,169.14,180.1,185.2,167.26,167.26,181.7,181.8,186.2,180.38,182.77,186.8,179.71,180.9,182.4,181.24,182.6,169.15,180.96,183.4,180.26,182.23,178.47,183.2,182.93,169.48,182.3,182.04,185.32,166.37,184.68,168.52,182.54,183.81,183.52,185.64,181.59,181.5,180.15,182.5,179.68,167.7,182.8,184.7,167.32,181.59,185.6,179.99,180.63,186.8,180.62,180.7,180.86,181.16,181.9,167.5,185.43,181.11,180.57,184.36,185.48,185.94,166.06,185.9,181.6,177.47,183.2,180.23,185.2,180.68,184.87,183.3,181.21,181.3,183.4,180.5,181.2,181.13,170.62,181.63,169.04,180.23,183.54,185.31,172.91,185.3,181.2,180.22,184.46,187.1,186.3,183.81,166.87,180.09,182.3,165.98,165.96,165.76,180.02,183.63,184.28,187,180.17,181.82,187.2,166.02,184.52,186.9,179.79,185.77,182.54,183.33,167.38,181.15,180.84,167.18,167.01,183.13,180.8,167.01,166.83,183.2,166.94,184.6,167.25,181.31,166.69,167.34,181.59,167.42,166.9,166.85,166.8,166.91,167.54,166.18,181.91,187.15,181.41,182.22,168.71,166.62,184.61,184.6,184.42,184.46,183.95,180.47,166.49,181.57,184.47,182.1,182.8,180.97,183.91,182.26,181.18,183.84,179.82,167.26,187.55,182.41,186.51,182.04,187.8,181.31,181.69,182.64,183.4,167.16,181.33,166.36,181.87,181.25,186.74,168.75,179.87,181.42,179.27,181.06,181.9,167.15,166.28,185,169.76,166.78,182.93,182.39,184.03,181.96,182.25,180.81,180.86,174.46,179.8,185.5,185.62,180.92,180.2,182.4,170.99,168.98,181.87,186.26,181.53,184.91,168.69,181.54,165.67,181.3,179.1,179.02,180.31,171.5,179.91,181.75,179.86,172.65,182.37,181.02,183.47,183.59,180.92,183.22,182.21,183.97,167.39,186.54,180.18,181.09,167.91,183.4,185.01,181.41,184,176.03,186.73,177.52,181.38,181.88,181.98,166.07,180.12,170.34,171.72,180.98,182.1,180.6,180.58,180.8,182.3,180.87,180.11,181.04,180.87,180.98,184.83,180.09,184.28,181.32,166.1,181.71,182.62,167.1,182.85,186.08,180.24,179.15,181.66,169.37,184.27,180.94,181.74,186.4,169.1,181.24,183.32,181.54,181.5,181.4,182.41,182.44,181.53,179.86,179.9,181.58,185.19,167.32,181.57,167.18,177.01,181.51,180,184.48,187.48,179.98,186.78,183.23,181.72,186.73,167.91,185.86,170.45,180.49,172.76,181.51,182.5,185.27,182.9,171.4,181.48,178.3,178.29,168.08,169.71,182.8,182.78,180,181.69,181.48,181.2,180.8,179.67,167.24,186.87,183.95,178.42,181.4,181.17,181.61,186.83,185.3,175.7,183,181.59,181.3,183.34,180.64,180.3,181.84,185.77,180.85,169.66,180.03,167.03,185.9,185.6,167.43,186.73,184.3,180.92,185.33,183.86,166.75,167.41,184.52,184.51,166.55,186.3,185.1,182.73,184.53,180.77,180.5,181,183.6,180.9,165.8,181.5,171.44,171.46,184.85,186.1,184.62,183.4,166.64,180.27,185.5,181.58,181.65,178.43,181.9,182,180.7,180.6,169.46,182.1,183.8,181.63,184.7,180.21,184.8,169.52,181.06,184.97,181.3,181.75,182.02,179.84,180.89,186.59,167.1,183,181.72,180.49,185.1,186.52,180.67,180.4,179.54,186.36,179.62,182.44,168.93,182.4,166.9,185.3,185.23,183.11,180.9,185.1,184.37,182.44,182.29,185.9,168.63,179.97,185.26,169.44,181.62,185.25,182.65,169.9,180.05,181.23,180.26,179.98,180.48,181.39,185.93,166.56,167.23,186.72,181.41,185.4,171.17,185.17,181.15,167.24,180.78,180.78,181.89,181.7,166.66,169.63,181.37,185.96,174.21,167.02,181.57,167.05,167.01,180.58,181.2,182.43,182.2,181.28,179.77,181.63,184.84,181.4,166.2,166.3,182.69,178.98,169.5,170.04,184.52,177.1,167.11,180.28,166.53,183.78,181.25,180.15,185.8,180.58,185.11,181.27,180,185.86,180.94,181.62,181.42,181.33,179.85,170.52,169.53,182.39,179.97,171.51,185.98,181.51,165.97,169.75,184.47,183.45,182.8,181.44,167.95,184.41,181.61,181.77,182.22,181.02,167.32,182.72,182.54,166.01,185.13,180.21,180.21,185.18,184.75,186.16,181.71,183.99,181.16,181.73,181.01,182.1,182.39,183.99,184.13,182.4,182.32,182.92,184.9,184.49,181.62,178.52,184.5,179.95,180.06,180.26,183.44,184.95,181.2,183.58,184.6,167.44,166.72,184.23,183.95,181.59,180.13,180.74,166.98,184.64,182.38,184.5,184.5,169.05,184.68,185.74,183.71,183.5,182.26,170.7,181.67,170.56,183.6,183.5,187.15,166.93,171.66,170.3,181.3,184.53,181.42,181.42,183.86,181.37,188.1,179.54,167.06,184.2,187.8,170.56],10,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.75},{"showCoverageOnHover":true,"zoomToBoundsOnClick":true,"spiderfyOnMaxZoom":true,"removeOutsideVisibleBounds":true,"spiderLegPolylineOptions":{"weight":1.5,"color":"#222","opacity":0.5},"freezeAtZoom":false},null,["Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -20.42 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.62 <br/> Longitude: 181.03","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -26 <br/> Longitude: 184.1","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.97 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -20.42 <br/> Longitude: 181.96","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.68 <br/> Longitude: 184.31","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -11.7 <br/> Longitude: 166.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.11 <br/> Longitude: 181.93","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -28.74 <br/> Longitude: 181.74","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.47 <br/> Longitude: 179.59","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.44 <br/> Longitude: 180.69","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -12.26 <br/> Longitude: 167","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.54 <br/> Longitude: 182.11","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 6.1 <br/> Latitude: -20.7 <br/> Longitude: 169.92","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.94 <br/> Longitude: 184.95","Sample ID:  <br/> Magnitude: 6 <br/> Latitude: -13.64 <br/> Longitude: 165.96","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.83 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.5 <br/> Longitude: 179.78","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -22.63 <br/> Longitude: 180.31","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.84 <br/> Longitude: 181.16","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -10.98 <br/> Longitude: 166.32","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.3 <br/> Longitude: 180.16","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.2 <br/> Longitude: 182","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -19.66 <br/> Longitude: 180.28","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.94 <br/> Longitude: 181.49","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -14.72 <br/> Longitude: 167.51","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -16.46 <br/> Longitude: 180.79","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.97 <br/> Longitude: 181.47","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.84 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.58 <br/> Longitude: 179.24","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.32 <br/> Longitude: 166.74","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.55 <br/> Longitude: 185.05","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -23.55 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.3 <br/> Longitude: 186","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -25.82 <br/> Longitude: 179.33","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.73 <br/> Longitude: 169.23","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.64 <br/> Longitude: 181.28","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.66 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.82 <br/> Longitude: 169.33","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -37.37 <br/> Longitude: 176.78","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.31 <br/> Longitude: 186.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -24.97 <br/> Longitude: 179.82","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.49 <br/> Longitude: 186.04","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.23 <br/> Longitude: 169.41","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -30.1 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.4 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -11.77 <br/> Longitude: 166.32","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.12 <br/> Longitude: 180.08","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -18.97 <br/> Longitude: 185.25","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.75 <br/> Longitude: 182.35","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.26 <br/> Longitude: 184.42","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.75 <br/> Longitude: 173.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.37 <br/> Longitude: 180.67","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.1 <br/> Longitude: 182.16","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.85 <br/> Longitude: 182.13","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.7 <br/> Longitude: 181","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -22.06 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.8 <br/> Longitude: 181.35","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.2 <br/> Longitude: 179.2","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.69 <br/> Longitude: 181.55","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -21.16 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -13.82 <br/> Longitude: 172.38","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.49 <br/> Longitude: 166.22","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.68 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.1 <br/> Longitude: 184.93","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.14 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.96 <br/> Longitude: 179.62","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.42 <br/> Longitude: 181.86","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.46 <br/> Longitude: 187.81","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -15.31 <br/> Longitude: 185.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.86 <br/> Longitude: 184.35","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -11.55 <br/> Longitude: 166.2","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -23.74 <br/> Longitude: 179.99","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.7 <br/> Longitude: 181.23","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.54 <br/> Longitude: 180.04","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.21 <br/> Longitude: 184.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.11 <br/> Longitude: 167.06","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.81 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -28.98 <br/> Longitude: 181.11","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -34.02 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.84 <br/> Longitude: 180.99","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.57 <br/> Longitude: 182.38","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.12 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.7 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.66 <br/> Longitude: 184.31","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.5 <br/> Longitude: 170.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.64 <br/> Longitude: 179.96","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.43 <br/> Longitude: 186.3","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.41 <br/> Longitude: 186.44","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15.48 <br/> Longitude: 167.53","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.36 <br/> Longitude: 167.06","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -20.64 <br/> Longitude: 182.02","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.72 <br/> Longitude: 169.71","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.44 <br/> Longitude: 185.26","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.73 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.24 <br/> Longitude: 181.11","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.16 <br/> Longitude: 183.41","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -13.66 <br/> Longitude: 166.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.57 <br/> Longitude: 179.92","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -16.98 <br/> Longitude: 185.61","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -26.2 <br/> Longitude: 178.41","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.88 <br/> Longitude: 180.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -33 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.33 <br/> Longitude: 180.69","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.44 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -34.89 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.24 <br/> Longitude: 169.49","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -22.55 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -36.95 <br/> Longitude: 177.81","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.75 <br/> Longitude: 185.23","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -16.85 <br/> Longitude: 182.31","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.06 <br/> Longitude: 182.45","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -26.11 <br/> Longitude: 178.3","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -26.2 <br/> Longitude: 178.35","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.13 <br/> Longitude: 178.31","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -13.66 <br/> Longitude: 172.23","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.47 <br/> Longitude: 172.29","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.6 <br/> Longitude: 167.4","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.96 <br/> Longitude: 169.48","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.65 <br/> Longitude: 166.97","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.9 <br/> Longitude: 178.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.05 <br/> Longitude: 180.4","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.22 <br/> Longitude: 182.43","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -31.24 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.93 <br/> Longitude: 167.89","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.3 <br/> Longitude: 183.84","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -26.53 <br/> Longitude: 178.57","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.72 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.19 <br/> Longitude: 183.51","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.43 <br/> Longitude: 185.43","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.05 <br/> Longitude: 181.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.52 <br/> Longitude: 168.98","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.71 <br/> Longitude: 180.3","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.3 <br/> Longitude: 180.82","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.24 <br/> Longitude: 168.02","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -16.14 <br/> Longitude: 187.32","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.95 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -25.2 <br/> Longitude: 182.6","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.84 <br/> Longitude: 184.16","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -12.66 <br/> Longitude: 169.46","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -20.65 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -13.23 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -29.91 <br/> Longitude: 181.43","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -14.31 <br/> Longitude: 173.5","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.1 <br/> Longitude: 184.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.8 <br/> Longitude: 185.17","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.27 <br/> Longitude: 173.49","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -23.58 <br/> Longitude: 180.17","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.9 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -23.34 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 6.4 <br/> Latitude: -15.56 <br/> Longitude: 167.62","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.83 <br/> Longitude: 182.56","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -11.8 <br/> Longitude: 165.8","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.54 <br/> Longitude: 167.68","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.65 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -11.75 <br/> Longitude: 166.07","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.81 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.9 <br/> Longitude: 169.84","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.34 <br/> Longitude: 166.24","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.98 <br/> Longitude: 180.5","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.34 <br/> Longitude: 179.52","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -13.86 <br/> Longitude: 167.16","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -35.56 <br/> Longitude: 180.2","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -35.48 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -34.2 <br/> Longitude: 179.43","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -26 <br/> Longitude: 182.12","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -19.89 <br/> Longitude: 183.84","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.43 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.89 <br/> Longitude: 169.42","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.82 <br/> Longitude: 181.83","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.68 <br/> Longitude: 180.34","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.2 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.2 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.03 <br/> Longitude: 182.29","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -32.22 <br/> Longitude: 180.2","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.64 <br/> Longitude: 180.64","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.42 <br/> Longitude: 185.16","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.84 <br/> Longitude: 181.48","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.02 <br/> Longitude: 184.24","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.04 <br/> Longitude: 181.75","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.6 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.88 <br/> Longitude: 184.3","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.3 <br/> Longitude: 183","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.45 <br/> Longitude: 181.85","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -17.67 <br/> Longitude: 187.09","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -22.3 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -19.85 <br/> Longitude: 181.85","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -24.27 <br/> Longitude: 179.88","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.85 <br/> Longitude: 185.13","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -20.02 <br/> Longitude: 184.09","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -18.56 <br/> Longitude: 169.31","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.87 <br/> Longitude: 182","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -24.08 <br/> Longitude: 179.5","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -32.2 <br/> Longitude: 179.61","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.36 <br/> Longitude: 181.19","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.85 <br/> Longitude: 182.53","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -24 <br/> Longitude: 182.75","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.41 <br/> Longitude: 181.74","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.72 <br/> Longitude: 180.3","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.67 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.7 <br/> Longitude: 182.2","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.23 <br/> Longitude: 183.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.72 <br/> Longitude: 183.35","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.95 <br/> Longitude: 169.09","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.97 <br/> Longitude: 182.32","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.96 <br/> Longitude: 180.54","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.32 <br/> Longitude: 181.69","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.28 <br/> Longitude: 180.62","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.2 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.66 <br/> Longitude: 180.13","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -16.17 <br/> Longitude: 184.1","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -28.25 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -20.47 <br/> Longitude: 185.68","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.55 <br/> Longitude: 180.27","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.94 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.67 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.13 <br/> Longitude: 181.52","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.21 <br/> Longitude: 183.83","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.31 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.52 <br/> Longitude: 185.7","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.36 <br/> Longitude: 171.65","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.43 <br/> Longitude: 184.48","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.37 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.77 <br/> Longitude: 180.16","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -13.65 <br/> Longitude: 166.66","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.55 <br/> Longitude: 182.9","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.24 <br/> Longitude: 185.75","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.73 <br/> Longitude: 182.53","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.34 <br/> Longitude: 171.52","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.4 <br/> Longitude: 180.94","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.64 <br/> Longitude: 180.81","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -16 <br/> Longitude: 182.82","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -19.62 <br/> Longitude: 185.35","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.84 <br/> Longitude: 180.13","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -23.54 <br/> Longitude: 179.93","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.23 <br/> Longitude: 182.68","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.68 <br/> Longitude: 180.63","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.44 <br/> Longitude: 166.53","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.96 <br/> Longitude: 180.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.08 <br/> Longitude: 182.74","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -24.36 <br/> Longitude: 182.84","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -14.7 <br/> Longitude: 166","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.2 <br/> Longitude: 183.68","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -16.65 <br/> Longitude: 185.51","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.11 <br/> Longitude: 181.67","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.95 <br/> Longitude: 181.65","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.5 <br/> Longitude: 186.9","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -23.36 <br/> Longitude: 180.01","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.15 <br/> Longitude: 169.5","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -10.97 <br/> Longitude: 166.26","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -14.85 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.8 <br/> Longitude: 181.38","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.5 <br/> Longitude: 170.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -29.1 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.32 <br/> Longitude: 180.88","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.09 <br/> Longitude: 184.89","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.18 <br/> Longitude: 169.33","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.81 <br/> Longitude: 179.36","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -23.79 <br/> Longitude: 179.89","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -19.02 <br/> Longitude: 184.23","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.9 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.06 <br/> Longitude: 169.01","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.88 <br/> Longitude: 181.47","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.41 <br/> Longitude: 183.05","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -26.17 <br/> Longitude: 184.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -14.95 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.73 <br/> Longitude: 168.8","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.21 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.29 <br/> Longitude: 180.85","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.76 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.09 <br/> Longitude: 180.38","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -23.8 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.16 <br/> Longitude: 181.99","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -22.13 <br/> Longitude: 180.38","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.44 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.33 <br/> Longitude: 180.18","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.78 <br/> Longitude: 179.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22 <br/> Longitude: 180.52","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -19.13 <br/> Longitude: 182.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -30.72 <br/> Longitude: 180.1","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -22.32 <br/> Longitude: 180.54","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.45 <br/> Longitude: 177.77","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.7 <br/> Longitude: 185","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.95 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.4 <br/> Longitude: 179.85","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.3 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.13 <br/> Longitude: 185.32","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.07 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.6 <br/> Longitude: 182.28","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.48 <br/> Longitude: 181.49","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -13.34 <br/> Longitude: 166.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.92 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.31 <br/> Longitude: 179.69","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -15.24 <br/> Longitude: 186.21","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -16.4 <br/> Longitude: 185.86","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -24.57 <br/> Longitude: 178.4","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.94 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -30.64 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.64 <br/> Longitude: 169.32","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.09 <br/> Longitude: 169.28","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -19.68 <br/> Longitude: 184.14","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.44 <br/> Longitude: 185.74","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.09 <br/> Longitude: 181.38","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -14.99 <br/> Longitude: 171.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.3 <br/> Longitude: 179.7","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.68 <br/> Longitude: 181.36","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22 <br/> Longitude: 180.53","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.38 <br/> Longitude: 181.39","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -32.62 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -13.05 <br/> Longitude: 169.58","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -12.93 <br/> Longitude: 169.63","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -18.6 <br/> Longitude: 181.91","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.34 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.48 <br/> Longitude: 183.78","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.4 <br/> Longitude: 181.02","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.32 <br/> Longitude: 181.03","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -18.77 <br/> Longitude: 169.24","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.16 <br/> Longitude: 179.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.59 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.82 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.79 <br/> Longitude: 183.48","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.83 <br/> Longitude: 182.04","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -29.5 <br/> Longitude: 182.31","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.49 <br/> Longitude: 166.36","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -26.1 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.04 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -10.78 <br/> Longitude: 165.77","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.76 <br/> Longitude: 185.77","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -11.41 <br/> Longitude: 166.24","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -19.1 <br/> Longitude: 183.87","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.91 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -27.33 <br/> Longitude: 182.6","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -12.25 <br/> Longitude: 166.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.49 <br/> Longitude: 179.07","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.18 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25.8 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -27.19 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.27 <br/> Longitude: 182.38","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.1 <br/> Longitude: 182.18","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -27.22 <br/> Longitude: 182.28","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.38 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.27 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.54 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.2 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.71 <br/> Longitude: 182.47","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.6 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.38 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.54 <br/> Longitude: 185.48","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.21 <br/> Longitude: 182.43","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -28.96 <br/> Longitude: 182.61","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.01 <br/> Longitude: 166.29","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.46 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -30.17 <br/> Longitude: 182.02","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.27 <br/> Longitude: 182.36","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -17.79 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.19 <br/> Longitude: 171.4","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -17.1 <br/> Longitude: 182.68","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.18 <br/> Longitude: 182.53","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -11.64 <br/> Longitude: 166.47","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.98 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -16.9 <br/> Longitude: 185.72","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -21.98 <br/> Longitude: 179.6","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -32.14 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.8 <br/> Longitude: 169.21","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -26.78 <br/> Longitude: 183.61","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.43 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.3 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.83 <br/> Longitude: 182.51","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -23.44 <br/> Longitude: 182.93","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.73 <br/> Longitude: 179.99","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -19.89 <br/> Longitude: 184.08","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.59 <br/> Longitude: 181.09","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -19.77 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.31 <br/> Longitude: 184.06","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -15.33 <br/> Longitude: 186.75","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.2 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15.36 <br/> Longitude: 186.66","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.29 <br/> Longitude: 186.42","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.36 <br/> Longitude: 186.71","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -16.24 <br/> Longitude: 167.95","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.47 <br/> Longitude: 167.14","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -25.5 <br/> Longitude: 182.82","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -14.32 <br/> Longitude: 167.33","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.04 <br/> Longitude: 182.01","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -28.83 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.82 <br/> Longitude: 181.49","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.23 <br/> Longitude: 180.98","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -10.72 <br/> Longitude: 165.99","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -27 <br/> Longitude: 183.88","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.36 <br/> Longitude: 186.16","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.17 <br/> Longitude: 183.68","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.94 <br/> Longitude: 181.26","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.46 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.04 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.7 <br/> Longitude: 179.6","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -17.72 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -15.87 <br/> Longitude: 188.13","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -17.84 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -13.45 <br/> Longitude: 170.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -30.8 <br/> Longitude: 182.16","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.63 <br/> Longitude: 166.14","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -30.4 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -26.18 <br/> Longitude: 178.59","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.7 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.95 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.51 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.36 <br/> Longitude: 167.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.61 <br/> Longitude: 180.23","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -33.2 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.68 <br/> Longitude: 186.8","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.24 <br/> Longitude: 184.56","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -20.07 <br/> Longitude: 169.14","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -25.04 <br/> Longitude: 180.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.5 <br/> Longitude: 185.2","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -14.28 <br/> Longitude: 167.26","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -14.43 <br/> Longitude: 167.26","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -32.7 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -34.1 <br/> Longitude: 181.8","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -19.7 <br/> Longitude: 186.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.19 <br/> Longitude: 180.38","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -26.6 <br/> Longitude: 182.77","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.04 <br/> Longitude: 186.8","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.1 <br/> Longitude: 179.71","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -32.6 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -33 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.58 <br/> Longitude: 181.24","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.61 <br/> Longitude: 182.6","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.47 <br/> Longitude: 169.15","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.47 <br/> Longitude: 180.96","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.4 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.33 <br/> Longitude: 180.26","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -18.55 <br/> Longitude: 182.23","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -26.16 <br/> Longitude: 178.47","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.8 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.63 <br/> Longitude: 182.93","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.89 <br/> Longitude: 169.48","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.3 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.56 <br/> Longitude: 182.04","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.1 <br/> Longitude: 185.32","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -12.66 <br/> Longitude: 166.37","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.05 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -17.97 <br/> Longitude: 168.52","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.83 <br/> Longitude: 182.54","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.55 <br/> Longitude: 183.81","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.28 <br/> Longitude: 183.52","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.72 <br/> Longitude: 185.64","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.85 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -21.11 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25.31 <br/> Longitude: 180.15","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -26.46 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -24.09 <br/> Longitude: 179.68","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.96 <br/> Longitude: 167.7","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.19 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.81 <br/> Longitude: 184.7","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.03 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.06 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19 <br/> Longitude: 185.6","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -23.53 <br/> Longitude: 179.99","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.18 <br/> Longitude: 180.63","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.66 <br/> Longitude: 186.8","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18 <br/> Longitude: 180.62","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.08 <br/> Longitude: 180.7","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.05 <br/> Longitude: 180.86","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -29.9 <br/> Longitude: 181.16","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.9 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.61 <br/> Longitude: 167.5","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -16.03 <br/> Longitude: 185.43","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -17.68 <br/> Longitude: 181.11","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -31.94 <br/> Longitude: 180.57","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.14 <br/> Longitude: 184.36","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18 <br/> Longitude: 185.48","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -16.95 <br/> Longitude: 185.94","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -10.79 <br/> Longitude: 166.06","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.83 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -32.9 <br/> Longitude: 181.6","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -37.93 <br/> Longitude: 177.47","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -29.09 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.56 <br/> Longitude: 180.23","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.6 <br/> Longitude: 185.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.39 <br/> Longitude: 180.68","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -14.85 <br/> Longitude: 184.87","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -22.7 <br/> Longitude: 183.3","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -32.42 <br/> Longitude: 181.21","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.9 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -23.58 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -34.4 <br/> Longitude: 180.5","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.61 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.07 <br/> Longitude: 181.13","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -13.84 <br/> Longitude: 170.62","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -30.24 <br/> Longitude: 181.63","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.49 <br/> Longitude: 169.04","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.45 <br/> Longitude: 180.23","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -16.04 <br/> Longitude: 183.54","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.14 <br/> Longitude: 185.31","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -22.54 <br/> Longitude: 172.91","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.9 <br/> Longitude: 185.3","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -30.04 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -24.03 <br/> Longitude: 180.22","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.89 <br/> Longitude: 184.46","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -16.51 <br/> Longitude: 187.1","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.1 <br/> Longitude: 186.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.06 <br/> Longitude: 183.81","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.07 <br/> Longitude: 166.87","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.46 <br/> Longitude: 180.09","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.41 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -11.81 <br/> Longitude: 165.98","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -11.76 <br/> Longitude: 165.96","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.08 <br/> Longitude: 165.76","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -25.59 <br/> Longitude: 180.02","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -26.54 <br/> Longitude: 183.63","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -20.9 <br/> Longitude: 184.28","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.99 <br/> Longitude: 187","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.46 <br/> Longitude: 180.17","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.81 <br/> Longitude: 181.82","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.17 <br/> Longitude: 187.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -11.67 <br/> Longitude: 166.02","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.75 <br/> Longitude: 184.52","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.5 <br/> Longitude: 186.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -26.18 <br/> Longitude: 179.79","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.66 <br/> Longitude: 185.77","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.22 <br/> Longitude: 182.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.68 <br/> Longitude: 183.33","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.43 <br/> Longitude: 167.38","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -32.45 <br/> Longitude: 181.15","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.31 <br/> Longitude: 180.84","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.44 <br/> Longitude: 167.18","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -13.26 <br/> Longitude: 167.01","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.26 <br/> Longitude: 183.13","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -33.57 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.77 <br/> Longitude: 167.01","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.79 <br/> Longitude: 166.83","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21 <br/> Longitude: 183.2","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.28 <br/> Longitude: 166.94","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.28 <br/> Longitude: 184.6","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16.1 <br/> Longitude: 167.25","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.7 <br/> Longitude: 181.31","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.96 <br/> Longitude: 166.69","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -15.95 <br/> Longitude: 167.34","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.56 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -15.9 <br/> Longitude: 167.42","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -15.29 <br/> Longitude: 166.9","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.86 <br/> Longitude: 166.85","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.2 <br/> Longitude: 166.8","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.71 <br/> Longitude: 166.91","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -16.45 <br/> Longitude: 167.54","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -11.54 <br/> Longitude: 166.18","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.61 <br/> Longitude: 181.91","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -15.61 <br/> Longitude: 187.15","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.16 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.65 <br/> Longitude: 182.22","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -20.33 <br/> Longitude: 168.71","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.08 <br/> Longitude: 166.62","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.28 <br/> Longitude: 184.61","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.44 <br/> Longitude: 184.6","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.12 <br/> Longitude: 184.42","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.65 <br/> Longitude: 184.46","Sample ID:  <br/> Magnitude: 5.9 <br/> Latitude: -22.91 <br/> Longitude: 183.95","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.06 <br/> Longitude: 180.47","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -13.56 <br/> Longitude: 166.49","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -17.99 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.92 <br/> Longitude: 184.47","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -30.69 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -21.92 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -25.04 <br/> Longitude: 180.97","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.92 <br/> Longitude: 183.91","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -27.75 <br/> Longitude: 182.26","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.71 <br/> Longitude: 181.18","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.6 <br/> Longitude: 183.84","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -34.68 <br/> Longitude: 179.82","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -14.46 <br/> Longitude: 167.26","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.85 <br/> Longitude: 187.55","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.02 <br/> Longitude: 182.41","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.41 <br/> Longitude: 186.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.18 <br/> Longitude: 182.04","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.49 <br/> Longitude: 187.8","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -17.74 <br/> Longitude: 181.31","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.49 <br/> Longitude: 181.69","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.51 <br/> Longitude: 182.64","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -27.28 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.9 <br/> Longitude: 167.16","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.57 <br/> Longitude: 181.33","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -11.25 <br/> Longitude: 166.36","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.04 <br/> Longitude: 181.87","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.89 <br/> Longitude: 181.25","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -16.62 <br/> Longitude: 186.74","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.09 <br/> Longitude: 168.75","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -24.96 <br/> Longitude: 179.87","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.95 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.31 <br/> Longitude: 179.27","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.95 <br/> Longitude: 181.06","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.58 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.62 <br/> Longitude: 167.15","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -12.72 <br/> Longitude: 166.28","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -21.79 <br/> Longitude: 185","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.48 <br/> Longitude: 169.76","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -12.84 <br/> Longitude: 166.78","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.02 <br/> Longitude: 182.93","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.89 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.07 <br/> Longitude: 184.03","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -27.98 <br/> Longitude: 181.96","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -28.1 <br/> Longitude: 182.25","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.24 <br/> Longitude: 180.81","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.24 <br/> Longitude: 180.86","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -19.89 <br/> Longitude: 174.46","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -32.82 <br/> Longitude: 179.8","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -22 <br/> Longitude: 185.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.57 <br/> Longitude: 185.62","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.5 <br/> Longitude: 180.92","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -33.03 <br/> Longitude: 180.2","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -30.09 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.75 <br/> Longitude: 170.99","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.99 <br/> Longitude: 168.98","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.6 <br/> Longitude: 181.87","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15.65 <br/> Longitude: 186.26","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -17.78 <br/> Longitude: 181.53","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.04 <br/> Longitude: 184.91","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.06 <br/> Longitude: 168.69","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.07 <br/> Longitude: 181.54","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -12.85 <br/> Longitude: 165.67","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -33.29 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -34.63 <br/> Longitude: 179.1","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -24.18 <br/> Longitude: 179.02","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -23.78 <br/> Longitude: 180.31","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -22.37 <br/> Longitude: 171.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.97 <br/> Longitude: 179.91","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -34.12 <br/> Longitude: 181.75","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -25.25 <br/> Longitude: 179.86","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -22.87 <br/> Longitude: 172.65","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.48 <br/> Longitude: 182.37","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.46 <br/> Longitude: 181.02","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -28.56 <br/> Longitude: 183.47","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.56 <br/> Longitude: 183.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.3 <br/> Longitude: 180.92","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.08 <br/> Longitude: 183.22","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -18.82 <br/> Longitude: 182.21","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.51 <br/> Longitude: 183.97","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -12.05 <br/> Longitude: 167.39","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.4 <br/> Longitude: 186.54","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.93 <br/> Longitude: 180.18","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.23 <br/> Longitude: 181.09","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.23 <br/> Longitude: 167.91","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -28.15 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.81 <br/> Longitude: 185.01","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.72 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.29 <br/> Longitude: 184","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -38.46 <br/> Longitude: 176.03","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.48 <br/> Longitude: 186.73","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -37.03 <br/> Longitude: 177.52","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.48 <br/> Longitude: 181.38","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -18.12 <br/> Longitude: 181.88","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.17 <br/> Longitude: 181.98","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -11.4 <br/> Longitude: 166.07","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.1 <br/> Longitude: 180.12","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -14.28 <br/> Longitude: 170.34","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.87 <br/> Longitude: 171.72","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.59 <br/> Longitude: 180.98","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -27.6 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.94 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.88 <br/> Longitude: 180.58","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -30.01 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -19.19 <br/> Longitude: 182.3","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -18.14 <br/> Longitude: 180.87","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.46 <br/> Longitude: 180.11","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.44 <br/> Longitude: 181.04","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.21 <br/> Longitude: 180.87","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.26 <br/> Longitude: 180.98","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.85 <br/> Longitude: 184.83","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.82 <br/> Longitude: 180.09","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.6 <br/> Longitude: 184.28","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.8 <br/> Longitude: 181.32","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -10.78 <br/> Longitude: 166.1","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.12 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.34 <br/> Longitude: 182.62","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -15.34 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.97 <br/> Longitude: 182.85","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -15.97 <br/> Longitude: 186.08","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.47 <br/> Longitude: 180.24","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.11 <br/> Longitude: 179.15","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.54 <br/> Longitude: 181.66","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -18.92 <br/> Longitude: 169.37","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.16 <br/> Longitude: 184.27","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.48 <br/> Longitude: 180.94","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.19 <br/> Longitude: 181.74","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.35 <br/> Longitude: 186.4","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.69 <br/> Longitude: 169.1","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.89 <br/> Longitude: 181.24","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.61 <br/> Longitude: 183.32","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.93 <br/> Longitude: 181.54","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.6 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.96 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -18.8 <br/> Longitude: 182.41","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.61 <br/> Longitude: 182.44","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.74 <br/> Longitude: 181.53","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -25.23 <br/> Longitude: 179.86","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.9 <br/> Longitude: 179.9","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.07 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -15.43 <br/> Longitude: 185.19","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.3 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.04 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -13.9 <br/> Longitude: 167.18","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.64 <br/> Longitude: 177.01","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -17.98 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.45 <br/> Longitude: 184.48","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.11 <br/> Longitude: 187.48","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.73 <br/> Longitude: 179.98","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -17.74 <br/> Longitude: 186.78","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.56 <br/> Longitude: 183.23","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.97 <br/> Longitude: 181.72","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.45 <br/> Longitude: 186.73","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -15.93 <br/> Longitude: 167.91","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.47 <br/> Longitude: 185.86","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.44 <br/> Longitude: 170.45","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.16 <br/> Longitude: 180.49","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -13.36 <br/> Longitude: 172.76","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -21.22 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.1 <br/> Longitude: 182.5","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -18.35 <br/> Longitude: 185.27","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.2 <br/> Longitude: 182.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.42 <br/> Longitude: 171.4","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.91 <br/> Longitude: 181.48","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -26.53 <br/> Longitude: 178.3","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -26.5 <br/> Longitude: 178.29","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -16.31 <br/> Longitude: 168.08","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.76 <br/> Longitude: 169.71","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.1 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -19.28 <br/> Longitude: 182.78","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.5 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.26 <br/> Longitude: 181.69","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.97 <br/> Longitude: 181.48","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -26.02 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -30.3 <br/> Longitude: 180.8","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -24.89 <br/> Longitude: 179.67","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -14.57 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -15.4 <br/> Longitude: 186.87","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.06 <br/> Longitude: 183.95","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -25.14 <br/> Longitude: 178.42","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.3 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -25.28 <br/> Longitude: 181.17","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.63 <br/> Longitude: 181.61","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -19.02 <br/> Longitude: 186.83","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.1 <br/> Longitude: 185.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -38.59 <br/> Longitude: 175.7","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -19.3 <br/> Longitude: 183","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -31.03 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -30.51 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.55 <br/> Longitude: 183.34","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.14 <br/> Longitude: 180.64","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -25.6 <br/> Longitude: 180.3","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.04 <br/> Longitude: 181.84","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -21.29 <br/> Longitude: 185.77","Sample ID:  <br/> Magnitude: 5.9 <br/> Latitude: -21.08 <br/> Longitude: 180.85","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.64 <br/> Longitude: 169.66","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -24.41 <br/> Longitude: 180.03","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -12.16 <br/> Longitude: 167.03","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -17.1 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -21.13 <br/> Longitude: 185.6","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -12.34 <br/> Longitude: 167.43","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -16.43 <br/> Longitude: 186.73","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.7 <br/> Longitude: 184.3","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.18 <br/> Longitude: 180.92","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.78 <br/> Longitude: 185.33","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.57 <br/> Longitude: 183.86","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -13.7 <br/> Longitude: 166.75","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -12.27 <br/> Longitude: 167.41","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.1 <br/> Longitude: 184.52","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -19.85 <br/> Longitude: 184.51","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -11.37 <br/> Longitude: 166.55","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -20.7 <br/> Longitude: 186.3","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.24 <br/> Longitude: 185.1","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -16.4 <br/> Longitude: 182.73","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.6 <br/> Longitude: 184.53","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.63 <br/> Longitude: 180.77","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21.6 <br/> Longitude: 180.5","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -21.77 <br/> Longitude: 181","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -21.8 <br/> Longitude: 183.6","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.05 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -10.8 <br/> Longitude: 165.8","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.9 <br/> Longitude: 181.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.26 <br/> Longitude: 171.44","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.33 <br/> Longitude: 171.46","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -24.04 <br/> Longitude: 184.85","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.4 <br/> Longitude: 186.1","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -15 <br/> Longitude: 184.62","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.87 <br/> Longitude: 183.4","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -14.12 <br/> Longitude: 166.64","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.61 <br/> Longitude: 180.27","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.56 <br/> Longitude: 185.5","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.19 <br/> Longitude: 181.58","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.07 <br/> Longitude: 181.65","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -26 <br/> Longitude: 178.43","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -20.21 <br/> Longitude: 181.9","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -28 <br/> Longitude: 182","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.74 <br/> Longitude: 180.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -31.8 <br/> Longitude: 180.6","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.91 <br/> Longitude: 169.46","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.45 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -22.9 <br/> Longitude: 183.8","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.11 <br/> Longitude: 181.63","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -23.8 <br/> Longitude: 184.7","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.42 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.2 <br/> Longitude: 184.8","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -12.93 <br/> Longitude: 169.52","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.14 <br/> Longitude: 181.06","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.13 <br/> Longitude: 184.97","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.08 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -20.07 <br/> Longitude: 181.75","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.9 <br/> Longitude: 182.02","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -25.04 <br/> Longitude: 179.84","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.85 <br/> Longitude: 180.89","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -19.34 <br/> Longitude: 186.59","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.83 <br/> Longitude: 167.1","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.73 <br/> Longitude: 183","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -18.1 <br/> Longitude: 181.72","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -22.12 <br/> Longitude: 180.49","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.39 <br/> Longitude: 185.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -16.21 <br/> Longitude: 186.52","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.75 <br/> Longitude: 180.67","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -22.1 <br/> Longitude: 180.4","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -24.97 <br/> Longitude: 179.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -19.36 <br/> Longitude: 186.36","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -22.14 <br/> Longitude: 179.62","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.48 <br/> Longitude: 182.44","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.54 <br/> Longitude: 168.93","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21.62 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -13.4 <br/> Longitude: 166.9","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.5 <br/> Longitude: 185.3","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.67 <br/> Longitude: 185.23","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -21.78 <br/> Longitude: 183.11","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -30.63 <br/> Longitude: 180.9","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.7 <br/> Longitude: 185.1","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.2 <br/> Longitude: 184.37","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -19.7 <br/> Longitude: 182.44","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.4 <br/> Longitude: 182.29","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.85 <br/> Longitude: 185.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.38 <br/> Longitude: 168.63","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -24.33 <br/> Longitude: 179.97","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -20.89 <br/> Longitude: 185.26","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -18.97 <br/> Longitude: 169.44","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -17.99 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.8 <br/> Longitude: 185.25","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -25.42 <br/> Longitude: 182.65","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.6 <br/> Longitude: 169.9","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -26.06 <br/> Longitude: 180.05","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.56 <br/> Longitude: 181.23","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -25.63 <br/> Longitude: 180.26","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -25.46 <br/> Longitude: 179.98","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.23 <br/> Longitude: 180.48","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.55 <br/> Longitude: 181.39","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.18 <br/> Longitude: 185.93","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -13.79 <br/> Longitude: 166.56","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -15.18 <br/> Longitude: 167.23","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -18.78 <br/> Longitude: 186.72","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.9 <br/> Longitude: 181.41","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -18.5 <br/> Longitude: 185.4","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -14.82 <br/> Longitude: 171.17","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -15.65 <br/> Longitude: 185.17","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -30.01 <br/> Longitude: 181.15","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -13.16 <br/> Longitude: 167.24","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -21.03 <br/> Longitude: 180.78","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.4 <br/> Longitude: 180.78","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.93 <br/> Longitude: 181.89","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.87 <br/> Longitude: 181.7","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -12.01 <br/> Longitude: 166.66","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -19.1 <br/> Longitude: 169.63","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -22.85 <br/> Longitude: 181.37","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.08 <br/> Longitude: 185.96","Sample ID:  <br/> Magnitude: 5.7 <br/> Latitude: -21.14 <br/> Longitude: 174.21","Sample ID:  <br/> Magnitude: 6 <br/> Latitude: -12.23 <br/> Longitude: 167.02","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.91 <br/> Longitude: 181.57","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -11.38 <br/> Longitude: 167.05","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -11.02 <br/> Longitude: 167.01","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -22.09 <br/> Longitude: 180.58","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.8 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.94 <br/> Longitude: 182.43","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.85 <br/> Longitude: 182.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -21.91 <br/> Longitude: 181.28","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.03 <br/> Longitude: 179.77","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -18.1 <br/> Longitude: 181.63","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.4 <br/> Longitude: 184.84","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.2 <br/> Longitude: 181.4","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -12 <br/> Longitude: 166.2","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -11.7 <br/> Longitude: 166.3","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -26.72 <br/> Longitude: 182.69","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -24.39 <br/> Longitude: 178.98","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.64 <br/> Longitude: 169.5","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -21.35 <br/> Longitude: 170.04","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -22.82 <br/> Longitude: 184.52","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -38.28 <br/> Longitude: 177.1","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -12.57 <br/> Longitude: 167.11","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -22.24 <br/> Longitude: 180.28","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -13.8 <br/> Longitude: 166.53","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -21.07 <br/> Longitude: 183.78","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.74 <br/> Longitude: 181.25","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -23.87 <br/> Longitude: 180.15","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -21.29 <br/> Longitude: 185.8","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -22.2 <br/> Longitude: 180.58","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -15.24 <br/> Longitude: 185.11","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.82 <br/> Longitude: 181.27","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -32.14 <br/> Longitude: 180","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -19.3 <br/> Longitude: 185.86","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -33.09 <br/> Longitude: 180.94","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.18 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.46 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.44 <br/> Longitude: 181.33","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -24.71 <br/> Longitude: 179.85","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -21.53 <br/> Longitude: 170.52","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -19.17 <br/> Longitude: 169.53","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -28.05 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.39 <br/> Longitude: 179.97","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -22.33 <br/> Longitude: 171.51","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -15.28 <br/> Longitude: 185.98","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.27 <br/> Longitude: 181.51","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -10.96 <br/> Longitude: 165.97","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -21.52 <br/> Longitude: 169.75","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -19.57 <br/> Longitude: 184.47","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.08 <br/> Longitude: 183.45","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -25.06 <br/> Longitude: 182.8","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -17.85 <br/> Longitude: 181.44","Sample ID:  <br/> Magnitude: 5.3 <br/> Latitude: -15.99 <br/> Longitude: 167.95","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.56 <br/> Longitude: 184.41","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -17.98 <br/> Longitude: 181.61","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -18.4 <br/> Longitude: 181.77","Sample ID:  <br/> Magnitude: 5.1 <br/> Latitude: -27.64 <br/> Longitude: 182.22","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.99 <br/> Longitude: 181.02","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -14.86 <br/> Longitude: 167.32","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -29.33 <br/> Longitude: 182.72","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -25.81 <br/> Longitude: 182.54","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -14.1 <br/> Longitude: 166.01","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.63 <br/> Longitude: 185.13","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -23.47 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -23.92 <br/> Longitude: 180.21","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -20.88 <br/> Longitude: 185.18","Sample ID:  <br/> Magnitude: 5.6 <br/> Latitude: -20.25 <br/> Longitude: 184.75","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -19.33 <br/> Longitude: 186.16","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -18.14 <br/> Longitude: 181.71","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -22.41 <br/> Longitude: 183.99","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -20.77 <br/> Longitude: 181.16","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -17.95 <br/> Longitude: 181.73","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.83 <br/> Longitude: 181.01","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -27.84 <br/> Longitude: 182.1","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -19.94 <br/> Longitude: 182.39","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -23.6 <br/> Longitude: 183.99","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.7 <br/> Longitude: 184.13","Sample ID:  <br/> Magnitude: 4.6 <br/> Latitude: -30.39 <br/> Longitude: 182.4","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -18.98 <br/> Longitude: 182.32","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -27.89 <br/> Longitude: 182.92","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.5 <br/> Longitude: 184.9","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -23.73 <br/> Longitude: 184.49","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.93 <br/> Longitude: 181.62","Sample ID:  <br/> Magnitude: 5.5 <br/> Latitude: -35.94 <br/> Longitude: 178.52","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -18.68 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -23.47 <br/> Longitude: 179.95","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -23.49 <br/> Longitude: 180.06","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -23.85 <br/> Longitude: 180.26","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -27.08 <br/> Longitude: 183.44","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.88 <br/> Longitude: 184.95","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.97 <br/> Longitude: 181.2","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -21.71 <br/> Longitude: 183.58","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -23.9 <br/> Longitude: 184.6","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.78 <br/> Longitude: 167.44","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -12.57 <br/> Longitude: 166.72","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -19.69 <br/> Longitude: 184.23","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -22.04 <br/> Longitude: 183.95","Sample ID:  <br/> Magnitude: 4.1 <br/> Latitude: -17.99 <br/> Longitude: 181.59","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -23.5 <br/> Longitude: 180.13","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -21.4 <br/> Longitude: 180.74","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -15.86 <br/> Longitude: 166.98","Sample ID:  <br/> Magnitude: 5.4 <br/> Latitude: -23.95 <br/> Longitude: 184.64","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -25.79 <br/> Longitude: 182.38","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -23.75 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -24.1 <br/> Longitude: 184.5","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -18.56 <br/> Longitude: 169.05","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -23.3 <br/> Longitude: 184.68","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.03 <br/> Longitude: 185.74","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -20.77 <br/> Longitude: 183.71","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -28.1 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -18.83 <br/> Longitude: 182.26","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -23 <br/> Longitude: 170.7","Sample ID:  <br/> Magnitude: 5 <br/> Latitude: -20.82 <br/> Longitude: 181.67","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -22.95 <br/> Longitude: 170.56","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -28.22 <br/> Longitude: 183.6","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -27.99 <br/> Longitude: 183.5","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -15.54 <br/> Longitude: 187.15","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -12.37 <br/> Longitude: 166.93","Sample ID:  <br/> Magnitude: 5.2 <br/> Latitude: -22.33 <br/> Longitude: 171.66","Sample ID:  <br/> Magnitude: 4.8 <br/> Latitude: -22.7 <br/> Longitude: 170.3","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.86 <br/> Longitude: 181.3","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -16 <br/> Longitude: 184.53","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -20.73 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 4.3 <br/> Latitude: -15.45 <br/> Longitude: 181.42","Sample ID:  <br/> Magnitude: 4.9 <br/> Latitude: -20.05 <br/> Longitude: 183.86","Sample ID:  <br/> Magnitude: 4 <br/> Latitude: -17.95 <br/> Longitude: 181.37","Sample ID:  <br/> Magnitude: 4.2 <br/> Latitude: -17.7 <br/> Longitude: 188.1","Sample ID:  <br/> Magnitude: 4.4 <br/> Latitude: -25.93 <br/> Longitude: 179.54","Sample ID:  <br/> Magnitude: 4.7 <br/> Latitude: -12.28 <br/> Longitude: 167.06","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -20.13 <br/> Longitude: 184.2","Sample ID:  <br/> Magnitude: 4.5 <br/> Latitude: -17.4 <br/> Longitude: 187.8","Sample ID:  <br/> Magnitude: 6 <br/> Latitude: -21.59 <br/> Longitude: 170.56"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-38.59,-10.72],"lng":[165.67,188.13]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="your-turn-part-2" class="section level2 hasAnchor" number="97.5">
<h2 class="hasAnchor"><span class="header-section-number">97.5</span> Your Turn (Part 2)<a href="#your-turn-part-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Add a code chunk below the ‚ÄúPreproccessing‚Äù header and add the following <strong>DT</strong> code</p>
<ul>
<li>add this link (<a href="https://rstudio.github.io/DT/" class="uri">https://rstudio.github.io/DT/</a>) to your description above the code chunk to describe where you can find more information on <strong>DT</strong></li>
</ul>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(thesis.df, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div></li>
<li><p>Add a code chunk below the ‚ÄúStudy Area‚Äù header and add the following <strong>leaflet</strong> code</p>
<ul>
<li>add this link (<a href="https://rstudio.github.io/leaflet/" class="uri">https://rstudio.github.io/leaflet/</a>) to your description above the code chunk to describe where you can find more information on <strong>leaflet</strong></li>
</ul>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorFactor</span>(<span class="fu">c</span>(<span class="st">&quot;#619Cff&quot;</span>, <span class="st">&quot;#F8766D&quot;</span>, <span class="st">&quot;#00BA38&quot;</span>),</span>
<span id="cb569-4"><a href="#cb569-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">domain =</span> <span class="fu">c</span>(<span class="st">&quot;Cazenovia&quot;</span>, <span class="st">&quot;Onondaga&quot;</span>, <span class="st">&quot;Otisco&quot;</span>))</span>
<span id="cb569-5"><a href="#cb569-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-6"><a href="#cb569-6" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(<span class="at">data =</span> thesis.df,</span>
<span id="cb569-7"><a href="#cb569-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">options =</span> <span class="fu">leafletOptions</span>(<span class="at">minZoom =</span> <span class="dv">7</span>,</span>
<span id="cb569-8"><a href="#cb569-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">maxZoom =</span> <span class="dv">13</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb569-9"><a href="#cb569-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb569-10"><a href="#cb569-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="sc">~</span>long, <span class="sc">~</span>lat,</span>
<span id="cb569-11"><a href="#cb569-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillOpacity =</span> <span class="fl">0.75</span>,</span>
<span id="cb569-12"><a href="#cb569-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(lake),</span>
<span id="cb569-13"><a href="#cb569-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stroke =</span> <span class="cn">FALSE</span>,</span>
<span id="cb569-14"><a href="#cb569-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">popup =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample ID:&quot;</span>, thesis.df<span class="sc">$</span>unique_id, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb569-15"><a href="#cb569-15" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Lake:&quot;</span>, thesis.df<span class="sc">$</span>lake, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb569-16"><a href="#cb569-16" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Latitude:&quot;</span>, thesis.df<span class="sc">$</span>lat, <span class="st">&quot;&lt;br/&gt;&quot;</span>,</span>
<span id="cb569-17"><a href="#cb569-17" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Longitude:&quot;</span>, thesis.df<span class="sc">$</span>long)</span>
<span id="cb569-18"><a href="#cb569-18" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div></li>
<li><p>Edit the scatter plot code chunk to make the figure interactive with <strong>plotly</strong></p>
<ul>
<li><p>add this link (<a href="https://plot.ly/ggplot2/" class="uri">https://plot.ly/ggplot2/</a>) to your description above the code chunk</p></li>
<li><p>play around with the interactive plot and the tools provided at the top right of the plot</p>
<ul>
<li>For example, you can zoom in, click on points to get more information, take a snapshot of the current plot, etc.</li>
</ul>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true" tabindex="-1"></a>scatter.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(thesis.df,</span>
<span id="cb570-4"><a href="#cb570-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(substrate_size_d50,</span>
<span id="cb570-5"><a href="#cb570-5" aria-hidden="true" tabindex="-1"></a>                           pct_diptera)) <span class="sc">+</span></span>
<span id="cb570-6"><a href="#cb570-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> lake)) <span class="sc">+</span></span>
<span id="cb570-7"><a href="#cb570-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb570-8"><a href="#cb570-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-9"><a href="#cb570-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(scatter.plot)</span></code></pre></div></li>
</ul></li>
</ol>
</div>
</div>
<div id="child-documents" class="section level1 hasAnchor" number="98">
<h1 class="hasAnchor"><span class="header-section-number">98</span> Child Documents<a href="#child-documents" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In general, I find that a single R Markdown file quickly becomes unwieldy. I recommend breaking the document up into multiple ‚Äúchild‚Äù documents and sourcing these child documents in a parent document. My child documents generally represent major subsections of the document.</p>
<p>I prefer to store the parent R Markdown file in a folder labeled ‚Äúmarkdown‚Äù (rproject/markdown) and the child R Markdown files in a sub-directory of my ‚Äúmarkdown‚Äù folder called ‚Äúsections‚Äù (rproject/markdown/sections). In the parent file, the child files are sourced within the code chunk header using <code>child = 'sections/example.Rmd'</code>. After sourcing all the child chunks, the parent file can be knit (compiled) like a normal R markdown document. The child documents cannot be run in the parent file.</p>
<p><img src="img/rmarkdown/child_document.png" /></p>
<div id="extract-and-run-r-code-from-r-markdown-files" class="section level2 hasAnchor" number="98.1">
<h2 class="hasAnchor"><span class="header-section-number">98.1</span> Extract and Run R-Code from R Markdown Files<a href="#extract-and-run-r-code-from-r-markdown-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The parent file is great for organizing sections of your document, but the child documents cannot be executed within R Studio like a normal code chunk. Without the ability to easily execute the R code within the child documents it can become very difficult to develop new child documents because new child documents often depend on upstream code execution.</p>
<p>Imagine you have a parent document that sources child sections which import your data and clean your data. You now want to visualize your data; accordingly, you begin to develop a visualization child document, which depends on information from the upstream child sections. It would be inefficient and inappropriate to perform all the steps in the upstream child sections within the visualization section. Therefore, you need an effective way to execute the upstream child sections while you continue to develop the visualization section. The inefficient way of doing this is to open each child Rmd file in R Studio and execute them manually in the correct sequence. This becomes tedious after you have three or more documents (imagine doing this for 10+ child sections). The most efficient way that I have found to run upstream child sections is to extract the R-code chunks from each Rmd file, save them in a ‚Äúraw_scripts‚Äù folder, and then source/execute the scripts within a regular R script file (.R).</p>
<div id="r-code" class="section level3 hasAnchor" number="98.1.1">
<h3 class="hasAnchor"><span class="header-section-number">98.1.1</span> R Code<a href="#r-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section we establish the file path to the folder that contains all the child documents. The names of the child documents are extracted and stored as a vector. The <code>grepl()</code> function is used to retain only the Rmd files stored in the vector.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a>sections.path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(rprojroot<span class="sc">::</span><span class="fu">find_root</span>(<span class="st">&quot;r_in_practice.Rproj&quot;</span>),</span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;markdown&quot;</span>,</span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;sections&quot;</span>)</span>
<span id="cb571-4"><a href="#cb571-4" aria-hidden="true" tabindex="-1"></a>r.files.vec <span class="ot">&lt;-</span> <span class="fu">list.files</span>(sections.path)</span>
<span id="cb571-5"><a href="#cb571-5" aria-hidden="true" tabindex="-1"></a>r.files.vec <span class="ot">&lt;-</span> r.files.vec[<span class="fu">grepl</span>(<span class="st">&quot;.Rmd&quot;</span>, r.files.vec)]</span></code></pre></div>
<p>Next, a file path is specified for the R-scripts that will be extracted from the R Markdown documents; I place these files within a ‚Äúraw_script/extracted‚Äù folder. The <code>map()</code> function from the purrr package is used to loop through each file in the vector (r.files.vec). Within the <code>map()</code> loop, the <code>purl()</code> function from knitr is used to extract the R-code from the R Markdown documents and save the code to the specified folder.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a>extracted.path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(rprojroot<span class="sc">::</span><span class="fu">find_root</span>(<span class="st">&quot;r_in_practice.Rproj&quot;</span>),</span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;markdown&quot;</span>,</span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;raw_scripts&quot;</span>,</span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;extracted&quot;</span>)</span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map</span>(r.files.vec, <span class="cf">function</span>(file.i) {</span>
<span id="cb572-7"><a href="#cb572-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(file.i)</span></span>
<span id="cb572-8"><a href="#cb572-8" aria-hidden="true" tabindex="-1"></a>  file.name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;.Rmd&quot;</span>, <span class="st">&quot;&quot;</span>, file.i)</span>
<span id="cb572-9"><a href="#cb572-9" aria-hidden="true" tabindex="-1"></a>  extracted.file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(file.name, <span class="st">&quot;.R&quot;</span>)</span>
<span id="cb572-10"><a href="#cb572-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">purl</span>(</span>
<span id="cb572-11"><a href="#cb572-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">file.path</span>(sections.path, file.i),</span>
<span id="cb572-12"><a href="#cb572-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">file.path</span>(extracted.path, extracted.file)</span>
<span id="cb572-13"><a href="#cb572-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb572-14"><a href="#cb572-14" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Finally, create a vector of file names (<code>source.vec</code>) stored in the ‚Äúraw_script/extracted‚Äù folder. You will want to type these out manually (do not use <code>list.files()</code> functions) because in this format you can easily comment out certain scripts and only run the scripts of interest. <code>map()</code> is then used to loop through each specified file in <code>source.vec</code>. Keep in mind that the order of the file names specified in <code>source.vec</code> will determine the order that these files are executed in the <code>map()</code> function; therefore, order the files in <code>source.vec</code> from furthest upstream to furthest downstream. Each iteration of the loop, executes (sources) the specified R-script.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a>source.vec <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;introduction.R&quot;</span>,</span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;quick_reference.R&quot;</span>,</span>
<span id="cb573-4"><a href="#cb573-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;installation_updates.R&quot;</span>,</span>
<span id="cb573-5"><a href="#cb573-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;r_project.R&quot;</span>,</span>
<span id="cb573-6"><a href="#cb573-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;version_control.R&quot;</span></span>
<span id="cb573-7"><a href="#cb573-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb573-8"><a href="#cb573-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-9"><a href="#cb573-9" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map</span>(source.vec, <span class="cf">function</span>(source.i) {</span>
<span id="cb573-10"><a href="#cb573-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">source</span>(<span class="fu">file.path</span>(extracted.path, source.i))</span>
<span id="cb573-11"><a href="#cb573-11" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Once all the R-scripts extracted from the upstream child R Markdown files have been executed, you can begin or continue work on a new child R Markdown document. I keep all the above code in a single R-script and execute the entire script each time I use this file to make sure all of the files are up-to-date.</p>
</div>
</div>
<div id="your-turn-4" class="section level2 hasAnchor" number="98.2">
<h2 class="hasAnchor"><span class="header-section-number">98.2</span> Your Turn<a href="#your-turn-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Create an R Markdown document for each of the sections, designated by Header level 1s, we have created thus far.</p>
<ul>
<li>save the documents within your project root (where your .Rproj file lives)</li>
</ul></li>
<li><p>Copy the Header and the relevant content below the header. Paste the content into the appropriate R Markdown document.</p></li>
<li><p>Create a parent R Markdown document.</p>
<ul>
<li>create a code chunk for each section.</li>
<li>add <code>child = 'insert-file-name-here.Rmd'</code> to the header of the appropriate code chunk</li>
</ul></li>
<li><p>Knit the document</p></li>
</ol>
</div>
</div>
<div id="parameterized-reports" class="section level1 hasAnchor" number="99">
<h1 class="hasAnchor"><span class="header-section-number">99</span> Parameterized Reports<a href="#parameterized-reports" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Parameterized reports enable you to create a report template and generate reports for a subset of the data based on this template.</p>
<p>For example, imagine you are tasked with generating 100 one page fact sheets for lakes in your state. The fact sheets will include boilerplate language but for each lake‚Äôs fact sheet you will need to update the name of the lake used through out the document, provide a list of metrics relevant to the lake (e.g., lake area, lat/longs, and max depth), and map of the lake. Think about how long it would take you to compile of the necessary components (e.g., lake metrics and lake maps), the amount of time it would take you to manually add these components to each fact sheet, and the struggles you would likely run into with formatting. Now imagine you complete all 100 fact sheets, hand the fact sheets to your boss, and they ask you to change the format of all the maps in the fact sheets. You would likely need to manually re-generate all of the maps and manually replace the maps in each document.</p>
<p>Here is a link to a great lecture on creating parameterized reports: <a href="https://www.coursera.org/lecture/reproducible-templates-analysis/adding-parameters-in-a-document-template-6fQwc" class="uri">https://www.coursera.org/lecture/reproducible-templates-analysis/adding-parameters-in-a-document-template-6fQwc</a></p>
<div id="params" class="section level2 hasAnchor" number="99.1">
<h2 class="hasAnchor"><span class="header-section-number">99.1</span> params<a href="#params" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To add a parameter or parameters to your document, add the <code>params:</code> argument below <code>output: html_document</code>. Below <code>params:</code> you can specify any parameter name you want to use and any default value you want to supply. In this example I will be using the <code>iris</code> data set, and therefore I specified that the name of my parameter would be ‚Äúspecies‚Äù and the default value would be ‚Äúsetosa.‚Äù</p>
<center>
<p><img src="img/rmarkdown/param_yaml.png" /></p>
</center>
<p>The specified parameter can be used throughout the document with the syntax <code>params$species</code>. <code>params$species</code> will act as a place holder throughout the document until the document is rendered and, in this case, the species is specified; this specified species will be used throughout the document where <code>params$species</code> was acting as a placeholder.</p>
<p>In the example below, I use inline code to insert the species name into the title of the document. Therefore, the title will automatically update during rendering depending on the specified parameter.</p>
<center>
<p><img src="img/rmarkdown/param_yaml_dynamic_title.png" /></p>
</center>
<p>The parameters can also be used to filter the original data frame to a subset of interest. For example, the iris data frame can be filtered to only include the specified species of interest using the code below.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-3"><a href="#cb574-3" aria-hidden="true" tabindex="-1"></a>iris.sub <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">%in%</span> params<span class="sc">$</span>species, ]</span></code></pre></div>
<p>The parameter can be referenced frequently to update the text in the document or to filter to the data of interest. In the image below, the iris data set will be filtered by the specified parameter to generate <code>iris.sub</code>. <code>iris.sub</code> will be used to calculate the mean value for each flower characteristic.</p>
<center>
<p><img src="img/rmarkdown/param_iris-summary.png" /></p>
</center>
</div>
<div id="knitting" class="section level2 hasAnchor" number="99.2">
<h2 class="hasAnchor"><span class="header-section-number">99.2</span> Knitting<a href="#knitting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To the knit the document, click on the knit drop-down menu (the small triangle to the right of the Knit button) and select ‚ÄúKnit with Parameters‚Ä¶‚Äù A pop-up window will appear specifying the list of available parameters and their default values. These default values can be edited prior to clicking ‚Äúknit‚Äù at the bottom right of the window.</p>
<center>
<p><img src="img/rmarkdown/params_knit-with-parameters.png" /></p>
</center>
<p>The document will then render.</p>
<center>
<p><img src="img/rmarkdown/param_rendered-example.png" width="600" /></p>
</center>
</div>
<div id="rmarkdownrender" class="section level2 hasAnchor" number="99.3">
<h2 class="hasAnchor"><span class="header-section-number">99.3</span> rmarkdown::render()<a href="#rmarkdownrender" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <strong>rmarkdown</strong> function <code>render()</code> can also be used to compile the document. The <code>input</code> specifies the parameterized .Rmd file. The <code>params</code> argument species the parameter values to be used when rendering the document. Note that the value supplied to <code>params</code> must be wrapped by <code>list()</code>.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="at">input =</span> <span class="st">&quot;parameterized/param_template.Rmd&quot;</span>,</span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">params =</span> <span class="fu">list</span>(<span class="at">species =</span> <span class="st">&quot;setosa&quot;</span>))</span></code></pre></div>
<p>It would not be efficient to specify each parameter of interest one-by-one. Instead a loop can be written to iteratively generate parameterized documents. Below the function <code>lapply()</code> is used to create the loop. <code>unique(iris$Species)</code> supplies a vector of unique species names (i.e., ‚Äúsetosa‚Äù, ‚Äúversicolor‚Äù, and ‚Äúvirginica‚Äù) to generate parameterized reports. <code>species.i</code> is specified as a placeholder to represent each unique species in the iris data set; therefore <code>species.i</code> is used to specify what the species parameter should equal and it is used to generate a unique and easy to interpret file name <code>output_file = paste0(species.i, ".HTML")</code>.</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">unique</span>(iris<span class="sc">$</span>Species), <span class="cf">function</span>(species.i) {</span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="st">&quot;parameterized/param_template.Rmd&quot;</span>,</span>
<span id="cb576-3"><a href="#cb576-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">params =</span> <span class="fu">list</span>(<span class="at">species =</span> species.i),</span>
<span id="cb576-4"><a href="#cb576-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">output_file =</span> <span class="fu">paste0</span>(species.i, <span class="st">&quot;.HTML&quot;</span>))</span>
<span id="cb576-5"><a href="#cb576-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="your-turn-5" class="section level2 hasAnchor" number="99.4">
<h2 class="hasAnchor"><span class="header-section-number">99.4</span> Your Turn<a href="#your-turn-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Create a new .Rmd file and copy/paste the content of the .Rmd file created in <a href="#lesson-5-code-chunks-and-inline-code">Lesson 5: Code Chunks and Inline Code</a></li>
<li>add <code>params:</code> and specify lake as a parameter with Onondaga as the default (<code>lake: Onondaga</code>) to the YAML header</li>
<li>Use inline code to have the YAML title update to include the specified parameter (<code>params$lake</code>)</li>
<li>In your introductory paragraph, use inline code to specify that this document is specific to X Lake.</li>
<li>Filter <code>thesis.df</code> to only represent the specified lake parameter</li>
</ol>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a>thesis.df <span class="ot">&lt;-</span> thesis.df <span class="sc">%&gt;%</span> </span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lake <span class="sc">%in%</span> params<span class="sc">$</span>lake)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><p>Update your conclusion section text to specify that the results are from X Lake and use inline code to specify:</p>
<ul>
<li>the minimum relative abundance of Diptera taxa <code>min(thesis.df$pct_diptera)</code></li>
<li>the maximum relative abundance of Diptera taxa <code>max(thesis.df$pct_diptera)</code></li>
<li>the median richness value observed in the lake <code>median(thesis.df$richness)</code></li>
</ul></li>
<li><p>Render the document using the ‚ÄúKnit with Parameters‚Ä¶‚Äù button</p>
<ul>
<li>Use the default parameter</li>
<li>Specify a different parameter (e.g., lake = Cazenovia)</li>
</ul></li>
<li><p><strong>Bonus:</strong> Try to write a loop with <code>lapply()</code> and <code>render()</code> to automate the process to generate a report for each of the three lakes in the data set.</p></li>
</ol>
<!--chapter:end:1701_markdown.Rmd-->
</div>
</div>
<div id="thoughts-from-hadley-wickham-on-tidyverse" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Thoughts from Hadley Wickham on Tidyverse<a href="#thoughts-from-hadley-wickham-on-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Although I‚Äôm perpetually reluctant to embed videos that I don‚Äôt host, I think hearing from Hadley Wickham is worthwhile.</p>
<div id="dive-into-hadley-wickhams-tidyverse" class="section level2 hasAnchor" number="99.5">
<h2 class="hasAnchor"><span class="header-section-number">99.5</span> Dive into Hadley Wickham‚Äôs Tidyverse<a href="#dive-into-hadley-wickhams-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/MjHQo-t2v_c" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="current-state-of-the-tidyverse-2020" class="section level2 hasAnchor" number="99.6">
<h2 class="hasAnchor"><span class="header-section-number">99.6</span> Current State of the Tidyverse (2020)<a href="#current-state-of-the-tidyverse-2020" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/OwwYfxB8CA0" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:2306_hadley.Rmd-->
</div>
</div>
<div id="part-back-matter" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART) Back Matter<a href="#part-back-matter" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="good-resources" class="section level1 hasAnchor" number="100">
<h1 class="hasAnchor"><span class="header-section-number">100</span> Good Resources<a href="#good-resources" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><a href="https://psychnerdjae.github.io/into-the-tidyverse/" class="uri">https://psychnerdjae.github.io/into-the-tidyverse/</a></li>
<li><a href="https://github.com/rundel/hw01">Automatic Grading with RMarkdown example</a></li>
<li><a href="https://afredston.github.io/learn-git/learn-git.html">Git/Github for virtual learning</a> (from <a href="https://twitter.com/AFredston/status/1354865931772682243">this tweet</a>)</li>
<li><a href="https://github.com/therealsreehari/Learn-Datascience-for-Free">Learn-Datascience-for-Free</a></li>
<li><a href="https://allisonhorst.shinyapps.io/dplyr-learnr/" class="uri">https://allisonhorst.shinyapps.io/dplyr-learnr/</a></li>
</ul>
<div id="cheatsheets" class="section level2 hasAnchor" number="100.1">
<h2 class="hasAnchor"><span class="header-section-number">100.1</span> Cheatsheets<a href="#cheatsheets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rstudio has a glorious number of <a href="https://rstudio.com/resources/cheatsheets/">cheatsheets</a>, including:</p>
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/blob/master/old/pdfs/data-wrangling-cheatsheet.pdf">Data Wrangling</a></li>
</ul>
</div>
</div>
<div id="media-without-a-home-yet" class="section level1 hasAnchor" number="101">
<h1 class="hasAnchor"><span class="header-section-number">101</span> Media without a home yet<a href="#media-without-a-home-yet" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="sips-resources" class="section level2 hasAnchor" number="101.1">
<h2 class="hasAnchor"><span class="header-section-number">101.1</span> SIPS Resources<a href="#sips-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://docs.google.com/document/d/1z15bL9cP84re6d4zdkO60q06lnknnN3xEktN7GnLFFQ/edit">Data Management Hackathon - Syllabus</a></li>
<li><a href="http://improvingpsych.org/sipsinaction/sips-products/">SIPS Products</a></li>
</ul>
</div>
<div id="visualizing-linear-models-an-r-bag-of-tricks" class="section level2 hasAnchor" number="101.2">
<h2 class="hasAnchor"><span class="header-section-number">101.2</span> Visualizing Linear Models: An R Bag of Tricks<a href="#visualizing-linear-models-an-r-bag-of-tricks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://friendly.github.io/VisMLM-course/">Visualizing Linear Models: An R Bag of Tricks</a></li>
</ul>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">I&#39;m starting a 3-week <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> short course, Visualizing Linear Models: An R Bag of Tricks.<br>One week on univariate models, two weeks on models for multivariate responses. <br>Lectures notes, examples and exercises are at: <a href="https://t.co/LF1iVPZOPs">https://t.co/LF1iVPZOPs</a></p>&mdash; Michael Friendly (@datavisFriendly) <a href="https://twitter.com/datavisFriendly/status/1365801123584565249?ref_src=twsrc%5Etfw">February 27, 2021</a></blockquote>

</div>
<div id="for-new-programmers-learning-keyboard-shortcuts" class="section level2 hasAnchor" number="101.3">
<h2 class="hasAnchor"><span class="header-section-number">101.3</span> For new programmers learning keyboard shortcuts‚Ä¶<a href="#for-new-programmers-learning-keyboard-shortcuts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.shortcutfoo.com/" class="uri">https://www.shortcutfoo.com/</a></p>
</div>
<div id="are-you-a-student-if-yes-this-is-the-best-data-science-project-for-you" class="section level2 hasAnchor" number="101.4">
<h2 class="hasAnchor"><span class="header-section-number">101.4</span> Are you a student? If yes, this is the best data science project for you!<a href="#are-you-a-student-if-yes-this-is-the-best-data-science-project-for-you" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/2goqyY5XBeI" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="rstudio-is-magic" class="section level2 hasAnchor" number="101.5">
<h2 class="hasAnchor"><span class="header-section-number">101.5</span> rstudio is magic<a href="#rstudio-is-magic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">Multiple cursors in <a href="https://twitter.com/rstudio?ref_src=twsrc%5Etfw">@RStudio</a> are so handy! Holding down the option key and drag gives me multiple synced cursors üñ±Ô∏èüñ±Ô∏èüñ±Ô∏è <a href="https://t.co/nQKzqIwsou">pic.twitter.com/nQKzqIwsou</a></p>&mdash; Emil Hvitfeldt (@Emil_Hvitfeldt) <a href="https://twitter.com/Emil_Hvitfeldt/status/1356468455101227009?ref_src=twsrc%5Etfw">February 2, 2021</a></blockquote>

</div>
<div id="automation-quote" class="section level2 hasAnchor" number="101.6">
<h2 class="hasAnchor"><span class="header-section-number">101.6</span> automation quote<a href="#automation-quote" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">&quot;I‚Äôve always objected to doing anything over again if I had already done it once.&quot; ‚Äì Grace Hopper</p>&mdash; Programming Wisdom (@CodeWisdom) <a href="https://twitter.com/CodeWisdom/status/1358724807525871617?ref_src=twsrc%5Etfw">February 8, 2021</a></blockquote>

</div>
<div id="how-computer-memory-works" class="section level2 hasAnchor" number="101.7">
<h2 class="hasAnchor"><span class="header-section-number">101.7</span> How computer memory works!<a href="#how-computer-memory-works" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/p3q5zWCw8J4" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="is-coding-a-math-skill-or-a-language-skill-neither-both" class="section level2 hasAnchor" number="101.8">
<h2 class="hasAnchor"><span class="header-section-number">101.8</span> Is Coding a Math Skill or a Language Skill? Neither? Both?<a href="#is-coding-a-math-skill-or-a-language-skill-neither-both" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/xPecMsFmEm4?t=7" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="quantum-computers-explained" class="section level2 hasAnchor" number="101.9">
<h2 class="hasAnchor"><span class="header-section-number">101.9</span> Quantum Computers Explained!<a href="#quantum-computers-explained" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/JhHMJCUmq28" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="the-rise-of-the-machines-why-automation-is-different-this-time" class="section level2 hasAnchor" number="101.10">
<h2 class="hasAnchor"><span class="header-section-number">101.10</span> The Rise of the Machines ‚Äì Why Automation is Different this Time<a href="#the-rise-of-the-machines-why-automation-is-different-this-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/WSKi8HfcxEk" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="emergence-how-stupid-things-become-smart-together" class="section level2 hasAnchor" number="101.11">
<h2 class="hasAnchor"><span class="header-section-number">101.11</span> Emergence ‚Äì How Stupid Things Become Smart Together<a href="#emergence-how-stupid-things-become-smart-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/16W7c0mb-rE" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="how-not-to-ask-for-help" class="section level2 hasAnchor" number="101.12">
<h2 class="hasAnchor"><span class="header-section-number">101.12</span> How not to ask for help<a href="#how-not-to-ask-for-help" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>#&gt; Error in tweet_blockquote(tweet_url = tweet_url, maxwidth = maxwidth,  : 
#&gt;   Not Found (HTTP 404).</code></pre>
</div>
<div id="the-birthday-paradox" class="section level2 hasAnchor" number="101.13">
<h2 class="hasAnchor"><span class="header-section-number">101.13</span> The Birthday Paradox<a href="#the-birthday-paradox" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/ofTb57aZHZs" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="why-cant-you-divide-by-zero" class="section level2 hasAnchor" number="101.14">
<h2 class="hasAnchor"><span class="header-section-number">101.14</span> Why can‚Äôt you divide by zero?<a href="#why-cant-you-divide-by-zero" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/NKmGVE85GUU" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="yea-hes-chewing-up-my-stats-homework-but-that-face-though" class="section level2 hasAnchor" number="101.15">
<h2 class="hasAnchor"><span class="header-section-number">101.15</span> Yea he‚Äôs chewing up my stats homework but that face though‚Ä¶<a href="#yea-hes-chewing-up-my-stats-homework-but-that-face-though" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote class="reddit-card" data-card-created="1611607953">
<a href="https://www.reddit.com/r/CatsBeingCats/comments/l4fnqx/yea_hes_chewing_up_my_stats_homework_but_that/">Yea he‚Äôs chewing up my stats homework but that face though‚Ä¶</a> from <a href="http://www.reddit.com/r/CatsBeingCats">r/CatsBeingCats</a>
</blockquote>
<script async src="//embed.redditmedia.com/widgets/platform.js" charset="UTF-8"></script>
</div>
<div id="coding-kitty" class="section level2 hasAnchor" number="101.16">
<h2 class="hasAnchor"><span class="header-section-number">101.16</span> Coding Kitty<a href="#coding-kitty" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://hostrider.com/" class="uri">https://hostrider.com/</a></p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">I‚Äôve been using R since 2008. Today I learned about stats::reformulate(). <a href="https://t.co/7xm4CiHkW9">https://t.co/7xm4CiHkW9</a></p>&mdash; James E. Pustejovsky (@jepusto) <a href="https://twitter.com/jepusto/status/1471297801506234368?ref_src=twsrc%5Etfw">December 16, 2021</a></blockquote>

</div>
<div id="democratic-databases-science-on-github" class="section level2 hasAnchor" number="101.17">
<h2 class="hasAnchor"><span class="header-section-number">101.17</span> Democratic databases: science on GitHub<a href="#democratic-databases-science-on-github" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Nature:</em> ‚Äú<a href="https://www.nature.com/news/democratic-databases-science-on-github-1.20719">Democratic databases: science on GitHub</a>‚Äù (Perkel, 2016).</p>
</div>
<div id="ten-simple-rules-for-getting-started-on-twitter-as-a-scientist" class="section level2 hasAnchor" number="101.18">
<h2 class="hasAnchor"><span class="header-section-number">101.18</span> Ten simple rules for getting started on Twitter as a scientist<a href="#ten-simple-rules-for-getting-started-on-twitter-as-a-scientist" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1007513" class="uri">https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1007513</a></p>
</div>
<div id="nyt-data-ethics-stuff" class="section level2 hasAnchor" number="101.19">
<h2 class="hasAnchor"><span class="header-section-number">101.19</span> NYT data ethics stuff<a href="#nyt-data-ethics-stuff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.nytimes.com/2021/01/31/technology/facial-recognition-photo-tool.html" class="uri">https://www.nytimes.com/2021/01/31/technology/facial-recognition-photo-tool.html</a></p>
</div>
<div id="section" class="section level2" number="101.20">
<h2><span class="header-section-number">101.20</span> </h2>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="qst" dir="ltr">Art! <a href="https://t.co/XuDToJAmnp">https://t.co/XuDToJAmnp</a></p>&mdash; Prof. Mason Garrison üåàüí´‚ú® (@SMasonGarrison) <a href="https://twitter.com/SMasonGarrison/status/1372640164493856773?ref_src=twsrc%5Etfw">March 18, 2021</a></blockquote>

<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--HappyGitWithR Links-->
<!--Package Links-->
<!--Shiny links-->
<!--Publications-->
<!--R Documentation-->
<!--Wikipedia Links-->
<!--Misc. Links-->
<!--chapter:end:9997_resources.Rmd-->
</div>
</div>
<div id="public-health" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Public Health<a href="#public-health" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Ok, so I know that this class is about data science, R, and data visualization‚Ä¶ However, I figured that it might be helpful for us all to have some public health dashboards in one easy place. If you want, we can pretend that this section is course content related‚Ä¶ because it shows data and whatnot. Or that it can give you ideas for portfolio pieces‚Ä¶</p>
<div id="crowns-and-tears-a-covid-19-visualization-with-a-music-box-and-punch-cards" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Crowns and Tears: A Covid-19 visualization with a Music Box and punch cards<a href="#crowns-and-tears-a-covid-19-visualization-with-a-music-box-and-punch-cards" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/DqfrOPs2pKM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>Source Code: <a href="https://github.com/simonhuwiler/crowns-and-tears" class="uri">https://github.com/simonhuwiler/crowns-and-tears</a></p>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/Tp-BrzUtMBM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="masks" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Masks<a href="#masks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/pa6BlJlrL-k" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="dashboards" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Dashboards<a href="#dashboards" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="wake-forest" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Wake Forest<a href="#wake-forest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The embedded dashboards are maintained by Wake Forest University and are made using <a href="https://powerbi.microsoft.com/en-us/what-is-power-bi/">Microsoft Power BI</a>. More info about the dashboard can be found here <a href="https://ourwayforward.wfu.edu/covid-19-dashboard">here</a></p>
<p><br></p>
<iframe src="https://ourwayforward.wfu.edu/covid-19-dashboard/#powerbi-embedded-1946" scrolling="no" style="width: 100%; height:775px">
</iframe>
</div>
<div id="north-carolina" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">North Carolina<a href="#north-carolina" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe src="https://mapf.maps.arcgis.com/apps/opsdashboard/index.html#/926f40a0fb9d43729fbc0f42f0f5a940" style="width:100%;height:600px">
</iframe>
&lt;iframe style=‚Äúwidth:100%&gt;
<div id="viz1647719625614" class="tableauPlaceholder" style="position: relative">
<noscript>
<a href='https:&#47;&#47;covid19.ncdhhs.gov&#47;dashboard&#47;wastewater-monitoring'><img alt='North Carolina Wastewater Monitoring Network ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;4Q&#47;4Q7H8WCY4&#47;1_rss.png' style='border: none' /></a>
</noscript>
<object class="tableauViz" style="display:none;">
<param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;4Q7H8WCY4' /> <param name='toolbar' value='no' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;4Q&#47;4Q7H8WCY4&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' />
</object>
</div>
<pre><code>            &lt;script type=&#39;text/javascript&#39;&gt;                    var divElement = document.getElementById(&#39;viz1647719625614&#39;);                    var vizElement = divElement.getElementsByTagName(&#39;object&#39;)[0];                    if ( divElement.offsetWidth &gt; 800 ) { vizElement.style.width=&#39;700px&#39;;vizElement.style.height=&#39;1750px&#39;;} else if ( divElement.offsetWidth &gt; 500 ) { vizElement.style.width=&#39;700px&#39;;vizElement.style.height=&#39;1750px&#39;;} else { vizElement.style.width=&#39;100%&#39;;vizElement.style.height=&#39;2050px&#39;;}                     var scriptElement = document.createElement(&#39;script&#39;);                    scriptElement.src = &#39;https://public.tableau.com/javascripts/api/viz_v1.js&#39;;                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                &lt;/script&gt;</code></pre>
</iframe>
<!--chapter:end:9998_publichealth.Rmd-->
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">References<a href="#references" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:9999_references.Rmd-->
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fox2016applied" class="csl-entry">
Fox, John. 2016. <em>Applied Regression Analysis and Generalized Linear Models</em>. Third edition. Los Angeles: SAGE Publications, Inc.
</div>
<div id="ref-spector2008" class="csl-entry">
Spector, P. 2008. <em>Data Manipulation with r</em>. Use r! Springer. <a href="https://books.google.com/books?id=grfuq1twFe4C">https://books.google.com/books?id=grfuq1twFe4C</a>.
</div>
<div id="ref-white2013" class="csl-entry">
White, Ethan P., Elita Baldridge, Zachary T. Brym, Kenneth J. Locey, Daniel J. McGlinn, and Sarah R. Supp. 2013. <span>‚ÄúNine Simple Ways to Make It Easier to (Re)use Your Data.‚Äù</span> <em>PeerJ PrePrints</em> 1 (July): e7v2. <a href="https://doi.org/10.7287/peerj.preprints.7v2">https://doi.org/10.7287/peerj.preprints.7v2</a>.
</div>
<div id="ref-wickham2015a" class="csl-entry">
Wickham, H. 2015. <em>Advanced r</em>. Chapman &amp; Hall/CRC the r Series. CRC Press. <a href="https://books.google.com/books?id=FfsYCwAAQBAJ">https://books.google.com/books?id=FfsYCwAAQBAJ</a>.
</div>
<div id="ref-wickham2011b" class="csl-entry">
Wickham, Hadley. 2011a. <span>‚ÄúTestthat: Get Started with Testing.‚Äù</span> <em>The R Journal</em> 3 (1): 5‚Äì10.
</div>
<div id="ref-wickham2011a" class="csl-entry">
‚Äî‚Äî‚Äî. 2011b. <span>‚ÄúThe Split-Apply-Combine Strategy for Data Analysis.‚Äù</span> <em>Journal of Statistical Software, Articles</em> 40 (1): 1‚Äì29. <a href="https://doi.org/10.18637/jss.v040.i01">https://doi.org/10.18637/jss.v040.i01</a>.
</div>
<div id="ref-wickham2014" class="csl-entry">
‚Äî‚Äî‚Äî. 2014. <span>‚ÄúTidy Data.‚Äù</span> <em>Journal of Statistical Software, Articles</em> 59 (10): 1‚Äì23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
<div id="ref-wickham-unpub" class="csl-entry">
Wickham, Hadley, and Jenny Bryan. In progress. <em>R Packages</em>. 2nd ed. <a href="https://r-pkgs.org">https://r-pkgs.org</a>.
</div>
<div id="ref-wickham2016" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. O‚ÄôReilly Media. <a href="https://books.google.com/books?id=vfi3DQAAQBAJ">https://books.google.com/books?id=vfi3DQAAQBAJ</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>(ref:sourcetree-install)<a href="#fnref1" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p>(If previous versions of this lab, there was an automated check to see if for your R Markdown document knitted properly. It required using github actions, which made this lab a tad too complicated.)<a href="#fnref2" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn3"><p>Source: <a href="https://collections.ed.ac.uk/art/about" class="uri">https://collections.ed.ac.uk/art/about</a><a href="#fnref3" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn4"><p>Source: <a href="https://www.opensecrets.org/about/">Open Secrets - About</a>.<a href="#fnref4" class="footnote-back">‚Ü©Ô∏é</a></p></li>
<li id="fn5"><p><a href="http://www.dartmouth.edu/~chance/course/topics/winning_number.html" class="uri">http://www.dartmouth.edu/~chance/course/topics/winning_number.html</a><a href="#fnref5" class="footnote-back">‚Ü©Ô∏é</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
